/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 Socket.IO v4.4.1
 (c) 2014-2022 Guillermo Rauch
 Released under the MIT License.
*/
var $jscomp$templatelit$1=['\n    <ul class="','">\n      ',"\n    </ul>\n  "];$jscomp$templatelit$1.raw=$jscomp$templatelit$1.slice();var $jscomp$templatelit$0=['\n        <li class="','">',"</li>\n      "];$jscomp$templatelit$0.raw=$jscomp$templatelit$0.slice();var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(l){var t=0;return function(){return t<l.length?{done:!1,value:l[t++]}:{done:!0}}};$jscomp.arrayIterator=function(l){return{next:$jscomp.arrayIteratorImpl(l)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,t,n){l!=Array.prototype&&l!=Object.prototype&&(l[t]=n.value)};$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(l,t){this.$jscomp$symbol$id_=l;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function l(n){if(this instanceof l)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(n||"")+"_"+t++,n)}var t=0;return l}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.iterator;l||(l=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[l]&&$jscomp.defineProperty(Array.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.asyncIterator;l||(l=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(l){$jscomp.initSymbolIterator();l={next:l};l[$jscomp.global.Symbol.iterator]=function(){return this};return l};
$jscomp.makeIterator=function(l){var t="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];return t?t.call(l):$jscomp.arrayIterator(l)};$jscomp.arrayFromIterator=function(l){for(var t,n=[];!(t=l.next()).done;)n.push(t.value);return n};$jscomp.arrayFromIterable=function(l){return l instanceof Array?l:$jscomp.arrayFromIterator($jscomp.makeIterator(l))};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(l){var t=function(){};t.prototype=l;return new t};
$jscomp.underscoreProtoCanBeSet=function(){var l={a:!0},t={};try{return t.__proto__=l,t.a}catch(n){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(l,t){l.__proto__=t;if(l.__proto__!==t)throw new TypeError(l+" is not extensible");return l}:null;
$jscomp.inherits=function(l,t){l.prototype=$jscomp.objectCreate(t.prototype);l.prototype.constructor=l;if($jscomp.setPrototypeOf){var n=$jscomp.setPrototypeOf;n(l,t)}else for(n in t)if("prototype"!=n)if(Object.defineProperties){var h=Object.getOwnPropertyDescriptor(t,n);h&&Object.defineProperty(l,n,h)}else l[n]=t[n];l.superClass_=t.prototype};
$jscomp.polyfill=function(l,t,n,h){if(t){n=$jscomp.global;l=l.split(".");for(h=0;h<l.length-1;h++){var u=l[h];u in n||(n[u]={});n=n[u]}l=l[l.length-1];h=n[l];t=t(h);t!=h&&null!=t&&$jscomp.defineProperty(n,l,{configurable:!0,writable:!0,value:t})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(l){function t(){this.batch_=null}function n(e){return e instanceof u?e:new u(function(a,c){a(e)})}if(l&&!$jscomp.FORCE_POLYFILL_PROMISE)return l;t.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(e)};var h=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){h(e,0)};t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=
this.batch_;this.batch_=[];for(var a=0;a<e.length;++a){var c=e[a];e[a]=null;try{c()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e;})};var u=function(e){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{e(a.resolve,a.reject)}catch(c){a.reject(c)}};u.prototype.createResolveAndReject_=function(){function e(f){return function(e){c||(c=!0,f.call(a,e))}}var a=this,c=!1;
return{resolve:e(this.resolveTo_),reject:e(this.reject_)}};u.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof u)this.settleSameAsPromise_(e);else{a:switch(typeof e){case "object":var a=null!=e;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}};u.prototype.resolveToNonPromiseObj_=function(e){var a=void 0;try{a=e.then}catch(c){this.reject_(c);return}"function"==typeof a?
this.settleSameAsThenable_(a,e):this.fulfill_(e)};u.prototype.reject_=function(e){this.settle_(2,e)};u.prototype.fulfill_=function(e){this.settle_(1,e)};u.prototype.settle_=function(e,a){if(0!=this.state_)throw Error("Cannot settle("+e+", "+a+"): Promise already settled in state"+this.state_);this.state_=e;this.result_=a;this.executeOnSettledCallbacks_()};u.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)m.asyncExecute(this.onSettledCallbacks_[e]);
this.onSettledCallbacks_=null}};var m=new t;u.prototype.settleSameAsPromise_=function(e){var a=this.createResolveAndReject_();e.callWhenSettled_(a.resolve,a.reject)};u.prototype.settleSameAsThenable_=function(e,a){var c=this.createResolveAndReject_();try{e.call(a,c.resolve,c.reject)}catch(f){c.reject(f)}};u.prototype.then=function(e,a){function c(a,c){return"function"==typeof a?function(k){try{f(a(k))}catch(x){h(x)}}:c}var f,h,q=new u(function(a,c){f=a;h=c});this.callWhenSettled_(c(e,f),c(a,h));return q};
u.prototype.catch=function(e){return this.then(void 0,e)};u.prototype.callWhenSettled_=function(e,a){function c(){switch(f.state_){case 1:e(f.result_);break;case 2:a(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?m.asyncExecute(c):this.onSettledCallbacks_.push(c)};u.resolve=n;u.reject=function(e){return new u(function(a,c){c(e)})};u.race=function(e){return new u(function(a,c){for(var f=$jscomp.makeIterator(e),h=f.next();!h.done;h=f.next())n(h.value).callWhenSettled_(a,
c)})};u.all=function(e){var a=$jscomp.makeIterator(e),c=a.next();return c.done?n([]):new u(function(f,e){function q(a){return function(c){k[a]=c;h--;0==h&&f(k)}}var k=[],h=0;do k.push(void 0),h++,n(c.value).callWhenSettled_(q(k.length-1),e),c=a.next();while(!c.done)})};return u},"es6","es3");$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(l){if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(l){this.yieldResult=l};$jscomp.generator.Context.prototype.throw_=function(l){this.abruptCompletion_={exception:l,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(l){this.abruptCompletion_={return:l};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(l){this.abruptCompletion_={jumpTo:l};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(l,t){this.nextAddress=t;return{value:l}};$jscomp.generator.Context.prototype.yieldAll=function(l,t){l=$jscomp.makeIterator(l);var n=l.next();$jscomp.generator.ensureIteratorResultIsObject_(n);if(n.done)this.yieldResult=n.value,this.nextAddress=t;else return this.yieldAllIterator_=l,this.yield(n.value,t)};
$jscomp.generator.Context.prototype.jumpTo=function(l){this.nextAddress=l};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(l,t){this.catchAddress_=l;void 0!=t&&(this.finallyAddress_=t)};$jscomp.generator.Context.prototype.setFinallyBlock=function(l){this.catchAddress_=0;this.finallyAddress_=l||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(l,t){this.nextAddress=l;this.catchAddress_=t||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(l){this.catchAddress_=l||0;l=this.abruptCompletion_.exception;this.abruptCompletion_=null;return l};$jscomp.generator.Context.prototype.enterFinallyBlock=function(l,t,n){n?this.finallyContexts_[n]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=l||0;this.finallyAddress_=t||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(l,t){t=this.finallyContexts_.splice(t||0)[0];if(t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();void 0!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=l};$jscomp.generator.Context.prototype.forIn=function(l){return new $jscomp.generator.Context.PropertyIterator(l)};
$jscomp.generator.Context.PropertyIterator=function(l){this.object_=l;this.properties_=[];for(var t in l)this.properties_.push(t);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var l=this.properties_.pop();if(l in this.object_)return l}return null};$jscomp.generator.Engine_=function(l){this.context_=new $jscomp.generator.Context;this.program_=l};
$jscomp.generator.Engine_.prototype.next_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,l,this.context_.next_);this.context_.next_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(l){this.context_.start_();var t=this.context_.yieldAllIterator_;if(t)return this.yieldAllStep_("return"in t?t["return"]:function(l){return{value:l,done:!0}},l,this.context_.return);this.context_.return(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],l,this.context_.next_);this.context_.throw_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(l,t,n){try{var h=l.call(this.context_.yieldAllIterator_,t);$jscomp.generator.ensureIteratorResultIsObject_(h);if(!h.done)return this.context_.stop_(),h;var u=h.value}catch(m){return this.context_.yieldAllIterator_=null,this.context_.throw_(m),this.nextStep_()}this.context_.yieldAllIterator_=null;n.call(this.context_,u);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var l=this.program_(this.context_);if(l)return this.context_.stop_(),{value:l.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}this.context_.stop_();if(this.context_.abruptCompletion_){l=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(l.isException)throw l.exception;return{value:l.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(l){this.next=function(t){return l.next_(t)};this.throw=function(t){return l.throw_(t)};this.return=function(t){return l.return_(t)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(l,t){t=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(t));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(t,l.prototype);return t};
$jscomp.asyncExecutePromiseGenerator=function(l){function t(h){return l.next(h)}function n(h){return l.throw(h)}return new Promise(function(h,u){function m(e){e.done?h(e.value):Promise.resolve(e.value).then(t,n).then(m,u)}m(l.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(l){return $jscomp.asyncExecutePromiseGenerator(l())};$jscomp.asyncExecutePromiseGeneratorProgram=function(l){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(l)))};
$jscomp.iteratorFromArray=function(l,t){$jscomp.initSymbolIterator();l instanceof String&&(l+="");var n=0,h={next:function(){if(n<l.length){var u=n++;return{value:t(u,l[u]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};$jscomp.polyfill("Array.prototype.keys",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l){return l})}},"es6","es3");
$jscomp.polyfill("Object.is",function(l){return l?l:function(l,n){return l===n?0!==l||1/l===1/n:l!==l&&n!==n}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(l){return l?l:function(l,n){var h=this;h instanceof String&&(h=String(h));var u=h.length;n=n||0;for(0>n&&(n=Math.max(n+u,0));n<u;n++){var m=h[n];if(m===l||Object.is(m,l))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(l,t,n){if(null==l)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return l+""};$jscomp.polyfill("String.prototype.includes",function(l){return l?l:function(l,n){return-1!==$jscomp.checkStringArgs(this,l,"includes").indexOf(l,n||0)}},"es6","es3");
$jscomp.owns=function(l,t){return Object.prototype.hasOwnProperty.call(l,t)};$jscomp.polyfill("Object.entries",function(l){return l?l:function(l){var n=[],h;for(h in l)$jscomp.owns(l,h)&&n.push([h,l[h]]);return n}},"es8","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var l={},t=Object.create(new $jscomp.global.Proxy(l,{get:function(n,h,u){return n==l&&"q"==h&&u==t}}));return!0===t.q}catch(n){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(l){function t(){if(!l||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),e=new l([[a,2],[c,3]]);if(2!=e.get(a)||3!=e.get(c))return!1;e.delete(a);e.set(c,4);return!e.has(a)&&4==e.get(c)}catch(k){return!1}}function n(){}function h(a){var f=typeof a;return"object"===f&&null!==a||"function"===f}function u(a){if(!$jscomp.owns(a,e)){var f=new n;$jscomp.defineProperty(a,e,{value:f})}}function m(a){var f=Object[a];f&&(Object[a]=function(a){if(a instanceof
n)return a;u(a);return f(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(t())return l;var e="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var a=0,c=function(f){this.id_=(a+=Math.random()+1).toString();if(f){f=$jscomp.makeIterator(f);for(var c;!(c=f.next()).done;)c=c.value,this.set(c[0],c[1])}};c.prototype.set=function(a,c){if(!h(a))throw Error("Invalid WeakMap key");u(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+
a);a[e][this.id_]=c;return this};c.prototype.get=function(a){return h(a)&&$jscomp.owns(a,e)?a[e][this.id_]:void 0};c.prototype.has=function(a){return h(a)&&$jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};c.prototype.delete=function(a){return h(a)&&$jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return c},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(l){function t(){if($jscomp.ASSUME_NO_NATIVE_MAP||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),f=new l($jscomp.makeIterator([[a,"s"]]));if("s"!=f.get(a)||1!=f.size||f.get({x:4})||f.set({x:4},"t")!=f||2!=f.size)return!1;var e=f.entries(),h=e.next();if(h.done||h.value[0]!=a||"s"!=h.value[1])return!1;h=e.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!e.next().done?!1:!0}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(t())return l;$jscomp.initSymbolIterator();var n=new WeakMap,h=function(a){this.data_={};this.head_=e();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};h.prototype.set=function(a,f){a=0===a?0:a;var c=u(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=f:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:f},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};h.prototype.delete=function(a){a=u(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};h.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};h.prototype.has=function(a){return!!u(this,a).entry};
h.prototype.get=function(a){return(a=u(this,a).entry)&&a.value};h.prototype.entries=function(){return m(this,function(a){return[a.key,a.value]})};h.prototype.keys=function(){return m(this,function(a){return a.key})};h.prototype.values=function(){return m(this,function(a){return a.value})};h.prototype.forEach=function(a,f){for(var c=this.entries(),e;!(e=c.next()).done;)e=e.value,a.call(f,e[1],e[0],this)};h.prototype[Symbol.iterator]=h.prototype.entries;var u=function(c,f){var e=f&&typeof f;"object"==
e||"function"==e?n.has(f)?e=n.get(f):(e=""+ ++a,n.set(f,e)):e="p_"+f;var h=c.data_[e];if(h&&$jscomp.owns(c.data_,e))for(c=0;c<h.length;c++){var k=h[c];if(f!==f&&k.key!==k.key||f===k.key)return{id:e,list:h,index:c,entry:k}}return{id:e,list:h,index:-1,entry:void 0}},m=function(a,f){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:f(c)};c=null}return{done:!0,value:void 0}})},e=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return h},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(l,t){for(var n=1;n<arguments.length;n++){var h=arguments[n];if(h)for(var u in h)$jscomp.owns(h,u)&&(l[u]=h[u])}return l};$jscomp.polyfill("Object.assign",function(l){return l||$jscomp.assign},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l,n){return n})}},"es8","es3");
$jscomp.polyfill("Math.trunc",function(l){return l?l:function(l){l=Number(l);if(isNaN(l)||Infinity===l||-Infinity===l||0===l)return l;var n=Math.floor(Math.abs(l));return 0>l?-n:n}},"es6","es3");$jscomp.polyfill("Object.values",function(l){return l?l:function(l){var n=[],h;for(h in l)$jscomp.owns(l,h)&&n.push(l[h]);return n}},"es8","es3");$jscomp.polyfill("Math.log10",function(l){return l?l:function(l){return Math.log(l)/Math.LN10}},"es6","es3");
$jscomp.polyfill("Array.from",function(l){return l?l:function(l,n,h){n=null!=n?n:function(a){return a};var u=[],m="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];if("function"==typeof m){l=m.call(l);for(var e=0;!(m=l.next()).done;)u.push(n.call(h,m.value,e++))}else for(m=l.length,e=0;e<m;e++)u.push(n.call(h,l[e],e));return u}},"es6","es3");
$jscomp.findInternal=function(l,t,n){l instanceof String&&(l=String(l));for(var h=l.length,u=0;u<h;u++){var m=l[u];if(t.call(n,m,u,l))return{i:u,v:m}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(l){return l?l:function(l,n){return $jscomp.findInternal(this,l,n).v}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(l,n,h){var u=this.length||0;0>n&&(n=Math.max(0,u+n));if(null==h||h>u)h=u;h=Number(h);0>h&&(h=Math.max(0,u+h));for(n=Number(n||0);n<h;n++)this[n]=l;return this}},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Set",function(l){function t(){if($jscomp.ASSUME_NO_NATIVE_SET||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var h=Object.seal({x:4}),u=new l($jscomp.makeIterator([h]));if(!u.has(h)||1!=u.size||u.add(h)!=u||1!=u.size||u.add({x:4})!=u||2!=u.size)return!1;var m=u.entries(),e=m.next();if(e.done||e.value[0]!=h||e.value[1]!=h)return!1;e=m.next();return e.done||e.value[0]==h||4!=e.value[0].x||e.value[1]!=e.value[0]?!1:m.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(t())return l;$jscomp.initSymbolIterator();var n=function(h){this.map_=new Map;if(h){h=$jscomp.makeIterator(h);for(var l;!(l=h.next()).done;)this.add(l.value)}this.size=this.map_.size};n.prototype.add=function(h){h=0===h?0:h;this.map_.set(h,h);this.size=this.map_.size;return this};n.prototype.delete=function(h){h=this.map_.delete(h);this.size=this.map_.size;return h};n.prototype.clear=function(){this.map_.clear();
this.size=0};n.prototype.has=function(h){return this.map_.has(h)};n.prototype.entries=function(){return this.map_.entries()};n.prototype.values=function(){return this.map_.values()};n.prototype.keys=n.prototype.values;n.prototype[Symbol.iterator]=n.prototype.values;n.prototype.forEach=function(h,l){var m=this;this.map_.forEach(function(e){return h.call(l,e,e,m)})};return n},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(l){return l?l:function(l,n){var h=$jscomp.checkStringArgs(this,l,"startsWith");l+="";var u=h.length,m=l.length;n=Math.max(0,Math.min(n|0,h.length));for(var e=0;e<m&&n<u;)if(h[n++]!=l[e++])return!1;return e>=m}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(l){return l?l:function(l,n){var h=$jscomp.checkStringArgs(this,l,"endsWith");l+="";void 0===n&&(n=h.length);n=Math.max(0,Math.min(n|0,h.length));for(var u=l.length;0<u&&0<n;)if(h[--n]!=l[--u])return!1;return 0>=u}},"es6","es3");
var EnxRtc=function(l){function t(h){if(n[h])return n[h].exports;var u=n[h]={i:h,l:!1,exports:{}};l[h].call(u.exports,u,u.exports,t);u.l=!0;return u.exports}var n={};t.m=l;t.c=n;t.d=function(h,l,m){t.o(h,l)||Object.defineProperty(h,l,{configurable:!1,enumerable:!0,get:m})};t.n=function(h){var l=h&&h.__esModule?function(){return h["default"]}:function(){return h};t.d(l,"a",l);return l};t.o=function(h,l){return Object.prototype.hasOwnProperty.call(h,l)};t.p="";return t(t.s=33)}([function(l,t,n){Object.defineProperty(t,
"__esModule",{value:!0});l=n(1);var h=n.n(l),u=n(34),m=function(){u().format("YY-MM-DD::HH:mm:ss");var e=function(a){console.log.apply(console,$jscomp.arrayFromIterable(a))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){if("string"===typeof a||"number"===typeof a){var c=a;"number"===typeof c?(c=Math.round(a),c<=m.ERROR&&c>=m.DEBUG?m.logLevel=c:c==m.NONE&&(m.logLevel=m.ERROR),m.error("setting log level:  req: "+a+" old: "+c+"new: "+m.logLevel)):(a=m.logLevel,-1<"DEBUG TRACE INFO WARNING ERROR NONE".split(" ").indexOf(c)?
(m.logLevel=c,m.error("setting log level:  req: "+c+" old: "+a+"new: "+m.logLevel)):m.error("setLogLevel() invalid param"))}else m.error("setLogLevel() invalid param type")},getLogLevel:function(a){return m.logLevel},setOutputFunction:function(a){e=a},setLogPrefix:function(a){},setLogCache:function(a){m.logCache=a},log:function(a,c){for(var f=[],w=1;w<arguments.length;++w)f[w-1]=arguments[w];var q=u().format("YY-MM-DD::HH:mm:ss:SSS")+":";if(!(a<m.logLevel)){switch(a){case m.DEBUG:q+="D";break;case m.TRACE:q+=
"T";break;case m.INFO:q+="I";break;case m.WARNING:q+="W";break;case m.ERROR:q+="E"}q+="::";w=h.a.getLocalStorageItem("logID");q+=null!=w?w:"";w=[q].concat(f);if(m.logCache){var k="";for(v in f)k="object"===typeof f[v]?k+JSON.stringify(f[v],null,2):k+f[v];f={};var v=h.a.getLocalStorageItem("vcxRTCLib-log");null!=v&&(f=JSON.parse(v),500<Object.keys(f).length&&delete Object.keys(f)[0],h.a.removeLocalStorageItem("vcxRTCLib-log"));f[q]=k;h.a.setLocalStorageItem("vcxRTCLib-log",JSON.stringify(f,null,2))}if(void 0!==
m.panel){f="";for(v=0;v<w.length;v+=1)f+=w[v];m.panel.value=m.panel.value+"\n"+f}else e.apply(m,[w])}},debug:function(a){for(var c=[],f=0;f<arguments.length;++f)c[f-0]=arguments[f];m.log.apply(m,[m.DEBUG].concat($jscomp.arrayFromIterable(c)))},trace:function(a){for(var c=[],f=0;f<arguments.length;++f)c[f-0]=arguments[f];m.log.apply(m,[m.TRACE].concat($jscomp.arrayFromIterable(c)))},info:function(a){for(var c=[],f=0;f<arguments.length;++f)c[f-0]=arguments[f];m.log.apply(m,[m.INFO].concat($jscomp.arrayFromIterable(c)))},
warning:function(a){for(var c=[],f=0;f<arguments.length;++f)c[f-0]=arguments[f];m.log.apply(m,[m.WARNING].concat($jscomp.arrayFromIterable(c)))},error:function(a){for(var c=[],f=0;f<arguments.length;++f)c[f-0]=arguments[f];m.log.apply(m,[m.ERROR].concat($jscomp.arrayFromIterable(c)))}}}();m.logLevel=m.INFO;m.logCache=!0;t["default"]=m},function(l,t,n){n(35);var h={socketCustomPathSupported:!0,socketCustomPath:"/v3/socket.io/"};t=h.socketCustomPathSupported?void 0!=h.socketCustomPath?h.socketCustomPath:
"/v3/socket.io/":void 0;h.socketiopath=t;h.browser_info=function(){var e="none",a,c=window.navigator.userAgent;if(-1!=(a=c.indexOf("OPR")))var f="opera";else-1!=(a=c.indexOf("Firefox"))?f="mozilla":-1!=(a=c.indexOf("Edg"))?f="edge":-1!=(a=c.indexOf("Chrome"))?f="chrome-stable":-1!=c.indexOf("Safari")?(f="safari",-1!=(a=c.indexOf("Version"))&&(e=c.substring(a+8))):-1!=(a=c.indexOf("MSIE"))||-1!=(a=c.indexOf("Windows NT"))?f="IE":(c.includes("iPhone")||c.includes("iPad"))&&c.includes("Mobile")&&-1!=
(a=c.indexOf("OS"))?((f=c.substring(a+3))&&(e=f.substring(0,f.indexOf(" "))),e?(e.replace(/_/g,"."),f="safari"):(f="none",a=-1)):f="none";if("none"==e&&-1!=a){var h=c.substring(a);-1!=(a=h.indexOf("/"))&&(e=h.substring(a+1))}var q;-1!=(q=e.indexOf(";"))&&(e=e.substring(0,q));-1!=(q=e.indexOf(" "))&&(e=e.substring(0,q));a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(c)?"mobile":"desktop";return{name:f,version:e,device_type:a}}();h.is_supported=!(void 0===
RTCPeerConnection||!/chrome-stable|mozilla|safari|opera|edge/i.test(h.browser_info.name));h.browser_type=window.navigator.userAgent.match("Chrome")?"chrome-stable":window.navigator.userAgent.match("Firefox")?"mozilla":window.navigator.userAgent.match(/Safari|AppleWebKit/g)?"safari":window.navigator.userAgent.match("Edge")?"edge":window.navigator.userAgent.match("Electron")?"electron":window.navigator.userAgent.match(".NET")?"IE":"none";h.device_type=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(window.navigator.userAgent)?
"mobile":"desktop";h.videoBitrateQualityMap;h.cameraResolutionTable;var u=function(e,a,c,f){var h=c;switch(a){case "get":h=e.getItem(c);break;case "set":e.setItem(c,f);break;case "remove":e.removeItem(c)}return h},m=function(e,a,c){try{return u(localStorage,e,a,c)}catch(f){if(void 0!=f.SecurityError)try{return u(sessionStorage,e,a,c)}catch(w){}return null}};l.exports={product:{company:"Vcloudx Inc",product:"enablex.io",version:"3.1.8",release:"3.1.8"},maxClientsForDataChannel:40,default_region:["IN"],
data_throughput_duration:2,video_bandwidth_duration:10,audio_bandwidth_duration:10,video_layer_bitrates:{0:3E5,1:8E5,2:15E5},video_resolution_range:{FD:{min:{width:160,height:90},max:{width:1280,height:720}},HD:{min:{width:320,height:180},max:{width:1280,height:720}},SD:{min:{width:320,height:180},max:{width:960,height:540}},LD:{min:{width:160,height:90},max:{width:640,height:360}},Default:{min:{width:160,height:90},max:{width:1280,height:720}}},video_bandwidth_range:{FD:{0:{min:100,max:1200},1:{min:100,
max:800},2:{min:100,max:400}},HD:{0:{min:100,max:1200},1:{min:100,max:800},2:{min:100,max:400}},SD:{0:{min:100,max:700},1:{min:100,max:400},2:{min:100,max:250}},LD:{0:{min:80,max:400},1:{min:80,max:250},2:{min:80,max:150}},ND:{0:{min:0,max:0},1:{min:40,max:200},2:{min:40,max:100}},share:{min:100,max:400},canvas:{min:1024,max:4096}},screen_resolution_range:{FD:{bw:600,fps:20},HD:{bw:600,fps:20},SD:{bw:400,fps:15},LD:{bw:200,fps:10}},proxy_api_url:"apiproxy.enablex.io",proxy_api_port:443,ice_servers:{IN:{turnURI:"turns:ts.enablex.io:443",
turnUdpURI:"turns:ts.enablex.io:19302?transport=udp",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},US:{turnURI:"turns:eu2ts.enablex.io:443",turnUdpURI:"turns:eu2ts.enablex.io:19302?transport=udp",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},SG:{turnURI:"turns:sgts.enablex.io:443",turnUdpURI:"turns:sgts.enablex.io:19302?transport=udp",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},
DE:{turnURI:"turns:gwcts.enablex.io:443",turnUdpURI:"turns:gwcts.enablex.io:19302?transport=udp",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"}},browser_info:h.browser_info,browser_type:h.browser_type,device_type:h.device_type,socketiopath:h.socketiopath,user_agent:window.navigator.userAgent,is_supported:function(){return h.is_supported},setVideoBwQualityMapper:function(e){e.minBwKbpsToCheck&&(h.videoBitrateQualityMap=e.bpsQualityMapTable.slice(),h.cameraResolutionTable=
e.camResTable.slice());h.videoQualityMapMinBwKbps=e.minBwKbpsToCheck},getBitrateMapTable:function(){return h.videoBitrateQualityMap},getCamResolutionTable:function(){return h.cameraResolutionTable},getCamResTableToCheck:function(e){if(void 0!==h.videoBitrateQualityMap&&e<=h.videoQualityMapMinBwKbps)for(var a=0;a<h.videoBitrateQualityMap.length;a++)if(h.videoBitrateQualityMap[a].kbps<=e)return{resTable:h.cameraResolutionTable.slice(h.videoBitrateQualityMap[a].resTable.index),fps:h.videoBitrateQualityMap[a].fps.max}},
internetDetectionUrl:"https://api.enablex.io/status",getLocalStorageItem:function(e){return m("get",e)},setLocalStorageItem:function(e,a){return m("set",e,a)},removeLocalStorageItem:function(e){return m("remove",e)},senduserDataMaximumLimit:2048,noise_analysis:!0,noise_suppression_sdk_url:"https://d1seim8g02n0k0.cloudfront.net/noise_suppression_sdk/EnxNs.js",csp_enabled:!1,eventLogLevel:"warn",getMediaConnectionTimeoutSecs:function(e){return e?5:30},socketErrorTimeoutSecs:5}},function(l,t,n){var h=
n(4);t.a=function(){var l=Object(h.c)({});l.url="";return l}},function(l,t,n){var h=function(l){var m=l.name;var e=l.src;var a=l.srcObject;var c=l.href;var f=l.rel;var w=l.type;var q=l.target;var k=l.autoplay;var v=l.playsinline;var r=l.alt;var x=l.title;var p=l.id;var b=l.class;l=h.getStyle(l.style);var u=null;m&&""!=m&&null!=m&&(u=document.createElement(m),e&&""!=e&&null!=e&&u.setAttribute("src",e),a&&""!=a&&null!=a&&u.setAttribute("srcObject",a),c&&""!=c&&null!=c&&u.setAttribute("href",c),q&&""!=
q&&null!=q&&u.setAttribute("target",q),r&&""!=r&&null!=r&&u.setAttribute("alt",r),x&&""!=x&&null!=x&&u.setAttribute("title",x),f&&""!=f&&null!=f&&u.setAttribute("rel",f),w&&""!=w&&null!=w&&u.setAttribute("type",w),k&&""!=k&&null!=k&&u.setAttribute("autoplay",k),v&&""!=v&&null!=v&&u.setAttribute("playsinline",v),p&&""!=p&&null!=p&&u.setAttribute("id",p),b&&""!=b&&null!=b&&u.setAttribute("class",b),l&&""!=l&&null!=l&&u.setAttribute("style",l));return u};h.getStyle=function(h){var m="",e;for(e in h)m+=
e+":"+h[e]+";";return m};h.getById=function(h){return document.getElementById(h)};h.getByClass=function(h){return document.getElementsByClassName(h)[0]};h.getByTag=function(h){return document.getElementsByTagName(h)[0]};h.getTagByDOM=function(h,m){return m.getElementsByTagName(h)[0]};h.getByClass=function(h,m){return m.getElementsByClassName(h)[0]};h.append=function(h,m){return m.appendChild(h)};h.setStyle=function(h,m,e){h.style[m]=e};h.addCssFile=function(l){h.getByTag("head").appendChild(l)};h.checkParam=
function(h){var m=!1;h&&null!=h&&""!=h&&(m=!0);return m};t.a=h},function(l,t,n){n.d(t,"c",function(){return m});n.d(t,"b",function(){return e});n.d(t,"e",function(){return a});n.d(t,"f",function(){return c});n.d(t,"d",function(){return f});n.d(t,"g",function(){return w});n.d(t,"a",function(){return q});var h=n(0),u=n(7),m=function(){var a={},c={};a.addEventListener=function(a,k){void 0===c[a]&&(c[a]=[]);c[a].push(k)};a.removeEventListener=function(a,k){c[a]&&(k=c[a].indexOf(k),-1!==k&&c[a].splice(k,
1))};if("IE"!==u.a.browserEngineCheck())a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&h["default"].debug(" dispatchEvent() Event: "+JSON.stringify(a.type));for(var k=c[a.type]||[],b=0;b<k.length;b+=1)k[b](a)};else{var f=function(a,k){k=k||{bubbles:!1,cancelable:!1,detail:void 0};var b=document.createEvent("CustomEvent");b.initCustomEvent(a,k.bubbles,k.cancelable,k.detail);b.data=k.detail;
return b};f.prototype=window.Event.prototype;window.CustomEvent=f;a.dispatchEvent=function(a){"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&h["default"].debug("dispatchEvent() Event: "+a.type);a=f(a.type,{bubbles:!1,cancelable:!1,detail:a});document.getElementById("WebrtcEverywherePluginId").dispatchEvent(a)}}a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;a.eventsList=c;return a},e=function(a){var k={};k.type=a.type;return k},a=function(a){var k=
e(a);k.streams=a.streams;k.message=a.message;k.room=a.room;k.users=a.users;k.type=a.type;k.bandwidth=a.bandwidth;k.TalkerCount=a.TalkerCount;k.me=a.me;k.mediaRecord=a.mediaRecord;k.error=a.error;return k},c=function(a){var k=e(a);k.stream=a.stream;k.msg=a.msg;k.bandwidth=a.bandwidth;k.attrs=a.attrs;return k},f=function(a){return e(a)},w=function(a){var k=e(a);k.name=a.name;k.role=a.role;k.clientId=a.clientId;k.permissions=a.permission;void 0!=a.user_ref&&(k.user_ref=a.user_ref);void 0!=a.data&&(k.data=
a.data);return k},q=function(a){var k=e(a);k.message=a.message;return k}},function(l,t,n){l={SocketEvent:{},RoomEvent:{},UserEvent:{},StreamEvent:{}};l.SocketEvent.onAddStream="onAddStream";l.SocketEvent.onRemoveTrack="onRemoveTrack";l.SocketEvent.media_engine_connecting="media_engine_connecting";l.SocketEvent.signaling_message_peer="signaling_message_peer";l.SocketEvent.publish_me="publish_me";l.SocketEvent.unpublish_me="unpublish_me";l.SocketEvent.onBandwidthAlert="onBandwidthAlert";l.SocketEvent.onBandwidthEvents=
"bandwidthEvents";l.SocketEvent.onSelfBandwidthAlert="onSelfBandwidthAlert";l.SocketEvent.onDataStream="onDataStream";l.SocketEvent.onUpdateAttributeStream="onUpdateAttributeStream";l.SocketEvent.onRemoveStream="onRemoveStream";l.SocketEvent.disconnect="disconnect";l.SocketEvent.connection_failed="connection_failed";l.SocketEvent.error="error";l.SocketEvent.connect_error="connect_error";l.SocketEvent.connect_timeout="connect_timeout";l.SocketEvent.reconnecting="reconnecting";l.SocketEvent.reconnect=
"reconnect";l.SocketEvent.reconnected="reconnected";l.SocketEvent.reconnect_attempt="reconnect_attempt";l.SocketEvent.reconnect_error="reconnect_error";l.SocketEvent.reconnect_failed="reconnect_failed";l.SocketEvent.user_connected="user-connected";l.SocketEvent.user_updated="user-updated";l.SocketEvent.user_disconnected="user-disconnected";l.SocketEvent.user_subscribed="user-subscribed";l.SocketEvent.user_unsubscribed="user-unsubscribed";l.SocketEvent.dial_state_events="dialStateEvents";l.RoomEvent.user_role_changed=
"userRoleChanged";l.RoomEvent.user_role_management_events="userRoleManagementEvents";l.SocketEvent.onStatSubscription="onStatSubscription";l.SocketEvent.onStreamingNotification="onStreamingNotification";l.SocketEvent.onHlsStreamingNotification="onHlsStreamingNotification";l.SocketEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";l.SocketEvent.onLiveRecordingNotification="onLiveRecordingNotification";l.SocketEvent.onRoomLiveRecordingOn="room-live-recording-on";l.SocketEvent.onRoomLiveRecordingOff=
"room-live-recording-off";l.SocketEvent.onRoomLiveRecordingFailed="room-live-recording-failed";l.SocketEvent.data_stream_room="onDataStreamToRoom";l.RoomEvent.onStreamingNotification="onStreamingNotification";l.RoomEvent.onHlsStreamingNotification="onHlsStreamingNotification";l.RoomEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";l.RoomEvent.onLiveRecordingNotification="onLiveRecordingNotification";l.UserEvent.user_awaited="user-awaited";l.UserEvent.user_joined=
"user-joined";l.RoomEvent.room_connected="room-connected";l.RoomEvent.room_disconnected="room-disconnected";l.RoomEvent.room_awaited="room-awaited";l.RoomEvent.room_record_on="room-record-on";l.RoomEvent.room_record_off="room-record-off";l.RoomEvent.onRoomLiveRecordingOn="room-live-recording-on";l.RoomEvent.onRoomLiveRecordingOff="room-live-recording-off";l.RoomEvent.onRoomLiveRecordingFailed="room-live-recording-failed";l.RoomEvent.update_layout="update-layout";l.RoomEvent.change_layout="change-layout";
l.RoomEvent.new_active_talker="active-talkers-updated";l.RoomEvent.hard_mute_audio="hardmute-user-audio";l.RoomEvent.hard_unmute_audio="hardunmute-user-audio";l.RoomEvent.hard_mute_video="hardmute-user-video";l.RoomEvent.get_active_talker="getNumberOfTalker";l.RoomEvent.set_active_talker="setNumberOfTalker";l.RoomEvent.get_active_max_talker="getMaxNumberOfTalker";l.RoomEvent.set_adavanced_options="setAdvancedOptions";l.RoomEvent.get_adavanced_options="getAdvancedOptions";l.RoomEvent.client_stats=
"clientStats";l.RoomEvent.switch_user_role="switchUserRole";l.RoomEvent.hard_unmute_video="hardunmute-user-video";l.RoomEvent.auxilary_publish_events="auxilaryPublishEvents";l.RoomEvent.share_started="shareStarted";l.RoomEvent.share_stopped="shareStopped";l.RoomEvent.screen_share_override="shareOverride";l.RoomEvent.streaming_uri="streamingUri";l.RoomEvent.stop_sharing="stopSharing";l.RoomEvent.share_state_events="shareStateEvents";l.RoomEvent.extend_conference_duration="extendConferenceDuration";
l.RoomEvent.lock_room="lockRoom";l.RoomEvent.drop="drop";l.RoomEvent.subscriber_video_mute="subscriber-video-mute";l.RoomEvent.switch_codec="switch-publish-media-codec";l.RoomEvent.canvas_started="canvasStarted";l.RoomEvent.canvas_stopped="canvasStopped";l.RoomEvent.canvas_state_events="canvasStateEvents";l.RoomEvent.custom_data_saved="CustomDataSaved";l.RoomEvent.custom_data_updated="CustomDataUpdated";l.RoomEvent.transcription_events="transcription-events";l.RoomEvent.analytics_events="meeting-summary-events";
l.RoomEvent.meeting_summary_subscription_events="meeting-summary-subscription";l.RoomEvent.invite_breakout_room="invite-breakout-room";l.RoomEvent.user_joined_breakout_room="user-joined-breakout-room";l.RoomEvent.user_left_breakout_room="breakout-user-disconnected";l.RoomEvent.breakout_room_destroyed="breakout-room-destroyed";l.RoomEvent.generic_events="genericEvents";l.RoomEvent.network_reconnected="network-reconnected";l.RoomEvent.network_disconnected="network-disconnected";l.RoomEvent.network_reconnectiontimeout=
"network-reconnect-timeout";l.RoomEvent.network_reconnectfailed="network-reconnect-failed";l.RoomEvent.fs_upload_started="fs-upload-started";l.RoomEvent.fs_file_uploaded="fs-file-available";l.RoomEvent.fs_download_started="fs-download-started";l.RoomEvent.fs_file_downloaded="fs-upload-success";l.RoomEvent.fs_file_upload_result="fs-upload-result";l.RoomEvent.fs_file_download_result="fs-download-result";l.SocketEvent.floor_management_events="floorManagementEvents";l.SocketEvent.room_management_events=
"roomManagementEvents";l.UserEvent.user_audio_muted="user-audio-muted";l.UserEvent.user_audio_unmuted="user-audio-unmuted";l.UserEvent.user_video_muted="user-video-muted";l.UserEvent.user_video_unmuted="user-video-unmuted";l.SocketEvent.hard_mute="hardMute";l.SocketEvent.hard_mute_room="room-muted";l.SocketEvent.hard_unmute_room="room-unmuted";l.SocketEvent.switched_room="roomSwitched";l.RoomEvent.room_transcription_on="room-transcription-on";l.RoomEvent.room_transcription_off="room-transcription-off";
l.RoomEvent.self_transcription_on="self-transcription-on";l.RoomEvent.self_transcription_off="self-transcription-off";l.constant={};l.constant.H264_CODEC="H264_AND_OPUS";l.constant.default="default";l.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8="12.0";l.constant.SAFARI_VERSION_SUPPORTING_VP8="12.1";l.constant.FIREFOX_VERSION_VIDEO_MUTE_SUPPORT="60.0";l.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="72.0";l.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="66.0";l.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT=
"13.0.0";l.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="64.0";l.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="13.1.0";l.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT="11.0.0";t.a=l},function(l,t,n){t.a={error_000:{result:0,msg:"success"},error_1000:{result:1E3,msg:"Non supported browser"},error_1130:{result:1130,error:"Moderator not present/ wait for Moderator",desc:""},error_1131:{result:1131,error:"room/media connection not exists",desc:""},error_1132:{result:1132,error:"video quality param mismatch / same as existing param/ invalid range ",
desc:""},error_1133:{result:1133,error:"internal system error",desc:""},error_1140:{result:1140,error:"Previous similar request in process",desc:""},error_1141:{result:1141,error:"Remote streams can't be muted",desc:""},error_1142:{result:1142,error:"Invalid Device Id",desc:"OverconstrainedError: Invalid device id provided"},error_1143:{result:1143,error:"Requested device not found",desc:"NotFoundError: Requested device was not found"},error_1144:{result:1144,error:"Permission denied",desc:"NotAllowedError: The request is not allowed by the user agent or the platform in the current context"},
error_1145:{result:1145,error:"Could not start video source",desc:"NotReadableError: Could not start video source"},error_1146:{result:1146,error:"Failed to execute getUserMedia on MediaDevices",desc:"TypeError: At least one of audio and video must be requested"},error_1147:{result:1147,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video width constraint could not be satisfied"},error_1148:{result:1148,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video height constraint could not be satisfied"},
error_1149:{result:1149,error:"Constraints could be not satisfied",desc:"One of the constraints (Height, Width, DeviceId) is not satisfied."},error_1150:{result:1150,error:"Reason unknown",desc:"Reason unknown"},error_1151:{result:1151,error:"A screen share is already running",desc:""},error_1152:{result:1152,error:"Audio only calls are allowed/set with your current browser ",desc:""},error_1153:{result:1153,error:"Unsupported browser",desc:""},error_1154:{result:1154,error:"Given frame rate is not supported",
desc:"Frame rate might be negative or not a number which is not accepted by captureStream method"},error_1155:{result:1155,error:"Invalid options/parameters /values",desc:"Invalid options parameters/values "},error_1156:{result:1156,error:"Invalid streamType",desc:" streamType  should be set as canvas for canvas streams and talker for talker streams"},error_1157:{result:1157,error:"The given canvas element does not exist in the DOM",desc:"The canvas element you have provided does not exist in the DOM"},
error_1158:{result:1158,error:"This browser does not support canvas",desc:"This browser does not support canvas"},error_1159:{result:1159,error:"Stream / User not found",desc:"Stream / User not found"},error_1160:{result:1160,error:"Media connection failure",desc:"Media connection failure"},error_1161:{result:1161,error:"Server connection failure",desc:"Server connection failure"},error_1162:{result:1162,error:"The DOM element does not exist",desc:"The element with DOM reference provided does not exist"},
error_1163:{result:1163,error:"Network disconnected",desc:"Socket or media connection has failed due to network error"},error_1164:{result:1164,error:"Network reconnected",desc:"Network reconnected"},error_1165:{result:1165,error:"Reconnect attempt exceeded",desc:"Reconnection failed"},error_1166:{result:1166,error:"Reconnection timed out",desc:"Reconnection failed"},error_1167:{result:1167,error:"Publish or subscribe failed",desc:"After reconnection publish or subscibe failed"},error_1168:{result:1168,
error:"Not allowed",desc:"Only moderator has rights to excercise this transaction"},error_1169:{result:1169,msg:"No listener for event",desc:""},error_1170:{result:1170,error:"Not supported",desc:"Feature is not enabled because of room config or no licence "},error_1171:{result:1171,error:"Room not connected",desc:"Room not connected"},error_1172:{result:1172,error:"Room connect failed",desc:"Room connect failed"},error_1173:{result:1173,error:"Floor not granted for participant",desc:"Floor not granted"},
error_1174:{result:1174,error:"Local Recording started already",desc:""},error_1175:{result:1175,error:"Local Recording not started /stream not having media",desc:""},error_1176:{result:1176,error:"Moderator declined right to control media devices ",desc:""},error_1177:{result:1177,error:"MediaDevice state is already in same state",desc:""},error_1178:{result:1178,error:"Reconnection for a single participant in the room is not allowed",desc:"Reconnection not allowed"},error_1179:{result:1179,error:" files to upload input array size is 0",
desc:" empty file transfer is not allowed"},error_1180:{result:1180,error:" room is disconected",desc:" file sharing is not allowed on disconnected rooms"},error_1181:{result:1181,error:" Recieve file operation is not permitted.",desc:" File which you are trying to receive  does not exist."},error_1182:{result:1182,error:"file upload failed",desc:"file upload failed "},error_1183:{result:1183,error:" file download failed ",desc:" file download failed"},error_1184:{result:1184,error:"user video resolution inavlid range",
desc:"user video resolution inavlid range"},error_1185:{result:1185,error:"file upload failed ",desc:"file upload failed because provided file list is empty"},error_1186:{result:1186,error:"file upload failed ",desc:"file size is zero bytes"},error_1187:{result:1187,error:"file upload failed ",desc:"file upload failed because it exceeded max upload limit"},error_1188:{result:1188,error:"current and requested state / value are same",desc:"current and requested state / value are same"},error_1189:{result:1189,
error:"Media operation not allowed in mute state",desc:""},error_4121:{result:4121,error:"room already locked / unlocked",desc:" room is already locked/unlocked"},error_7000:{result:7E3,error:"streaming error",desc:" streaming error"},error_7008:{result:7008,error:"streaming error",desc:"only moderator can start streaming"},error_7009:{result:7009,error:"streaming error",desc:"invalid or undefined streaming configuration"},error_7101:{result:7101,error:"streaming error",desc:"rtmpUrl should not exceed more than 3 values"},
error_7102:{result:7102,error:"streaming error",desc:"invalid rtmp or url format"},error_7103:{result:7103,error:"streaming error",desc:"room is disconnecting, cannot start streaming"},error_7044:{result:7044,error:"streaming error",desc:"only moderator can stop streaming"},error_7045:{result:7045,error:"streaming error",desc:"room is disconnecting, streaming will be stopped"},error_7072:{result:7072,error:"streaming params change error",desc:"only moderator can change streaming params"},error_7078:{result:7078,
error:"streaming params change error",desc:"room is disconnecting, cannot change streaming params"},error_7201:{result:7201,error:"live recording error",desc:"only moderator can start live recording"},error_7202:{result:7202,error:"live recording error",desc:"invalid url format"},error_7203:{result:7203,error:"live recording error",desc:"room is disconnecting, cannot start live recording"},error_7204:{result:7204,error:"live recording error",desc:"live recording error"},error_7036:{result:7036,error:"live recording error",
desc:"only moderator can stop live recording"},error_7037:{result:7037,error:"live recording error",desc:"room is disconnecting, live recording will be stopped"},error_7079:{result:7079,error:"room is disconected",desc:"Layout update is not allowed on disconnected rooms"},error_7071:{result:7071,error:"live recording error",desc:"only moderator can change live recording params"},error_8000:{result:8E3,error:"invalidate transcoding error",desc:"Room is disconnecting, invalidate transcoding cannot be performed now"},
error_8001:{result:8001,error:"Live transcription is already in progress",desc:"Live transcription is already in progress"},error_8002:{result:8002,error:"Live transcription is not running",desc:"Live transcription is not started"},error_8003:{result:8003,error:"Live summary is already in progress",desc:"Live summary is already in progress"},error_8004:{result:8004,error:"Live summary is not running",desc:"Live summary is not started"},CC002:{cause:2002,msg:"unexpected-disconnection"},CC006:{cause:2006,
msg:"normal-disconnect"},error_1190:{result:1190,error:"Exception found",desc:"Could not fetch video size"},error_1191:{result:1191,error:"Stream track ended state ",desc:"Stream track is already ended"},error_1192:{result:1192,error:"Invalid parameters",desc:"Invalid value for layout parameter"},error_1193:{result:1193,error:"Invalid parameters",desc:"Invalid value for service parameter"},error_1194:{result:1194,error:"Invalid parameters",desc:"Invalid value for clients parameter"},error_1195:{result:1195,
error:"Large text Data",desc:"Failed to handle larger text-data"},error_1196:{result:1196,error:"content-length value exceeded.",desc:"Entered value of content-length exceeded the maximum allowed value."},error_1197:{result:1197,error:"stream Invalid state .",desc:"room not published or already stream in published."},error_1198:{result:1198,error:"failed to start noise suppression",desc:""},error_1199:{result:1199,error:"failed to stop noise suppression",desc:""},error_1200:{result:1200,error:"share initiation timeout",
desc:""},error_1201:{result:1201,error:"insufficient privilages. operation is allowed only for Moderator",desc:""},error_1202:{result:1202,error:"room config supports audio_only / audioOnly is enabled by user , no effect on requested API",desc:""},error_1203:{result:1203,error:"moderator unmute operation not allowed as user muted already",desc:""},error_1707:{result:1707,msg:"Request Not found"}}},function(l,t,n){(function(h){var l=n(38),m=n(39),e=n(40),a=n(0),c=n(26),f=n(6),w=n(5),q=n(8),k=n(9),
v=103,r,x=!1,p={deviceList:void 0},b=function(){var b="none";"undefined"!==typeof h&&h.exports?b="fake":null!==window.navigator.userAgent.match("Firefox")?b="mozilla":null!==window.navigator.userAgent.match("Chrome")?(b="chrome-stable",null!==window.navigator.userAgent.match("Electron")?b="electron":null!==window.navigator.userAgent.match("Edge")&&(b="edge")):null!==window.navigator.userAgent.match("Safari")?b="safari":null!==window.navigator.userAgent.match("AppleWebKit")?b="safari":null!==window.navigator.userAgent.match(".NET")&&
(b="IE");return b},J=function(){var b=navigator.userAgent,a=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(a[1])){var k=/\brv[ :]+(\d+)/g.exec(b)||[];return"IE "+(k[1]||"")}if("Chrome"===a[1]&&(k=b.match(/\b(OPR|Edge)\/(\d+)/),null!=k))return k.slice(1).join(" ").replace("OPR","Opera");a=a[2]?a[2]:navigator.appVersion;null!=(k=b.match(/version\/([^\s]+)/i))&&(a=k[1]);return a},F=function(b){var a=J();if("string"!==typeof b)return!1;a=a.split(".");b=
b.split(".");for(var k=Math.min(a.length,b.length),c=0;c<k;++c){a[c]=parseInt(a[c],10);b[c]=parseInt(b[c],10);if(a[c]>b[c])return!1;if(a[c]<b[c])return!0}return a.length==b.length?!1:!(a.length<b.length)},z=function(b,a){for(var k={cam:[],mic:[],speaker:[]},c={},f={},d={},e=function(b,a,d){b.label?console.log(" checkProcessDevice() device name: "+b.label):console.log(" checkProcessDevice() no device name id: "+b.deviceId);b.label&&b.label.includes("Intel")&&b.label.includes("RealSense")?console.log("checkProcessDevice() Intel RealSense device,ignoring. DevInfo: "+
JSON.stringify(b)):"default"==b.deviceId.toLowerCase()&&b.label?d.label=b.label:b.label&&d.label&&d.label.includes(b.label)?(b=JSON.parse(JSON.stringify(b)),b.label=d.label,b.default=!0,a.unshift(b),d.label=void 0):(b.default=!1,a.push(b))},h=function(b,a){a.default=!0;b.length?b.unshift(a):b.push(a)},q=0;q<b.length;q++)switch(b[q].kind){case "audioinput":a.mic&&e(b[q],k.mic,c);break;case "videoinput":a.cam&&e(b[q],k.cam,f);break;case "audiooutput":a.speaker&&e(b[q],k.speaker,d)}c.label&&h(k.mic,
c);f.label&&h(k.cam,f);d.label&&h(k.speaker,d);return k},M=function(b){var a={cam:[],mic:[],speaker:[]},k={cam:[],mic:[],speaker:[]},c={cam:[],mic:[],speaker:[]};if(void 0!==p.deviceList){k=JSON.parse(JSON.stringify(p.deviceList));for(var f in b.cam){var d=!1,e;for(e in k.cam)b.cam[f].deviceId===k.cam[e].deviceId&&(c.cam.push(k.cam.splice(e,1)[0]),d=!0);!1===d&&a.cam.push(b.cam[f])}for(var h in b.mic){f=!1;for(var q in k.mic)b.mic[h].deviceId===k.mic[q].deviceId&&b.mic[h].label===k.mic[q].label&&
(c.mic.push(k.mic.splice(q,1)[0]),f=!0);!1===f&&a.mic.push(b.mic[h])}for(var m in b.speaker){h=!1;for(var r in k.speaker)b.speaker[m].deviceId===k.speaker[r].deviceId&&b.speaker[m].label===k.speaker[r].label&&(c.speaker.push(k.speaker.splice(r,1)[0]),h=!0);!1===h&&a.speaker.push(b.speaker[m])}p.deviceList=b}return{current:c,added:a,removed:k}},A=function(e,h,m){m=void 0===m?!0:m;"IE"===b()||"edge"===b()?(k.a.error("agent-event",q.a.event_incompatible_browser,{error:f.a.error_1153}),h(null,f.a.error_1153)):
x&&"safari"===b()?h("success",null):navigator.mediaDevices.getUserMedia(e).then(function(b){x=!0;h(b,null)}).catch(function(b){console.log("getUserMedia() failed err: "+JSON.stringify(b)+" config: "+JSON.stringify(e));b=Object(c.a)(b);k.a.error("agent-event",q.a.event_gum_failed,{error:b});if(!m||b.result!==f.a.error_1143.result&&b.result!==f.a.error_1144.result)a["default"].error("Failed to get media devices : "+JSON.stringify(b)),h(null,b);else if(e.video&&e.audio){var p=JSON.parse(JSON.stringify(e));
p.video=!1;p.videoConfigured=e.video;a["default"].warning("getUserMedia() failed with error: "+JSON.stringify(b)+" retry with audio-only");A(p,h)}else e.video||void 0==e.videoConfigured?(a["default"].error("Failed to get media devices permission: "+JSON.stringify(b)),h(null,b)):(p=JSON.parse(JSON.stringify(e)),p.video=e.videoConfigured,p.audio=!1,console.log("getUserMedia() failed with error: "+JSON.stringify(b)+" retry with video-only"),A(p,h))})},C=function(b){navigator.mediaDevices.enumerateDevices().then(function(a){b(a)})},
G=function(b,k){var c={};void 0!==b?(c.mic=void 0!=b.mic?b.mic:!1,c.cam=void 0!=b.cam?b.cam:!1,c.speaker=void 0!=b.speaker?b.speaker:!1):c={mic:!0,cam:!0,speaker:!0};a["default"].debug("getDeviceList ops: "+JSON.stringify(b)+" media ops: "+JSON.stringify(c));c.mic||c.cam?A({audio:c.mic,video:c.cam},function(b,a){b||a&&(a.result===f.a.error_1145.result||a.result===f.a.error_1150.result)?C(function(b,e){b?(console.log("getDeviceList() getList() devices: "+JSON.stringify(b)),b=z(b,c),k({result:0,devices:b})):
k(a&&a.result===f.a.error_1145.result?a:e)}):(console.log("getDeviceList() getMediaPermission() failed ,error: "+JSON.stringify(a)),k(a))}):c.speaker?C(function(b,a){b&&(b=z(b,c),k({result:0,devices:b}))}):k(f.a.error_1155)},N=function(){return document.getElementById("WebrtcEverywherePluginId")},X=function(b,a,k,c){b.addEventListener(a,k,c)};t.a={GetUserMedia:function(c,f,e){f=void 0===f?function(){}:f;e=void 0===e?function(){}:e;var m,p=b();if("chrome-stable"===p||"electron"===p||"mozilla"===p||
"safari"===p){var d=function(b,a,d){navigator.mediaDevices.getUserMedia(b).then(a).catch(d)};var v=function(b,a,d){navigator.getDisplayMedia?navigator.getDisplayMedia({video:!0}).then(a).catch(d):navigator.mediaDevices.getDisplayMedia(b).then(a).catch(d)}}else d=navigator.getUserMedia=function(b,a,d){"complete"!==document.readyState?r||(r=!0,X(document,"readystatechange",function(){r&&"complete"==document.readyState&&(r=!1,N().getUserMedia(b,a,d))})):N().getUserMedia(b,a,d)};p=function(){a["default"].debug("Screen access requested");
switch(b()){case "electron":a["default"].debug("Screen sharing in Electron");m={};m.video=c.video||{};m.video.mandatory=c.video.mandatory||{};m.video.mandatory.chromeMediaSource="screen";d(m,f,e);break;case "mozilla":a["default"].debug("Screen sharing in Firefox max fps: 5");m={};void 0!==c.video?(m.video={},m.video.mediaSource="window"):m={audio:c.audio,video:{mediaSource:"window"}};F(w.a.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)?d(m,f,e):(m.video={width:{max:9999},height:{max:9999},
frameRate:{ideal:10},displaySurface:{ideal:["monitor"]}},v(m,f,e));break;case "safari":F(w.a.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT)?(a["default"].error("Screen Sharing not supported for safari version: "+J()),k.a.error("agent-event",q.a.event_incompatible_browser,{error:"This safari version does not support ScreenSharing"})):(a["default"].debug("Screen sharing  Safari "),m={video:{width:{max:9999},height:{max:9999},frameRate:{ideal:10},displaySurface:{ideal:["monitor"]}}},v(m,f,e));break;case "chrome-stable":a["default"].debug("Screen sharing in Chrome");
m={};if(c.desktopStreamId)m.video=c.video||{mandatory:{}},m.video.mandatory=m.video.mandatory||{},m.video.mandatory.chromeMediaSource="desktop",m.video.mandatory.chromeMediaSourceId=c.desktopStreamId,m.video.mandatory.chromeMediaSourceId=c.desktopStreamId,d(m,f,e);else if(F(w.a.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)){var h="apedaiecomcfkjdjbnkfcdafaikkdkeo";c.extensionId&&(a["default"].debug("extensionId supplied, using "+c.extensionId),h=c.extensionId);a["default"].debug("Screen access on chrome stable, looking for extension");
try{chrome.runtime.sendMessage(h,{getStream:!0},function(b){void 0===b?(a["default"].error("Access to screen denied"),e({code:"Access to screen denied"})):(b=b.streamId,void 0!==c.video.mandatory?(m.video=c.video,m.video.mandatory.chromeMediaSource="desktop",m.video.mandatory.chromeMediaSourceId=b):m={video:{mandatory:{maxFrameRate:c.fps,chromeMediaSource:"desktop",chromeMediaSourceId:b}}},d(m,f,e))})}catch(Z){a["default"].debug("Screensharing plugin is not accessible "),k.a.error("agent-event",q.a.event_incompatible_browser,
{error:"Screensharing plugin is not accessible"}),e({code:"no_plugin_present"})}}else a["default"].debug("Screen sharing in Chrome without extension max Fps::"+c.fps),m.video={width:{max:9999},height:{max:9999},frameRate:{ideal:10},displaySurface:{ideal:["monitor"]}},void 0!=c.audio&&!1!==c.audio&&(m.audio=!0),v(m,f,e);break;default:a["default"].error("This browser does not support ScreenSharing"),k.a.error("agent-event",q.a.event_incompatible_browser,{error:"This browser does not support ScreenSharing"})}};
c.screen?p():"undefined"!==typeof h&&h.exports?a["default"].error("Video/audio streams not supported in controller yet"):(a["default"].debug("Calling getUserMedia with config",JSON.stringify(c)),d(c,f,e))},buildPair:function(c){var f={};v+=1;c.sessionId=v;f.browser=b();if("fake"===f.browser)a["default"].warning("Publish/subscribe video/audio streams not supported in media yet"),k.a.warn("agent-event",q.a.event_incompatible_browser,{error:"Publish/subscribe video/audio streams not supported in media yet"}),
f=Object(e.a)(c);else if("mozilla"===f.browser)a["default"].debug("Firefox Stack"),f=Object(m.a)(c);else if("safari"===f.browser)a["default"].debug("Safari using Chrome Stable Stack"),f=Object(l.a)(c);else if("chrome-stable"===f.browser||"electron"===f.browser)a["default"].debug("Chrome Stable Stack"),f=Object(l.a)(c);else if("IE"===f.browser)a["default"].debug("IE using Chrome Stable Stack"),f=Object(l.a)(c);else throw a["default"].error("No stack available for this browser"),k.a.error("agent-event",
q.a.event_incompatible_browser,{error:"No stack available for this browser"}),Error("WebRTC stack not available");f.updateSpec||(f.updateSpec=function(b,c){c=void 0===c?function(){}:c;a["default"].error("Update Configuration not implemented in this browser");k.a.error("agent-event",q.a.event_incompatible_browser,{error:"Update Configuration not implemented in this browser"});c("unimplemented")});return f},browserEngineCheck:b,getAndroidVersion:function(){var b=navigator.userAgent;return 0<=b.indexOf("Android")?
parseFloat(b.slice(b.indexOf("Android")+8)):!1},mediaDeviceUpdate:function(a,k,c,f){console.log("mediaDeviceUpdate() id2Reset: "+a+" id2Set: "+c+" options: "+JSON.stringify(k));a&&void 0!=p.changedDevicesCallbacks&&p.changedDevicesCallbacks[a]&&delete p.changedDevicesCallbacks[a];if(void 0!=k&&void 0!=c){if(p.mediaDeviceOptions){if(JSON.stringify(p.mediaDeviceOptions)!=JSON.stringify(k)){a=$jscomp.makeIterator(Object.entries(k));for(var e=a.next();!e.done;e=a.next()){e=$jscomp.makeIterator(e.value);
var d=e.next().value;e.next();k[d]&&(p.mediaDeviceOptions[d]=!0)}}}else p.mediaDeviceOptions=JSON.parse(JSON.stringify(k));void 0!=p.changedDevicesCallbacks?p.changedDevicesCallbacks[c]={callback:f,options:k}:(void 0===p.deviceList&&G(k,function(b){p.deviceList=b.devices}),p.changedDevicesCallbacks={},p.changedDevicesCallbacks[c]={callback:f,options:k},"safari"==b()&&F(w.a.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT)?setInterval(function(){G(p.mediaDeviceOptions,function(b){if(void 0===p.deviceList)p.deviceList=
b.devices;else{b=M(b.devices);for(var a=$jscomp.makeIterator(Object.entries(p.changedDevicesCallbacks)),d=a.next();!d.done;d=a.next())d=$jscomp.makeIterator(d.value),d.next(),d.next().value.callback(b)}})},3E3):navigator.mediaDevices.ondevicechange=function(b){console.log("ondevicechange() evnt : "+b);if(void 0==p.receivedDC||1!=p.receivedDC)p.receivedDC=!0,setTimeout(function(){p.receivedDC=!1;G(p.mediaDeviceOptions,function(b){if(0==b.result)if(void 0===p.deviceList)p.deviceList=b.devices;else{b=
M(b.devices);for(var a=$jscomp.makeIterator(Object.entries(p.changedDevicesCallbacks)),d=a.next();!d.done;d=a.next())d=$jscomp.makeIterator(d.value),d.next(),d.next().value.callback(b)}else console.log("ondevicechange() getDeviceList failed error: "+JSON.stringify(b))})},1E3)})}},getDeviceList:G,getBrowserVersion:J,GetCanvasStream:function(c,e,h){e=void 0===e?function(){}:e;h=void 0===h?function(){}:h;var m=null,p=null,d=b();if(c.canvas)if("chrome-stable"===d||"mozilla"===d||"safari"===d){if(void 0!==
c.canvas.fps&&0<c.canvas.fps)var r=c.canvas.fps;else if(void 0!==c.canvas.fps){a["default"].error("Framerate is invalid is: ",c.canvas.fps);h(f.a.error_1154);k.a.error("agent-event",q.a.event_incompatible_browser,{error:f.a.error_1154});return}c=c.canvas.canvasId;try{(m=document.querySelector("#"+c))&&(m instanceof HTMLMediaElement||m instanceof HTMLCanvasElement)?(p=m.captureStream(m instanceof HTMLCanvasElement?r:void 0))?e(p):(a["default"].error("captureStream() failed . canvasFps : ",r),h(f.a.error_1159),
k.a.error("agent-event",q.a.event_incompatible_browser,{error:f.a.error_1159})):(a["default"].error("DOM Element does not exists/ not a Media Element. DomId is: ",c),k.a.error("agent-event",q.a.event_incompatible_browser,{error:f.a.error_1157}),h(f.a.error_1157))}catch(ja){a["default"].error("DOM Element does not exists/ not a Media Element. DomId is: ",c),h(f.a.error_1157),k.a.error("agent-event",q.a.event_incompatible_browser,{error:f.a.error_1157,exception:"Canvas chrome err: "+JSON.stringify(ja)})}}else a["default"].error(" getCanvasStream() This browser does not support canvas"),
h(f.a.error_1158),k.a.error("agent-event",q.a.event_incompatible_browser,{error:f.a.error_1154});else a["default"].error(" getCanvasStream() is called without canvas options"),k.a.error("agent-event",q.a.event_incompatible_browser,{error:"Canvas called without options"}),h(f.a.error_1155)},isCurrentVerLess:F,getSupportedDeviceConstraints:function(){return navigator.mediaDevices.getSupportedConstraints()}}}).call(t,n(37)(l))},function(l,t,n){l={event_ice_failed:{event_code:"4000",severity:"critical",
event_name:"ice-failed",event_description:"ICE failed"},event_ice_success:{event_code:"40001",severity:"",event_name:"ice-success",event_description:"ICE success"},event_stream_subscribe_failed:{event_code:"4001",severity:"critical",event_name:"stream-subscribe-failed",event_description:"Failed to subscribe to stream"},event_stream_subscribe_success:{event_code:"40011",severity:"",event_name:"stream-subscribe-success",event_description:"Subscribe to stream successful"},event_stream_unsubscribe_failed:{event_code:"4002",
severity:"critical",event_name:"stream-unsubscribe-failed",event_description:"Failed to unsubscribe from stream"},event_stream_unsubscribe_success:{event_code:"40021",severity:"",event_name:"stream-unsubscribe-success",event_description:"Unsubscribe from stream success"},event_socket_connect_failed:{event_code:"4003",severity:"critical",event_name:"socket-connect-failed",event_description:"Socket connection failed"},event_socket_connect_success:{event_code:"40031",severity:"",event_name:"socket-connect-success",
event_description:"Socket connection successful"},event_stream_publish_failed:{event_code:"4004",severity:"critical",event_name:"stream-publish-failed",event_description:"Failed to publish stream"},event_stream_publish_success:{event_code:"40041",severity:"",event_name:"stream-publish-success",event_description:"stream published successfully"},event_stream_unpublish_failed:{event_code:"4005",severity:"critical",event_name:"stream-unpublish-failed",event_description:"Failed to unpublish stream"},event_stream_unpublish_success:{event_code:"40051",
severity:"",event_name:"stream-unpublish-success",event_description:"Unpublish stream success"},event_start_recording_failed:{event_code:"4006",severity:"critical",event_name:"start-recording-failed",event_description:"Failed to start recording"},event_start_recording_success:{event_code:"40061",severity:"",event_name:"start-recording-success",event_description:"Start recording success"},event_start_local_recording_failed:{event_code:"40062",severity:"critical",event_name:"start-local-recording-failed",
event_description:"Failed to start local recording"},event_start_local_recording_success:{event_code:"40063",severity:"",event_name:"start-local-recording-success",event_description:"Start local recording success"},event_stop_recording_failed:{event_code:"4007",severity:"critical",event_name:"stop-recording-failed",event_description:"Failed to stop recording"},event_stop_recording_success:{event_code:"40071",severity:"",event_name:"stop-recording-success",event_description:"Stop recording success"},
event_stop_local_recording_failed:{event_code:"40072",severity:"critical",event_name:"stop-local-recording-failed",event_description:"Failed to stop local recording"},event_stop_local_recording_success:{event_code:"40073",severity:"",event_name:"stop-local-recording-success",event_description:"Stop local recording success"},event_start_screenshare_failed:{event_code:"4008",severity:"critical",event_name:"start-screenshare-failed",event_description:"Failed to start screenshare"},event_start_screenshare_success:{event_code:"40081",
severity:"",event_name:"start-screenshare-success",event_description:"Screenshare Start successfully"},event_stop_screenshare_failed:{event_code:"4009",severity:"critical",event_name:"stop-screenshare-failed",event_description:"Failed to stop screenshare"},event_stop_screenshare_success:{event_code:"40091",severity:"",event_name:"stop-screenshare-success",event_description:"Screenshare stopped successfully"},event_start_canvas_failed:{event_code:"4010",severity:"critical",event_name:"start-canvas-failed",
event_description:"Failed to start canvas"},event_start_canvas_success:{event_code:"40101",severity:"",event_name:"start-canvas-success",event_description:"Canvas started successfully"},event_stop_canvas_failed:{event_code:"4011",severity:"critical",event_name:"stop-canvas-failed",event_description:"Failed to stop canvas"},event_stop_canvas_success:{event_code:"40111",severity:"",event_name:"stop-canvas-success",event_description:"Canvas stopped successfully"},event_network_reconnect_timeout:{event_code:"4012",
severity:"high",event_name:"network-reconnect-timeout",event_description:"Reconnection timed out"},event_start_annotation_failed:{event_code:"4012",severity:"high",event_name:"start-annotation-failed",event_description:"Start Annotation Failed"},event_start_annotation_success:{event_code:"40121",severity:"high",event_name:"start-annotation-success",event_description:"Start Annotation successful"},event_stop_annotation_failed:{event_code:"4013",severity:"high",event_name:"stop-annotation-failed",event_description:"Stop Annotation Failed"},
event_stop_annotation_success:{event_code:"40131",severity:"high",event_name:"stop-annotation-success",event_description:"Stop Annotation successful"},event_send_message_failed:{event_code:"4013",severity:"high",event_name:"send-message-failed",event_description:"Failed to send message"},event_send_message_success:{event_code:"40131",severity:"",event_name:"send-message-success",event_description:"Send message success"},event_reconnect_socket_failed:{event_code:"4014",severity:"high",event_name:"reconnect-socket-failed",
event_description:"Failed to reconnect socket"},event_reconnect_socket_success:{event_code:"40141",severity:"",event_name:"reconnect-socket-success",event_description:"Socket reconnection success"},event_send_data_failed:{event_code:"4018",severity:"high",event_name:"send-data-failed",event_description:"Failed to send data"},event_send_data_success:{event_code:"40181",severity:"",event_name:"send-data-success",event_description:"Send data success"},event_media_access_denied:{event_code:"4019",severity:"critical",
event_name:"media-access-denied",event_description:"Access to media denied"},event_media_access_success:{event_code:"40191",severity:"",event_name:"media-access-allowed-success",event_description:"User has granted access to local media."},event_agent_media_access_denied:{event_code:"40192",severity:"critical",event_name:"agent-media-access-denied-failed",event_description:"Access to media denied (Agent)"},event_gum_failed:{event_code:"4020",severity:"critical",event_name:"gum-failed",event_description:"Get User Media failed"},
event_gum_success:{event_code:"40201",severity:"",event_name:"gum-success",event_description:"Get User Media success"},event_agent_gum_failed:{event_code:"40201",severity:"critical",event_name:"agent-gum-failed",event_description:"Get User Media failed (Agent)"},event_audio_device_access_failed:{event_code:"4021",severity:"critical",event_name:"audio-device-access-failed",event_description:"Failed to access Audio device"},event_agent_audio_device_access_failed:{event_code:"40211",severity:"critical",
event_name:"agent-audio-device-access-failed",event_description:"Failed to access Audio device (Agent)"},event_video_device_access_failed:{event_code:"4022",severity:"critical",event_name:"video-device-access-failed",event_description:"Failed to access Video device"},event_agent_video_device_access_failed:{event_code:"40221",severity:"critical",event_name:"agent-video-device-access-failed",event_description:"Failed to access Video device (Agent)"},event_remote_canvas_stream_failed:{event_code:"4023",
severity:"high",event_name:"remote-canvas-stream-failed",event_description:"Remote canvas stream failed"},event_capture_canvas_stream_failed:{event_code:"4024",severity:"critical",event_name:"capture-canvas-stream-failed",event_description:"Failed to capture canvas stream"},event_set_local_description:{event_code:"4025",severity:"none",event_name:"set-local-description",event_description:"Local SDP description is set"},event_set_remote_description:{event_code:"4026",severity:"none",event_name:"set-remote-description",
event_description:"Remote SDP description is set"},event_reconnect_subscribe_failed:{event_code:"4027",severity:"high",event_name:"reconnect-subscribe-failed",event_description:"Failed to subscribe while reconnecting"},event_reconnect_publish_failed:{event_code:"4028",severity:"high",event_name:"reconnect-publish-failed",event_description:"Failed to publish while reconnecting"},event_incompatible_browser:{event_code:"4029",severity:"high",event_name:"incompatible-browser",event_description:"Browser is incompatible"},
event_connect_socket_failed:{event_code:"4030",severity:"high",event_name:"connect-socket-failed",event_description:"Socket connection failed"},event_connect_socket_success:{event_code:"40301",severity:"",event_name:"connect-socket-success",event_description:"Socket connection successful"},event_room_reconnection_failed:{event_code:"4031",severity:"high",event_name:"room-reconnection-failed",event_description:"Room reconnection failed"},event_room_reconnection_success:{event_code:"40311",severity:"",
event_name:"room-reconnection-success",event_description:"Room reconnection success"},event_room_disconnection_failed:{event_code:"4032",severity:"high",event_name:"room-disconnection-failed",event_description:"Room disconnection failed"},event_room_disconnection_success:{event_code:"40321",severity:"",event_name:"room-disconnection-success",event_description:"Room disconnection success"},event_mute_self_audio_failed:{event_code:"4033",severity:"high",event_name:"mute-self-audio-failed",event_description:"mute self audio failed"},
event_mute_self_audio_success:{event_code:"40331",severity:"",event_name:"mute-self-audio-success",event_description:"mute self audio success"},event_unmute_self_audio_failed:{event_code:"4034",severity:"high",event_name:"unmute-self-audio-failed",event_description:"unmute self audio failed"},event_unmute_self_audio_success:{event_code:"40341",severity:"",event_name:"unmute-self-audio-success",event_description:"unmute self audio success"},event_room_mute_failed:{event_code:"4035",severity:"high",
event_name:"room-mute-failed",event_description:"room mute failed"},event_room_mute_success:{event_code:"40351",severity:"",event_name:"room-mute-success",event_description:"room mute success"},event_room_unmute_failed:{event_code:"4036",severity:"high",event_name:"room-unmute-failed",event_description:"room unmute failed"},event_room_unmute_success:{event_code:"40361",severity:"",event_name:"room-unmute-success",event_description:"room unmute success"},event_file_shared_failed:{event_code:"4037",
severity:"high",event_name:"file-shared-failed",event_description:"file shared failed"},event_file_shared_success:{event_code:"40371",severity:"",event_name:"file-shared-success",event_description:"file shared success"},event_file_download_failed:{event_code:"4038",severity:"high",event_name:"file-downlod-failed",event_description:"file download failed"},event_file_download_success:{event_code:"40381",severity:"",event_name:"file-downlod-success",event_description:"file downlod success"},event_mute_self_video_failed:{event_code:"4039",
severity:"high",event_name:"mute-self-video-failed",event_description:"mute self video failed"},event_mute_self_video_success:{event_code:"40391",severity:"",event_name:"mute-self-video-success",event_description:"mute self video success"},event_unmute_self_video_failed:{event_code:"4040",severity:"high",event_name:"unmute-self-video-failed",event_description:"unmute self video failed"},event_unmute_self_video_success:{event_code:"40401",severity:"",event_name:"unmute-self-video-success",event_description:"unmute self video failed"},
event_low_bandwidth_update:{event_code:"4041",severity:"",event_name:"low-bandwidth-update",event_description:"low bandwidth update"},event_network_change:{event_code:"4042",severity:"",event_name:"network-change",event_description:"network change"},event_connection_lost:{event_code:"4043",severity:"",event_name:"connection-lost",event_description:"connection lost"},event_make_outbound_call_failed:{event_code:"4044",severity:"high",event_name:"make-outbound-call-failed",event_description:"Outbound call failed"},
event_make_outbound_call_success:{event_code:"40441",severity:"",event_name:"make-outbound-call-success",event_description:"Outbound call success"},event_make_outbound_call_state:{event_code:"4045",severity:"",event_name:"make-outbound-call-state",event_description:"Outbound call state"},event_abwd_mute_video_success:{event_code:"4101",severity:"",event_name:"mute-publisher-video-success",event_description:"Publisher video muted due to low bandwidth"},event_fs_upload_started_success:{event_code:"4102",
severity:"",event_name:"fs-upload-started-success",event_description:"File is being shared"},event_fs_file_available_success:{event_code:"4103",severity:"",event_name:"fs-file-available-success",event_description:"File is being shared"},event_room_user_connect_failed:{event_code:"4104",severity:"",event_name:"room-user-connect-failed",event_description:"User connection to the Room failed"},event_room_user_connect_success:{event_code:"41041",severity:"",event_name:"room-user-connect-success",event_description:"A new user is connected to the Room"},
event_room_user_disconnect_failed:{event_code:"4105",severity:"",event_name:"room-user-disconnect-failed",event_description:"User disconnection to the Room failed"},event_room_user_disconnect_success:{event_code:"41051",severity:"",event_name:"room-user-disconnect-success",event_description:"User is disconnected to the Room"},event_start_live_recording_failed:{event_code:"4046",severity:"critical",event_name:"start-live-recording-failed",event_description:"Failed to start live recording"},event_start_live_recording_success:{event_code:"40461",
severity:"",event_name:"start-live-recording-success",event_description:"Start live recording success"},event_stop_live_recording_failed:{event_code:"4047",severity:"critical",event_name:"stop-live-recording-failed",event_description:"Failed to stop live recording"},event_stop_live_recording_success:{event_code:"40471",severity:"",event_name:"stop-live-recording-success",event_description:"Stop live recording success"},event_live_recording_param_change_failed:{event_code:"40472",severity:"",event_name:"live-recording-param-change-failed",
event_description:"live recording params change failed"},event_live_recording_param_change_success:{event_code:"40473",severity:"",event_name:"live-recording-param-change-success",event_description:"live recording params change success"},event_streaming_param_change_failed:{event_code:"40474",severity:"",event_name:"Streaming-param-change-failed",event_description:"Streaming params change failed"},event_streaming_param_change_success:{event_code:"40475",severity:"",event_name:"Streaming-param-change-success",
event_description:"Streaming params change success"},event_general_failed:{event_code:"4106",severity:"critical",event_name:"general-failed",event_description:"General error"},event_general_success:{event_code:"41061",severity:"",event_name:"general-success",event_description:"General success"},event_stream_player_failed:{event_code:"4107",severity:"critical",event_name:"player-play-failed",event_description:"player div is not playing the video"},event_media_connection_failed:{event_code:"4108",severity:"critical",
event_name:"media-connection-failed",event_description:"media connection/s failed"},event_streams_subscribe_bw_alerts:{event_code:"4109",severity:"high",event_name:"subscribe-streams-bw-alerts",event_description:"media stream subscribe indications"},event_streams_publish_bw_alerts:{event_code:"4110",severity:"high",event_name:"publish-stream-bw-alerts",event_description:"media stream publish bw indications"},event_client_connection_success:{event_code:"41062",severity:"critical",event_name:"client-connection-success",
event_description:"client connection  success"},event_client_connection_failed:{event_code:"41063",severity:"critical",event_name:"client-connection-success",event_description:"client connection  failed"},event_stream_track_pc_failed:{event_code:"41064",severity:"critical",event_name:"event_stream_track_pc_failed",event_description:"stream failed or pc undefined"},event_stream_media_failed:{event_code:"41065",severity:"critical",event_name:"event_stream_media_failed",event_description:"stream player null or avstream null "}};
for(var h in l)l[l[h].event_code]=l[h];t.a=l},function(l,t,n){var h=n(0);l=n(1);var u=n.n(l);n=function(){var m={eventLoggerToken:void 0,eventServer:{},logID:void 0,eventBuffer:[],uniqueSequence:1,clientId:void 0};switch(u.a.eventLogLevel){case "trace":m.logLevel=2;break;case "debug":m.logLevel=1;break;case "info":m.logLevel=3;break;case "warn":m.logLevel=4;break;case "error":m.logLevel=5;break;default:m.logLevel=6}m.init=function(e){try{e.eventServer&&e.eventServer.url&&(m.eventServer.url=e.eventServer.url,
m.logID=e.logId)}catch(a){h["default"].error("Error! Failed to send auth request to Event Server. Error: "+a+".")}};m.log=function(e,a){try{if(!(e<m.logLevel)){h["default"].debug("EventLogger.log event SENT"+JSON.stringify(a));var c={},f=(new Date).toISOString();if(u.a.eventLogNewFormat)c.logId=m.logID,c.event=a.event,c.meta=a.meta,c.tstamp=f;else{var w="info";switch(e){case 1:w="debug";break;case 2:w="trace";break;case 3:w="info";break;case 4:w="warning";break;case 5:w="error";break;default:w="info"}c.key=
{logID:m.logID,endpointType:"client",instanceID:m.logID,uniqueSequence:m.uniqueSequence++};c.severity=a.event?a.event.severity:"none";c.eventLevel=[];c.eventLevel.push(w);c.eventLevel.push(a.source);c.eventMeta={};c.eventMeta.event=a.event;c.eventMeta.meta=a.meta;c.isAnonymousInfo=!0;c.sourceTimeStamp=f}if(m.eventServer.url&&m.eventLoggerToken){var q=new XMLHttpRequest;q.onreadystatechange=function(){4===this.readyState&&200===this.status?h["default"].info(this.responseText):h["default"].error("Connection to Event Server did not establish. readyState: "+
this.readyState+" Status: "+this.status)};q.open("POST","https://"+m.eventServer.url+"/event",!0);q.setRequestHeader("Content-Type","application/json");q.setRequestHeader("eventToken",m.eventLoggerToken);q.send(JSON.stringify(c))}else m.eventBuffer.push(c)}}catch(k){h["default"].error("Error! Failed to post log event to Event Server. Error: "+k+".")}};m.debug=function(e,a,c){m.log(1,{source:e,event:a,meta:c})};m.trace=function(e,a,c){m.log(2,{source:e,event:a,meta:c})};m.info=function(e,a,c){m.log(3,
{source:e,event:a,meta:c})};m.warn=function(e,a,c){m.log(4,{source:e,event:a,meta:c})};m.error=function(e,a,c){void 0!=c.error&&"object"!=typeof c.error&&(c.error={errorDesc:c.error});m.log(5,{source:e,event:a,meta:c})};m.close=function(){};m.revalidate=function(){};m.processBufferEvents=function(){for(var e=0;e<m.eventBuffer.length;e++){var a=m.eventBuffer[e],c=new XMLHttpRequest;c.onreadystatechange=function(){4==this.readyState&&200==this.status?h["default"].info(this.responseText):h["default"].error("Connection to Event Server did not establish. Status: "+
this.status)};c.open("POST","https://"+m.eventServer.url+"/event",!0);c.setRequestHeader("Content-Type","application/json");c.setRequestHeader("eventToken",m.eventLoggerToken);c.send(JSON.stringify(a))}};m.setClientId=function(e){m.clientId=e};m.setEventLoggerToken=function(e){e&&(m.eventLoggerToken=e,m.eventLoggerToken&&m.eventServer&&m.eventServer.url&&m.processBufferEvents())};return m}();t.a=n},function(l,t,n){t.a={vcx_player:{width:"inherit",height:"inherit",position:"relative","background-color":"black",
overflow:"hidden"},vcx_player_loader:{width:"100%",height:"100%",position:"absolute"},vcx_player_screen_saver:{width:"100%",height:"100%",position:"absolute","z-index":"1"},vcx_stream:{width:"inherit !important",height:"inherit !important",position:"absolute","object-fit":"cover"},default_vcx_bar:{height:"100%",width:"100%",position:"absolute"},vcx_subbar_bottom:{width:"100%",height:"15%","max-height":"33px",color:"#aaa",position:"absolute",bottom:0,"background-repeat":"repeat-x;","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom","padding-top":"50px","z-index":2},vcx_subbar_top:{width:"100%",height:"15%","max-height":"30px",color:"#aaa",position:"absolute",top:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"top !important",
"padding-bottom":"50px","z-index":2},vcx_subbar_left:{width:"15%",height:"100%","max-width":"30px",color:"#aaa",position:"absolute",left:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},vcx_subbar_right:{width:"15%",height:"100%","max-width":"30px",color:"#aaa",position:"absolute",right:0,transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
"-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},brand_logo:{"max-width":"30px","max-height":"30px",cursor:"pointer",position:"absolute",right:"0px",margin:"5px"},theater_view:{width:"100% !important",height:"80% !important"},full_view:{width:"100% !important",height:"100% !important",top:"0px",left:"0px",position:"fixed !important","z-index":3},icon:{margin:"7px","max-width":"30px",cursor:"pointer"},
icon_record:{color:"#f00"},icon_volume:{color:"#aaa"},icon_play:{color:"#aaa"},icon_mic:{color:"#aaa"},icon_zoom:{color:"#aaa"},icon_share:{color:"#aaa"}}},function(l,t,n){var h=this,u=n(7),m=n(4),e=n(41),a=n(14),c=n(53),f=n(3),w=n(54),q=n(19),k=n(0),v=n(5),r=n(6);l=n(1);var x=n.n(l),p=n(8),b=n(9),J=n(16),F=n(57),z=n(62),M=n(63),A=n(68),C=["meeting_agenda","abstract_summary","key_points","action_items","sentiment_analysis"],G=["user","owner","room","session"],N=["all","none"],X=!0,H;window.statsIcon=
'<svg  viewBox="0 0 16 16" width="16" height="16" xml:space="preserve" fill="green"><rect height="6" width="4" y="10"/><rect height="10" width="4" x="6" y="6"/><rect height="16" width="4" x="12"/></svg>';window.lowBwIcon='<svg id="icon_low_bw" height="20" viewBox="0 0 24 24" width="20" title="Low Bandwidth"><path d="m16.155 13.799-5.284 7.908c-.43.665.048 1.542.84 1.542h10.507c.789 0 1.268-.872.843-1.538l-5.223-7.908c-.392-.613-1.288-.616-1.683-.004z" fill="#ffc107"/><path fill="#f44236" d="m22.288 24.031h-10.576c-.944 0-1.712-.747-1.712-1.665 0-.333.098-.647.281-.908l5.271-8.206c.294-.479.852-.784 1.448-.784s1.154.305 1.456.796l5.28 8.221c.166.235.264.549.264.882 0 .918-.768 1.664-1.712 1.664zm-5.288-10.062c-.088 0-.154.042-.179.082l-5.296 8.245c-.025.148.062.235.187.235h10.576c.125 0 .212-.087.212-.165 0-.027-.006-.042-.008-.044l-5.306-8.26c-.032-.051-.098-.093-.186-.093z"/><path fill="#f44236" d="m17 19.719c-.414 0-.75-.336-.75-.75v-1.917c0-.414.336-.75.75-.75s.75.336.75.75v1.917c0 .414-.336.75-.75.75z"/><ellipse cx="17" cy="21.365" rx=".75" ry=".719"/><path fill="#f44236" d="m.75 24c-.414 0-.75-.336-.75-.75v-7.5c0-.414.336-.75.75-.75s.75.336.75.75v7.5c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m6.75 24c-.414 0-.75-.336-.75-.75v-11.5c0-.414.336-.75.75-.75s.75.336.75.75v11.5c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m12.75 13.74c-.414 0-.75-.336-.75-.75v-7.24c0-.414.336-.75.75-.75s.75.336.75.75v7.24c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m18.75 11.11c-.414 0-.75-.336-.75-.75v-9.61c0-.414.336-.75.75-.75s.75.336.75.75v9.61c0 .414-.336.75-.75.75z"/></svg>';
t.a=function(l,n,t){function da(g){return void 0==g||"string"!=typeof g||0==G.includes(g)?!1:!0}if(x.a.is_supported()){var d=Object(m.c)(t),E={timer:void 0,intervalSecs:2,timeoutSecs:10,disconnectedDurationSecs:0};d.filesToUpload=[];d.f2rec={};d.availableFiles=[];var Q=new Map,Z=new Map,ea=new Map,K=[],T=10485760,ha="",O="";d.showFsUi=!1;d.internetDetectionUrl=x.a.internetDetectionUrl;d.remoteStreams=Object(w.a)();d.remotePendingStreams=Object(w.a)();d.remoteStreamsInfo=Object(w.a)();d.numATSubscribersAdded=
0;d.localStreams=Object(w.a)();d.roomID="";d.talkerCount=0;d.userAudioTalkerCount=0;d.userVideoTalkerCount=0;d.state=0;d.allStreamsActive=!1;d.streamsHealthTimerId=0;d.Connection=void 0===n?u.a:n;d.receiveVideoQuality=new Map;d.receiveVideoQuality.set("talker","Auto");d.receiveVideoQuality.set("canvas","HD");d.mediaStatsMode="disable";d.liveTranscription=!1;d.liveRoomTranscription=!1;d.transcriptionLanguage="";d.liveMeetingAnalytics=!1;d.userRoleChangeRequests=[];d.tempUserRequests={};var fa=void 0==
t.data||1==t.data?!0:!1,y=Object(e.a)(l);d.socket=y;d.userList=new Map;d.dialOutList=new Map;d.cControlReq=void 0;d.cCrequest=[];d.awaitedParticipants=new Map;d.floorGranted=!1;d.floorInvited=!1;d.floorAccepted=!1;d.roomJson=void 0;d.clientId=void 0;d.mode=void 0;d.activeTalker=!1;d.shareStatus=!1;d.shareDisplayWaitTimeoutSecs=0;d.shareEventInfo;d.ScreenSharelocalStream=null;d.isSharingClient=!1;d.forcedStopSharing=!1;d.isCanvasSharing=!1;d.isCanvasSharingClient=!1;d.canvasStatus=!1;d.activeTalkerList=
new Map;d.audioOnlyMode=!1;d.roomMuted=!1;var D=JSON.parse(q.a.decodeBase64(t.token));d.reconnectionState=!1;d.reconnectAttempt=0;d.connectAttempt=0;d.isFirstConnect=!0;var aa={},ma=3,Y=7;d.isStreamingClient=!1;d.sendRecvBitrateStats=!1;d.speakerInfo={id:t&&t.speakerId?t.speakerId:void 0,volume:1};var ka="none",ia=0,qa=0,ba=0,na=0,U=0,Aa=0,Ha=0,Ia=!1,R=!1,ra=!1;D.isStreamingClient&&(k["default"].setLogCache(!1),k["default"].info("Room() streaming client, disable local store"));var Ba=!1,Ja=!1,Qa;
t.hasOwnProperty("reconnectInfo")?(k["default"].info("reconnect parameter",t.reconnectInfo),d.reconnectionAllowed=t.reconnectInfo.allow_reconnect,d.reconnectionTimeOutInterval=t.reconnectInfo.timeout_interval,ma=t.reconnectInfo.number_of_attempts):(d.reconnectionAllowed=!0,d.reconnectionTimeOutInterval=45E3,ma=3);E.timeoutSecs=d.reconnectionTimeOutInterval/1E3;x.a.alertNotifyInfo={mode:"image"};t.alertNotifyInfo&&"object"===typeof t.alertNotifyInfo&&t.alertNotifyInfo.mode&&("text"==t.alertNotifyInfo.mode||
"image"==t.alertNotifyInfo.mode||"none"==t.alertNotifyInfo.mode)&&(x.a.alertNotifyInfo=Object.assign(x.a.alertNotifyInfo,t.alertNotifyInfo));var S=!1,V=-1;d.localStreamsBeforeReconnect=Object(w.a)();d.oldSpecInfo=void 0;d.mediaConfiguration=D.roomMeta.settings.media_configuration?D.roomMeta.settings.media_configuration:"Default";d.maxVideoLayers=0;d.defaultBandwidth=new Map;d.defaultBandwidth.set(1,2E5);d.defaultBandwidth.set(2,3E5);d.defaultBandwidth.set(3,4E5);d.defaultBandwidth.set(4,6E5);d.defaultBandwidth.set(5,
8E5);d.defaultBandwidth.set(6,1E6);d.defaultBandwidth.set(7,12E5);d.videoMutedUsers={};var sa,oa,xa;d.mediaActivationDelaySecs=0;var Ka,P=d.remoteStreams,ta=d.remotePendingStreams,W=d.localStreams,ya;d.hardMuteRoom=!1;var ib=Object(c.a)(null,null);d.breakOutRoom=ib;d.me={};d.roomSettings={};d.mute=!1;d.muteInfo={room:{audio:!1,video:!1},stream:{hard:{audio:!1,video:!1}}};d.muteAudioOnJoin=!1;d.muteVideoOnJoin=!1;d.cCapprovedHands=[];d.externalIp="";d.subscribeSessionStats=!1;d.canvasOptions={width:1280,
height:720,domHandle:""};d.inputContext=null;d.canvasVideoPlayer="";var ca=x.a.video_resolution_range[D.roomMeta.settings.quality],jb=document.createElement("style");jb.innerHTML=".stats-container{ \n                         position: absolute;\n                         z-index: 5;\n                         padding: 2px;\n                         top: 2px;\n                         right: 2px;\n                         font-size: 12px;\n                         width: 22px;\n                         height: 22px;\n                         text-align: center;\n                         background: white;\n                         border-radius: 10px;\n                     }\n                     .stats-button{\n                         cursor:pointer;\n                         width: 15px;\n                         height: 15px;\n                         padding: 0 0 0 2px;\n                     }\n                     .stats-detail{ height: 100%;}\n                     .stats-overlay-inner{\n                         display: flex;\n                         flex-direction: row;\n                         justify-content: space-between;\n                         padding: 8px 2px 6px 10px;\n                     }\n                     .stats-right-partition, .stats-left-partition {}\n                     .stats-left-partition {margin-right: 10px;}\n                     .stats-button svg {width: 12px;height: 12px;}\n                         ";
var kb=document.createElement("style");kb.innerHTML=".bw-notification{\n                                 position: absolute;\n                                 //z-index: 5;\n                                 top:1%;\n                                 left:50%;\n                                 //bottom: 5px;\n                                 //right: 5px;\n                                 //margin-top:-50px;\n                                 //margin-left:-100px;\n                                 padding: 5px;\n                                 color: #fff;\n                                 //background: rgba(50,50,50,0.5);\n                                 }";
var La=!1,lb=!1,mb=0,Ra=function(g){k["default"].info(" in Remove stream : id: "+g.getID()+" stream.stream : "+g.stream);g.stream&&(g.hide(),g.stop(),g.close(),delete g.stream);g.pc&&(g.pc.close(),delete g.pc);1==g.getID()&&void 0!=d.subscriberPC&&delete d.subscriberPC},Sa=function(g,b){Ca(g,"add",function(g){})},Ob=function(g,b){g=b.track.kind;var a;b:{var I=Math.trunc(parseInt(b.transceiver.mid)/2),c=d.remoteStreams.values()[I];if(c)if("audio"==g){if(void 0==c.audioMid){c.audioMid=I;g=c;break b}}else{if(void 0==
c.videoMid){c.videoMid=I;g=c;break b}}else console.log("allocateMid() failed sidIndex: "+I+" type:  "+g);g=void 0}g=(a=g)?a:void 0;if(g)g.initRemoteStream(b.streams[0],b.track);else return k["default"].error("initializeRemoteStreamTrack() failed stream not found  mid: "+b.transceiver.mid+" kind: "+b.track.kind),!1;d.remoteStreams.remove(g.getID());d.remoteStreams.add(g.getID(),g);d.dispatchEvent(Object(m.f)({type:"stream-subscribed",stream:g}));g.room=d;b=d.remoteStreamsInfo.get(g.getID());g.updateVideo(g.getID(),
b?b.player:void 0)},Za=function(g,b,a){var I={callback:function(b){k["default"].debug("Sending message",b);d.socket.sendSDP("signaling_message",{streamId:g.getID(),msg:b,browser:g.pc.browser},void 0,function(){})},nop2p:!0,audio:b.audio&&g.ifAudio(),video:b.video&&g.ifVideo(),maxAudioBW:b.maxAudioBW,maxVideoBW:b.maxVideoBW,limitMaxAudioBW:t.maxAudioBW,limitMaxVideoBW:t.maxVideoBW,iceServers:d.iceServers,forceTurn:g.forceTurn};a?t.maxSubsVideoBW&&(I.maxVideoBW=t.maxSubsVideoBW.total,I.limitMaxVideoBW=
t.maxVideoBW):I.simulcast=b.simulcast;return I},Qb=function(){if(2==d.state&&d.allStreamsActive){var g=[];P.forEach(function(b,a){if(2==d.state&&"connected"==b.state)if(a=nb(b),"INACTIVE"==a.audio||"INACTIVE"==a.video)Ca(b,"add",function(g){});else if("CLOSED"==a.audio||"CLOSED"==a.video)g.push(parseInt(b.getID())),k["default"].error("checkAndProcessStreamsHealth() adding reset sIds: "+JSON.stringify(g))});g.length&&(k["default"].error("checkAndProcessStreamsHealth() sending reset-stream req sIds: "+
JSON.stringify(g)),d.setAdvancedOptions([{id:"reset-streams",sIds:g}],function(g){k["default"].error("checkAndProcessStreamsHealth reset-stream callback resp: "+JSON.stringify(g))}));W.forEach(function(g,b){if(2==d.state&&"connected"==g.state){var a=nb(g);a.audio&&a.video||(k["default"].info(" stream state: id "+g.getID()+" health: "+JSON.stringify(a)),g.ifScreen()||g.ifCanvas()?(a=g.ifScreen()?" stream-screen failed ":" stream-canvas failed",d.dispatchEvent({type:a,stream:g})):(a.audio||(k["default"].info(" stream state: id "+
g.getID()+"  mute/unmute audio track "),g.muteAudio(function(b){g.unmuteAudio(function(b){b.result!==r.a.error_000.result&&d.dispatchEvent({type:"stream-audio failed",stream:g})},!1)},!1)),a.video||(k["default"].info(" stream video health bad : id "+b+"  mute/unmute video track "),g.muteVideo(function(a){k["default"].info(" stream id "+b+" mute callback resp: "+JSON.stringify(a));g.unmuteVideo(function(a){a.result!==r.a.error_000.result&&(k["default"].info(" stream id "+b+" unmute callback resp: "+
JSON.stringify(a)),d.dispatchEvent({type:"stream-video failed",stream:g}))},!1)},!1))))}});2==d.state&&d.dataStream&&"failed"==d.dataStream.state&&(k["default"].error("checkAndProcessStreamsHealth() restart datastream : id "+d.dataStream.getID()),Ta({id:d.dataStream.getID(),data:!0}))}},nb=function(g){var a={audio:"NA",video:"NA"};if(g){var c=function(b,a,d,I){void 0==g.tracksInfo&&(g.tracksInfo={audio:{numSecsMuted:0},video:{numSecsMuted:0}});if(a){var c=b.getAudioTracks();b=g.tracksInfo.audio}else c=
b.getVideoTracks(),b=g.tracksInfo.video;a="NA";c=$jscomp.makeIterator(c);for(var f=c.next();!f.done;f=c.next())f=f.value,!0===f.enabled?"live"===f.readyState?d&&f.muted?(b.numSecsMuted++,b.numSecsMuted==I.resetStream?(k["default"].error("Track ready but muted ,wait timeout id: "+g.getID()+" - "+f.kind+"num secs muted: "+b.numSecsMuted+" reset request"),a="CLOSED"):b.numSecsMuted<I.restartStream?k["default"].error("Track ready but muted ,wait timeout id: "+g.getID()+" - "+f.kind+"num secs muted: "+
b.numSecsMuted):(a="INACTIVE",b.numSecsMuted=0,k["default"].error("Track not ready - muted with timeout restarting id: "+g.getID()+" - "+f.kind+" num secs muted: "+b.numSecsMuted))):(k["default"].debug("Track ready  id: "+g.getID()+" - "+f.kind),b.numSecsMuted&&(b.numSecsMuted=0),a="ACTIVE"):(k["default"].error("Track not ready id : "+g.getID()+" - "+f.kind+" state: "+f.readyState),b.numSecsMuted=0,a="INACTIVE"):k["default"].debug("Track not ready  and not enabled : id "+g.getID()+" - "+f.kind);return a},
f=!1,e=!1,h=!1,m={restartStream:10,resetStream:3};if(g.local)m.resetStream=0,g.audioStream&&(a.audio=c(g.audioStream,!0,!g.ifCanvas()&&!g.ifScreen(),m)),g.videoStream&&(a.video=c(g.videoStream,!1,!g.ifCanvas(),m));else{if(!g.ifCanvas()&&!g.ifScreen()){var q=d.activeTalkerList.get(g.getID());if(q)switch(q.mediatype){case "audiovideo":h=f=e=!0;break;case "video":h=f=!0;break;case "audio":case "audioOnly":h=e=!0}}else if(g.ifScreen()&&d.shareStatus&&!d.isSharingClient){f=!0;q=!1;var r="stream miss";
if(g.player&&g.player.video&&g.player.video.srcObject&&g.mediaStream){var w=g.player.video.srcObject.getVideoTracks(),v=g.mediaStream.getVideoTracks();w[0].id==v[0].id?q=!0:r="mismatch"}else g.player&&g.player.video&&g.player.video.srcObject||(r="player missing");if(q)d.shareDisplayWaitTimeoutSecs&&(d.shareDisplayWaitTimeoutSecs=0);else{if(3<=d.shareDisplayWaitTimeoutSecs)return a.video=!1,d.shareDisplayWaitTimeoutSecs=0,k["default"].error("checkStreamState() failed shareDisplayTimeoutSecs: "+d.shareDisplayWaitTimeoutSecs+
r),a;d.shareDisplayWaitTimeoutSecs++;k["default"].info("checkStreamState() shareDisplayTimeoutSecs: "+d.shareDisplayWaitTimeoutSecs+r)}}if(g.mediaStream){if(!h||g.isVideoMuted()||g.player&&g.player.video&&!g.player.video.paused)g.numSecsPlayerPaused&&(g.numSecsPlayerPaused=0);else if(g.numSecsPlayerPaused=g.numSecsPlayerPaused?g.numSecsPlayerPaused+1:1,3==g.numSecsPlayerPaused&&g.player&&g.player.video)k["default"].error("stream player paused wait half timeout  resetting srcObject id: "+g.getID()+
"num secs track player paused: "+g.numSecsPlayerPaused),g.player.video.srcObject=g.mediaStream;else if(6>g.numSecsPlayerPaused)k["default"].error("stream player paused wait timeout id: "+g.getID()+"num secs track player paused: "+g.numSecsPlayerPaused);else return k["default"].error("stream player paused timeout restarting id: "+g.getID()+"num secs track player paused: "+g.numSecsPlayerPaused),a.audio=!1,a.video=!1,g.numSecsPlayerPaused=0,a;a.audio=c(g.mediaStream,!0,e,m);a.video=c(g.mediaStream,
!1,f,m);"INACTIVE"!=a.video&&d.isStreamingClient&&g.player&&g.player.video&&(c=g.player.video,c.player_stats&&3E3<c.getVideoPlaybackQuality().creationTime-c.player_stats.creationTime&&!(c.getVideoPlaybackQuality().totalVideoFrames>c.player_stats.totalVideoFrames)&&(console.error(" video player stats stopped : frames prev: "+c.player_stats.totalVideoFrames+" new: "+c.getVideoPlaybackQuality().totalVideoFrames),c={streamId:g.getID(),currTotalFrames:c.getVideoPlaybackQuality().totalVideoFrames,prevTotalFrames:c.player_stats.totalVideoFrames},
b.a.error("stream-event",p.a.event_stream_player_failed,{error:c})))}}}return a},Rb=function(g,a){var I=!0;void 0==d.subscriberPC&&(d.subscriberPC=d.Connection.buildPair(Za(g,a,!0)),P.forEach(function(g,b){g.audioMid=g.videoMid=void 0}),I=!1);g.pc=d.subscriberPC;k["default"].info("Create remote connection for subscribe:-"+JSON.stringify(a));g.pc.ontrack=Ob.bind(null,g);k["default"].info("Registering the peer connection timer for the subscriber stream "+g.getID());var c=function(a,d){k["default"].debug(" stream state ICE remote id - "+
g.getID()+" : "+a+" source: "+d);"failed"===a?(g.reconnect=!1,k["default"].error(d+" connection state failed - streamId: "+g.getID()),Sa(g),b.a.error("room-event",p.a.event_ice_failed,{error:{}})):(k["default"].debug("stream ID",g.getID()),k["default"].debug("ice connection state",a),"connected"===a&&(a=g.pc?" stream.pc: true":" stream.pc: false",a+=g.mediaStream?" medstream : true":"medstream : false",k["default"].info("ice connection state connected - streamId : "+g.getID()+a),b.a.info("room-event",
p.a.event_ice_success,{message:"ICE connected successfully"}),g.reconnect&&(g.reconnect=!1,g.reconnectAttempt=0,(a=ea.get(g.getID()))?("none"!=a.mediatype&&(d=JSON.parse(JSON.stringify(a)),d.mediatype="none",g.reloadPlayer(d,ra)),g.reloadPlayer(a,ra)):k["default"].info(" stream state ICE remote id - "+g.getID()+" : ICE reconnected "))))};I||(g.pc.oniceconnectionstatechange=function(g){c(g,"ice")},g.pc.onconnectionstatechange=function(g){c(g,"pc")},g.pc.createOffer(!0,!1,P.values()))},Ca=function(g,
b,a){a=void 0===a?function(){}:a;if(0==d.socket.state||!0===d.reconnectionState)k["default"].error("checkWaitReconnectStream() room/socket not connected id : "+g.getID()+" recon state: "+d.reconnectionState),a(!1);var I=g.local||1==g.getID()?g:P.get(1);"add"==b&&("connected"!==I.state?(k["default"].error("checkWaitReconnectStream() invalid state - stream id : "+I.getID()+" state: "+I.state),a(!1)):7<=I.reconnectAttempt?(k["default"].error("checkWaitReconnectStream() reconnect retries exceed - global reconnect stream id: "+
I.getID()),2==d.state&&d.socket.disconnect(),a(!1)):(I.reconnect=!0,I.state="wait_for_reconnect",ia||(ia++,d.dispatchEvent(Object(m.e)({type:"network-reconnecting",message:"Connection issues - reconnecting, please wait"}))),ab(I,function(g){!1===g&&(k["default"].error("checkWaitReconnectStream () failed streamId: "+I.getID(),2==d.state?" global reconnect":"room not connected ignoring "),2==d.state&&d.socket.disconnect());a(g)})))},ab=function(g,b){b=void 0===b?function(){}:b;if("reconnect"!=g.state){if("reconnecting"==
g.state){b(!0);return}if(!g.local){var a;P.forEach(function(g,b){void 0!==g&&void 0!==g.mediaStream?(console.log("reconnect Stream id: "+b+" stopping track "),!a&&g.pc&&(a=g.pc),g.mediaStream.getTracks().forEach(function(g){g.onended=null;g.stop()}),console.log("reconnect Stream id: "+b+" after stopping track ")):k["default"].error("remote stream or media stream is undefined id: "+b)});a&&(console.log("reconnect Stream pc close"),a.close());P.forEach(function(g,b){g.pc&&delete g.pc;g.state="reconnect";
ab(g)});b(!0);return}}g.state="reconnecting";g.reconnectAttempt++;g.reconnectsTotal+=1;g.local?Aa++:U++;var I=d.remoteStreamsInfo.get(g.getID()),c=I?I.userReqOpt:void 0,f="none",e=setTimeout(function(){k["default"].info("reconnectStream() fail timeout stream local: "+g.local+" id: "+g.getID()+" cmd: "+f);b(!1)},3E3);g.local?(k["default"].info("reconnectStream()  streamId: "+g.getID()+" calling unpublish()"),f="unpublish",d.unpublish(g,function(a,I){k["default"].info("reconnectStream()  streamId: "+
g.getID()+" unpublish callback calling publish()");f="publish";d.publish(g,c,function(){k["default"].info("reconnectStream()  streamId: "+g.getID()+" publish callback");f="publish-done";clearTimeout(e);b(!0)})})):(k["default"].info("reconnectStream()  streamId: "+g.getID()+" calling unsubscribe()"),f="unsubscribe",d.unsubscribe(g,function(a,I){f="subscribe";k["default"].info("reconnectStream()  streamId: "+g.getID()+" unsubscribe callback calling publish()");d.subscribe(g,c,function(){f="subscribe-done";
k["default"].info("reconnectStream()  streamId: "+g.getID()+" subscribe callback");clearTimeout(e);b(!0)})}))};d.reconnectStreamById=function(g,b,a){a=void 0===a?function(){}:a;(b=b?W.get(g):P.get(g))?(console.log("reconnectStreamById() stream id: "+g),ab(b,a)):console.log("reconnectStreamById() failed stream not found id: "+g)};d.reconnectStream=function(g,b){Ca(g,"add",void 0===b?function(){}:b)};d.notifyDeviceUpdate=function(){var g={mic:!0,cam:!0,speaker:!1};W.forEach(function(b,a){b.ifScreen()||
b.ifCanvas()||(g.mic=b.audio,g.cam=b.video)});u.a.mediaDeviceUpdate(g,"room_notifyDeviceUpdate",function(g){d.dispatchEvent(Object(m.e)({type:"user-media-device-list-change",message:g}))})};var Sb=function(g,b){b=void 0===b?{}:b;g.pc=d.Connection.buildPair(Za(g,b));g.channel=g.pc.createDataChannel(g.getID());g.channel.onopen=function(b){console.log("data channel on open pushing pending messages");if(g.pendingMessages){b=g.pendingMessages.length;for(var a=0;a<b;a++){var d=g.pendingMessages.pop();g.channel.send(d.msg);
d.callback(r.a.error_000)}}k["default"].info("createDataStreamVcxRtcConnection Channel open  state: "+g.channel.readyState)};g.channel.onclose=function(b){k["default"].info("createDataStreamVcxRtcConnection Channel close  state: "+g.channel.readyState)};g.channel.onmessage=function(g){g=JSON.parse(g.data);switch(g.type){case "chat":var b="message-received";break;case "data-internal-in":b=g.message.type;pb(g,function(){});break;default:b="user-data-received"}d.dispatchEvent(Object(m.e)({type:b,message:g}))};
var a=function(b,a){"failed"===b?(g.state="failed",k["default"].error(" stream state  data state: "+b+" source: "+a+" reconnect: "+g.reconnect)):"connected"===b&&(g.state="connected",g.reconnect=!1,g.reconnectAttempt=0,k["default"].info(" stream data state : "+b+" source: "+a));k["default"].info("handleConnectionStateChange state:",b)};g.pc.oniceconnectionstatechange=function(g){a(g,"ice")};g.pc.onconnectionstatechange=function(g){a(g,"pc")};b.createOffer||g.pc.createDataConnectionOffer()},Tb=function(g,
b){b=void 0===b?{}:b;k["default"].info("data channel  video: options: "+JSON.stringify(b));d.socket.sendSDP("addDataChannel",b,void 0,function(a){Sb(g,b)})},Ub=function(g,b){b=Object.assign(b);g.audio||(b.audio=!1);g.pc=d.Connection.buildPair(Za(g,b));var a=g.ifCanvas()||g.ifScreen()?g.videoStream:g.inputMediaSource.video[g.inputMediaSource.video.selected];a&&(g.videoStream=a);k["default"].info("Registering the peer connection timer for the publisher stream "+g.getID());var c=function(b,a){var d=
g.ifCanvas()?"canvas":g.ifScreen()?"screen":"main";"failed"===b?(g.reconnect=!1,k["default"].error(" stream state  local  "+d+" : "+b+" source: "+a+" reconnect: "+g.reconnect),Sa(g)):"connected"===b&&(g.reconnect=!1,g.reconnectAttempt=0,k["default"].info(" stream state local  "+d+" : "+b+" source: "+a));k["default"].info("handleConnectionStateChange state:",b)};g.pc.oniceconnectionstatechange=function(g){c(g,"ice")};g.pc.onconnectionstatechange=function(g){c(g,"pc")};b.createOffer||g.pc.createOffer(!1,
!1,[g])},Vb=function(g){var k=Object(a.a)(d.Connection,{streamID:g.id,local:!1,clientId:g.clientId,audio:g.audio,video:g.video,data:g.data,screen:g.screen,attributes:g.attributes});k.room=d;P.add(g.id,k);g=Object(m.f)({type:"stream-added",stream:k});b.a.info("room-event",p.a.event_general_success,{message:"socketOnAddStream - stream added"});d.dispatchEvent(g)},Wb=function(g){g=g.id.streamId;var k=Object(a.a)(d.Connection,{streamID:g}),c=f.a.getById("screen_saver_"+g);f.a.getByClass("icon_play",c.parentNode).disabled=
!0;c&&"none"===c.style.display?c.style.display="block":c&&"block"===c.style.display&&(c.style.display="none");g=Object(m.e)({type:"track-removed",streams:[k],message:"tracked removed from stream: "+g});b.a.info("room-event",p.a.event_general_success,{message:"socketOnRemoveTrack - tracked removed from stream"});d.dispatchEvent(g)},qb=function(g){var a=g.name,c=g.role,f=g.permissions,e={name:g.name,permissions:g.permissions,role:g.role,user_ref:g.user_ref,videoMuted:g.videoMuted,audioMuted:g.audioMuted};
e.audioEnabled=void 0!=g.audioEnabled?g.audioEnabled:!0;e.videoEnabled=void 0!=g.videoEnabled?g.videoEnabled:!0;void 0!=g.data&&(e.data=g.data);"audience"!=g.role&&d.userList.set(g.clientId,e);"audience"==g.role&&(d.audienceCount=g.audienceCount?g.audienceCount:0);d.awaitedParticipants.get(g.clientId)&&d.awaitedParticipants.delete(g.clientId);d.tempUserRequests[g.clientId]&&(d.tempUserRequests[g.clientId].userRoleChange&&(d.userRoleChangeRequests.push(d.tempUserRequests[g.clientId].userRoleChange),
delete d.tempUserRequests[g.clientId].userRoleChange),d.tempUserRequests[g.clientId].grantedFloor&&(d.cCapprovedHands.push(d.tempUserRequests[g.clientId].grantedFloor),delete d.tempUserRequests[g.clientId].grantedFloor));k["default"].info("userConnected() user name: "+a);b.a.info("room-event",p.a.event_room_user_connect_success,{message:"onUserConnected - user connected"});g={type:"user-connected",clientId:g.clientId};d.privacyModes&&d.privacyModes.userListHidden&&"moderator"!==d.me.role||(g.name=
a,g.role=c,g.permission=f,g.user=e,g.user_ref=e.user_ref,void 0!=e.data&&(g.data=e.data));d.dispatchEvent(Object(m.g)(g))},Xb=function(g){var b=d.userList.get(g.clientId);!b||d.privacyModes&&d.privacyModes.userListHidden&&"moderator"!==d.me.role?void 0==b?k["default"].error("onUserUpdate() failed - user not found : "+JSON.stringify(g)):k["default"].debug("onUserUpdate() failed - privacy policy userList hidden enabled"):"media-modes"==g.key?void 0!=g.info&&void 0!=g.info.publish?(b.audioEnabled!=g.info.publish.audio&&
(b.audioEnabled=g.info.publish.audio,d.dispatchEvent(Object(m.g)({type:b.audioEnabled?"user-audio-enabled":"user-audio-disabled",clientId:g.clientId}))),b.videoEnabled!=g.info.publish.video&&(b.videoEnabled=g.info.publish.video,d.dispatchEvent(Object(m.g)({type:b.videoEnabled?"user-video-enabled":"user-video-disabled",clientId:g.clientId})))):k["default"].error("onUserUpdate() failed - filed missing for media-modes : "+JSON.stringify(g)):k["default"].error("onUserUpdate() failed - invalid key : "+
JSON.stringify(g))},Yb=function(g){var a=g.name,k=g.role,c=g.permissions,f=g.clientId,e=g.user_ref,h=g.data;"audience"!=k&&d.userList.delete(g.clientId);"audience"==g.role&&d.audienceCount&&0<d.audienceCount&&d.audienceCount--;"lecture"===d.mode&&"moderator"===d.me.role&&(g=Da(f))&&(void 0==d.tempUserRequests[f]&&(d.tempUserRequests[f]={}),d.tempUserRequests[f].grantedFloor=g);if(g=Ma(f))void 0==d.tempUserRequests[f]&&(d.tempUserRequests[f]={}),d.tempUserRequests[f].userRoleChange=g;a={type:"user-disconnected",
name:a,clientId:f,role:k,permission:c,user_ref:e};void 0!=h&&(a.data=h);h=Object(m.g)(a);b.a.info("room-event",p.a.event_room_user_disconnect_success,{message:"userDisConnect - user disconnected"});d.dispatchEvent(h)},Zb=function(g){g=Object(m.d)({type:"user-subscribed",name:g.name,role:g.role,user_ref:g.user_ref,socket:g.socket});b.a.info("room-event",p.a.event_general_success,{message:"userSubcribe - user subscribed"});d.dispatchEvent(g)},$b=function(g){g=Object(m.d)({type:"user-subscribed",name:g.name,
role:g.role,user_ref:g.user_ref,socket:g.socket});b.a.info("room-event",p.a.event_general_success,{message:"userUnSubcribe - user unsubscribed"});d.dispatchEvent(g)},bc=function(g){k["default"].debug(" socketOnVcxRtcMessage() arg: "+JSON.stringify(g));if(g.peerId)var a=P.get(g.peerId);else{if(d.dataStream&&g.streamId==d.dataStream.getID()){!d.dataStream.failed&&d.dataStream.pc&&(d.dataStream.pc.processSignalingMessage(g.msg,void 0),g.msg&&"object"===typeof g.msg&&"ready"===g.msg.type&&(d.dataStream.state=
"connected",g=d.dataStream.getSelectedCandidatePair(),k["default"].error("data channel ready selected candidates pair : "+(g?JSON.stringify(g):"unknown"))));return}a=W.get(g.streamId)}if(a&&!a.failed&&a.pc)a.pc.processSignalingMessage(g.msg,d.mediaConfiguration),g.msg&&"object"===typeof g.msg&&("ready"===g.msg.type?(g=a.getSelectedCandidatePair(),g="selected candidates pair : "+(g?JSON.stringify(g):"unknown"),a.local?(Ua(a.ifScreen(),a.ifCanvas()),a.ifCanvas()||a.ifScreen()?(Na(!1,a.getID(),!0),k["default"].error("stream state local "+
(a.ifCanvas()?"canvas":"screen")+" ready "+g)):k["default"].error(" stream state local main: ready "+g)):(k["default"].error(" stream state remote : ready "+g),d.remoteStreams.forEach(function(g){g.setSpeaker(d.speakerInfo.id)}),d.audioOnlyMode&&(k["default"].info(" stream state remote : ready setting video talkers to 0 for audioOnly"),d.socket.emitEvent(v.a.RoomEvent.set_active_talker,{numVideoTalkers:0,numTalkers:d.userVideoTalkerCount,numAudioTalkers:d.userAudioTalkerCount},function(g){}))),a.onConnectionStateChanged(!0),
Ca(a,"del"),a.local||P.forEach(function(g,b){if(a.getID()!=g.getID())g.onConnectionStateChanged(!0)})):"started"===g.msg.type&&(!a.local||a.ifCanvas()||a.ifScreen()||ac(a)));else{var c=" id: ";c=void 0!=g.peerId?c+g.peerId:void 0!=g.streamId?c+g.streamId:c+"undefined ";c+=" err: ";c=a?a.failed?c+"stream failed true ":c+"stream PC  null":c+"stream not found";b.a.error("stream-event",p.a.event_stream_track_pc_failed,{err:c});k["default"].error("socketOnVcxRtcMessage(), Failed "+c+" arg: "+JSON.stringify(g))}},
cc=function(g){var b=W.get(g.streamId);b&&!b.failed?b.pc.get(g.peerSocket).processSignalingMessage(g.msg):(b=P.get(g.streamId),b.pc.processSignalingMessage(g.msg))},dc=function(g){W.get(g.streamId)},ec=function(g){W.get(g.streamId)},rb=function(g){k["default"].debug("Received SocketOnSelfBandwidthAlert",JSON.stringify(g));if("SubscriberBandWidth"===g.message){var a=Object(m.e)({type:"room-bandwidth-alert",message:g.bandwidth});d.dispatchEvent(a)}else W.forEach(function(a,d){1===g.bandwidth?(k["default"].info("mute publisher video due to low bandwidth"),
b.a.info("room-event",p.a.event_low_bandwidth_update,{message:"socketOnSelfBandwidthAlert - muted publisher video due to low bandwidth"}),a.muteVideo()):"ShareBandwidth"===g.message&&a.screen?a.setVideoParamsRange(g.bandwidth,void 0,void 0,void 0,!0):"PublisherBandwidth"!==g.message||a.screen||(H=g.bandwidth,a.setVideoParamsRange(g.bandwidth,void 0,void 0,void 0,!0))})},fc=function(g){"bw-alert"===g.id?sb(g.msg):"publisher-bw"===g.id||"share-bw"===g.id?rb(g.msg):(g=Object(m.e)({type:g.id,message:g.msg}),
d.dispatchEvent(g))},sb=function(g){k["default"].info("OnbandwidthAlert:",g);for(var a=!1,c=0;c<g.length;c++){var f=d.remoteStreams.getAll()[g[c].streamId];null==f?k["default"].info("Stream not found"):("unknown"==g[c].bw?(k["default"].warning("socketOnBandwidthAlert() sId: "+g[c].streamId+" Bwd unknown, marking for reconn"),a=!0,qa++):"low"==g[c].bw?ba++:na++,f.setBandwidthAlert(g[c]))}b.a.warn("room-event",p.a.event_streams_subscribe_bw_alerts,{low:ba,unknown:qa,restored:na});a&&(console.log("socketOnBandwidthAlert() unknown/no bwd received event,reconnecting stream"),
Ca(d.remoteStreams.get(1),"add",function(g){}))},gc=function(g){if(d.activeTalker)if(d.eventsList&&void 0!==d.eventsList&&"message-received"in d.eventsList){var b=Object(m.e)({type:"message-received",message:g.msg});d.dispatchEvent(b)}else b=Object(m.e)({type:"active-talker-data-in",message:g.msg}),d.dispatchEvent(b);else b=P.get(g.id),g=Object(m.f)({type:"stream-data-in",msg:g.msg,stream:b}),b.dispatchEvent(g)},Va=function(g,b,a,c){c=document.createElement("div");c.setAttribute("id","fs-notif-id-"+
Math.random());c.setAttribute("class","fs-notification");c.setAttribute("style","display:block;position:relative;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)");b.appendChild(c);b=c;switch(a){case "fs-upload-init":a="upload started for file "+g.data[g.data.length-1].name+" of size "+g.data[g.data.length-1].size/1E3+" KB";c=g.message;g=document.createElement("br");b.appendChild(g);a=document.createTextNode(a);
b.appendChild(a);b.appendChild(g);break;case "fs-file-uploaded":a="uploaded 100 % "+g.name+"  of size "+g.size/1E3+" KB";c=g.message;g=document.createElement("br");b.appendChild(g);a=document.createTextNode(a);b.appendChild(a);b.appendChild(g);break;case "fs-upload-started":a=g.sender+" is sharing file "+g.message.data[g.message.data.length-1].name+"  of size "+g.message.data[g.message.data.length-1].size/1E3+" KB";c=g.message;g=document.createElement("br");b.appendChild(g);a=document.createTextNode(a);
b.appendChild(a);b.appendChild(g);break;case "fs-file-available":c=g.message;g=document.createElement("br");b.appendChild(g);var f=document.createElement("BUTTON");a=document.createTextNode(c.name);f.setAttribute("style","color:red;font-size:23px");f.setAttribute("id",K.length-1);f.appendChild(a);b.appendChild(f);f.onclick=function(){d.recvFiles(f.id)};b.appendChild(g);break;default:k["default"].info("random data to fantom UI ")}},hc=function(g,b){k["default"].debug("socketOnDataStreamToRoom",g.type);
switch(g.type){case "chat":var a="message-received";break;case "data-internal-in":a=g.message.type;pb(g,b);break;default:a="user-data-received"}d.eventsList&&a in d.eventsList?(g=Object(m.e)({type:a,message:g}),d.dispatchEvent(g),b&&b(r.a.error_000)):b&&b(r.a.error_1169)},pb=function(g,a){switch(g.message.type){case "fs-upload-started":g.message.broadcast=g.broadcast;g.message.sender=g.sender;g.message.senderId=g.senderId;k["default"].info(" file is being shared with you fs-upload-started",g.message);
!0===d.showFsUi&&null!==document.getElementById(O)&&(Va(g,document.getElementById(O),"fs-upload-started"),b.a.info("room-event",p.a.event_file_download_success,{error:{}}));break;case "fs-file-available":g.message.broadcast=g.broadcast;g.message.sender=g.sender;g.message.senderId=g.senderId;K.push(g.message);a={broadcast:g.broadcast,sender:g.sender,senderId:g.senderId,name:g.message.name,size:g.message.size,speed:g.message.speed,createdAt:g.message.createdAt,dlimit:g.message.dlimit,time:g.message.time,
expiresAt:g.message.expiresAt,timeLimit:g.message.timeLimit,index:K.length-1};d.availableFiles.push(a);k["default"].info("file is available for download fs-file-available name: "+a.name+" id: "+(a.id?a.id:"undefined"));a=Object(m.e)({type:"fs-download-result",message:{messageType:"download-available",result:0,description:"file-available",response:{downloadStatus:"available",jobId:a.index,downloadInfo:a}}});d.dispatchEvent(a);!0===d.showFsUi&&null!==document.getElementById(O)&&Va(g,document.getElementById(O),
"fs-file-available");break;case "fs-upload-cancelled":break;default:k["default"].info("unknown internal data type from signaling server ",g.type),b.a.error("room-event",p.a.event_file_download_failed,{error:{}})}},ic=function(g){var b=P.get(g.id),a=Object(m.f)({type:"stream-attributes-updated",attrs:g.attrs,stream:b});b.updateLocalAttributes(g.attrs);b.dispatchEvent(a)},jc=function(g){k["default"].info("socketOnRemoveStream() stream id to remove: "+g.id);var a=W.get(g.id);if(a)Sa(a);else if(a=P.get(g.id))P.remove(g.id),
Ra(a),g=Object(m.f)({type:"stream-removed",stream:a}),b.a.info("room-event",p.a.event_general_success,{message:"socketOnRemoveStream - stream removed"}),d.dispatchEvent(g)},kc=function(){k["default"].info("Socket disconnected, lost connection to Signalling Server, room state: "+d.state);0!==d.state&&3!==d.state&&(d.breakOutRoom.disconnectAll(),va(!1,!1,"socketDisconnect"))},lc=function(g){if(g.streamId){var a="ICE Connection Failed on "+g.type+" "+g.streamId+" "+d.state;k["default"].error(a);b.a.error("room-event",
p.a.event_ice_failed,{arg:g});g="publish"===g.type?W.get(g.streamId):P.get(g.streamId);Sa(g,a)}},mc=function(g){d.reconnectionAllowed?(k["default"].error("socketOnError() Cannot connect to client Controller setting timer "),b.a.info("room-event",p.a.event_general_success,{message:"socketOnError - Cannot connect to signalling"}),sa=setTimeout(function(){sa=void 0;!d.socket||d.socket.checkSetSocketState()?(k["default"].info(" socket error timeout socket not connected calling doesConnectionExist()"),
0===d.state?Wa():d.isFirstConnect&&(va(!0,!1,"sock error",!1),d.dispatchEvent(Object(m.e)({type:"room-error",error:r.a.error_1161.result,message:r.a.error_1161.error})))):k["default"].info(" socket error timeout , socket connected, ignoring")},1E3*x.a.socketErrorTimeoutSecs)):k["default"].error("socketOnError() reconnection not allowed. ignoring socket error")},bb=function(g){k["default"].debug("sendDataSocketFromStreamEvent");var a=g.stream;g=g.msg;a.local?y.sendMessage("sendDataStream",{id:a.getID(),
msg:g}):(k["default"].error("You can not send data through a remote stream"),b.a.error("room-event",p.a.event_general_failed,{message:"sendDataSocketFromStreamEvent - You can not send data through a remote stream"}))},cb=function(g,b,a,c,f,e){g&&void 0!==b&&"boolean"===typeof b&&(!1!==b||a&&Array.isArray(a)&&a.length)&&"number"===typeof c?c>x.a.senduserDataMaximumLimit?(k["default"].error("message: content-length must be <= 2048, entered value : "+c+" kB"),e(r.a.error_1196)):fa&&d.dataStream?(c=(new Date).getTime(),
g={clients:a,broadcast:b,sender:d.me.name,senderId:d.clientId,type:f,message:g,timestamp:c},d.dataStream.channel?"open"==d.dataStream.channel.readyState?(d.dataStream.channel.send(JSON.stringify(g)),e(r.a.error_000)):"connecting"==d.dataStream.channel.readyState?(d.dataStream.pendingMessages||(d.dataStream.pendingMessages=[]),d.dataStream.pendingMessages.push({msg:g,callback:e})):(k["default"].error("validateSendUserData() error, data connection channel in invalid state"),e(r.a.error_1160)):"initing"==
d.dataStream.state?(d.dataStream.pendingMessages||(d.dataStream.pendingMessages=[]),d.dataStream.pendingMessages.push({msg:g,callback:e})):(k["default"].error("validateSendUserData() error, data connection stream in invalid state"),e(r.a.error_1160))):d.socket.emitEvent("sendDataStreamToRoom",{msg:g,broadcast:b,clients:a,type:f},e):(k["default"].error("message: invalid parameter, msg/broadcast/clients/contentLength undefined or type mistmatch"),e(r.a.error_1155))};d.sendUserData=function(g,b,a,d){d=
void 0===d?function(){}:d;var c=100;g["content-length"]&&(c=g["content-length"],delete g["content-length"]);JSON.stringify(g).length/1024>c?(k["default"].error("message: large data, failed - larger text-data. Max allowed length is "+c+" kB"),d(r.a.error_1195)):cb(g,b,a,c,"user_data",d)};var tb=function(g,b,a,d,c){g.type=b;cb(g,a,d,0,"data-internal-in",void 0===c?function(){}:c)};d.recordTranscriptMessage=function(g,b){b=void 0===b?function(){}:b;"string"!=typeof g&&"object"==typeof g&&JSON.stringify(g);
d.socket.emitEvent("sendDataStreamToRoom",{msg:g,broadcast:!1,clients:[],type:"transcription"},b)};d.sendMessage=function(g,b,a,d){d=void 0===d?function(){}:d;var c=0;"string"==typeof g?c=g.length/1024:"object"==typeof g&&(c=JSON.stringify(g).length/1024);cb(g,b,a,c,"chat",d)};var nc=function(g,b){b=void 0===b?function(){}:b;var a=["grid","talker","presenter"],c=["liveRecording","streaming","screenShare","all"],f=g.service;g=g.layout;void 0==b||"function"!==typeof b?k["default"].error("message: invalid value for callback parameter"):
"moderator"!==d.me.role?(k["default"].warning("User should be a moderator to change layout details."),b(r.a.error_1168)):0===d.state?(k["default"].info("Room is disconnected"),b(r.a.error_7079)):void 0!=g&&"string"===typeof g&&a.includes(g)?void 0!=f&&"string"===typeof f&&c.includes(f)?(a={},a.layout=g,a.service=f,d.socket.sendParamEvent("sendLayoutData",a,function(g,a){k["default"].info("sending sendLayoutData");null===g?(k["default"].error("Error in layout update: ",a),b(a)):(k["default"].info("Layout updated successfully."),
b(g))})):(k["default"].error("message: invalid value for service parameter"),b&&b(r.a.error_1193)):(k["default"].error("message: invalid value for layout parameter"),b&&b(r.a.error_1192))},ua=function(g){var b=0,a=0,d=0,c=0,k=0,f=0,e="";g&&(Object.keys(g).forEach(function(e){switch(e){case "bitrateCalculated":c=Math.round(g[e]/1E3);break;case "framerateCalculated":k=g[e];break;case "bandwidth":d=Math.round(g[e]/1E3);break;case "packetsLost":f=g[e];break;case "frameHeight":b=g[e];break;case "frameWidth":a=
g[e]}}),!x.a.csp_enabled&&(e+='<div> <strong style="color:black;" > '+a+"X"+b+"p"+k+"@"+c+"Kbps</strong></div>",d||f))&&(e+='<div> <strong style="color:black;" > AvailBw:'+d+"Kbps, loss:"+f+"</strong></div>");return x.a.csp_enabled?{resHeight:b,resWidth:a,packetsLost:f,bandwidth:d,frameRate:k,bitrate:c}:{displayString:e,resHeight:b,resWidth:a,packetsLost:f,bandwidth:d,frameRate:k,bitrate:c}},oc=function(g){var b=[],a={},c={},f={};g.statData.stats.forEach(function(g){var e=g.streamType;if("actStat"===
e){var I={};if(x.a.csp_enabled)for(void 0==b[g.subscriberStreamId]&&(b[g.subscriberStreamId]={id:g.subscriberStreamId}),I.video=[],Object.keys(g.total).forEach(function(b){"bitrateCalculated"===b&&(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)&&(I["total-bitrate-kbps"]=b)}),e=0;e<g.videoStats.length;e++)I.video[e]=ua(g.videoStats[e]);else e=document.querySelectorAll("#stats-left-part-"+g.subscriberStreamId),void 0==b[g.subscriberStreamId]&&(b[g.subscriberStreamId]=
{id:g.subscriberStreamId}),I.video=[],e.forEach(function(b){if(void 0!==b&&null!==b){var a="";Object.keys(g.total).forEach(function(b){if("bitrateCalculated"===b)if(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)I["total-bitrate-kbps"]=b;else if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+="<div> <strong>Tx Total:</strong>  "+b+"Kbps </div>"});for(var c=0;c<g.videoStats.length;c++)if(I.video[c]=ua(g.videoStats[c]),"display"==d.mediaStatsMode||
"notify-display"==d.mediaStatsMode)a+=I.video[c].displayString,b.innerHTML='<div id="" class="stats-detail"> '+a+"</div>"}});b[g.subscriberStreamId].publisher=I}else if("selfPcStat"===e){void 0==b[g.subscriberStreamId]&&(b[g.subscriberStreamId]={id:g.subscriberStreamId});var h={video:[]};if(x.a.csp_enabled)for(parseInt(g.streamId),Object.keys(g.total).forEach(function(b){"bitrateCalculated"===b&&(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)&&(h["total-bitrate-kbps"]=
b)}),e=0;e<g.videoStats.length;e++)h.video[e]=ua(g.videoStats[e]);else{var m=parseInt(g.streamId)+1;document.querySelectorAll("#stats-right-part-"+g.subscriberStreamId).forEach(function(b){if(void 0!==b&&null!==b){var a="";Object.keys(g.total).forEach(function(b){if("bitrateCalculated"===b)if(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)h["total-bitrate-kbps"]=b;else if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+="<div> <strong>Rx ID: "+
m+", Total:</strong>  "+b+"Kbps </div>"});b.innerHTML='<div id="" class="stats-detail">'+a+"</div>";for(var c=0;c<g.videoStats.length;c++)if(h.video[c]=ua(g.videoStats[c]),"display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+=h.video[c].displayString,b.innerHTML='<div id="" class="stats-detail">'+a+"</div>"}})}k["default"].debug(" subscriberStreamId: "+g.subscriberStreamId+" substat: "+JSON.stringify(h));b[g.subscriberStreamId].subscriber=h}else if("selfPubStat"===e)if(x.a.csp_enabled)for(Object.keys(g.total).forEach(function(b){"bitrateCalculated"===
b&&(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)&&(a["total-bitrate-kbps"]=b)}),a.video=[],e=0;e<g.videoStats.length;e++)a.video[e]=ua(g.videoStats[e]);else e=document.querySelectorAll("#stats-left-part-"+g.streamId),e.forEach(function(b){if(void 0!==b&&null!==b){var c="";Object.keys(g.total).forEach(function(b){if("bitrateCalculated"===b)if(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a["total-bitrate-kbps"]=
b;else if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)c+="<div> <strong>Tx Total</strong> "+b+"Kbps</div>"});a.video=[];for(var k=0;k<g.videoStats.length;k++)if(a.video[k]=ua(g.videoStats[k]),"display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)c+=a.video[k].displayString,b.innerHTML='<div id="" class="stats-detail">'+c+"</div>"}});else"canvasStat"===e?x.a.csp_enabled?(Object.keys(g.total).forEach(function(b){"bitrateCalculated"===b&&(b=Math.round(g.total[b]/1E3),"notify"==
d.mediaStatsMode||"notify-display"==d.mediaStatsMode)&&(c["total-bitrate-kbps"]=b)}),c.video=ua(g.videoStats)):(e=document.querySelectorAll("#stats-left-part-"+g.subscriberStreamId),e.forEach(function(b){if(void 0!==b&&null!==b){var a="";Object.keys(g.total).forEach(function(b){if("bitrateCalculated"===b)if(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)c["total-bitrate-kbps"]=b;else if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+=
"<div> <strong>Tx Total:</strong>  "+b+"Kbps </div>"});c.video=ua(g.videoStats);if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+=c.video.displayString,b.innerHTML='<div id="" class="stats-detail">'+a+"</div>"}})):"shareStat"===e&&(x.a.csp_enabled?(Object.keys(g.total).forEach(function(b){"bitrateCalculated"===b&&(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)&&(f["total-bitrate-kbps"]=b)}),f.video=ua(g.videoStats)):(e=document.querySelectorAll("#stats-left-part-"+
g.subscriberStreamId),e.forEach(function(b){if(void 0!==b&&null!==b){var a="";Object.keys(g.total).forEach(function(b){if("bitrateCalculated"===b)if(b=Math.round(g.total[b]/1E3),"notify"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)f["total-bitrate-kbps"]=b;else if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+="<div> <strong>Tx Total:</strong>  "+b+"Kbps </div>"});f.video=ua(g.videoStats);if("display"==d.mediaStatsMode||"notify-display"==d.mediaStatsMode)a+=f.video.displayString,
b.innerHTML='<div id="" class="stats-detail">'+a+"</div>"}})))});k["default"].info("that.mediaStatsMode : "+d.mediaStatsMode+" talkers: "+JSON.stringify(b)+" selfPublisherStat: "+JSON.stringify(a));"notify"!=d.mediaStatsMode&&"notify-display"!=d.mediaStatsMode||d.dispatchEvent({type:"media-stats",talkers:b,publisher:a,share:f,canvas:c})},ub=function(g){var a=g.stream;g=g.attrs;a.local?(a.updateLocalAttributes(g),y.sendMessage("updateStreamAttributes",{id:a.getID(),attrs:g}),b.a.info("room-event",
p.a.event_general_success,{message:"updateAttributesFromStreamEvent - updateStreamAttributes - success"})):k["default"].error("You can not update attributes in a remote stream")},B=function(g,b){b.args?g.apply(null,$jscomp.arrayFromIterable(b.args)):g()},db=function(g,b,a){return{state:g,data:b.ifData(),audio:b.ifAudio(),video:b.ifVideo(),screen:b.ifScreen(),canvas:b.ifCanvas(),canvasType:a.canvasType,attributes:b.getAttributes(),metadata:a.metadata,createOffer:a.createOffer,muteStream:a.muteStream,
shareMetadata:a.shareMetadata}},eb=function(g,a,c,f){f=void 0===f?function(){}:f;null===g?(k["default"].error("Error when publishing the stream",c),b.a.error("room-event",p.a.event_stream_publish_failed,{error:c}),f(void 0,c)):(k["default"].info("Stream published stream type: "+(a.screen?"screen":a.canvas?"canvas":"main")),b.a.info("room-event",p.a.event_stream_publish_success,{error:{}}),a.setID(g),a.on("internal-send-data",bb),a.on("internal-set-attributes",ub),W.add(g,a),a.room=d,f(g))},pc=function(g,
b,a){a=void 0===a?function(){}:a;if(g.url){var c="url";var f=g.url}else c="recording",f=g.recording;k["default"].info("Checking publish options for",g.getID());g.checkOptions(b);d.socket.sendSDP("publish",db(c,g,b),f,function(b,d){eb(b,g,d,a)})},qc=function(g,b,a){a=void 0===a?function(){}:a;d.socket.sendSDP("publish",db("data",g,b),void 0,function(b,d){eb(b,g,d,a)})},Na=function(g,b,a){k["default"].debug("setMediaConnectionTimer()  enable: "+g+" pub: "+a+"  streamId: "+b);void 0!=oa&&clearTimeout(oa);
g?oa=setTimeout(function(){rc(b,a)},1E3*x.a.getMediaConnectionTimeoutSecs(d.isStreamingClient)):(d.dispatchEvent(Object(m.e)({type:"media-state",message:{active:!0}})),oa=void 0)},fb=function(g,b,a){a=void 0===a?function(){}:a;if(void 0!==g.screen&&0!=g.screen||void 0!==g.canvas&&0!=g.canvas)void 0!==g.canvas&&1==g.canvas?k["default"].info("Publishing Canvas spatiallayers 3 createOffer",b.createOffer):k["default"].info("Publishing Share createOffer",b.createOffer);else{g.handleMediaDeviceChangeNotify("publisher",
!0,!1);var c=b.maxVideoLayers?b.maxVideoLayers:d.maxVideoLayers;1<c&&3>=c&&(b.simulcast={numSpatialLayers:c,spatialLayerBitrates:x.a.video_layer_bitrates});k["default"].info("Publishing Main, createOffer",b.createOffer," Max video layers: "+c)}c=db("media_engine",g,b);c.minVideoBW=b.minVideoBW;c.maxVideoBW=b.maxVideoBW;c.scheme=b.scheme;k["default"].info("publish video: constraints: "+JSON.stringify(c)+" options: "+JSON.stringify(b));d.socket.sendSDP("publish",c,void 0,function(c){c&&0===c.result&&
(eb(c.id,g,void 0,void 0),Ub(g,b),g.clientId=d.clientId,g.maxVideoBwKbpsReqByServer=b.maxVideoBW);a(c)});Na(!0,g.getID(),!0)},sc=function(g,b){g=b&&g.ifVideo();var a=b&&b.width,d=b&&b.height;b=b&&b.frameRate;return a||d||b?{width:a,height:d,frameRate:b}:g},tc=function(g,a,c){c=void 0===c?function(){}:c;var f=a;void 0==f&&(f={});f.maxVideoBW=f.maxVideoBW||t.defaultVideoBW;f.maxVideoBW>t.maxVideoBW&&(f.maxVideoBW=t.maxVideoBW);f.audio=void 0===f.audio?!0:f.audio;f.video=void 0===f.video?!0:f.video;
f.data=void 0===f.data?!0:f.data;f.canvas=void 0===f.canvas?!0:f.canvas;g.checkOptions(f);a={streamId:g.getID(),audio:f.audio&&g.ifAudio(),video:sc(g,f.video),data:f.data&&g.ifData(),canvas:f.canvas&&g.ifCanvas(),browser:d.Connection.browserEngineCheck(),createOffer:f.createOffer,metadata:f.metadata,muteStream:f.muteStream,slideShowMode:f.slideShowMode};1==g.getID()&&g.handleMediaDeviceChangeNotify("subscriber",!1,!0,function(g){d.speakerInfo=g.info;d.remoteStreams.forEach(function(b){b.setSpeaker(g.info.deviceId)})});
k["default"].debug("SOCKET EVENT subscribe:- "+JSON.stringify(a));d.socket.sendSDP("subscribe",a,void 0,function(a,d){null===a?(k["default"].error("Error subscribing to stream ",d),b.a.error("room-event",p.a.event_stream_subscribe_failed,{error:d}),c(void 0,d)):(k["default"].info("Subscriber added"),k["default"].info("stream subscription result",a),Rb(g,f),c(!0))})},uc=function(g,a,c){c=void 0===c?function(){}:c;d.socket.sendSDP("subscribe",{streamId:g.getID(),data:a.data,metadata:a.metadata},void 0,
function(a,f){null===a?(k["default"].error("Error subscribing to stream ",f),b.a.error("room-event",p.a.event_stream_subscribe_failed,{error:f}),c(void 0,f)):(k["default"].info("Stream subscribed"),a=Object(m.f)({type:"stream-subscribed",stream:g}),d.dispatchEvent(a),c(!0))})},vb=function(g){var a=P.get(1);a||W.forEach(function(g,b){a||(a=g)});a&&a.getSelectedCandidateType(function(a){b.a.warn("room-event",g,{numReconnects:d.reconnectAttempt,lastDiscReason:d.lastDisconnectReason,connType:a,numStreamReconnects:{pub:Aa,
sub:U}})})},va=function(g,b,a,c){c=void 0===c?!0:c;k["default"].info("validateProcessNetworkTimeout() forceDisconnect : "+g+" rejoin room:"+b+" retries: "+d.reconnectAttempt+" state: "+d.state);d.lastDisconnectReason=a;if(g||0==d.state||2==d.state)4==Ha&&d.postClientLogs(),!g&&d.reconnectAttempt<ma?(d.reconnectionAllowed=d.isStreamingClient?!1:!0,b?(c&&d.dispatchEvent(Object(m.e)({type:"network-reconnecting",message:"Network issues - reconnecting, please wait"})),d.rejoinRoom(function(g){g.result!=
r.a.error_000.result&&va(!1,!0,a,c)})):gb(c)):(vb(p.a.event_client_connection_failed),k["default"].info("force disconnect"),d.reconnectionAllowed=!1,gb(c),c&&d.dispatchEvent(Object(m.e)({type:"network-reconnect-timeout",error:r.a.error_1165.result,message:r.a.error_1165.error})))},Wa=function(g){g=void 0===g?!1:g;k["default"].info("doesConnectionExist() state: "+d.state+" timer: "+E.timer+"timeoutCb: "+g);if(0===d.state&&(!E.timer||g)){var b=0,a=new XMLHttpRequest;g=void 0!==d.internetDetectionUrl?
d.internetDetectionUrl:x.a.internetDetectionUrl;var c=Math.round(1E4*Math.random());a.timeout=15E3;a.open("HEAD",g+"?rand="+c,!0);a.ontimeout=function(g){k["default"].info("xhr timeout---------------")};a.addEventListener("readystatechange",function(g){g=E.disconnectedDurationSecs*E.intervalSecs;4===a.readyState?200<=a.status&&304>a.status?(b++,E.timer&&(clearTimeout(E.timer),delete E.timer),k["default"].info("internet is back connection exists after !"+g+" secs"),E.disconnectedDurationSecs=0,1===
b&&va(!1,!0,"networkLost")):(E.timer&&(clearTimeout(E.timer),delete E.timer),E.disconnectedDurationSecs++,k["default"].info("internet connection doesn't exist! secs left: "+(E.timeoutSecs-g)),g<E.timeoutSecs?E.timer=setTimeout(Wa.bind(this),1E3*E.intervalSecs,!0):va(!0,!1,"networkLost")):k["default"].debug("ajax req readystate: ",a.readyState,"status ",a.status,"timer",E.timer)}.bind(h),!1);a.send()}},vc=function(){d.remoteStreams.size()&&d.remoteStreamsInfo.clear();d.remoteStreams.forEach(function(g,
b){var a={};g.player&&(a.player=g.player);g.userRequestOptions?a.userReqOpt=g.userRequestOptions:k["default"].error(" onRoomConnected() player and userRequestOptions missing, ignoring sid: "+b);d.remoteStreamsInfo.add(b,a)});k["default"].info("storeRemoteStreamPlayers() remoteStreamsInfo: "+JSON.stringify(d.remoteStreamsInfo.keys()))},xb=function(g,b){g&&P.size()&&d.remoteStreamsInfo.clear();var a;P.forEach(function(b,c){void 0!==b&&void 0!==b.stream?b.stream.getTracks().forEach(function(g){g.onended=
null;g.stop()}):k["default"].debug("remote stream or media stream is undefined id: "+c);b.pc&&(a||(a=b.pc),delete b.pc);if(g){var f={};b.player&&(f.player=b.player);b.userRequestOptions&&(f.userReqOpt=b.userRequestOptions);d.remoteStreamsInfo.add(c,f)}Ra(b);P.remove(c)});a&&a.close();W.forEach(function(b,a){b.pc&&(b.pc.close(),delete b.pc);g&&wb(b);b&&b.local&&(k["default"].info("stream off for internal send data"),b.off("internal-send-data",bb));W.remove(a)});d.allStreamsActive=!1},gb=function(g,
a){k["default"].info("clearAll() room-disconnected, reconnectionAllowed: "+d.reconnectionAllowed);if(!1===d.reconnectionAllowed){Xa("clear-all",!0,!0);try{k["default"].debug("normal socket closure, disconnect socket room state:"+d.state);var c=function(g){k["default"].debug("disconnectSocket() room state: "+d.state+" initiator: "+g);0!=d.state&&(d.state=0,d.allStreamsActive=!1,0!==d.streamsHealthTimerId&&(clearInterval(d.streamsHealthTimerId),d.streamsHealthTimerId=0),y.disconnect(),y.state=y.DISCONNECTED,
y=void 0);a&&a(r.a.error_000)};if(2==d.state){d.state=3;d.allStreamsActive=!1;0!==d.streamsHealthTimerId&&(clearInterval(d.streamsHealthTimerId),d.streamsHealthTimerId=0);var f=setTimeout(c,1E3,"timer");d.socket.emitEvent(v.a.RoomEvent.drop,{self:!0},function(g){clearTimeout(f);c("disc callback")})}else 3!=d.state&&c("direct")}catch(Bd){k["default"].debug("Socket already disconnected"),a&&a(r.a.error_1163)}}else k["default"].debug("in clear all - unexpected disconnection and the case for reconnect"),
xb(!0),y.state=y.DISCONNECTED,d.state=0,d.allStreamsActive=!1,0!==d.streamsHealthTimerId&&(clearInterval(d.streamsHealthTimerId),d.streamsHealthTimerId=0),k["default"].info("send network disconnected event"),g&&(g=Object(m.e)({type:"network-disconnected",error:r.a.error_1163.result,message:r.a.error_1163.error}),d.dispatchEvent(g)),Wa(),a&&(b.a.error("room-event",p.a.event_general_failed,{message:r.a.error_1163}),a(r.a.error_1163))};d.connect=function(g,a){g=void 0===g?{allow_reconnect:!0,number_of_attempts:3,
timeout_interval:45E3}:g;a=void 0===a?function(){}:a;var c=JSON.parse(q.a.decodeBase64(t.token));d.reconnectionAllowed=g.allow_reconnect;d.reconnectionTimeOutInterval=g.timeout_interval;ma=g.number_of_attempts;k["default"].debug(" connection attempt check :"+d.connectAttempt);E.timeoutSecs=d.reconnectionTimeOutInterval/1E3;Y<ma&&(Y=ma);if(d.connectAttempt>=Y||d.reconnectAttempt>=ma)va(!0,!1,"connectAttemptExceed"),a(r.a.error_1165);else{!0===d.reconnectionState&&(d.reconnectAttempt++,c.isReconnecting=
!0,c.reconnectAttempt=d.reconnectAttempt,c.oldClientIdForReconnect=d.clientId,!d.isModerator()&&d.sharePermissions&&d.sharePermissions.screen&&d.sharePermissions.canvas&&("idle"!=d.sharePermissions.screen.state||"idle"!=d.sharePermissions.canvas.state)&&(c.changedOptions={sharePermissions:{screen:{state:d.sharePermissions.screen.state},canvas:{state:d.sharePermissions.canvas.state}}}),c.room=d.roomID,c.role=d.me.role,c.name=d.me.name,c.user_ref=d.me.user_ref,c.reconnectCount=d.reconnectAttempt,k["default"].info("new token request for the reconnection: ",
c));k["default"].info("room.connect() roomId: "+d.roomID+" logId: "+c.logId);c.logId&&x.a.setLocalStorageItem("logID",c.logId);d.state=1;d.me.logId=c.logId;d.allStreamsActive=!1;0!==d.streamsHealthTimerId&&(clearInterval(d.streamsHealthTimerId),d.streamsHealthTimerId=0);c.hostType=x.a.browser_info.name;c.hostVersion=x.a.browser_info.version;c.hostDeviceType=x.a.browser_info.device_type;c.userAgent=x.a.user_agent;c.advancedOptions=t.options;c.version=x.a.product.version;void 0!=t.maxActiveTalkers&&
"number"==typeof t.maxActiveTalkers&&(c.maxActiveTalkers=t.maxActiveTalkers);x.a.maxClientsForDataChannel&&c.roomMeta.settings.participants>x.a.maxClientsForDataChannel&&(fa=!1);c.singlePC="subs";c.dataChannel=fa;sa&&(clearTimeout(sa),sa=void 0);d.connectAttempt++;g=8E3;var f=2;c.isStreamingClient&&(g=4E3,f=2);k["default"].info("calling socket connect that.connectAttempt: "+d.connectAttempt);d.socket.connect({token:c,timeoutMs:g,retryAttempts:f},function(g){k["default"].info("socket response: ",g);
0===g.result?(d.connectAttempt=0,k["default"].info("socket.connect token accepted"),d.externalIp=g.connectedIP,a(r.a.error_000)):(k["default"].info("connect error",g),Wa(),d.dispatchEvent(Object(m.e)({type:"room-error",error:g.result,message:g.msg})),d.createEventLog("clientConnFailed",{clientId:"",hostType:x.a.browser_info.name,hostVersion:x.a.browser_info.version,error:g.msg,externalIp:d.externalIp}),a(r.a.error_1161))},function(g){k["default"].error("Not Connected! Error: "+g);va(!0,!1,"connectFailed");
if("object"==typeof g&&void 0!=g.result){k["default"].error("socket.connect failed with error: "+JSON.stringify(g));var c=g.result}else c=g;c=Object(m.e)({type:"room-error",error:c,message:g});b.a.error("room-event",p.a.event_socket_connect_failed,{numReconnects:d.reconnectAttempt,discReason:d.lastDisconnectReason});d.dispatchEvent(c);d.createEventLog("clientConnFailed",{clientId:"",hostType:x.a.browser_info.name,hostVersion:x.a.browser_info.version,error:g,externalIp:d.externalIp});a(r.a.error_1161)})}};
d.rejoinRoom=function(g){g=void 0===g?function(){}:g;k["default"].debug("=========== port of hope--- reconnect");""!=d.externalIp&&(d.reconnectionState=!0);k["default"].info(" rejoinRoom() disconnect and connect after 1 sec");d.state=4;xb(d.reconnectionState);void 0===y&&!0===d.reconnectionState?(k["default"].info("reconnect creating a new socket"),d.state=0,d.allStreamsActive=!1,0!==d.streamsHealthTimerId&&(clearInterval(d.streamsHealthTimerId),d.streamsHealthTimerId=0),k["default"].info("reconnect force a new socket"),
y=Object(e.a)(void 0),d.socket=y):(d.socket.disconnect(),k["default"].debug("previous connection is still there or the reconnection state is false"));d.userList.clear();var b={allow_reconnect:d.reconnectionAllowed,timeout_interval:d.reconnectionTimeOutInterval,number_of_attempts:ma};setTimeout(function(){k["default"].info(" rejoinRoom() connecting11 ");d.connect(b,g)}.bind(h),1E3)};d.disconnect=function(g){k["default"].info("room.disconnect() clearing alll ");d.reconnectionAllowed=!1;gb(!0,function(b){void 0==
g&&(g={cause:r.a.CC006});b=Object(m.e)({type:"room-disconnected",message:g});k["default"].debug("that.disconnect() sending room-disconnected event");d.dispatchEvent(b)})};d.removeTrack=function(g){d.socket.sendSDP("removeTrack",{streamId:g,msg:"track-removed"},void 0,function(){})};d.getWaitingUserList=function(g){d.socket.sendMessage("getAwaitedUser",function(b){if(0===b.result)for(var a in b.awaitedParticipants)d.awaitedParticipants.set(b.awaitedParticipants[a].clientId,{clientId:b.awaitedParticipants[a].clientId,
name:b.awaitedParticipants[a].name});g&&g(b)})};d.updateLayout=function(g,b){nc(g,b)};var Oa=function(g,b){k["default"].info("event: "+g+":"+b.clientId+"::::"+b.name);d.cCrequest.push({clientId:b.clientId,name:b.name,type:"raised"});g=Object(m.e)({type:g,users:b});d.dispatchEvent(g)},Da=function(g){for(var b=!1,a=0;a<d.cCapprovedHands.length;a++)if(d.cCapprovedHands[a].clientId==g){b=d.cCapprovedHands[a];d.cCapprovedHands.splice(a,1);break}return b},yb=function(g){for(var b=!1,a=0;a<d.cCrequest.length;a++)if(d.cCrequest[a].clientId==
g){d.cCrequest.splice(a,1);b=!0;break}return b},Pa=function(g,a){switch(g){case "floor-granted":a.clientId===d.clientId?d.floorGranted=!0:d.cCapprovedHands.push({clientId:a.clientId,moderatorId:a.moderatorId});break;case "floor-invited":a.clientId===d.clientId&&(d.floorInvited=!0);break;case "floor-denied":a.clientId===d.clientId&&(d.floorGranted=!1);break;case "floor-cancelled":a.clientId===d.clientId?d.floorInvited=!1:Da(a.clientId);break;case "floor-released":a.clientId===d.clientId?(d.localStreams.getAll(),
W.forEach(function(g,a){k["default"].info(g.getID()+"::::"+a);d.unpublish(g,function(a){1==a?(k["default"].info("stream has been un-published"),b.a.info("room-event",p.a.event_stream_unpublish_success,{error:{}})):(k["default"].info("error during stream un-publishing"),b.a.error("room-event",p.a.event_stream_unpublish_failed,{stream:g}));d.floorGranted=!1})})):Da(a.clientId)}"floor-released"==g&&d.dispatchEvent(Object(m.e)({type:"release-floor",users:a}));d.dispatchEvent(Object(m.e)({type:g,users:a}))},
wc=function(g){k["default"].info(" onFloorManagementEvents: "+JSON.stringify(g));switch(g.id){case "floorRequested":Oa("floor-requested",g);break;case "floorCancelled":Oa("floor-cancelled",g);break;case "floorFinished":Oa("floor-finished",g);break;case "floorRejected":d.floorInvited=!1;Oa("floor-rejected",g);break;case "floorAccepted":Oa("floor-accepted",g);break;case "inviteToFloor":Pa("floor-invited",g);break;case "floorGranted":Pa("floor-granted",g);break;case "floorDenied":Pa("floor-denied",g);
break;case "floorReleased":Pa("floor-released",g);break;case "cancelFloorInvite":Pa("floor-invite-cancelled",g)}},xc=function(g){k["default"].info(g);g=Object(m.e)({type:"hard-mute",users:g});d.dispatchEvent(g)},yc=function(g,b){Ea(!1,!0,!1,!0,b,!0,{type:"hard-unmute-room",message:g});d.mute=d.muteInfo.room.audio=!1;d.hardMuteInitiator=!1},zc=function(g,b){Ea(!0,!0,!1,!0,b,!0,{type:"hard-mute-room",message:g});d.mute=d.muteInfo.room.audio=!0;d.hardMuteInitiator=!1};d.enableKnock=function(g,b){void 0!==
g&&"boolean"===typeof g?d.socket.emitEvent("enableKnock",g,function(a){k["default"].info("enableKnock response"+JSON.stringify(a));0===a.result&&!1===g&&d.awaitedParticipants.clear();b&&b(a)}):b(!1)};d.openFloor=function(g,b){void 0!==g&&"boolean"===typeof g?d.socket.emitEvent("openFloor",g,function(a){k["default"].info("openFloor response"+JSON.stringify(a));0===a.result&&(d.floorOpen=g);b&&b(a)}):b(!1)};var Ac=function(g){g=Object(m.e)({type:"room-awaited",message:"waiting for moderator approval"});
d.dispatchEvent(g)},Bc=function(g){var b={clientId:g.clientId,name:g.name};g.data&&(b.data=g.data);d.awaitedParticipants.set(g.clientId,b);g=Object(m.e)({type:"user-awaited",message:{user:b}});d.dispatchEvent(g)};d.approveAwaitedUser=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?d.socket.emitEvent("user-allowed",g,function(a,c){null===a?k["default"].error("Error on knock approve request",c):(d.awaitedParticipants.delete(g),b(a,c))}):k["default"].error("approveAwaitedUser() invalid param - callback")};
d.denyAwaitedUser=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?d.socket.emitEvent("user-denied",g,function(a,c){null===a?k["default"].error("Error on knock deny request",c):(d.awaitedParticipants.delete(g),b(a,c))}):k["default"].error("denyAwaitedUser() invalid param - callback")};var Ta=function(g){g&&fa&&(d.dataStream&&(d.dataStream.close(),d.dataStream.pc&&(d.dataStream.pc.close(),delete d.dataStream.pc),delete d.dataStream),d.dataStream=Object(a.a)(d.Connection,{streamID:g.id,
data:!0}),d.dataStream.state="initing",Na(!0,d.dataStream.getID(),!0),Tb(d.dataStream,{streamId:g.id,singlePC:"subs"}),k["default"].info("initDataChannelStream() success streamId: "+g.id))},zb=function(g,b){var c=[],f=b?parseInt(b):1;ta.clear();P.clear();b=Object.keys(g);k["default"].info(" initSubscriberStreams() num strms: "+b.length+" activate: "+f);for(f=0;f<b.length;f+=1){var e=g[b[f]],h=Object(a.a)(d.Connection,{streamID:e.id,local:!1,audio:e.audio,video:e.video,data:e.data,screen:e.screen,
canvas:!("undefined"===typeof e.canvas||!1===e.canvas),attributes:e.attributes,speaker:d.speakerInfo});c.push(h);P.add(e.id,h)}k["default"].info(" initSubscriberStreams() ids remoteStreams: "+JSON.stringify(P.keys())+" remotePendingStreams: "+JSON.stringify(ta.keys()));return c},Cc=function(g){k["default"].info("onRoomConnected() - reconnection: "+d.reconnectionState);var c=[],f=g.streams||[],e=g.id,h=g.userList,q=g.room;d.me=g.user||{};d.roomSettings=g.room.settings||{};d.mute=d.muteInfo.room.audio=
g.room.mute;d.reconnectionState||(d.muteInfo.stream.hard.audio=d.muteInfo.room.audio);d.mediaRecord=g.mediaRecord;d.subscription=g.subscription;d.mode=g.room.settings.mode;g.room.settings.media_type&&"audio_only"==g.room.settings.media_type?(d.mediaType="audio_only",d.audioOnlyModeEnabled=!0):d.mediaType="audio_video";console.log("media type is : "+d.mediaType);x.a.csp_enabled||(document.head.append(jb),document.head.append(kb));void 0!=d.subscriberPC&&delete d.subscriberPC;"lecture"===d.mode&&"moderator"===
g.user.role&&(0<g.raisedHands.length&&g.raisedHands.forEach(function(g){d.cCrequest.push(g)}),0<g.floorInvites.length&&g.floorInvites.forEach(function(g){d.cCrequest.push(g)}),0<g.approvedHands.length&&g.approvedHands.forEach(function(g){d.cCapprovedHands.push(g)}));d.userRoleChangeRequests=g.userRoleChangeRequests&&0<g.userRoleChangeRequests.length?g.userRoleChangeRequests.slice():[];d.activeTalker=q.settings.active_talker;for(var p in g.awaitedParticipants)d.awaitedParticipants.set(g.awaitedParticipants[p].clientId,
{clientId:g.awaitedParticipants[p].clientId,name:g.awaitedParticipants[p].name});d.iceServers=g.iceServers;d.state=2;d.mediaConfiguration=g.mediaConfiguration;g.nonTalkerMediaParams&&(d.nonTalkerMediaParams=g.nonTalkerMediaParams);d.videoMutedUsers=g.videoMutedUsers;t.defaultVideoBW=g.defaultVideoBW;t.maxVideoBW=g.maxVideoBW;d.clientId=g.clientId;d.confId=g.room.conf_num;d.maxVideoLayers=g.maxVideoLayers||0;d.maxCanvasRefreshRate=g.maxCanvasRefreshRate||0;d.share=g.room.share;d.locked=g.room.locked||
!1;d.waitRoom=g.room.waitRoom||!1;d.knockEnabled=g.room.knockEnabled||!1;d.userAudioTalkerCount=g.numAudioTalkers||0;d.userVideoTalkerCount=g.numVideoTalkers||0;t.minVideoBW=g.minVideoBW;t.maxVideoFps=g.maxVideoFps;d.liveRoomTranscription=g.transcription;d.privacyModes=g.privacyModes;d.remoteUserNotifications=void 0!=g.remoteUserNotifications?g.remoteUserNotifications:!0;d.mediaActivationDelaySecs=g.mediaActivationDelaySecs||0;g.room.sharePermissions&&(d.sharePermissions=g.room.sharePermissions);
!0===g.transcription&&(d.transcriptionLanguage=g.transcriptionLanguage);d.internetDetectionUrl=void 0!=g.internetDetectionUrl?g.internetDetectionUrl:x.a.internetDetectionUrl;d.floorOpen=void 0!==g.room.openFloor?g.room.openFloor:!0;x.a.setVideoBwQualityMapper(g.videoBitrateQualityMap);g.uploadedFileInfos&&(d.availableFiles=JSON.parse(JSON.stringify(g.uploadedFileInfos)),K=g.uploadedFileInfos);b.a.setClientId(g.clientId);g.utilToken&&b.a.setEventLoggerToken(g.utilToken);if(void 0!==g.room.fileShareService){p=
{};p=g.room.fileShareService;var w={};w.call_num=g.clientId;w.room_id=g.id;w.service_id=g.room.service_id;w.conf_num=g.room.conf_num;w.userName=g.user.name||"";T=g.room.fileShareService.maxSize;p.callInfo=w;Object(J.f)(p)}else k["default"].info(" server does not support file sharing ");void 0!=g.isStreamingClient&&(!0===g.isStreamingClient?(k["default"].setLogCache(!1),k["default"].setLogLevel(k["default"].DEBUG),k["default"].info("onRoomConnected() streaming client, log level to debug & disable local store"),
d.isStreamingClient=!0):(k["default"].debug("NOT A S T Client"),d.isStreamingClient=!1));void 0!==g.room&&g.room.isAnalyticsStarted&&(d.isAnalyticsStarted=g.room.isAnalyticsStarted);void 0!=g.room.hls&&(d.hls=g.room.hls);d.audienceCount=g.audienceCount?g.audienceCount:0;g.room.customRoomData&&(d.customRoomData=g.room.customRoomData);g.room.customSessionData&&(d.customSessionData=g.room.customSessionData);void 0==t.speakerInfo&&Ab(d.speakerInfo.id,function(g){g?(d.speakerInfo.deviceId=g.deviceId,d.speakerInfo.groupId=
g.groupId,d.speakerInfo.id=g.deviceId,t.speakerInfo={deviceId:g.deviceId,groupId:g.groupId}):d.speakerInfo.id=void 0});w=g.initialNumATs?parseInt(g.initialNumATs):1;d.reconnectionState&&vc();ta.clear();P.clear();p=Object.keys(f);k["default"].info(" onRoomConnected() num subs streams: "+p.length+" activate: "+w);for(var v=0;v<p.length;v+=1){var l=f[p[v]];w=Object(a.a)(d.Connection,{streamID:l.id,local:!1,audio:l.audio,video:l.video,data:l.data,screen:l.screen,canvas:!("undefined"===typeof l.canvas||
!1===l.canvas),attributes:l.attributes,speaker:d.speakerInfo});c.push(w);P.add(l.id,w)}k["default"].info(" onRoomConnected() ids remoteStreams: "+JSON.stringify(P.keys())+" remotePendingStreams: "+JSON.stringify(ta.keys()));d.roomID=e;d.confID=q.conf_num;Ta(g.dataChannelStream);k["default"].info("Connected to room "+d.roomID);for(var z in h)d.userList.set(h[z].clientId,h[z]);d.getMaxTalkers(function(g){d.talkerCount=g.maxTalkers});f={conf_num:q.conf_num,name:q.name,owner_ref:q.owner_ref,mode:q.settings.mode,
moderators:q.settings.moderators,participants:q.settings.participants,auto_recording:q.settings.auto_recording,canvas:q.settings.canvas,description:q.settings.description,created:q.created,mute:q.mute,quality:q.settings.quality,screen_share:q.share,locked:q.locked,wait_room:q.wait_room,duration:q.remainingDuration,analyzer:q.analyzer,screen_share_override:q.settings.screen_share_override,privacy_modes:q.privacyModes,remote_user_notifications:d.remoteUserNotifications,media_type:d.mediaType};d.sharePermissions&&
(f.share_permissions=d.sharePermissions);d.screenResolutionRange=null!=g.room.screenResolutionRange?g.room.screenResolutionRange:x.a.screen_resolution_range[f.quality];g.debugLevel&&(Ha=g.debugLevel);4==Ha&&d.postClientLogs();d.roomMeta=f;k["default"].debug("room-connected event - room Info : "+JSON.stringify(f));c={streams:c,users:h,room:f,me:d.me,mediaRecord:d.mediaRecord};!d.reconnectionState||d.isFirstConnect?(c.type="room-connected",d.dispatchEvent(Object(m.e)(c))):(fa&&c.dataStream&&(c.dataStreamInfo=
{id:c.dataStream.getID(),data:!0}),Bb(c,"reconnect"),k["default"].info("send network reconnected event"),d.dispatchEvent(Object(m.e)({type:"network-reconnected",error:r.a.error_1164.result,message:r.a.error_1164.error})));d.isFirstConnect=!1;void 0!=g.room.shareOn&&(g.room.shareOn!=d.shareStatus?(k["default"].info("onRoomConnected() share state mismatch srvr: "+g.room.shareOn+" clnt: "+d.shareStatus),d.shareStatus&&d.shareEventInfo&&(Cb(d.shareEventInfo),d.shareEventInfo=void 0),d.shareStatus=g.room.shareOn?
!1:!0):k["default"].info("onRoomConnected() shareOn"+g.room.shareOn));k["default"].info("onRoomConnected() that.externalIp: "+d.externalIp);d.reconnectClientName=g.user.name;d.createEventLog("clientConnSuccess",{clientId:g.clientId,clientName:g.user.name,hostType:x.a.browser_info.name,hostVersion:x.a.browser_info.version,externalIp:d.externalIp})},Xa=function(g,a,c,f,e,h,q){a=void 0===a?!0:a;c=void 0===c?!0:c;f=void 0===f?!0:f;e=void 0===e?!1:e;h=void 0===h?!1:h;q=void 0===q?!1:q;k["default"].info("stopWebRtcSessions() reason: "+
g);if(h||e)d.sharePermissions.screen.approved=[],d.sharePermissions.screen.pending=[],d.sharePermissions.canvas.approved=[],d.sharePermissions.canvas.pending=[],d.sharePermissions.screen.state="idle",d.sharePermissions.canvas.state="idle",d.userRoleChangeRequests=[],h&&(d.cCrequest=[],d.cCapprovedHands=[]);q&&d.userList.clear();c&&(d.activeTalkerList=new Map,d.remoteStreams.forEach(function(g,c){d.unsubscribe(g,function(c){c.result==r.a.error_000.result?(k["default"].info("stream has been un-subscribed"),
a&&d.dispatchEvent(Object(m.f)({type:"stream-removed",stream:g}))):(k["default"].info("error during stream unsubscribing res: "+JSON.stringify(c)),b.a.error("room-event",p.a.event_stream_unsubscribe_failed,{stream:g}))})}));f&&W.forEach(function(g,c){g.ifCanvas()&&d.stopCanvas(function(){});d.unpublish(g,function(c){1==c?(k["default"].info("stream has been un-published"),a&&d.dispatchEvent(Object(m.f)({type:"stream-removed",stream:g}))):(k["default"].info("error during stream un-publishing"),b.a.error("room-event",
p.a.event_stream_unpublish_failed,{stream:g}))})})},Bb=function(g,a){k["default"].info("reinitWebRtcSessions() reason: "+a);Ta(g.dataStreamInfo);g.subsStreamInfo&&(g.streams=zb(g.subsStreamInfo.streams,g.subsStreamInfo.initialNumATs));var c=g.streams;for(a={$jscomp$loop$prop$i$251:0};a.$jscomp$loop$prop$i$251<c.length;a={$jscomp$loop$prop$i$251:a.$jscomp$loop$prop$i$251},a.$jscomp$loop$prop$i$251++){var f=d.remoteStreamsInfo.get(c[a.$jscomp$loop$prop$i$251].getID());d.subscribe(c[a.$jscomp$loop$prop$i$251],
f?f.userReqOpt:void 0,function(g){return function(a){!0===a||"object"===typeof a&&0==a.result?k["default"].info("reinitWebRtcSessions() subscriber callback success id: "+c[g.$jscomp$loop$prop$i$251].getID()):(k["default"].info("reinitWebRtcSessions() subscriber callback failed, could not reconnect",a),d.reconPubSubFailed(a),d.dispatchEvent(Object(m.e)({type:"room-error",message:a})),b.a.error("api-event",p.a.event_reconnect_subscribe_failed,{error:"reinitWebRtcSessions() subscriber callback failed, couldnt reconnect",
message:a}))}}(a))}d.manageLiveTranscription();var e=function(){d.localStreamsBeforeReconnect.forEach(function(a,c){void 0===a.canvas&&void 0===a.screen&&(k["default"].info(" reinitWebRtcSessions() publish, audio video data stream"),d.localStreamsBeforeReconnect.remove(c),d.publish(a,a.userRequestOptions,function(c){0===c.result?(k["default"].info("reinitWebRtcSessions() stream published successfully"),d.manageStatsSubscription(a),d.manageRecordingStatus(),g.mediaRecord&&d.dispatchEvent(Object(m.e)({type:"room-record-on",
message:{}})),d.muteInfo.room.audio&&d.dispatchEvent({type:"room-muted",message:{}}),!0===a.selfMuteAudio&&a.sendEvent("user-audio-muted"),1==a.selfMuteVideo&&a.sendEvent("user-video-muted"),d.localStreamsBeforeReconnect.forEach(function(g,a){var c=function(c,f){d.localStreamsBeforeReconnect.remove(a);k["default"].info(" reinitWebRtcSessions() publish, "+c+" stream");d.socket.emitEvent("auxilaryPublishRequests",{req:"start",pubType:c,override:!0},function(a){a.result==r.a.error_000.result?d.publish(g,
f,function(g){if(0!==g.result){var a="reinitWebRtcSessions() publish failed "+c+"  stream failed";k["default"].info(a+" resp: "+JSON.stringify(g));d.reconPubSubFailed(g);d.dispatchEvent(Object(m.e)({type:"room-error",message:g}));b.a.error("api-event",p.a.event_reconnect_publish_failed,{error:a,message:g})}}):k["default"].warning("reinitWebRtcSessions() auxilaryPublishRequests() failed "+c+" resp: "+JSON.stringify(a))})};!0===g.canvas?c("canvas",{canvas:!0}):!0===g.screen?c("screen",{screen:!0}):
k["default"].error(" unknown stream type ????????????")})):(k["default"].info(" reinitWebRtcSessions() publishing failed, response for publish",c),d.reconPubSubFailed(c),d.dispatchEvent(Object(m.e)({type:"room-error",message:c})),b.a.error("api-event",p.a.event_reconnect_publish_failed,{error:"reinitWebRtcSessions() publishing failed, response for publish",message:c}))}))})};k["default"].info(" reinitWebRtcSessions() pub waitRoom: "+d.waitRoom+" role: "+d.me.role+" mode: "+d.mode);!1!==d.waitRoom||
"viewer"==d.me.role||"audience"==d.me.role||"lecture"===d.mode&&"moderator"!==d.me.role?"viewer"!=d.me.role&&"audience"!=d.me.role&&d.waitRoom?(k["default"].info("reinitWebRtcSessions() WaitRoom on no publish"),d.addEventListener("wait-room-disabled",function(g){"lecture"!==d.mode&&e()})):"viewer"!=d.me.role&&"audience"!=d.me.role||"lecture"===d.mode&&"moderator"!==d.me.role?("viewer"!=d.me.role&&"audience"!=d.me.role?k["default"].info(" reinitWebRtcSessions() No publish - participant is viewer/audience"):
k["default"].info("reinitWebRtcSessions()  No publish - participant in lecture mode"),d.floorGranted&&(d.floorGranted=!1,d.dispatchEvent(Object(m.e)({type:"release-floor",users:{clientId:d.clientId}})))):k["default"].info("no audio&video"):e();k["default"].debug(" reinitWebRtcSessions() setting reconnection state as false ");d.reconnectionState=!1;d.manageNumTalker();k["default"].info("send network reconnected event");a=Object(m.e)({type:"network-reconnected",error:r.a.error_1164.result,message:r.a.error_1164.error});
d.dispatchEvent(a)},rc=function(g,a){var c={streams:[]};d.localStreams.forEach(function(g,b){"connected"!=g.state&&(c.streams.push({id:b,type:"pub",state:g.state}),k["default"].error(" pub stream not connected id: "+b))});d.remoteStreams.forEach(function(g,b){"connected"!=g.state&&(c.streams.push({id:b,type:"sub",state:g.state}),k["default"].error(" sub stream not connected id: "+b))});d.dataStream&&"connected"!=d.dataStream.state&&(c.streams.push({id:d.dataStream.getID(),type:"data conn",state:d.dataStream.state}),
k["default"].error(" data stream not connected id: "+d.dataStream.getID()));c.streams.length?(c.client={mode:d.isStreamingClient?"streamer":"regular",role:d.me.role,device_type:x.a.browser_info.device_type,sdk_version:x.a.product.version,browser:{version:x.a.browser_info.version,name:x.a.browser_info.name}},k["default"].info("mediaConnectionTimeout () stream disc info: "+JSON.stringify(c)),b.a.error("room-event",p.a.event_media_connection_failed,c),va(!1,!0,"mediaConnectionFailed")):(d.dispatchEvent(Object(m.e)({type:"media-state",
message:{active:!0}})),k["default"].info("mediaConnectionTimeout ():  All streams in active state - Ignoring the event"))},Dc=function(g){k["default"].info(" onRoomDisconnected() : calling that.disconnect  with msg : "+JSON.stringify(g));void 0==g&&(g=r.a.CC002);d.disconnect(g)},Ea=function(g,a,c,f,e,h,q){var I=function(g,b,a,c){k["default"].info("hardMuteMediaDevices callback resp : "+JSON.stringify(b));b.result===r.a.error_000.result&&c&&(a?d.dispatchEvent(Object(m.e)(c)):g.dispatchEvent(Object(m.f)(c)))};
k["default"].info("hardMuteMediaDevices muteOn: "+g+" audio: "+a+" video: "+c+" sendsendServerEvent : "+f);d.localStreams.forEach(function(b,k){a&&b.ifAudio()?g?(d.muteInfo.stream.hard.audio=!0,b.muteAudio(function(g){I(b,g,h,q);e(g)},f,0,!1)):(d.muteInfo.stream.hard.audio=!1,b.unmuteAudio(function(g){I(b,g,h,q);e(g)},f,0,!1)):c&&b.ifVideo()&&(g?(d.muteInfo.stream.hard.video=!0,b.muteVideo(function(g){I(b,g,h,q);e(g)},f,0,"hard")):(d.muteInfo.stream.hard.video=!1,b.unmuteVideo(function(g){I(b,g,h,
q);e(g)},f,0,"hard")))});e&&(b.a.error("room-event",p.a.event_general_failed,{message:r.a.error_1159.error}),e(r.a.error_1159))},ac=function(g){var b={local:!1,hard:!1,eventInfo:void 0},a={local:!1,hard:!1,audioOnly:!1,eventInfo:void 0};d.muteInfo.stream.hard.audio&&!d.hardMuteInitiator&&(b.hard|=1);k["default"].info("streamId: "+g.getID()+" local cam Publish ready state");void 0!=d.videoMuteOnJoin&&(a.local|=d.videoMuteOnJoin.local,a.hard|=d.videoMuteOnJoin.hard,a.audioOnly|=d.videoMuteOnJoin.audioOnly,
g.audioOnlyModeEnabled&&(g.audioOnlyModeEnabled=!1),delete d.videoMuteOnJoin);void 0!=d.audioMuteOnJoin&&(b.local|=d.audioMuteOnJoin.local,b.hard|=d.audioMuteOnJoin.hard,delete d.audioMuteOnJoin);b.local|=g.config.audioMuted;a.local|=g.config.videoMuted;0==g.video&&(a={local:!1,hard:!1,audioOnly:!1});0==g.audio&&(b={local:!1,hard:!1});var c=function(g,d){d.result===r.a.error_000.result?k["default"].info("mediaDeviceMuteOnJoin() "+g+" audio: "+JSON.stringify(b)+" video: "+JSON.stringify(a)+" success"):
k["default"].error("mediaDeviceMuteOnJoin() "+g+" audio: "+JSON.stringify(b)+" video: "+JSON.stringify(a)+" failed. result: "+JSON.stringify(d))};a.local?g.muteVideo(function(g){c("videoSelfMuteCallback",g)},!0,1E3,"self"):g.selfMuteVideo&&g.unmuteVideo(function(g){c("videoSelfUnmuteCallback",g)},!0,1E3,"self");a.hard?g.muteVideo(function(g){c("videoHardMuteCallback",g)},!0,1E3,"hard"):g.hardVideoMuted&&g.unmuteVideo(function(g){c("videoHardUnmuteCallback",g)},!0,1E3,"hard");a.audioOnly?g.muteVideo(function(g){c("videoMuteAudioOnlyCallback",
g)},!0,1E3,"audioOnly"):g.audioOnlyModeEnabled&&g.muteVideo(function(g){c("videoMuteAudioOnlyCallback",g)},!0,1E3,"audioOnly");b.local?g.muteAudio(function(g){c("AudioSelfMuteCallback",g)},!0,1E3,!0):g.selfMuteAudio&&g.unmuteAudio(function(g){c("AudioSelfUnmuteCallback",g)},!0,1E3,!0);b.hard?g.muteAudio(function(g){c("AudioHardMuteCallback",g)},!0,1E3,!1):g.hardAudioMuted&&g.unmuteAudio(function(g){c("AudioHardUnmuteCallback",g)},!0,1E3,!1);g.config.audioMuted&&(g.config.audioMuted=!1);g.config.videoMuted&&
(g.config.videoMuted=!1)},Ec=function(g,b){d.hardMuteInitiator=!1;Ea(!0,!0,!1,!0,b,!0,{type:"hardmute-user-audio",message:g})},Fc=function(g,b){d.hardMuteInitiator=!1;Ea(!1,!0,!1,!0,b,!0,{type:"hardunmute-user-audio",message:g})},Gc=function(g,b){Ea(!0,!1,!0,!0,b,!0,{type:"hardmute-user-video",message:g})},Hc=function(g,b){Ea(!1,!1,!0,!0,b,!0,{type:"hardunmute-user-video",message:g})},Ic=function(g){switch(g.evnt){case "share-permission-mode-changed":d.sharePermissions[g.params.pubType].mode=g.params.mode;
!d.isModerator()||"all"!=g.params.mode&&"moderators"!=g.params.mode||(d.sharePermissions[g.params.pubType].approved=[],d.sharePermissions[g.params.pubType].pending=[]);break;case "share-permission-requested":d.isModerator()?-1==d.sharePermissions[g.params.pubType].pending.indexOf(g.params.clientId)&&d.sharePermissions[g.params.pubType].pending.push(g.params.clientId):d.sharePermissions[g.params.pubType].state=g.evnt;break;case "share-permission-granted":if(d.isModerator()){-1==d.sharePermissions[g.params.pubType].approved.indexOf(g.params.clientId)&&
d.sharePermissions[g.params.pubType].approved.push(g.params.clientId);var b=d.sharePermissions[g.params.pubType].pending.indexOf(g.params.clientId);-1!=b&&d.sharePermissions[g.params.pubType].pending.splice(b,1)}else d.sharePermissions[g.params.pubType].state=g.evnt;break;case "share-permission-denied":case "share-permission-released":d.isModerator()?(b=d.sharePermissions[g.params.pubType].approved.indexOf(g.params.clientId),-1!=b&&d.sharePermissions[g.params.pubType].approved.splice(b,1),b=d.sharePermissions[g.params.pubType].pending.indexOf(g.params.clientId),
-1!=b&&d.sharePermissions[g.params.pubType].pending.splice(b,1)):d.sharePermissions[g.params.pubType].state="idle";break;case "share-permission-cancelled":d.isModerator()&&(b=d.sharePermissions[g.params.pubType].pending.indexOf(g.params.clientId),-1!=b&&d.sharePermissions[g.params.pubType].pending.splice(b,1))}d.dispatchEvent(Object(m.e)({type:g.evnt,message:g.params}))},Db=function(g){d.shareDisplayWaitTimeoutSecs=0;if(d.allStreamsActive){k["default"].info("onShareStarted() event : "+JSON.stringify(g));
za(!0,d.canvasStatus);var b=Object(m.e)({type:"share-started",message:{clientId:g.clientId,name:g.name,streamId:g.streamId,layout:g.layout}});d.shareStatus=!0;d.clientId==g.clientId&&(d.isSharingClient=!0);k["default"].debug(" share-started event : "+JSON.stringify(b));d.dispatchEvent(b)}else k["default"].info("onShareStarted() , all streams not active , storing event: "+JSON.stringify(g)),d.shareStatus=!0,d.shareEventInfo=JSON.parse(JSON.stringify(g))},Jc=function(g){0===g.result&&g.mediaConfiguration!==
d.mediaConfiguration&&(d.mediaConfiguration=g.mediaConfiguration,d.localStreams.forEach(function(b,a){b.resetMediaConfiguration(g.mediaConfiguration)}))},Kc=function(g){k["default"].info("Stop sharing requested by client: ",g.clientId);d.forcedStopSharing=!0;console.log("that.forcedStopSharing: ",d.forcedStopSharing);d.isSharingClient&&(k["default"].info("stopScreenShare for current client"),d.stopScreenShare(function(g){}));1==d.isCanvasSharingClient&&(k["default"].info("stopCanvasShare for current client"),
d.stopAnnotation(function(g){}))},Lc=function(g){k["default"].info("Update Layout requested by client: ",g.clientId);d.clientId!=g.clientId&&(g=Object(m.e)({type:"layout-updated",message:g}),d.dispatchEvent(g))},Cb=function(g){za(!1,d.canvasStatus);var b={streamType:"share",streamId:g.streamId,negotiatedCodecs:{video:{codec:"VP8"},audio:{codec:"OPUS"}},externalIp:d.externalIp};g={clientId:g.clientId,name:g.name,streamId:g.streamId};console.log("that.forcedStopSharing: ",d.forcedStopSharing);d.forcedStopSharing&&
(g.stoppedBy="moderator");d.forcedStopSharing=!1;d.shareStatus=!1;d.shareEventInfo&&(d.shareEventInfo=void 0);console.log(" share-stopped eventMsg : "+JSON.stringify(g));d.dispatchEvent({type:"share-stopped",message:g});k["default"].info("additionalOptions: ",b);d.createEventLog("clientStreamShareStopped",b);d.isSharingClient=!1},Mc=function(g){console.log("onScreenShareOverride");d.isSharingClient&&(d.stopScreenShare(function(g){console.log("stopScreenShare response: ",g)}),g=Object(m.e)({type:"stop-old-screen-share",
message:{clientId:d.clientId}}),d.dispatchEvent(g))},Nc=function(g){var b=d.userList.get(g.clientId);b&&(b.audioMuted=g.user.audioMuted,d.userList.set(g.clientId,g.user));g.clientId!=d.clientId&&d.dispatchEvent(Object(m.g)({type:"user-audio-muted",clientId:g.clientId}));g.clientId==d.clientId?d.localStreams.forEach(function(b){!b.ifCanvas()&&!b.ifScreen()&&b.local&&b.isAudioMuted()&&d.dispatchEvent(Object(m.g)({type:"user-audio-muted",clientId:g.clientId}))}):d.dispatchEvent(Object(m.g)({type:"user-audio-muted",
clientId:g.clientId}))},Oc=function(g){d.userList.get(g.clientId).audioMuted=g.user.audioMuted;d.userList.set(g.clientId,g.user);g.clientId==d.clientId?d.localStreams.forEach(function(b){b.ifCanvas()||b.ifScreen()||!b.local||b.isAudioMuted()||d.dispatchEvent(Object(m.g)({type:"user-audio-unmuted",clientId:g.clientId}))}):d.dispatchEvent(Object(m.g)({type:"user-audio-unmuted",clientId:g.clientId}))},Pc=function(g){var b=d.userList.get(g.clientId);b?(b.videoMuted=g.user.videoMuted,d.userList.set(g.clientId,
g.user),g=Object(m.g)({type:"user-video-muted",clientId:g.clientId}),d.dispatchEvent(g)):k["default"].error("onUserVideoMuted() client not found cId: "+g.clientId)},Qc=function(g){d.userList.get(g.clientId).videoMuted=g.user.videoMuted;d.userList.set(g.clientId,g.user);g=Object(m.g)({type:"user-video-unmuted",clientId:g.clientId});d.dispatchEvent(g)},za=function(g,b){d.localStreams.forEach(function(a){if(!a.ifCanvas()&&!a.ifScreen()&&a.video&&a.local&&1<d.maxVideoLayers){var c=g||b?"ND":D.roomMeta.settings.quality;
c={0:1E3*x.a.video_bandwidth_range[c][2].max,1:1E3*x.a.video_bandwidth_range[c][1].max,2:1E3*x.a.video_bandwidth_range[c][0].max};k["default"].info("updating main video simulcast bps: "+JSON.stringify(c));a.updateSimulcastLayersBitrate(c)}})};d.publish=function(g,a,c){a=void 0===a?{}:a;c=void 0===c?function(){}:c;if("function"===typeof c){var f=a;if(!a.video||a.canvas||a.share||"audio_video"==d.mediaType&&(!d.subscription||d.subscription.audio_video)){if(f.video&&!f.canvas&&!f.share&&null!=g.videoStream){var e=
void 0==g.videoSize?!0:!1,h=Eb(g,!0);if(h.result!==r.a.error_000.result){k["default"].error(" Failed : room.publish video size invalid video size req: "+g.videoSize+" default : "+JSON.stringify(ca));b.a.error("room-event",p.a.event_general_failed,{message:"room.publish video size invalid video size req: "+g.videoSize+" default : "+JSON.stringify(ca)});c(h);return}!e||void 0===g.videoSize||"mobile"===x.a.browser_info.device_type||g.videoSize[0]==x.a.video_resolution_range.Default.min.wdith&&g.videoSize[1]==
x.a.video_resolution_range.Default.min.height&&g.videoSize[2]==x.a.video_resolution_range.Default.min.wdith&&g.videoSize[3]==x.a.video_resolution_range.Default.max.height||g.setVideoQualityParams(g.videoSize[0],g.videoSize[1],g.videoSize[2],g.videoSize[3]);g.maxVideoLayers=d.maxVideoLayers}if(a&&void 0!=a)try{g.userRequestOptions=JSON.parse(JSON.stringify(a))}catch(Cd){k["default"].info("Not a valid json")}!f.audio||f.canvas||f.share||null!=g.audioStream||(g.audio=!1);ya=g;!1===d.reconnectionState?
ya.ifScreen()?f.forceTurn=Ba:ya.ifCanvas()?(f.forceTurn=Ja,Qa=f.canvasType):(Ja=Ba=Ia=f.forceTurn?f.forceTurn:!1,(f.maxVideoBW||f.minVideoBW||f.maxVideoFps)&&ya.setVideoParamsRange(f.maxVideoBW,f.minVideoBW,f.maxVideoFps,void 0,!1),(t.maxVideoBW||t.minVideoBW||t.maxVideoFps)&&ya.setVideoParamsRange(t.maxVideoBW,t.minVideoBW,t.maxVideoFps,void 0,!0),k["default"].info(" options.maxVideoBW: "+f.maxVideoBW+" spec.maxVideoBW: "+t.maxVideoBW),void 0==f.maxVideoBW&&(f.maxVideoBW=t.maxVideoBW,f.minVideoBW=
t.minVideoBW)):ya.ifScreen()?f.forceTurn=Ba:ya.ifCanvas()?(f.forceTurn=Ja,f.canvasType=Qa):f.forceTurn=Ia;f.maxVideoBW=f.maxVideoBW||t.defaultVideoBW;f.maxVideoBW>t.maxVideoBW&&(f.maxVideoBW=t.maxVideoBW);void 0===f.minVideoBW&&(f.minVideoBW=0);f.minVideoBW>t.defaultVideoBW&&(f.minVideoBW=t.defaultVideoBW);f.forceTurn&&(g.forceTurn=f.forceTurn);f.simulcast=f.simulcast||!1;f.muteStream={audio:g.ifCanvas()?!0:g.isAudioMuted(),video:g.isVideoMuted()};d.muteAudioOnJoin=!!f.audioMuted;d.muteVideoOnJoin=
!!f.videoMuted;k["default"].debug("Publish forceTurn: ( "+f.forceTurn+","+Ia+" ) reconnect state: "+d.reconnectionState);if(g&&g.local&&!g.failed)if(d.waitRoom)k["default"].error("Publish() : failed Moderator not present and  waiting for moderator "),b.a.error("room-event",p.a.event_general_failed,{message:r.a.error_1130.error}),c(r.a.error_1130);else if(g.ifMedia())if(g.ifExternal())pc(g,f,c);else if(void 0!=d.videoMuteOnJoin&&delete d.videoMuteOnJoin,void 0!=d.audioMuteOnJoin&&delete d.audioMuteOnJoin,
!d.reconnectionState&&!g.reconnect||g.ifCanvas()||g.ifScreen()){if(!g.ifCanvas()&&!g.ifScreen()){if(!g.video||f.videoMuted||f.muteStream&&f.muteStream.video)d.videoMuteOnJoin={local:!0,hard:!1,audioOnly:!1};if(!g.audio||f.audioMuted||f.muteStream&&f.muteStream.audio)d.audioMuteOnJoin={local:!0,hard:!1}}k["default"].info("Publish stream options : ",f);fb(g,f,c)}else if(d.audioMuteOnJoin={local:g.selfMuteAudio,hard:g.hardAudioMuted},g.selfMuteVideo||g.hardVideoMuted||g.audioOnlyModeEnabled){var m=[];
g.selfMuteVideo&&m.push("self");g.hardVideoMuted&&m.push("hard");g.audioOnlyModeEnabled&&m.push("audioOnly");var q=function(b){if(0==b.result)for(b=0;b<m.length;b++)k["default"].info("publishVideoOnunmuteVideo() mute video reason: "+m[b]+" index: "+b),g.muteVideo(function(){},!1,0,m[b],!0);else k["default"].error("Publish stream unmute video failed :"+JSON.stringify(b));fb(g,f,c)};d.videoMuteOnJoin={local:g.selfMuteVideo,hard:g.hardVideoMuted,audioOnly:g.audioOnlyModeEnabled};a=[];for(e={$jscomp$loop$prop$indx$253:0};e.$jscomp$loop$prop$indx$253<
m.length;e={$jscomp$loop$prop$indx$253:e.$jscomp$loop$prop$indx$253},e.$jscomp$loop$prop$indx$253++)k["default"].info("publish() temporary unmuting video reason: "+m[e.$jscomp$loop$prop$indx$253]+" index: "+e.$jscomp$loop$prop$indx$253),a.push(new Promise(function(b){return function(a,d){g.unmuteVideo(function(g){a(g)},!1,0,m[b.$jscomp$loop$prop$indx$253])}}(e)));var I={result:0};Promise.all(a).then(function(g){for(var b=0;b<g.length;b++)0!==g[b].result&&(I=g[b]);q(I)})}else{if(!g.video||g.isVideoMuted())d.videoMuteOnJoin=
{local:!0,hard:!1,audioOnly:!1};if(!g.audio||g.isAudioMuted())d.audioMuteOnJoin.local=!0;fb(g,f,c)}else g.ifData()&&qc(g,f,c);else k["default"].error("Trying to publish invalid stream"),b.a.info("room-event",p.a.event_stream_publish_failed,{stream:g}),c(void 0,"Invalid Stream"),a={streamId:g.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===d.mediaConfiguration||"Default"===d.mediaConfiguration?"VP8":d.mediaConfiguration},audio:{codec:"OPUS"}},selectedCam:g.video.deviceId,
selectedMic:g.audio.deviceId,error:"Invalid stream",externalIp:d.externalIp},d.createEventLog("clientStreamPublishFailed",a)}else"audio_video"!=d.mediaType?k["default"].error("publish error: room media type not supported video : "+JSON.stringify(f.video)+" canvas: "+JSON.stringify(f.canvas)+" share: "+JSON.stringify(f.share)):k["default"].error("Licence error : feature not supported subscription - av: "+d.subscription.audio_video+" audio: "+d.subscription.audio_only+" canvas: "+d.subscription.audio_video+
" share: "+d.subscription.audio_video+" req audio: "+f.audio+" video: "+f.video+" share: "+f.share+" canvas: "+f.canvas),b.a.error("room-event",p.a.event_general_failed,{message:r.a.error_1170.error}),c({result:2110,msg:"License not found"})}else k["default"].error("publish() invalid param - callback")};var Rc=function(g){g=Object(m.e)({type:"room-record-on",message:{moderatorId:g.moderatorId}});d.dispatchEvent(g)},Sc=function(g){g=Object(m.e)({type:"room-record-off",message:{moderatorId:g.moderatorId}});
d.dispatchEvent(g)},Tc=function(g){g=Object(m.e)({type:"room-live-recording-on",message:{message:"live recording is running"}});d.dispatchEvent(g)},Uc=function(g){g=Object(m.e)({type:"room-live-recording-off",message:{message:""}});d.dispatchEvent(g)},Vc=function(g){g=Object(m.e)({type:"room-live-recording-failed",message:{error:g.error}});d.dispatchEvent(g)},Wc=function(g){g=Object(m.e)({type:"change-layout",message:{layout:g.layout}});d.dispatchEvent(g)},Xc=function(g){d.liveRoomTranscription=!0;
d.transcriptionLanguage=g.language;g=Object(m.e)({type:"room-transcription-on",message:{language:g.language}});d.dispatchEvent(g)},Yc=function(g){d.liveRoomTranscription=!1;!1===d.liveTranscription&&(d.transcriptionLanguage="");g=Object(m.e)({type:"room-transcription-off",message:{}});d.dispatchEvent(g)},Zc=function(g){d.liveTranscription=!0;d.transcriptionLanguage=g.language;g=Object(m.e)({type:"self-transcription-on",message:{language:g.language}});d.dispatchEvent(g)},$c=function(g){d.liveTranscription=
!1;!1===d.liveRoomTranscription&&(d.transcriptionLanguage="");g=Object(m.e)({type:"self-transcription-off",message:{}});d.dispatchEvent(g)},Gb=function(g){k["default"].info("processMediaActivationEvent () reason: "+g);d.mediaActivationDelaySecs=0;xa&&(clearTimeout(xa),xa=void 0);d.activeTalkersList2Process&&(Fb(d.activeTalkersList2Process),d.activeTalkersList2Process=void 0)},Fb=function(g){if(d.mediaActivationDelaySecs)k["default"].info("onNewActiveTalker() mediaActivationDelaySecs : "+d.mediaActivationDelaySecs),
void 0==xa&&(xa=setTimeout(Gb.bind(h),1E3*d.mediaActivationDelaySecs,"timeout")),d.activeTalkersList2Process=JSON.parse(JSON.stringify(g));else{"safari"===u.a.browserEngineCheck()&&!1===d.sendRecvBitrateStats&&Hb();if(d.nonTalkerMediaParams&&g.active!=X){if(g.active){if(void 0==H&&(H=t.maxVideoBW),void 0!=t.minVideoBW){var b={min:t.minVideoBW,max:H};var a=t.maxVideoFps}}else b={min:d.nonTalkerMediaParams.video.bw,max:d.nonTalkerMediaParams.video.bw},a=d.nonTalkerMediaParams.video.fps;void 0!=b&&(X=
g.active,d.localStreams.forEach(function(d,c){!d.ifVideo()||d.ifScreen()||d.ifCanvas()||(k["default"].debug("onActiveList (): setting video param for AT: "+g.active+" kbps: "+b.max+" fps:"+a),d.setVideoParamsRange(b.max,b.min,a,void 0,!0))}))}for(var c=new Map,f=0;f<g.activeList.length;f++)if(d.remoteStreams.getAll()[g.activeList[f].streamId]){var e=d.userList.get(g.activeList[f].clientId);e&&(g.activeList[f].user_ref=e.user_ref);"audio"===g.activeList[f].mediatype&&d.videoMutedUsers[g.activeList[f].clientId]?
(d.remoteStreams.getAll()[g.activeList[f].streamId].audioOnly=!0,k["default"].info("Recieved active talker list, videomuted: "+g.activeList[f].videomuted+" reason: "+g.activeList[f].reason),d.remoteStreams.getAll()[g.activeList[f].streamId].setVideoMutedMessage(g.activeList[f]),delete d.videoMutedUsers[g.activeList[f].clientId]):"audioOnly"===g.activeList[f].mediatype&&(d.remoteStreams.getAll()[g.activeList[f].streamId].audioOnly=!0);d.remoteStreams.getAll()[g.activeList[f].streamId].audioOnly&&"audiovideo"===
g.activeList[f].mediatype&&delete d.remoteStreams.getAll()[g.activeList[f].streamId].audioOnly;d.remoteStreams.getAll()[g.activeList[f].streamId].reloadPlayer(g.activeList[f],ra);c.set(g.activeList[f].streamId,g.activeList[f]);if((e=ea.get(g.activeList[f].streamId))&&e.mediatype!=g.activeList[f].mediatype){switch(g.activeList[f].mediatype){case "audiovideo":case "video":d.remoteStreams.getAll()[g.activeList[f].streamId].setVideoMutedMessage(g.activeList[f]);d.remoteStreams.getAll()[g.activeList[f].streamId].blankFrameSet&&
delete d.remoteStreams.getAll()[g.activeList[f].streamId].blankFrameSet;break;case "audio":case "audioOnly":d.remoteStreams.getAll()[g.activeList[f].streamId].setVideoMutedMessage(g.activeList[f]);d.remoteStreams.getAll()[g.activeList[f].streamId].blankFrameSet||(d.remoteStreams.getAll()[g.activeList[f].streamId].blankFrameSet=!0);break;default:k["default"].info("mediatype not handled entry:",JSON.stringify(g.activeList[f]))}ea.set(g.activeList[f].streamId,g.activeList[f])}else e||ea.set(g.activeList[f].streamId,
g.activeList[f])}else k["default"].error("onNewActiveTalker() remote stream undefined streamId: "+g.activeList[f].streamId);d.activeTalkerList=c;c=Object(m.e)({type:"active-talkers-updated",message:{activeList:g.activeList,active:g.active}});d.dispatchEvent(c);d.allStreamsActive||(d.allStreamsActive=!0,d.shareStatus&&d.shareEventInfo&&(Db(d.shareEventInfo),d.shareEventInfo=void 0),vb(p.a.event_client_connection_success),0==d.streamsHealthTimerId&&(Na(!1,0,!1),d.streamsHealthTimerId=setInterval(Qb,
1E4)))}};d.startRecord=function(g){g=void 0===g?function(){}:g;"function"===typeof g?d.startRecording(void 0,g):k["default"].error("startRecord() invalid param - callback")};d.stopRecord=function(g){g=void 0===g?function(){}:g;"function"===typeof g?d.stopRecording(void 0,g):k["default"].error("stopRecord() invalid param - callback")};d.startStreaming=function(g,a){a=void 0===a?function(){}:a;if("function"===typeof a&&"object"===typeof g&&g.hasOwnProperty("rtmpDetails")){k["default"].info("start streaming called");
var c=!0;if("moderator"!==d.me.role)c=!1,k["default"].info("user is trying to start streaming and he is not a moderator"),b.a.error("room-event",p.a.event_general_failed,{message:"startStreaming - "+r.a.error_7008.desc}),a(r.a.error_7008);else if(void 0===g.rtmpDetails)b.a.error("room-event",p.a.event_general_failed,{message:"startStreaming - "+r.a.error_7009.desc}),a(r.a.error_7009);else if(void 0!==g.rtmpDetails.rtmpUrl&&3<g.rtmpDetails.rtmpUrl.split(",").length)a(r.a.error_7101);else if(/(http|https|rtmp|rtmps):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(g.rtmpDetails.rtmpUrl)){var f=
{};0===d.state?(f=r.a.error_7103,k["default"].info(" room is disconnected"),a(f)):(a&&"function"===typeof a||(a=function(g){k["default"].info("SDK defined callback streaming response ",g)}),k["default"].info("start streaming called with callback "),c?y.sendMessage("startStreaming",g,function(g,b){null===g?(k["default"].error("Error on start streaming",b),void 0!==b.result?a(b):void 0!==b.status&&a({result:b.status.resultCode,error:"streaming error",desc:b.status.error.errorDesc,status:b.status})):
a({result:g.status.resultCode,error:"",desc:"",status:g.status},b)}):a(r.a.error_7000))}else k["default"].info(" invalid rtmp or page input url"),c=!1,b.a.error("room-event",p.a.event_general_failed,{message:"startStreaming - "+r.a.error_7102.desc}),a(r.a.error_7102)}else k["default"].error("startStreaming() invalid param - streamingConfig/callback")};d.stopStreaming=function(g,b){var a;void 0!=g&&"function"===typeof g?a=g:void 0!=b&&"function"===typeof b&&(a=b);"function"===typeof a?(k["default"].info("stop streaming called"),
"moderator"!==d.me.role?(k["default"].info("user is trying to stop streaming and he is not a moderator"),a(r.a.error_7044)):(g={options:{confNum:"12345",roomId:"9876"},rtmpDetails:{rtmpUrl:"rtmp://a.rtmp.youtube.com/live2/4rjb-hprf-7wf5-9923"},urlDetails:{url:"https://vc-manu.vcloudx.com:9074/room/?token=",layOut:{}}},b={},0===d.state?(b=r.a.error_7045,k["default"].info(" room is disconnected"),a(b)):(a&&"function"===typeof a||(a=function(g){k["default"].info("SDK defined callback streaming response ",
g)}),k["default"].info("stop called with callback "),y.sendMessage("stopStreaming",g,function(g,b){null===g?(k["default"].error("Error on stop streaming",b),void 0!==b.status&&a({result:b.status.resultCode,error:"streaming error",desc:b.status.error.errorDesc,status:b.status})):(k["default"].info("Stop streaming"),a({result:g.status.resultCode,error:"",desc:"",status:g.status},b))})))):k["default"].error("stopStreaming() invalid param - streamingConfig/callback")};d.setStreamingParams=function(g,
a){k["default"].info("set Streaming Params called");if("moderator"!==d.me.role)k["default"].warning("User should be a moderator user to change Streaming params"),a(r.a.error_7072);else{var c={};0===d.state?(c=r.a.error_7078,k["default"].info(" room is disconnected"),a(c)):(a&&"function"===typeof a||(a=function(g){k["default"].info("SDK defined callback Streaming params change response ",g)}),k["default"].info("Streaming params change called with callback "),y.sendMessage("setStreamingParams",g,function(g,
d){null===g?(k["default"].error("Error on Streaming param change: ",d),b.a.error("room-event",p.a.event_streaming_param_change_failed,{error:d,message:d.status.error}),a(d)):(k["default"].info("Streaming param change Success"),b.a.info("room-event",p.a.event_streaming_param_change_success,{error:{}}),a(g,d))}))}};d.startLiveRecording=function(g,a){k["default"].info("start Live Recording called");var c=!0;if("moderator"!==d.me.role)c=!1,k["default"].warning("User should be a moderator to start live recording"),
a(r.a.error_7201);else{var f={};0===d.state?(f=r.a.error_7203,k["default"].info(" room is disconnected"),a(f)):(a&&"function"===typeof a||(a=function(g){k["default"].info("SDK defined callback Live recording response ",g)}),k["default"].info("start Live Recording called with callback "),c?y.sendMessage("startLiveRecording",g,function(g,d){if(null===g&&(k["default"].error("Error on start Live Recording",d),b.a.error("room-event",p.a.event_start_live_recording_failed,{error:d,message:d.message}),void 0!==
d.status)){a({result:d.status.resultCode,error:"live recording error",desc:d.status.error.errorDesc});return}7014===g.status.resultCode&&(S=!0);b.a.info("room-event",p.a.event_start_live_recording_success,{error:{}});k["default"].info("Start Live Recording Success");a({result:g.status.resultCode,error:"",desc:""},d)}):a(r.a.error_7204))}};d.stopLiveRecording=function(g){g=void 0===g?function(){}:g;k["default"].info("stop Live Recording called");if("moderator"!==d.me.role)k["default"].warning("User should be a moderator user to start live recording"),
g(r.a.error_7036);else{var a={urlDetails:{url:"",layOut:{}}},c={};0===d.state?(c=r.a.error_7037,k["default"].info(" room is disconnected"),g(c)):(g&&"function"===typeof g||(g=function(g){k["default"].info("SDK defined callback Live Recording response ",g)}),k["default"].info("stop Live Recording called with callback "),y.sendMessage("stopLiveRecording",a,function(a,d){null===a?(k["default"].error("Error on stop stop live recording",d),b.a.error("room-event",p.a.event_stop_live_recording_failed,{error:d,
message:d.message}),void 0!==d.status&&g({result:d.status.resultCode,error:"live recording error",desc:d.status.error.errorDesc})):(7034===a.status.resultCode&&(S=!1,a.status.resultCode=0),k["default"].info("Stop Live Recording Success"),b.a.info("room-event",p.a.event_stop_live_recording_success,{error:{}}),g({result:a.status.resultCode,error:"",desc:""},d))}))}};d.setLiveRecordingParams=function(g,a){k["default"].info("set Live Recording Params called");if("moderator"!==d.me.role)k["default"].warning("User should be a moderator user to change live recording params"),
r.a.error_7071.desc="Only moderator can change live recording params",a(r.a.error_7071);else{var c={};0===d.state?(c=r.a.error_7079,k["default"].info(" room is disconnected"),a(c)):(a&&"function"===typeof a||(a=function(g){k["default"].info("SDK defined callback Live Recording params change response ",g)}),k["default"].info("Live Recording params change called with callback "),y.sendMessage("setLiveRecordingParams",g,function(g,d){null===g?(k["default"].error("Error on live recording param change: ",
d),b.a.error("room-event",p.a.event_live_recording_param_change_failed,{error:d,message:d.status.error}),a(d)):(k["default"].info("Live Recording param change Success"),b.a.info("room-event",p.a.event_live_recording_param_change_success,{error:{}}),a(g,d))}))}};d.invalidateTranscoding=function(g,b){k["default"].info("Invalidate Transcoding called");var a={};0===d.state?(a=r.a.error_8000,k["default"].info(" room is disconnected"),b(a)):(b&&"function"===typeof b||(b=function(g){k["default"].info("SDK defined callback Invalidate Transcoding response ",
g)}),k["default"].info("Invalidate Transcoding called with callback "),y.sendMessage("invalidateTranscoding",g,function(g,a){null===g?(k["default"].error("Error on Invalidate Transcoding",a),b(a)):(k["default"].info("Invalidate Transcoding"),b(g,a))}))};d.requestFloor=function(g){g=void 0===g?function(){}:g;"function"===typeof g?wa(d.clientId,"requestFloor",function(b,a){g(b,a);void 0!==b&&(d.cCrequest=d.cCrequest.filter(function(g){return g.clientId!==options}))}):k["default"].error("requestFloor() invalid param - callback")};
d.cancelFloor=function(g){g=void 0===g?function(){}:g;"function"===typeof g?wa(d.clientId,"cancelFloor",function(b,a){g(b,a);null!==b&&(d.cCrequest=d.cCrequest.filter(function(g){return g.clientId!==options}))}):k["default"].error("cancelFloor() invalid param - callback")};d.finishFloor=function(g){g=void 0===g?function(){}:g;"function"===typeof g?wa(d.clientId,"finishFloor",function(b,a){W.forEach(function(g,b){k["default"].info("finishFloor: unpulish "+g.getID()+"::::"+b);d.unpublish(g,function(g){})});
d.floorGranted=!1;g(b,a)}):k["default"].error("finishFloor() invalid param - callback")};d.grantFloor=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?wa(g,"grantFloor",function(a,c){null!==a&&(d.cCrequest=d.cCrequest.filter(function(b){return b.clientId!==g}),d.cCapprovedHands.push({clientId:g,moderatorId:d.clientId}));b(a,c)}):k["default"].error("grantFloor() invalid param - callback")};d.denyFloor=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?wa(g,"denyFloor",function(a,
c){b(a,c);null!==a&&(d.cCrequest=d.cCrequest.filter(function(b){return b.clientId!==g}))}):k["default"].error("denyFloor() invalid param - callback")};d.relaseFloor=function(g,b){d.releaseFloor(g,void 0===b?function(){}:b)};d.releaseFloor=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?wa(g,"releaseFloor",function(a,c){null!==a&&(d.cCrequest=d.cCrequest.filter(function(b){return b.clientId!==g}),Da(g));b(a,c)}):k["default"].error("releaseFloor() invalid param - callback")};d.inviteToFloor=
function(g,b){b=void 0===b?function(){}:b;var a={clientId:g};d.socket.sendMessage("inviteToFloor",a,function(c){0===c.result&&d.cCrequest.push({clientId:a.clientId,name:d.userList.get(g).name,type:"requested"});b(c)})};d.acceptInviteFloorRequest=function(g){g=void 0===g?function(){}:g;wa(d.clientId,"acceptFloor",function(b,a){g(b,a);void 0!==b&&(d.cCrequest=d.cCrequest.filter(function(g){return g.clientId!==options}))})};d.rejectInviteFloor=function(g){g=void 0===g?function(){}:g;wa(d.clientId,"rejectFloor",
function(b,a){d.floorInvited=!1;g(b,a);void 0!==b&&(d.cCrequest=d.cCrequest.filter(function(g){return g.clientId!==options}))})};d.cancelFloorInvite=function(g,b){b=void 0===b?function(){}:b;wa(g,"cancelFloorInvite",function(g,a){b(g,a);void 0!==g&&(d.cCrequest=d.cCrequest.filter(function(g){return g.clientId!==options}))})};d.chairControlMuteAll=function(g){g=void 0===g?function(){}:g;d.socket.sendEvent("room-muted",function(b,a){null===b?(k["default"].error("Error on floor request",a),g(void 0,
a)):g(b)})};d.chairControlUnMuteAll=function(g){g=void 0===g?function(){}:g;d.socket.sendEvent("room-unmuted",function(b,a){null===b?(k["default"].error("Error on floor request",a),g(void 0,a)):g(b)})};d.muteOne=function(g,b){b=void 0===b?function(){}:b;d.socket.sendParamEvent("muteUser",g,function(g,a){null===g?(k["default"].error("Error on floor request",a),b(void 0,a)):b(g)})};d.unMuteOne=function(g,b){b=void 0===b?function(){}:b;d.socket.sendParamEvent("unMuteUser",g,function(g,a){null===g?(k["default"].error("Error on floor request",
a),b(void 0,a)):b(g)})};d.muteRoom=function(g,a){a=void 0===a?function(){}:a;"function"===typeof a?void 0===g||void 0===g.audio&&void 0===g.video?a(r.a.error_1155):!1===g.video&&!1===g.audio?(k["default"].error("at least one of the constraints should be false"),a(r.a.error_1155)):(W.forEach(function(b,a){b.screen||b.canvas||(!0===g.audio&&b.ifAudio()&&!b.selfMuteAudio&&b.muteAudio(function(g){k["default"].info("Mute Audio for the call")},!0,0,!1,!0),b.ifVideo()&&!0===g.video&&!b.selfMuteVideo&&b.muteVideo(function(g){k["default"].info("Mute Video for the call")},
!0,0,"hard",!1,!0))}),d.socket.sendMessage("muteRoom",g,function(g,c){null===g?(k["default"].error("Error on mute room request",c),b.a.error("room-event",p.a.event_room_mute_failed,{message:"mute room request failed"}),a(void 0,c)):(d.roomMuted=!0,b.a.info("room-event",p.a.event_room_mute_success,{message:"mute room request succeeded"}),a(g))})):k["default"].error("muteRoom() invalid param - callback")};d.unMuteRoom=function(g,a){a=void 0===a?function(){}:a;"function"===typeof a?void 0===g||void 0===
g.audio&&void 0===g.video?a(r.a.error_1155):0!=g.video&&0!=g.audio?(k["default"].error("at least one of the constraints should be false"),a(r.a.error_1155)):(W.forEach(function(b,a){b.screen||b.canvas||(k["default"].info("SelfMuteAudio: "+b.selfMuteAudio+" hardMutedAudio: "+b.hardAudioMuted),g.audio||!b.ifAudio()||b.hardAudioMuted||b.unmuteAudio(function(g){k["default"].info("UnMute Audio for the call")},!0,0,!1,!0),k["default"].info("SelfMuteVideo: "+b.selfMuteVideo+" hardMutedVideo: "+b.hardVideoMuted),
g.video||!b.ifVideo()||b.hardVideoMuted||b.unmuteVideo(function(g){k["default"].info("UnMute Video for the call")},!0,0,"self",!0))}),d.socket.sendMessage("unMuteRoom",g,function(g,c){null===g?(k["default"].error("Error on mute room request",c),b.a.error("room-event",p.a.event_room_unmute_failed,{message:"unmute room request failed"}),a(void 0,c)):(d.roomMuted=!1,b.a.info("room-event",p.a.event_room_unmute_success,{message:"unmute room request succeeded"}),a(g))})):k["default"].error("unMuteRoom() invalid param - callback")};
d.pauseRoom=function(g){g=void 0===g?function(){}:g;"function"===typeof g?(k["default"].info("Pausing the room"),d.muteRoom({audio:!0,video:!0},function(b){g(b)})):k["default"].error("pauseRoom() invalid param - callback")};d.resumeRoom=function(g){g=void 0===g?function(){}:g;"function"===typeof g?(k["default"].info("Resuming the room"),d.unMuteRoom({audio:!1,video:!1},function(b){g(b)})):k["default"].error("resumeRoom() invalid param - callback")};d.switchRoomMode=function(g,b){b=void 0===b?function(){}:
b;d.socket.sendParamEvent("switchRoomMode",g,function(g,a){null===g?(k["default"].error("Error on floor request",a),b(void 0,a)):b(g)})};d.startRecording=function(g,a){a=void 0===a?function(){}:a;k["default"].debug("Trying to start recording...");var c,f=!(d.subscription&&!1===d.subscription.recording);f&&(g&&!1===g.local||!g)?(g&&(c=g.getID()),y.sendMessage("startRecord",{to:c},function(g,c){null===g?(k["default"].error("Error on start recording",c),b.a.error("room-event",p.a.event_start_recording_failed,
{error:c,message:c.msg}),a(c),d.createEventLog("roomRecordingFailed",{error:c,externalIp:d.externalIp})):(k["default"].info("Started recording"),b.a.info("room-event",p.a.event_start_recording_success,{error:{}}),0===g.result&&(S=!0),a(g,c),d.createEventLog("roomRecordingSuccess",{externalIp:d.externalIp}))})):f||(b.a.info("room-event",p.a.event_start_recording_failed,{message:r.a.error_1170.desc}),a(r.a.error_1170))};d.onMediaDeviceStateChanged=function(g,b,a){a=void 0===a?function(){}:a;if("active"==
b.state)if("cam"==b.type)if("connected"!=g.state||g.negotiatedMedia.video)a(r.a.error_000);else{if(g.userRequestOptions.video)var c=g.userRequestOptions.video;Ib(c,g,a)}else a(r.a.error_000);else"inactive"==b.state&&(k["default"].error("mediaDeviceError() errr: "+JSON.stringify(b.error)+"reconencting"),d.socket.disconnect(),a(r.a.error_000))};d.manageLiveTranscription=function(){console.log("Calling startLiveTranscription",d.liveTranscription);!0===d.liveTranscription&&0<d.reconnectAttempt&&!0===
d.reconnectionAllowed&&d.socket.sendMessage("startLiveTranscription",{language:d.transcriptionLanguage},function(g){d.liveTranscription=g&&0===g.result?!0:!1})};d.manageRecordingStatus=function(g){k["default"].info("reconnected manage recording status ",g);"moderator"===d.me.role&&1==S&&0<d.reconnectAttempt&&!0===d.reconnectionAllowed?(k["default"].info("room recording was enabled before reconnect"),d.startRecord(function(g,a){null!==g?(k["default"].info("reconnected manage recording success "),b.a.info("room-event",
p.a.event_start_recording_success,{message:"reconnected manage recording success"})):(k["default"].info("Failed to restart recording after reconnection."),b.a.error("room-event",p.a.event_start_recording_failed,{message:"Failed to restart recording after reconnection."}))})):(k["default"].info("reenbling recording for this role is not allowed ",d.me.role),b.a.info("room-event",p.a.event_start_recording_failed,{message:"reenbling recording for role "+d.me.role+" is not allowed"}))};d.stopRecording=
function(g,a){a=void 0===a?function(){}:a;d.subscription&&!1===d.subscription.recording?(b.a.info("room-event",p.a.event_stop_recording_failed,{message:r.a.error_1170.desc}),a(r.a.error_1170)):y.sendMessage("stopRecord",{id:g},function(c,f){null===c?(k["default"].error("Error on stop recording",f),b.a.error("room-event",p.a.event_stop_recording_failed,{error:f}),a(f)):(S=!1,k["default"].info("Stop recording",g),b.a.info("room-event",p.a.event_stop_recording_success,{error:{}}),a(c,f),d.createEventLog("roomRecordingStopped",
{externalIp:d.externalIp}))})};var Ua=function(g,b){var a=[];d.localStreamsBeforeReconnect.forEach(function(d,c){(d.canvas&&b||d.screen&&g||!(d.canvas||b||d.screen||g))&&a.push(d)});for(var c=0;c<a.length;c++)d.localStreamsBeforeReconnect.remove(a[c].getID())},wb=function(g){k["default"].debug("Inside storeLocalStreamForReconnect() reconnect: "+g.reconnect+" that.reconnectionState: "+d.reconnectionState+" that.reconnectionAllowed: "+d.reconnectionAllowed+" streamId: "+g.getID()+" canvas: "+g.canvas+
" screen: "+g.screen);return g.reconnect||d.reconnectionState||d.reconnectionAllowed?(Ua(g.screen,g.canvas),d.localStreamsBeforeReconnect.add(g.getID(),g),!0):!1};d.unpublish=function(g,a){a=void 0===a?function(){}:a;if("function"===typeof a)if(g&&g.local){y.sendMessage("unpublish",g.getID(),function(d,c){null===d?(k["default"].error("Error unpublishing stream",c),b.a.error("room-event",p.a.event_stream_unpublish_failed,{error:c}),a(void 0,c)):(delete g.failed,b.a.info("room-event",p.a.event_stream_unpublish_success,
{error:{}}),k["default"].info("Stream unpublished"),a(!0))});"connected"==g.state&&(g.state="inited");g.room=void 0;var d=W.get(g.getID());void 0!==d&&(d.hardVideoMuted&&d.unmuteVideo(function(g){k["default"].info("videoHardUnmuteCallback: "+JSON.stringify(g))},!1,0,!1),d.hardAudioMuted&&d.unmuteAudio(function(g){k["default"].info("audioHardUnmuteCallback: "+JSON.stringify(g))},!1,0,!1),d.pc&&(d.pc.close(),d.pc=null),d.reconnect&&wb(d));W.remove(g.getID());g.setID(0);g.off("internal-send-data",bb);
g.off("internal-set-attributes",ub)}else b.a.info("room-event",p.a.event_stream_unpublish_failed,{error:"Cannot unpublish, stream does not exist or is not local"}),k["default"].error("Cannot unpublish, stream does not exist or is not local"),a(void 0,"Cannot unpublish, stream does not exist or is not local");else k["default"].error("unpublish() invalid param - callback")};d.sendControlMessage=function(g,b,a){g&&g.getID()&&(b={type:"control",action:a},d.socket.sendSDP("signaling_message",{streamId:g.getID(),
msg:b}))};d.subscribe=function(g,a,c){a=void 0===a?{}:a;c=void 0===c?function(){}:c;var f=JSON.parse(JSON.stringify(a));k["default"].debug("room.subscribe streamId: "+g.getID()+" options: "+JSON.stringify(f));if(!g||g.local||g.failed)a="Error on subscribe",g?g.local?(k["default"].warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),a="Local copy of stream",b.a.error("room-event",p.a.event_stream_subscribe_failed,{error:a,stream:g})):g.failed&&
(k["default"].warning("Cannot subscribe to failed stream."),a="Failed stream",b.a.error("room-event",p.a.event_stream_subscribe_failed,{error:a,stream:g})):(k["default"].warning("Cannot subscribe to invalid stream"),a="Invalid or undefined stream",b.a.error("room-event",p.a.event_stream_subscribe_failed,{error:a})),c(void 0,a),g={streamType:g.ifScreen()?"share":"main",streamId:g.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===d.mediaConfiguration||"Default"===
d.mediaConfiguration?"VP8":d.mediaConfiguration},audio:{codec:"OPUS"}},error:a,externalIp:d.externalIp},d.createEventLog("clientStreamSubscribeFailed",g);else{if(g.ifMedia())g.ifVideo()||g.ifScreen()||(f.video=!1),g.ifAudio()||(f.audio=!1),g.ifCanvas()&&(f.data=!1),g.ifCanvas()||(f.canvas=!1),"safari"===x.a.browser_info.name&&(f.video=x.a.browser_info.version>=v.a.constant.SAFARI_VERSION_SUPPORTING_VP8?!0:!1),f.muteStream={audio:g.ifCanvas()?!0:void 0!=g.audioMuted?g.audioMuted:!1,video:g.videoMuted},
!1===d.reconnectionState?(R=f.forceTurn?f.forceTurn:!1,ra=f.imageOnVideoMute?f.imageOnVideoMute:!1):f.forceTurn=R,k["default"].info("Stream for subscribe in room.subscribe:- options:: "+JSON.stringify(f)),g.forceTurn=f.forceTurn,g.userRequestOptions=JSON.parse(JSON.stringify(a)),ta.get(g.getID())?(k["default"].info("subscribe() pending, not subscribing now streamId: ",g.getID()," remotePendingStreams keys"+JSON.stringify(ta.keys())),c(r.a.error_000)):(k["default"].info("subscribe() subscribing streamId: ",
g.getID()," options  ",JSON.stringify(f)),tc(g,f,c));else if(g.ifData()&&!1!==f.data)uc(g,f,c);else{k["default"].warning("There's nothing to subscribe to");c(void 0,"Nothing to subscribe to");return}k["default"].debug("Subscribing to: "+g.getID());b.a.info("room-event",p.a.event_stream_subscribe_success,{message:"Subscribing to: "+g.getID()});Na(!0,g.getID(),!1)}};d.unsubscribe=function(g,a){a=void 0===a?function(){}:a;void 0!==y?g&&!g.local?g.reconnect?(k["default"].info(" in that.unsubscribe() remove stream"),
Ra(g),delete g.failed,a(r.a.error_000)):y.sendMessage("unsubscribe",g.getID(),function(d,c){null===d?(k["default"].info("that.unsubscribe() unsubscribe callback failed for stream id: "+g.getID()),a(r.a.error_1167)):(Ra(g),delete g.failed,b.a.error("room-event",p.a.event_stream_unsubscribe_success,{message:"Unsubscribe from stream - success"}),a(r.a.error_000))},function(){k["default"].error("Error calling unsubscribe.");b.a.error("room-event",p.a.event_stream_unsubscribe_failed,{stream:g})}):a(r.a.error_1156):
a(r.a.error_1163)};d.hardMute=function(g){g=void 0===g?function(){}:g;"function"===typeof g?Fa("room-muted",!0,!1,!0,void 0,function(b){0==b.result&&(d.hardMuteInitiator=!0);g(b)}):k["default"].error("hardMute() invalid param - callback")};d.hardUnmute=function(g){g=void 0===g?function(){}:g;"function"===typeof g?Fa("room-unmuted",!0,!1,!0,void 0,function(b){0==b.result&&(d.hardMuteInitiator=!1);g(b)}):k["default"].error("hardUnmute() invalid param - callback")};d.hardMuteUserAudio=function(g,b){b=
void 0===b?function(){}:b;"function"===typeof b?Fa("hardmute-user-audio",!0,!1,!1,g,b):k["default"].error("hardMuteUserAudio() invalid param - callback")};d.hardUnmuteUserAudio=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?Fa("hardunmute-user-audio",!0,!1,!1,g,b):k["default"].error("hardUnmuteUserAudio() invalid param - callback")};d.hardMuteUserVideo=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?Fa("hardmute-user-video",!1,!0,!1,g,b):k["default"].error("hardMuteUserVideo() invalid param - callback")};
d.hardUnmuteUserVideo=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?Fa("hardunmute-user-video",!1,!0,!1,g,b):k["default"].error("hardUnmuteUserVideo() invalid param - callback")};d.subscriberVideoMute=function(g,b){d.socket.emitEvent(v.a.RoomEvent.subscriber_video_mute,{streamId:g},function(g){0==g.result&&b(g)})};d.setTalkerCount=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?"undefined"!=typeof g&&"number"===typeof g&&0<=g&&g===parseInt(g)?(V=g,d.socket.emitEvent(v.a.RoomEvent.set_active_talker,
{numTalkers:g,numAudioTalkers:3>=g?3:g,numVideoTalkers:d.audioOnlyMode?0:g},function(g){0==g.result&&(d.userAudioTalkerCount=g.numAudioTalkers,!1===d.audioOnlyMode&&(d.userVideoTalkerCount=g.numVideoTalkers));b(g)})):b(r.a.error_1155):k["default"].error("setTalkerCount() invalid param - callback")};d.getTalkerCount=function(g){"function"===typeof g?d.socket.sendEvent(v.a.RoomEvent.get_active_talker,function(b){g(b)}):k["default"].error("getTalkerCount() invalid param - callback")};d.getMaxTalkers=
function(g){"function"===typeof g?d.socket.sendEvent(v.a.RoomEvent.get_active_max_talker,function(b){g(b)}):k["default"].error("getMaxTalkers() invalid param - callback")};d.setAdvancedOptions=function(g,b){b=void 0===b?function(g){}:b;g&&Array.isArray(g)&&g.length&&"function"==typeof b?d.socket.emitEvent(v.a.RoomEvent.set_adavanced_options,g,b):b(r.a.error_1155)};d.getAdvancedOptions=function(g){g=void 0===g?function(g){}:g;"function"==typeof g?d.socket.sendEvent(v.a.RoomEvent.get_adavanced_options,
function(b){g(b)}):g(r.a.error_1155)};d.switchUserRole=function(g,b){b=void 0===b?function(){}:b;if("function"===typeof b&&g)if("string"===typeof g)"moderator"===d.me.role&&g&&d.clientId&&g!=d.clientId?d.socket.emitEvent(v.a.RoomEvent.switch_user_role,g,function(g){b(g)}):b("moderator"!==d.me.role?r.a.error_1168:d.clientId?r.a.error_1155:r.a.error_1171);else if(Array.isArray(g)&&g.length){var a=!0;if("moderator"===d.me.role)for(var c=0;c<g.length;c++){var f=d.userList.get(g[c].clientId);if(void 0==
f&&"audience"!=g[c].role||f&&f.role==g[c].role){k["default"].error("switchUserRole() failed "+(f?"user already in same role":" user not found / invalid role")+" info: "+JSON.stringify(g[c]));b({result:r.a.error_1159,info:g[c]});a=!1;return}}else if(1==g.length){if(g[0].clientId!=d.clientId||g[0].role==d.me.role)a=g[0].clientId!=d.clientId?{msg:" insfficent privileges for other clients",res:r.a.error_1168}:{msg:"user already in same role",res:r.a.error_1159},k["default"].error("switchUserRole() failed"+
a.msg+" info: "+JSON.stringify(g[0])),b({result:a.res,info:g[0]}),a=!1}else k["default"].error("switchUserRole() failed info: user has insufficient  privilages "),b({result:r.a.error_1168}),a=!1;a&&d.socket.emitEvent(v.a.RoomEvent.switch_user_role,g,function(g){b(g)})}else k["default"].error("switchUserRole() invalid param - options"),"function"===typeof b&&b(r.a.error_1155);else k["default"].error("switchUserRole() invalid param - callabck"),"function"===typeof b&&b(r.a.error_1155)};var Ma=function(g){for(var b=
0;b<d.userRoleChangeRequests.length;b++)if(d.userRoleChangeRequests[b].clientId==g)return g=d.userRoleChangeRequests[b],d.userRoleChangeRequests.splice(b,1),g;return!1},Ya=function(g,b,a){a=void 0===a?function(){}:a;k["default"].info("processUserRoleChangeRequest() options: "+JSON.stringify(g)+" action: "+b);d.socket.sendSDP("changeUserRoleOption",g,b,function(g,d){null===g?(k["default"].error("Error on "+b+" error: "+d),a(void 0,d)):a(g)})};d.requestUserRoleChange=function(g,b){b=void 0===b?function(){}:
b;"function"===typeof b&&g&&"object"==typeof g&&"string"==typeof g.role?Ya(g,"requestInitiate",b):(k["default"].error("requestUserRoleChange() invalid params"),"function"===typeof b&&b(r.a.error_1155))};d.cancelUserRoleChangeRequest=function(g){g=void 0===g?function(){}:g;"function"===typeof g?Ya({},"requestCancel",g):(k["default"].error("requestUserRoleChange() invalid params"),"function"===typeof g&&g(r.a.error_1155))};d.acceptUserRoleChangeRequest=function(g,b){b=void 0===b?function(){}:b;d.isModerator()?
"function"===typeof b&&g&&"object"==typeof g&&g.clientId&&"string"==typeof g.clientId&&g.role&&"string"==typeof g.role?Ma(g.clientId)&&Ya(g,"requestAccepted",b):(k["default"].error("requestUserRoleChange() invalid params"),"function"===typeof b&&b(r.a.error_1155)):(k["default"].error("acceptUserRoleChangeRequest() insufficient privilages"),"function"===typeof b&&b(r.a.error_1168))};d.denyUserRoleChangeRequest=function(g,b){b=void 0===b?function(){}:b;if(d.isModerator())if("function"===typeof b&&g&&
"object"==typeof g&&g.clientId&&"string"==typeof g.clientId){var a=!1;Ma(g.clientId)&&(Ya(g,"requestDenied",b),a=!0);a||(k["default"].error("denyUserRoleChangeRequest() request not found"),b(r.a.error_1707))}else k["default"].error("denyUserRoleChangeRequest() invalid params"),"function"===typeof b&&b(r.a.error_1155);else k["default"].error("denyUserRoleChangeRequest() insufficient privilages"),"function"===typeof b&&b(r.a.error_1168)};d.setSpeakerVolume=function(g,b){b=void 0===b?function(){}:b;
if(void 0==g||"number"!=typeof g&&"boolean"!=typeof g||"function"!=typeof b)b(r.a.error_1155);else{var a="boolean"==typeof g?Number(g):g;0<=a&&1>=a&&d.speakerInfo.volume!=g?(d.remoteStreams.forEach(function(b){b.setSpeaker(void 0,g)}),g?d.speakerInfo.volume||d.dispatchEvent(Object(m.e)({type:"speaker-unmuted",message:{}})):d.dispatchEvent(Object(m.e)({type:"speaker-muted",message:{}})),d.speakerInfo.volume=g,b(r.a.error_000)):b(d.speakerInfo.volume!=g?r.a.error_1188:r.a.error_1155)}};d.switchSpeaker=
function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?void 0==g||void 0!=d.speakerInfo.id&&g==d.speakerInfo.id||void 0!=b&&"function"!==typeof b||"safari"===u.a.browserEngineCheck()?"function"===typeof b&&b("safari"===u.a.browserEngineCheck()?r.a.error_1153:void 0==g?r.a.error_1155:r.a.error_1177):Ab(g,function(a){a?(d.speakerInfo.deviceId=a.deviceId,d.speakerInfo.groupId=a.groupId,P.forEach(function(b){b.setSpeaker(g)}),d.speakerInfo.id=g,b(r.a.error_000)):b(r.a.error_1142)}):k["default"].error("switchSpeaker() invalid param - callback")};
d.startLocalRecord=function(g,a,c){g=void 0===g?"remote":g;a=void 0===a?10:a;if("none"===ka){var f=[],e=0;if("remote"===g||"all"===g)P.forEach(function(g){f[e]=new Promise(function(b,a){g.startLocalRecord(respCallback=function(a){b({id:g.getID(),status:a})})});e++}),ka=g;if("local"===g||"all"===g)W.forEach(function(g){f[e]=new Promise(function(b,a){g.startLocalRecord(respCallback=function(a){b({id:g.getID(),status:a})})});e++}),ka=g;"none"!==ka?(0!==a&&(f[e]=new Promise(function(g,b){setTimeout(function(){d.stopLocalRecord(respCallback=
function(b,a){g(a)})},1E3*a)})),Promise.all(f).then(function(g){c&&(b.a.info("room-event",p.a.event_start_recording_success,{error:{}}),c(r.a.error_000,g))})):(k["default"].error("invalid param type"),b.a.info("room-event",p.a.event_start_recording_failed,{error:"invalid param type"}),c&&c(r.a.error_1155))}else k["default"].error("recording already in progress"),b.a.info("room-event",p.a.event_start_recording_failed,{error:"recording already in progress"}),c&&c(r.a.error_1174)};d.stopLocalRecord=
function(g){if("none"!==ka){var a=0;"remote"!==ka&&"all"!==ka||P.forEach(function(g){new Promise(function(b,a){g.stopLocalRecord(respCallback=function(a){b({id:g.getID(),status:a})})});a++});"local"!==ka&&"all"!==ka||W.forEach(function(g){new Promise(function(b,a){g.stopLocalRecord(respCallback=function(a){b({id:g.getID(),status:a})})});a++});ka="none";b.a.error("room-event",p.a.event_stop_recording_success,{error:{}})}else k["default"].error("recoding not stopped"),b.a.info("room-event",p.a.event_stop_recording_failed,
{message:r.a.error_1175.desc}),g&&g(r.a.error_1175)};d.setReceiveVideoQuality=function(g,b){if("[object Object]"===Object.prototype.toString.call(g)&&"function"===typeof b){var a={},c={},f={};f=g.videoQuality;var e=g.streamType;void 0===f&&(f="Auto");void 0===e&&(e="talker");k["default"].info("Dumping opts in setReceiveVideoQuality"+JSON.stringify(g)+" streamType"+e);if("talker"!=e&&"canvas"!=e)k["default"].info("setReceiveVideoQuality Failed Invalid Param -StreamType: "+e),b(r.a.error_1155);else{switch(f){case "HD":c.width=
1280;c.height=720;break;case "SD":c.width=960;c.height=540;break;case "LD":c.width=640;c.height=360;break;case "Auto":break;default:k["default"].info("setReceiveVideoQuality for "+e+". Failed Invalid Param -videoQuality: "+f);b(r.a.error_1155);return}c.frameRate=30;a.video=c;if("talker"==e&&d.receiveVideoQuality.get("talker")!==f||"canvas"==e&&d.receiveVideoQuality.get("canvas")!==f)P.forEach(function(g){"talker"===e&&!1===g.canvas&&!1===g.screen?g.updateConfiguration(a,function(g){k["default"].info("stream.updateConfiguration for talker stream result : "+
g)}):"canvas"===e&&!0===g.canvas&&g.updateConfiguration(a,function(g){k["default"].info("stream.updateConfiguration for canvas stream result : "+g)})}),d.receiveVideoQuality.set(e,f);f={result:0,msg:"Video quality successfully updated."};b(f)}}else"function"!==typeof b?k["default"].error("setReceiveVideoQuality() invalid param - callback() "):(k["default"].error("setReceiveVideoQuality() invalid param - QualityOpt "),b(r.a.error_1155))};d.getReceiveVideoQuality=function(g){return"talker"===g||"canvas"===
g?{result:0,videoQuality:d.receiveVideoQuality.get(g)}:r.a.error_1156};d.getStats=function(g,b,a){b=void 0===b?{intervalSecs:2,log:!0}:b;a=void 0===a?function(){}:a;if(void 0!=g&&"boolean"==typeof g&&"function"==typeof a)if(g){var c=function(g,a,d,c,f){f=void 0===f?function(){}:f;var k={},e=function(g,b,a){return g&&b&&a?(g.totalBytes=a-b.totalBytes,b.totalBytes=a,!0):!1};if(g.pc&&g.pc.peerConnection){var h,m={},q=g.getID();g.pc.peerConnection.getStats(null).then(function(p){p.forEach(function(f){switch(f.type){case "candidate-pair":f.nominated&&
(h=(a.pub?f.availableOutgoingBitrate:f.availableIncomingBitrate)/1E3,f=a.pub?f.bytesSent:f.bytesReceived,e(d[q+"-audio"],c[q+"-audio"],f)||(m[q+"-audio"]=f,m.audio=f),e(d[q+"-video"],c[q+"-video"],f)||(m[q+"-video"]=f,m.video=f));break;case "outbound-rtp":case "inbound-rtp":if(!(g.local&&"inbound-rtp"==f.type||!g.local&&"outbound-rtp"==f.type)){a.sIdMaps&&(q=f.mid?a.sIdMaps.mIds[parseInt(f.mid)]:a.sIdMaps.trackIds[f.trackIdentifier]);var p=q+"-"+f.kind;void 0==d[p]&&(d[p]={id:q,ssrc:0,reconnects:0,
availKbps:0},c[p]={totalBytes:0});var r="outbound-rtp"===f.type,w=d[p],v=c[p];w.ssrc=f.ssrc;w.id=g.getID();w.reconnects=g.reconnectsTotal;r?(w.type="pub",w.bps=v.bytes?8*(f.bytesSent-v.bytes)/b.intervalSecs:0,w.kbps=w.bps/1E3,w.targetkbps=f.targetBitrate/1E3,v.bytes=f.bytesSent):(w.type="sub",w.bps=v.bytes?8*(f.bytesReceived-v.bytes)/b.intervalSecs:0,w.kbps=w.bps/1E3,v.bytes=f.bytesReceived,w.packetsLost=f.packetsLost);"video"==f.kind?(w.id="vid:"+g.getID(),r?(w.fps=v.framesEncoded?(f.framesEncoded-
v.frames)/b.intervalSecs:0,v.frames=f.framesEncoded,w.fps=f.framesPerSecond,w.retransmitKbps=v.retransmittedBytesSent?8*(f.retransmittedBytesSent-v.retransmittedBytesSent)/(1E3*b.intervalSecs):0,v.retransmittedBytesSent=f.retransmittedBytesSent,w.keyFrames=f.keyFramesEncoded,w.targetFps=f.framesPerSecond):(w.fps=v.framesDecoded?(f.framesDecoded-v.framesDecoded)/b.intervalSecs:0,v.framesDecoded=f.framesDecoded,w.recivedfps=v.frames?(f.framesReceived-v.frames)/b.intervalSecs:0,v.frames=f.framesReceived,
w.droppedfps=v.framesDropped?(f.framesDropped-v.framesDropped)/b.intervalSecs:0,v.framesDropped=f.framesDropped),w.resH=f.frameHeight,w.resW=f.frameWidth,w.resoln=f.frameWidth+"X"+f.frameHeight,w.firs=f.firCount,w.plis=f.pliCount,w.nacks=f.nackCount):w.id="aud:"+g.getID();w.type+=g.ifScreen()?"sh":g.ifCanvas()?"cn":"mn";d[p].sId=q;void 0==k[q]&&(k[q]={});k[q][f.kind]=d[p];k[f.kind]=d[p];e(d[p],c[p],m[f.kind])&&(m[p]=0);h&&(d[q+"-"+f.kind].availKbps=h)}}});f(k)},function(g){return console.log(" peerconnection getStats failed err : "+
g)})}return k},f=function(g,a,c,f,k){var e=c&&c.totalBytes?c:a,h=8*e.totalBytes/b.intervalSecs;void 0==f&&(f={id:e.sId,"total-bitrate-kbps":0,video:[],audio:{}});f["total-bitrate-kbps"]=Math.round(h/1E3);c&&(c.bps||(c.resH=0,c.resW=0,c.fps=0,c.packetsLost=0),f.video[0]={resHeight:c.resH,resWidth:c.resW,frameRate:c.fps,bitrate:c.bps,packetsLost:c.packetsLost,bandwidth:h});a&&(f.audio[0]={bitrate:a.bps,bandwidth:h});if(k){var m=g.getPlayerStats(),q="AV";g.local||(k=d.activeTalkerList.get(parseInt(g.getID())))&&
"audiovideo"!=k.mediatype&&(q="video"==k.mediatype?"V":"audio"==k.mediatype||"audioOnly"==k.mediatype?"A":"N");document.querySelectorAll("#stats-right-part-"+e.sId).forEach(function(b){if(b&&null!==b){var d="<div> <strong> "+q;d=g.local?d+"  ,":d+(" ID: "+e.sId+",");d+="Total:</strong>:  "+f["total-bitrate-kbps"]+"Kbps </div>";c&&(d=d+'<div> <strong style="color:black;" >V: '+(c.ssrc+" - "+c.resW+"X"+c.resH+"p"+c.fps+"@"),d+=Math.round(c.bps/1E3)+"Kbps</strong></div>",d+='<div> <strong style="color:black;" > loss '+
c.packetsLost+" pli "+c.plis+" ",d+="Nacks "+c.nacks+"</div>");a&&(d=d+'<div> <strong style="color:black;" >A: '+(a.ssrc+" - "+Math.round(a.bps/1E3)+"Kbps</strong></div>"));d+='<div> <strong style="color:black;" >';if((!g.local||g.ifScreen())&&m.muted||g.local&&!g.ifScreen()&&!m.muted)d+="Player:  mute - "+m.muted;m.paused&&(d+="paused - "+m.paused);if(q.includes("A")&&!m.aTracks||q.includes("V")&&!m.vTracks)d+=" Tracks A -  "+m.aTracks+" V - "+m.vTracks;b.innerHTML='<div id="" class="stats-detail"> '+
(d+"</strong> </div> </div>")}})}},e={},h={};Ka=setInterval(function(){if(2==d.state){var g=[],a={video:[],audio:[]},k={video:[],audio:[]},m={video:[],audio:[]},q=[],p="notify-display"==d.mediaStatsMode||"notify"==d.mediaStatsMode,w=!x.a.csp_enabled&&("notify-display"==d.mediaStatsMode||"display"==d.mediaStatsMode);W.forEach(function(g,b){"connected"==g.state?q.push(new Promise(function(b,d){c(g,{pub:!0},e,h,function(d){if(p||w)(d.audio||d.video)&&f(g,d.audio,d.video,a,w),b(!0)})})):e[g.getID()+"-video"]&&
(delete e[g.getID()+"-audio"],delete e[g.getID()+"-video"],delete h[g.getID()+"-audio"],delete h[g.getID()+"-video"])});if(void 0==d.sIdMaps){d.sIdMaps={mIds:[],trackIds:{}};var r=0;P.forEach(function(g,b){g.ifAudio()&&(d.sIdMaps.mIds[r++]=b,d.sIdMaps.trackIds[g.transceivers.audio.receiver.track.id]=b);g.ifVideo()&&(d.sIdMaps.mIds[r++]=b,d.sIdMaps.trackIds[g.transceivers.video.receiver.track.id]=b)})}var v=P.get(1);v&&"connected"==v.state&&q.push(new Promise(function(b,a){c(v,{pub:!1,sIdMaps:d.sIdMaps},
e,h,function(a){(p||w)&&(a.video||a.audio)&&P.forEach(function(b,c){if(d.activeTalkerList.get(parseInt(c))||100<parseInt(c)&&(d.shareStatus||d.canvasStatus)){var e=d.activeTalkerList.get(parseInt(c))?g[parseInt(c)]:b.ifScreen()?m:k;(a[c].audio||a[c].video)&&f(b,a[c].audio,a[c].video,e,w,b)}});b(!0)})}));Promise.all(q).then(function(c){b.log&&console.table(Object.values(e));p&&d.dispatchEvent({type:"media-stats",talkers:g,publisher:a,share:m,canvas:k})})}},1E3*b.intervalSecs)}else Ka&&(clearTimeout(Ka),
Ka=void 0);else k["default"].error("Invalid paramaters "),a&&"function"==typeof a&&a(r.a.error_1155)};d.getStreamStats=function(g,b){b=void 0===b?function(){}:b;if(!y)return"Error getting stats - no socket";if(!g)return"Error getting stats - no stream";y.sendMessage("getStreamStats",g.getID(),function(g){g&&b(g)})};d.getStreamsByAttribute=function(g,b){var a=[];P.forEach(function(d){void 0!==d.getAttributes()&&d.getAttributes()[g]===b&&a.push(d)});return a};d.installPlugin=function(){if(!document.getElementById("WebrtcEverywherePluginId")){var g=
!!(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window);navigator.userAgent.indexOf("Safari");var a=document.createElement("object");g?a.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53"):a.setAttribute("type","application/webrtc-everywhere");a.setAttribute("id","WebrtcEverywherePluginId");document.body.appendChild(a);a.setAttribute("width","0");a.setAttribute("height","0");a.isWebRtcPlugin||"undefined"!==typeof navigator.plugins&&
(navigator.plugins["WebRTC Everywhere"]||navigator.plugins["WebRTC Everywhere Plug-in for Safari"])?(k["default"].info("Installed WEBRTC plugin for IE"),b.a.info("room-event",p.a.event_general_success,{message:"Installed WEBRTC plugin for IE"})):(k["default"].info("Browser does not appear to be WebRTC-capable"),b.a.warn("room-event",p.a.event_incompatible_browser,{message:"Browser does not appear to be WebRTC-capable"}),window.open("/assets/plugin/VCXIE_PLUGINS.exe","new"))}};d.checkHealth=function(g){g=
void 0===g?function(){}:g;var b={streams:{local:[],remote:[]}};W.forEach(function(g,a){b.streams.local.push(g.checkHealth())});P.forEach(function(g,a){b.streams.remote.push(g.checkHealth())});g(b)};d.postClientLogs=function(g,b){b=void 0===b?function(){}:b;"function"===typeof b?(d.checkHealth(),g=x.a.getLocalStorageItem("vcxRTCLib-log"),null!=g?d.socket.sendSDP("clientLogPosted",D.logId,g,function(g,a){g?(x.a.removeLocalStorageItem("vcxRTCLib-log"),b(r.a.error_000)):b(r.a.error_1161)}):(b(r.a.error_000),
k["default"].info("postClientLogs()  local storage null "))):k["default"].error("postClientLogs() invalid param - callback")};d.whoAmI=function(g){g=void 0===g?function(g){}:g;var b;d.userList.forEach(function(g,a){a===d.clientId&&(b=g)});g(b)};var Ib=function(g,b,a){b.userRequestOptions.video=void 0!=g?g:!0;b.config.video||(b.config.video=b.video=!0);k["default"].info("addRenegotiateVideo() : caling reconnectStream");Ca(b,"add",function(g){a(g?r.a.error_000:r.a.error_1167)})};d.addVideo=function(g,
a){a=void 0===a?function(){}:a;if(void 0!=g&&null!=g&&"object"!=typeof g)k["default"].error("addVideo() failed Invalid params"),a(r.a.error_1155);else if(!d.subscription||d.subscription.audio_video&&"audio_video"==d.mediaType){var c;W.forEach(function(g,b){g.ifCanvas()||g.ifScreen()||(c=g)});!c||c.isVideoMuted()||"connected"!=c.state||c.negotiatedMedia.video?c?a(c.isVideoMuted()?r.a.error_1189:r.a.error_1197):a(r.a.error_1159):(g&&(c.config.video&&"object"==typeof c.config.video||(c.config.video=
{}),g.deviceId&&(c.config.video.deviceId=g.deviceId),g.facingMode&&(c.config.video.facingMode=g.facingMode),Object.keys(c.config.video).length||(c.config.video=!0)),c.unmuteVideo(function(b){console.log("reconnectStreamOnUnmuteVideo resp:: "+JSON.stringify(b));0==b.result?Ib(g,c,a):a(r.a.error_1145)},!1,0,!c.hardVideoMuted,!1,!0))}else"audio_video"!=d.mediaType?k["default"].error("addVideo() error: room media type not supported"):k["default"].error("Licence error : feature not supported subscription - av: "+
d.subscription.audio_video),b.a.error("room-event",p.a.event_general_failed,{message:r.a.error_1170.error}),a(r.a.error_1170)};var Ga=function(g,b,a){a=void 0===a?function(){}:a;"function"!==typeof a||!b||"object"!=typeof b||void 0==b.pubType||"screen"!==b.pubType&&"canvas"!==b.pubType?a(r.a.error_1155):(b=JSON.parse(JSON.stringify(b)),b.req=g,d.socket.emitEvent("auxilaryPublishRequests",b,a))};d.setSharePermissionMode=function(g,b){Ga("set-permission-mode",g,b)};d.requestSharePermission=function(g,
b){Ga("req-permission",g,function(a){d.isModerator()||a.result!=r.a.error_000.result||(d.sharePermissions[g.pubType].state="share-permission-requested");b(a)})};d.grantSharePermission=function(g,b){Ga("grant-permission",g,b)};d.denySharePermission=function(g,b){Ga("deny-permission",g,b)};d.cancelSharePermission=function(g,b){Ga("cancel-permission",g,function(a){d.isModerator()||a.result!=r.a.error_000.result||(d.sharePermissions[g.pubType].state="idle");b(a)})};d.releaseSharePermission=function(g,
b){Ga("release-permission",g,b)};d.startScreenShare=function(g,a){var c;if(void 0!=g&&"function"===typeof g)var f=g;else void 0!=a&&"function"===typeof a&&(void 0!=g&&(c=g),f=a);if("function"===typeof f&&d.share){void 0==c?c={audio:"chrome-stable"===x.a.browser_info.name||"edge"===x.a.browser_info.name}:void 0==c.audio&&(c.audio=!1);c.layout=void 0!=c.layout?c.layout:"grid";d.forcedStopSharing=!1;var e,h;"safari"===x.a.browser_info.name&&(h=new Promise(function(g){e=Jb(c,function(b){g(b)})}));d.socket.emitEvent("auxilaryPublishRequests",
{req:"start",pubType:"screen",override:!0},function(g){g.result==r.a.error_000.result?("safari"!==x.a.browser_info.name&&(h=new Promise(function(g){e=Jb(c,function(b){g(b)})})),h.then(function(g){!0!==g||d.shareStatus||d.forcedStopSharing?(!0===g&&(g=d.shareStatus?r.a.error_1151:r.a.error_1200,e.close()),k["default"].error("startShare failed: err "+JSON.stringify(g)),d.socket.emitEvent("auxilaryPublishRequests",{req:"stop",pubType:"screen"},function(g){}),f(g)):(e.addEventListener("stream-ended",
function(g){k["default"].info(" screen share stream ended, stopping share");d.stopScreenShare(function(g){k["default"].info("stopScreenShare resp: "+JSON.stringify(g))})}),d.publish(e,{video:!0,share:!0,shareMetadata:{layout:c.layout},maxVideoBW:x.a.video_bandwidth_range.share.max,minVideoBW:x.a.video_bandwidth_range.share.min},function(g){f(g);var a={streamId:e.getID(),externalIp:d.externalIp,negotiatedCodecs:{audio:{codec:"OPUS"},video:{codec:"VP8"}}};g.result===r.a.error_000.result?za(!0,d.canvasStatus):
4108===g.result&&(a.error=g.msg,d.createEventLog("clientStreamShareFailed",a),b.a.info("room-event",p.a.event_start_screenshare_failed,{addOpt:a}),e.stream.getTracks().forEach(function(g){g.stop()}))}))})):(e&&e.stream.getTracks().forEach(function(g){g.stop()}),f(g))})}else"function"!==typeof f?k["default"].error("startScreenShare() invalid param - callback"):d.share?(k["default"].error("Room not connected../ licence error"),f(r.a.error_1171)):(k["default"].error("startScreenShare() failed share not supported in room/ no subscription"),
f(r.a.error_1170)),b.a.info("room-event",p.a.event_start_screenshare_failed,{error:error});localStream&&(d.ScreenSharelocalStream=localStream);return localStream};d.getScreenShareStream=function(){return d.ScreenSharelocalStream};d.stopScreenShare=function(g,a){a=void 0===a?function(){}:a;if("function"===typeof a){var c=r.a.error_1159;if(d&&d.share){var f;d.localStreams.forEach(function(g){g.ifScreen()&&g.local&&(Ua(!0,!1),g.close(),f=g,c=r.a.error_000)});za(!1,d.canvasStatus);void 0!=f&&d.localStreams.remove(f.getID())}else c=
d?r.a.error_1170:r.a.error_1171,k["default"].info("Room not connected../ licence error"),b.a.info("room-event",p.a.event_stop_screenshare_failed,{error:c});d.ScreenSharelocalStream=null;a?a(c):g&&"function"===typeof g&&g(c)}else k["default"].error("stopScreenShare() invalid param - callback")};d.stopAllSharing=function(g){console.log("stopAllSharing");1!=d.shareStatus&&1!=d.isCanvasSharing||d.socket.sendParamEvent("stopAllSharing",d.clientId,function(b){0!=b.result&&(k["default"].error(b.msg),b.result=
-1);g(b)})};var ad=function(g){g=Object(m.e)({type:"custom-data-saved",message:{result:g.result,scope:g.scope}});d.dispatchEvent(g)},bd=function(g){var b=g.data,a=g.scope;"room"==a?d.customRoomData=b:"session"==a?d.customSessionData=b:"user"==a&&(a=d.userList.get(g.clientId),a.customUserData=b,d.userList.set(g.clientId,a));g=Object(m.e)({type:"custom-data-updated",message:{result:g.result,scope:g.scope,msg:g.msg}});d.dispatchEvent(g)};d.saveCustomData=function(g,b,a){if(!d.subscription||void 0!==
d.subscription.datastore&&!1!==d.subscription.datastore){var c={result:0},f=g.scope,e=g.query;if(0==da(f))c.result=1,c.msg="Invalid scope parameter: "+f,a(c);else if(void 0==b||"object"!=typeof b||"object"==typeof b&&Array.isArray(b))k["default"].error("Invalid data: "+b),c.result=1,c.msg="Invalid  data",a(c);else if(e&&"string"!=typeof e)k["default"].error("Invalid data type of query: "+e),c.result=1,c.msg="Invalid  data type",a(c);else{e=Object.keys(b);e=$jscomp.makeIterator(e);for(var h=e.next();!h.done;h=
e.next())if(""===h.value){c.result=1;c.msg="Empty string as key not allowed.";a(c);return}d.socket.sendParamEvent("saveCustomData",{scope:f,data:b,query:g.query},function(g){0!=g.result&&k["default"].error(g.msg);a(g)})}}else k["default"].error("Customer datastore subsciption isn't supported for the room !!"),a(r.a.error_1170)};d.setCustomData=function(g,b,a){var c=g.scope,f=g.query;g=g.broadcast;if(!d.subscription||void 0!==d.subscription.datastore&&!1!==d.subscription.datastore){var e={result:0};
if("owner"==c||0==da(c))e.result=1,e.msg="owner"==c?"Owner scope not allowed.":"Invalid scope parameter: "+c,a(e);else{var h;if(h=g)h="string"!=typeof g||0==N.includes(g)?!1:!0,h=0==h;if(h)e.result=1,e.msg="Invalid broadcast parameter: "+g,a(e);else if(void 0==b||"object"!=typeof b||"object"==typeof b&&Array.isArray(b))k["default"].error("Invalid data: "+b),e.result=1,e.msg="Invalid  data",a(e);else if("user"!=c||void 0!=g&&"none"!=g){h=Object.keys(b);h=$jscomp.makeIterator(h);for(var q=h.next();!q.done;q=
h.next())if(""===q.value){e.result=1;e.msg="Empty string as key not allowed.";a(e);return}if(f&&"string"!=typeof f)k["default"].error("Invalid data type of query: "+f),e.result=1,e.msg="Invalid  data type",a(e);else if(f&&2<f.split(".").length)k["default"].error("Object level access exceeded, current size : "+f.split(".").length),e.result=1,e.msg="Object level access exceeded, It mustn't be greater than 2.",a(e);else{if("room"==c){if(f)if(h=f.split("."),0==h.length)d.customRoomData=Object.assign(d.customRoomData,
b);else if(1==h.length)d.customRoomData[f]=d.customRoomData[f]?Object.assign(d.customRoomData[f],b):b;else if(2==h.length)d.customRoomData[h[0]]?d.customRoomData[h[0]][h[1]]=d.customRoomData[h[0]][h[1]]?Object.assign(d.customRoomData[h[0]][h[1]],b):b:(d.customRoomData[h[0]]={},d.customRoomData[h[0]][h[1]]=b);else{k["default"].error("Object access level exceeded, it must be atmost 2 : "+f);e.result=1;e.msg="Object level access exceeded";a(e);return}else d.customRoomData=Object.assign(d.customRoomData,
b);b=d.customRoomData}else if("session"==c){if(f)if(h=f.split("."),0==h.length)d.customSessionData=Object.assign(d.customSessionData,b);else if(1==h.length)d.customSessionData[f]=d.customSessionData[f]?Object.assign(d.customSessionData[f],b):b;else if(2==h.length)d.customSessionData[h[0]]?d.customSessionData[h[0]][h[1]]=d.customSessionData[h[0]][h[1]]?Object.assign(d.customSessionData[h[0]][h[1]],b):b:(d.customSessionData[h[0]]={},d.customSessionData[h[0]][h[1]]=b);else{k["default"].error("Object access level exceeded, it must be atmost 2 : "+
f);e.result=1;e.msg="Object level access exceeded";a(e);return}else d.customSessionData=Object.assign(d.customSessionData,b);b=d.customSessionData}"all"==g?d.socket.sendParamEvent("setCustomData",{scope:c,data:b,query:f},function(b){0!=b.result&&k["default"].error(b.msg);a(b)}):(b=Object(m.e)({type:"custom-data-updated",message:{result:0,scope:c,msg:"success"}}),d.dispatchEvent(b))}}else e.result=1,e.msg="Invalid broadcast option for scope USER, it mustn't be undefined or set to none.",a(e)}}else k["default"].error("Customer datastore subsciption isn't supported for the room !!"),
a(r.a.error_1170)};d.getCustomData=function(b,a){if(!d.subscription||void 0!==d.subscription.datastore&&!1!==d.subscription.datastore){var g={result:0};if(void 0==b||"object"!=typeof b||"object"==typeof b&&Array.isArray(b))k["default"].error("Invalid data: "+b),g.result=1,g.msg="Invalid  options",a(g);else{var c=b.scope,f=b.query,e=b.db;if(e&&"boolean"!=typeof e)k["default"].error("Invalid data type of db: "+f),g.result=1,g.msg="Invalid  data type",a(g);else if(0==da(c))g.result=1,g.msg="Invalid scope parameter: "+
c,a(g);else if(f&&"string"!=typeof f)k["default"].error("Invalid data type of query: "+f),g.result=1,g.msg="Invalid  data type",a(g);else if(f&&2<f.split(".").length)k["default"].error("Object level access exceeded, current size : "+f.split(".").length),g.result=1,g.msg="Object level access exceeded, It mustn't be greater than 2.",a(g);else if(void 0==e||0==e){if("room"==c)var h=d.customRoomData;else"session"==c?h=d.customSessionData:"user"==c&&d.userList.get(d.clientId)&&(h=d.userList.get(d.clientId).customUserData);
f?(b=f.split("."),2<b.length?(k["default"].error("Object access level exceeded, it must be atmost 2 : "+f),g.result=1,g.msg="Object level access exceeded",a(g)):void 0==h?a("No data is set wrt provided scope : "+c+", Data : "+h):0==b.length?a(h):1==b.length?h[f]?a(h[f]):a("Data wrt query doesn't exist"):2==b.length&&(h[b[0]]?h[b[0]][b[1]]?a(h[b[0]][b[1]]):a("Data wrt query doesn't exist"):a("Data wrt query doesn't exist"))):a(h)}else 1==e&&"session"!=c?(g.result=1,g.msg="Option true for db paramereter is valid for session scope only, scope used  : "+
c,a(g)):d.socket.sendParamEvent("getCustomData",{scope:c,options:b,query:f},function(b){0!=b.result&&k["default"].error(b.msg);a(b)})}}else k["default"].error("Customer datastore subsciption isn't supported for the room !!"),a(r.a.error_1170)};d.lock=function(b){Kb(!0,b)};d.unlock=function(b){Kb(!1,b)};d.dropUser=function(b,a){a=void 0===a?function(){}:a;if(void 0===b||null===b||Array.isArray(b)&&"function"===typeof a&&"moderator"===d.me.role){var g={all:!1};g.clientIds=void 0===b||null===b?[]:b;
d.socket.emitEvent(v.a.RoomEvent.drop,g,a)}else"function"===typeof a?a("moderator"!==d.me.role?r.a.error_1168:r.a.error_1155):k["default"].error("dropUser() invalid param - callback")};d.pinUsers=function(b,a){Lb(!0,b,void 0===a?function(){}:a)};d.unpinUsers=function(b,a){Lb(!1,b,void 0===a?function(){}:a)};d.addSpotlightUsers=function(b,a){Mb(!0,b,void 0===a?function(){}:a)};d.removeSpotlightUsers=function(b,a){Mb(!1,b,void 0===a?function(){}:a)};d.destroy=function(g,a){var c=function(){},f={deleteRoom:!1};
void 0!=g&&"function"===typeof g?c=g:void 0!=a&&"function"===typeof a&&(void 0!=g&&(f=g),c=a);"function"===typeof c&&"object"==typeof f&&void 0!=f.deleteRoom?"moderator"===d.me.role?d.socket.emitEvent(v.a.RoomEvent.drop,{all:!0,clients:null,deleteRoom:f.deleteRoom},function(){}):(b.a.info("room-event",p.a.event_general_success,{message:"destroy - "+r.a.error_1168}),c(r.a.error_1168)):"function"===typeof c?c(r.a.error_1155):k["default"].error("() invalid param - callback")};d.setAudioOnlyMode=function(b,
a){a=void 0===a?function(){}:a;console.log("that.setAudioOnlyMode () enable: "+b);if("audio_video"==d.mediaType&&void 0!==b&&"boolean"===typeof b&&b!=d.audioOnlyMode&&"function"===typeof a){var g=[],c={numTalkers:d.userVideoTalkerCount,numAudioTalkers:d.userAudioTalkerCount};g[0]=new Promise(function(g,a){c.numVideoTalkers=b?0:d.userVideoTalkerCount;console.log("that.setAudioOnlyMode () enable: "+b+" promise numtalkers: "+JSON.stringify(c));d.socket.emitEvent(v.a.RoomEvent.set_active_talker,c,function(b){g(b)})});
g[1]=new Promise(function(g,a){W.forEach(function(a,c){a&&a.ifVideo()?b?a.muteVideo(function(b){console.log(" promise mutevideo: "+JSON.stringify(b));g(b)},!0,0,"audioOnly"):a.unmuteVideo(function(b){console.log(" promise unmutevideo: "+JSON.stringify(b));g(b)},!0,0,"audioOnly"):(k["default"].info("audioOnlyMode()  promise no video support sId: "+a.getID()),g(r.a.error_000))})});Promise.all(g).then(function(g){console.log(" promise all values: "+JSON.stringify(g));for(var c=0;c<g.length;c++)if(0!==
g[c].result&&g[c].result!==r.a.error_1177.result){a(g[c].result);return}d.audioOnlyMode=b;a(r.a.error_000)})}else g=void 0===b||"boolean"!==typeof b?r.a.error_1168:"audio_video"!=d.mediaType?r.a.error_1202:r.a.error_1188,"function"===typeof a?a(g):k["default"].error("setAudioOnlyMode() invalid param - callback")};var Ab=function(b,a){u.a.getDeviceList({speaker:!0},function(g){var c=!1;if(0==g.result)for(var d=0;d<g.devices.speaker.length;d++)if(b&&g.devices.speaker[d].deviceId==b||!b&&g.devices.speaker[d].label.toLowerCase().includes("default")){c=
JSON.parse(JSON.stringify(g.devices.speaker[d]));break}a(c)})},Kb=function(b,a){a=void 0===a?function(){}:a;"function"===typeof a?"moderator"===d.me.role&&b!=d.locked?d.socket.emitEvent(v.a.RoomEvent.lock_room,b,function(g){0===g.result&&(d.locked=b);a(g)}):a("moderator"!==d.me.role?r.a.error_1168:r.a.error_4121):k["default"].error("lockRoom() invalid param - callback")},Lb=function(b,a,c){c=void 0===c?function(){}:c;void 0===a||null===a||Array.isArray(a)&&a.length&&"function"===typeof c&&"moderator"===
d.me.role?d.setAdvancedOptions([{id:"update-pin-users",request:b?"add":"remove",clientIds:a}],c):"function"===typeof c?c("moderator"!==d.me.role?r.a.error_1168:r.a.error_1155):k["default"].error("pinUsers() invalid param - callback")},Mb=function(b,a,c){c=void 0===c?function(){}:c;void 0===a||null===a||Array.isArray(a)&&a.length&&"function"===typeof c?d.setAdvancedOptions([{id:"spotlight-users",request:b?"add":"remove",clientIds:a}],c):"function"===typeof c?c(r.a.error_1155):k["default"].error("spotlightUsers() invalid param - callback")},
wa=function(b,a,c){c=void 0===c?function(){}:c;void 0!==b&&"string"===typeof b?d.socket.sendSDP("processFloorRequest",b,a,function(b,g){null===b?(k["default"].error("Error on "+a+" error: "+g),c(void 0,g)):c(b)}):(k["default"].error(" Floor Req : "+a+"Invalid params"),c(void 0,r.a.error_1155))};d.sendSocketEvent=function(b,a){a=void 0===a?function(){}:a;d.socket.emitEvent("logClientEvents",b,function(b,g){g?a(g,"error"):a(b,"success")})};d.createEventLog=function(b,a){var g={eventType:b,roomId:d.roomID,
logId:D.logId,timestamp:new Date};Object.assign(g,a);k["default"].info(b+" :",g);d.sendSocketEvent(g,function(g,a){k["default"].info("Logging "+b+" response:  "+JSON.stringify(g)+" , "+a+" ")})};var Hb=function(){if(!1===d.reconnectionState){d.sendRecvBitrateStats||(d.sendRecvBitrateStats=!0);var b=[],a=0;P.forEach(function(g){g.pc&&g.pc.peerConnection&&(b[a]=g.pc.peerConnection.getStats(null).then(function(b){var a;b.forEach(function(b){"candidate-pair"===b.type&&void 0!==b.availableIncomingBitrate&&
(k["default"].debug("incoming bitrate: "+b.availableIncomingBitrate),a={streamId:g.getID(),availableRecvBitrate:parseInt(b.availableIncomingBitrate)})});return a||{streamId:g.getID(),availableRecvBitrate:0}},function(b){console.log(b);return{streamId:g.getID(),availableRecvBitrate:0}}),a++)});Promise.all(b).then(function(b){for(var g=0,a=0;a<b.length;a++)g+=b[a].availableRecvBitrate;k["default"].info("Bitrates Total:"+g+" streamInfo: "+JSON.stringify(b));d.socket.emitEvent(v.a.RoomEvent.client_stats,
{media:{subscribers:{totalAvailableBw:g}}},function(b){})});k["default"].debug("Setting timeout again to execute ");setTimeout(Hb,5E3)}else d.sendRecvBitrateStats=!1},Eb=function(b,a){if(void 0==b.videoSize)if(a)b.videoSize=[ca.min.width,ca.min.height,ca.max.width,ca.max.height];else return k["default"].error(" Failed : video size undefined"),r.a.error_1184;else{a=b.videoSize[0]*b.videoSize[1];var g=b.videoSize[2]*b.videoSize[3],c=ca.min.width*ca.min.height,d=ca.max.width*ca.max.height;if(a<c||a>
d||g>d||g<c||a>g)return k["default"].error(" Failed : video size invalid minPixelsSet:"+a+" minPixelsConfig:"+c+" maxPixelsSet: "+g+" maxPixelsConfig: "+d+" req: min: "+b.videoSize[0]+" X "+b.videoSize[1]+" max: "+b.videoSize[2]+" X "+b.videoSize[3]+" config: min: "+ca.min.width+" X "+ca.min.height+" max: "+ca.max.width+" X "+ca.max.height),r.a.error_1184}return r.a.error_000};d.initPublishStream=function(g,a,c,f){if(void 0!==a){if(void 0!=a.stream){var e=a.stream;if(e.audio||e.video)return e.stream?
(void 0!=g&&null!==document.getElementById(g)&&e.play(g,a.options),c(e)):e.init(),e;k["default"].error(" Failed : initPublishStream(): audio and video disabled in input stream");b.a.error("room-event",p.a.event_general_failed,{message:"initPublishStream - a/v disabled in input stream"});f(r.a.error_1146);return}if(a.audio||a.video||a.screen||a.canvas){a.video&&d.mediaConfiguration!==v.a.constant.H264_CODEC&&"safari"===x.a.browser_info.name&&x.a.browser_info.version<=v.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&
(a.video=!1,k["default"].info("Stream publish in Init publish:- SAFARI - false"));if(a.video&!a.canvas){var h=Eb(a,!0);if(h.result!==r.a.error_000.result){k["default"].error(" Failed : initPublishStream(): video size invalid");b.a.error("room-event",p.a.event_general_failed,{message:"initPublishStream - video size invalid"});f(h);return}}k["default"].debug("video Size: "+JSON.stringify(ca)+" config.video_resolution_range: "+x.a.video_resolution_range+" token.roomMeta.settings.quality: "+D.roomMeta.settings.quality+
" room meta: "+JSON.stringify(D.roomMeta)+" video Size: "+x.a.video_resolution_range[D.roomMeta.settings.quality]);void 0!=a.videoSize&&a.videoSize.length||(a.videoSize=[ca.min.width,ca.min.height,ca.max.width,ca.max.height]);e=EnxRtc.EnxStream(a)}else k["default"].error(" Failed : all stream opions (audio/video/screen/canvas)  false/undefined"),b.a.error("room-event",p.a.event_general_failed,{message:"initPublishStream - all stream opions (audio/video/screen/canvas) false/undefined"}),f(r.a.error_1155)}else b.a.info("room-event",
p.a.event_stream_publish_success,{message:"initPublishStream - success"}),e=EnxRtc.EnxStream({audio:!0,video:!0,data:!0,videoSize:[ca.min.width,ca.min.height,ca.max.width,ca.max.height]});"IE"===u.a.browserEngineCheck()?document.getElementById("WebrtcEverywherePluginId").addEventListener("media-access-allowed",function(b){k["default"].info("got media access:- "+JSON.stringify(b));null!==document.getElementById(g)&&e.play(g);c()}):(e.addEventListener("media-access-denied",f),e.addEventListener("media-access-failed",
f),e.addEventListener("media-access-allowed",function(b){null!==document.getElementById(g)&&e.play(g,a.options);c(b.stream)}));e.init();return e};var Jb=function(g,a){var c={video:!0,data:!0,screen:!0,fps:d.screenResolutionRange.fps,attributes:{name:"share"}};d.whoAmI(function(b){c.attributes.name=b.name+"_share"});c.audio=void 0!=g&&void 0!=g.audio?g.audio:!1;return d.initPublishStream("",c,function(){b.a.info("room-event",p.a.event_start_screenshare_success,{error:{}});a(!0)},function(g){"OverconstrainedError"===
g.msg.name&&k["default"].info("Resolution selected is not supported by your webcam");b.a.error("room-event",p.a.event_start_screenshare_failed,{event:g});a(g.msg)})},Nb=function(b,a,c){a=void 0===a?null:a;if(b)return b;a.style.position="relative";b=document.createElement("div");b.setAttribute("class","annotate-div");b.setAttribute("style","display:flex;justify-content: center;align-items: center;height: 100%;width: 100%;");if(c){var g=document.querySelector("#player_"+c.getID()).parentElement;if(g){var f=
document.createElement("canvas"),e=d.canvasVideoPlayer+"_veneer";f.id=e;f.width=a?a.clientWidth:d.canvasOptions.width;f.height=a?a.clientHeight:d.canvasOptions.height;a.style.height=f.height+"px";a.style.width=f.width+"px";f.className=d.canvasVideoPlayer+"_input_veneer";f.setAttribute("style","display:none;");document.body.appendChild(f);if(a){d.canvasOptions.width=a.clientWidth;d.canvasOptions.height=a.clientHeight;var k=document.createElement("div");k.setAttribute("id","canvas-wrapper");k.setAttribute("class",
"canvas-wrapper");if(!f)return;k.style.width=f.width+"px";k.style.height=f.height+"px";k.style.position="absolute";k.style.top="0%";k.append(f);A.a.appendCustomCanvas(k,f.className,f.width,f.height);A.a.appendCanvasFrame(k,f.className,f.width,f.height,c);document.getElementById(a.id)&&document.getElementById(a.id).appendChild(k)}else document.body.appendChild(wrapper);null!=a&&(b.appendChild(a),g.prepend(b));A.a.bindEventListernersForTools();d.inputContext=f.getContext("2d");A.a.startFrame();A.a.pause_play();
cd();return e}}},cd=function(){var b=A.a.getVideoFrameId(),a=document.getElementById(b);if(a){b=A.a.getCanvasId();var c=document.getElementById(b);c&&(mb=setInterval(function(){d.inputContext.globalAlpha=.1;0<a.width&&0<a.height&&0<A.a.getCanvasWidth()&&0<A.a.getCanvasHeight()&&d.inputContext.drawImage(a,0,0,A.a.getCanvasWidth(),A.a.getCanvasHeight());d.inputContext.globalAlpha=1;0<c.width&&0<c.height&&0<A.a.getCanvasWidth()&&0<A.a.getCanvasHeight()&&d.inputContext.drawImage(c,0,0,A.a.getCanvasWidth(),
A.a.getCanvasHeight())},.3))}};d.annotateToolAction=function(b,a){A.a.toolBarAction(b,a)};d.startAnnotation=function(g,a){var c=document.getElementById("canvas-wrapper");c&&c.remove();try{if(g){var f=g.getID(),e=document.querySelector("#player_"+f);if(e){var h=hb();k["default"].info(h,"status");d.canvas_video_player=document.getElementById("stream"+f);if(d.canvas_video_player)if(d.canvasVideoPlayer="stream"+f,h.result===r.a.error_000.result){var m=Nb(null,e,g);d.startCanvas({canvasSelector:m,fps:23,
canvasType:"Annotation"},function(b){0==b.result&&a&&a(h)});lb=!1;La=!0;b.a.info("room-event",p.a.event_start_annotation_success,{error:{}});A.a.mouseAnnotate(m,d.inputContext,"player_"+f,g)}else a&&a(h)}}}catch($a){console.info($a,"error"),k["default"].error("incorrect annotate params "+$a),b.a.error("room-event",p.a.event_start_annotation_failed,{error:$a}),a&&a(r.a.error_1155)}};d.stopAnnotation=function(b){La=!1;d.stopCanvas(b);A.a.stopAnnotation();clearInterval(mb)};d.adjustCanvas=function(){A.a.resize()};
d.startCanvas=function(g,a){a=void 0===a?function(){}:a;if("function"===typeof a){var c,f,e=g?g.canvasSelector:"";try{var h=hb();h.result===r.a.error_000.result?d.socket.emitEvent("auxilaryPublishRequests",{req:"start",pubType:"canvas"},function(m){if(m.result==r.a.error_000.result){f=Nb(e);if(g){m=g.fps?g.fps:d.canvasOptions.fps;var q=g.canvasType?g.canvasType:"default"}else m=d.canvasOptions.fps,q="default";c=dd({domHandle:f,fps:23<m?23:m,canvasType:q,refreshFn:g.refreshFn,maxRefreshRate:d.maxCanvasRefreshRate},
function(g,c){"success"===c?d.publish(g,{canvas:!0,canvasType:q,maxVideoBW:x.a.video_bandwidth_range.canvas.max,minVideoBW:x.a.video_bandwidth_range.canvas.min},function(g){0===g.result&&(k["default"].info("startCanvas response.result:",g),b.a.info("room-event",p.a.event_start_canvas_success,{error:{}}),za(d.shareStatus,!0),a&&a(g))}):a&&a(g)})}else a&&a(h)}):a&&a(h)}catch(ob){k["default"].error("incorrect canvas params "+ob),b.a.error("room-event",p.a.event_start_canvas_failed,{error:ob}),a&&a(r.a.error_1155)}return c}k["default"].error("startCanvas() invalid param - callback")};
d.playVideo=function(b,a,c){d.canvasVideoPlayer=b;b=document.querySelector("#"+b);void 0===b||null===b?c(r.a.error_1162):(d.canvas_video_player=b,a&&(d.canvasOptions.width=a.width?a.width:d.canvasOptions.width,d.canvasOptions.height=a.height?a.height:d.canvasOptions.height,d.canvasOptions.fps=a.fps?a.fps:23),d.startCanvas({fps:a.fps},c))};d.stopCanvas=function(a){a=void 0===a?function(){}:a;if("function"===typeof a){var g=hb();if(g.result===r.a.error_000.result){var c;d.localStreams.forEach(function(g){g&&
g.ifCanvas()&&(Ua(!1,!0),c=g,g.stream.getTracks().forEach(function(b){b.stop()}),g.onConnectionStateChanged(!1),g.close(),b.a.info("room-event",p.a.event_stop_canvas_success,{error:{}}),a({result:0,msg:"Canvas stopped successfully."}))});za(d.shareStatus,!1);void 0!=c&&d.localStreams.remove(c.getID())}else b.a.error("room-event",p.a.event_stop_canvas_failed,{error:{}}),a(g)}else k["default"].error("stopCanvas() invalid param - callback")};d.isModerator=function(){return d.me&&"moderator"===d.me.role};
var Fa=function(b,a,c,f,e,k){a=ed(a,c,!0);a.result===r.a.error_000.result&&(f||e&&"string"===typeof e)?d.socket.sendMessage(b,{clientId:e},function(b){k(b)}):k(a.result!==r.a.error_000.result?a:r.a.error_1155)},ed=function(b,a,c){b=!d.subscription||(!a||d.subscription.audio_video&&"audio_video"==d.mediaType)&&(!b||d.subscription.audio_only||d.subscription.audio_video);if(d&&b&&(!c||"moderator"===d.me.role))return r.a.error_000;c=d?b?r.a.error_1168:r.a.error_1170:r.a.error_1171;k["default"].error("validatePermission error code "+
c.result);return c},hb=function(){if(d&&d.subscription&&("lecture"!==d.mode||"moderator"===d.me.role||!0===d.floorGranted))return r.a.error_000;var b=d?d.subscription?r.a.error_1170:r.a.error_1173:r.a.error_1171;k["default"].error("validateCanvas() error code "+b.result);return b},dd=function(b,a){var g=null,c={video:!0,canvas:!0,attributes:{name:"canvas"}};!1===c.canvas&&(c.canvas=!0);!1===c.video&&(c.video=!0);!0===c.audio&&(c.audio=!1);c.div||(c.div=b.domHandle);c.fps||(c.fps=b.fps);void 0!=b.refreshFn&&
(c.refreshFn=b.refreshFn,c.maxCanvasRefreshRate=b.maxRefreshRate);void 0===c.attributes?c.attributes={name:"canvas"}:(void 0===c.attributes.name||"canvas"===c.attributes.name)&&d.whoAmI(function(b){c.attributes.name=b.name+"_canvas"});c.videoSize=[1920,1080,1920,1080];k["default"].info("initcanvas config "+JSON.stringify(c));d.initPublishStream("",c,function(b){g=b;a(g,"success")},function(b){"OverconstrainedError"===b.msg.name&&k["default"].info("Resolution selected is not supported by your webcam");
a(b.msg,"error")});return g},fd=function(b){var a=null;d.isCanvasSharing=!0;d.clientId==b.clientId&&(d.isCanvasSharingClient=!0);lb?a=Object(m.e)({type:"annotation-started-ack",message:{clientId:b.clientId,name:b.name,streamId:b.streamId,canvasType:b.canvasType}}):"Annotation"===b.canvasType?(La=!0,a=Object(m.e)({type:"canvas-started",message:{clientId:b.clientId,name:b.name,streamId:b.streamId,canvasType:b.canvasType}})):(d.canvasStatus=!0,La&&(d.canvasStatus=!1),La=!1,a=Object(m.e)({type:"canvas-started",
message:{clientId:b.clientId,name:b.name,streamId:b.streamId,canvasType:b.canvasType?b.canvasType:"default"}}));za(d.shareStatus,!0);d.dispatchEvent(a);k["default"].debug("onCanvasStarted event :",JSON.stringify(a));b.streamId?(b=P.get(b.streamId))&&!b.failed?b._setStaticQualityLayer(2,-1,function(b){k["default"].info("stream._setStaticQualityLayer (2/-1) for canvas result : "+b)}):k["default"].error("canvas started:stream is undefined or failed"):k["default"].error("canvas arg.streamId is undefined")},
gd=function(b){b=Object(m.e)({type:"canvas-stopped",message:{clientId:b.clientId,name:b.name,streamId:b.streamId}});d.canvasStatus=!1;d.isCanvasSharing=!1;za(d.shareStatus,!1);k["default"].debug("onCanvasStopped event :",JSON.stringify(b));d.dispatchEvent(b);d.isCanvasSharingClient=!1},hd=function(b){k["default"].info("canvasStateEvents");!0===b.videomuted?(b=Object(m.e)({type:"canvas-state-events",message:"Canvas stopped",reason:"bw"}),d.dispatchEvent(b)):(b=Object(m.e)({type:"canvas-state-events",
message:"Canvas resumed",reason:"bw"}),d.dispatchEvent(b))},id=function(b){k["default"].info("shareStateEvents");!0===b.videomuted?(b=Object(m.e)({type:"share-state-events",message:"Share stopped",reason:"bw"}),d.dispatchEvent(b)):(b=Object(m.e)({type:"share-state-events",message:"Share resumed",reason:"bw"}),d.dispatchEvent(b))},jd=function(b){if("speaker_notification"===b.id){b.id="talker-notification";for(var a={},g=$jscomp.makeIterator(b.data),c=g.next();!c.done;c=g.next())c=c.value,!0===c.speech?
a.speech=c.users:!0===c.noise&&(a.noise=c.users);b=Object(m.e)({type:b.id,message:a});d.dispatchEvent(b)}else b=Object(m.e)({type:b.id,message:b.data}),d.dispatchEvent(b)},kd=function(b){k["default"].info("onUserRoleChangedEvent"+JSON.stringify(b)+" ownclientId: "+d.clientId);if(b.clientsInfo){for(var a=0;a<b.clientsInfo.length;a++){var g=b.clientsInfo[a];if(b.clientsInfo[a].clientId==d.clientId)if("audience"!=g.role.new&&"audience"!=g.role.old){if("moderator"==g.role.new)if("participant"===d.me.role){g.sharePermissions&&
(d.sharePermissions.screen.approved=b.sharePermissions.screen.approved,d.sharePermissions.screen.pending=b.sharePermissions.screen.pending,d.sharePermissions.canvas.approved=b.sharePermissions.canvas.approved,d.sharePermissions.canvas.pending=b.sharePermissions.canvas.pending);d.me.role="moderator";if(b.awaitedParticipants)for(var c in b.awaitedParticipants)d.awaitedParticipants.set(b.awaitedParticipants[c].clientId,{clientId:b.awaitedParticipants[c].clientId,name:b.awaitedParticipants[c].name});
"lecture"===d.mode&&(d.cCrequest=[],d.cCapprovedHands=[],b.raisedHands.length&&b.raisedHands.forEach(function(b){d.cCrequest.push(b)}),b.approvedHands.length&&b.approvedHands.forEach(function(b){d.cCapprovedHands.push(b)}));b.userRoleChangeRequests&&(d.userRoleChangeRequests=b.userRoleChangeRequests.slice())}else k["default"].info("onUserRoleChangedEvent() already moderator - no change");else if("moderator"==g.role.old){d.me.role="participant";d.userRoleChangeRequests=[];if(b.userList){d.userList.clear();
for(var f in b.userList)d.userList.set(b.userList[f].clientId,b.userList[f])}Xa("role-change",!1,!1,"lecture"===d.mode,!1,!0,!1)}else k["default"].info("onUserRoleChangedEvent() Already partcipant - no change");void 0==b.userList&&g.user&&d.userList.set(g.clientId,g.user)}else d.me.role=g.role.new,"moderator"==g.role.new||"participant"==g.role.new?Bb({subsStreamInfo:b.subsStreamInfo,users:b.userList,room:d.roomMeta,me:d.me,mediaRecord:d.mediaRecord},"role-change"):("moderator"==g.role.old&&(d.userRoleChangeRequests=
[]),Xa("role-change",!1,!0,!0,!1,!0,!0));else{if("moderator"!=g.role.old){var e=void 0;d.sharePermissions.screen.pending&&-1==(e=d.sharePermissions.screen.pending.indexOf(g.clientId))?d.sharePermissions.screen.pending.splice(e,1):d.sharePermissions.screen.approved&&-1==(e=d.sharePermissions.screen.approved.indexOf(g.clientId))&&d.sharePermissions.screen.approved.splice(e,1);d.sharePermissions.canvas.pending&&-1==(e=d.sharePermissions.canvas.pending.indexOf(g.clientId))?d.sharePermissions.screen.pending.splice(e,
1):d.sharePermissions.canvas.approved&&-1==(e=d.sharePermissions.canvas.approved.indexOf(g.clientId))&&d.sharePermissions.screen.approved.splice(e,1);Da(g.clientId);yb(g.clientId)}"audience"==g.role.new?d.userList.delete(b.clientsInfo[a].clientId):void 0==b.userList&&g.user&&(g.user.clientId=g.clientId,qb(g.user))}Ma(b.clientsInfo[a].clientId)}d.audienceCount=b.audienceCount;if(b.userList){d.userList.clear();for(var h in b.userList)d.userList.set(b.userList[h].clientId,b.userList[h])}d.dispatchEvent(Object(m.e)({type:"user-role-changed",
message:b}))}else{if(b.moderator.new===d.clientId)if("participant"===d.me.role){b.sharePermissions&&(d.sharePermissions.screen.approved=b.sharePermissions.screen.approved,d.sharePermissions.screen.pending=b.sharePermissions.screen.pending,d.sharePermissions.canvas.approved=b.sharePermissions.canvas.approved,d.sharePermissions.canvas.pending=b.sharePermissions.canvas.pending);d.me.role="moderator";if(b.userList)for(a in d.userList.clear(),b.userList)d.userList.set(b.userList[a].clientId,b.userList[a]);
if(b.awaitedParticipants)for(g in b.awaitedParticipants)d.awaitedParticipants.set(b.awaitedParticipants[g].clientId,{clientId:b.awaitedParticipants[g].clientId,name:b.awaitedParticipants[g].name});"lecture"===d.mode&&(d.cCrequest=[],d.cCapprovedHands=[],b.raisedHands.length&&b.raisedHands.forEach(function(b){d.cCrequest.push(b)}),b.approvedHands.length&&b.approvedHands.forEach(function(b){d.cCapprovedHands.push(b)}))}else k["default"].info("onUserRoleChangedEvent() already Moderator - no change");
else if(b.moderator.old===d.clientId)if("moderator"===d.me.role){d.me.role="participant";if(b.userList)for(e in d.userList.clear(),b.userList)d.userList.set(b.userList[e].clientId,b.userList[e]);Xa("role-change",!1,!1,"lecture"===d.mode,!1,!0,!1)}else k["default"].info("onUserRoleChangedEvent() already partcipant - no change");else"moderator"===d.me.role&&(c=function(b,a){var g=d.sharePermissions[b].pending.indexOf(a);-1!=g?d.sharePermissions[b].pending.splice(g,1):-1!=(g=d.sharePermissions[b].approved.indexOf(a))&&
d.sharePermissions[b].approved.splice(g,1)},c("screen",b.moderator.new),c("canvas",b.moderator.new),"lecture"===d.mode&&(yb(b.moderator.new)||Da(b.moderator.new))),(c=d.userList.get(b.moderator.new))&&"participant"==c.role&&(c.role="moderator"),(c=d.userList.get(b.moderator.old))&&"moderator"==c.role&&(c.role="participant");b=Object(m.e)({type:"user-role-changed",message:b});d.dispatchEvent(b)}},ld=function(b){k["default"].info(" onUserRoleChangeEvents: "+JSON.stringify(b));var a=function(b,a){var g=
a.clientId==d.clientId?!0:!1;Ma(a.clientId)&&(g=!0);g&&d.dispatchEvent(Object(m.e)({type:b,message:a}))};switch(b.id){case "requestInitiated":d.userRoleChangeRequests.push({clientId:b.clientId,name:b.name,role:b.role});d.dispatchEvent(Object(m.e)({type:"user-role-change-requested",message:b}));break;case "requestCancelled":a("user-role-change-cancelled",b);break;case "requestAccepted":a("user-role-change-accepted",b);break;case "requestDenied":a("user-role-change-denied",b);break;default:k["default"].error("onUserRoleManagementEvents() unknown message: "+
JSON.stringify(b))}},md=function(a){k["default"].debug("onUserRoleChangedEvent"+JSON.stringify(a)+" ownclientId: "+d.clientId);"lecture"===d.mode?(d.mode="group",d.roomSettings.mode="group",d.cCrequest=[],d.cCapprovedHands=[]):"group"===d.mode&&(d.roomSettings.mode="lecture",d.mode="lecture",d.cCrequest=[],d.cCapprovedHands=[],"participant"===d.me.role?W.forEach(function(a,g){d.unpublish(a,function(g){1==g?k["default"].info("stream has been un-published"):(k["default"].info("error during stream un-publishing"),
b.a.error("room-event",p.a.event_stream_unpublish_failed,{stream:a}))})}):k["default"].info("onUserRoleChangedEvent() Already Moderator - no change"));a=Object(m.e)({type:"room-mode-switched",message:{mode:d.mode,moderator:a.moderator}});d.dispatchEvent(a)},nd=function(b){k["default"].info("onRoomManagementEvents:"+JSON.stringify(b));var a={};switch(b.id){case "room-locked":case "room-unlocked":d.locked="room-locked"===b.id;a=b.msg;break;case "floor-opened":d.floorOpen=!0;break;case "floor-closed":d.floorOpen=
!1;break;case "knock-enabled":d.knockEnabled=!0;break;case "knock-disabled":d.knockEnabled=!1;d.awaitedParticipants.clear();break;case "wait-room-disabled":d.waitRoom&&(d.waitRoom=!1);if(d.isStreamingClient){if(P.size()){k["default"].info("onRoomManagementEvents() wait-room-disabled streaming client & subs streams ignoring ");break}k["default"].info("onRoomManagementEvents() wait-room-disabled streaming client but no subscribed streams  ")}Ta(b.roomData.dataChannelStream);a=zb(b.roomData.streams||
[],b.roomData.numActiveATSubs);var g=b.roomData.userList,c;for(c in g)d.userList.set(g[c].clientId,g[c]);d.videoMutedUsers=b.roomData.videoMutedUsers||[];a={streams:a,users:g};break;case "privacy-modes-updated":d.privacyModes=b.modes;a.modes=b.modes;if(b.userList)for(g in a.userList=b.userList,b.userList)d.userList.set(b.userList[g].clientId,b.userList[g]);break;case "conf-media-activated":Gb("event");break;default:a=b.msg}b=Object(m.e)({type:b.id,message:a});d.dispatchEvent(b)},od=function(b){k["default"].info("Recieved an invite to join breakout room "+
JSON.stringify(b));k["default"].info("Join Breakout Room event dispatched");if(!0===b.force_join){var a=Object(m.e)({type:"breakout-room-joining",message:{room_id:b.room_id,requestor:b.requestor}});d.dispatchEvent(a);d.muteRoom({audio:!0,video:!0},function(a){0===a.result?W.forEach(function(a,g){a.screen||a.canvas||!a.ifAudio()&&!a.ifVideo()||d.joinBreakOutRoom({room_id:b.room_id,role:"participant"},{audio:!0,video:b.video?b.video:!1},function(b,a){b?(b=Object(m.e)({type:"breakout-room-connected",
streams:b.streams,room:b.room,roomData:b.roomData,localBreakoutStream:b.localBreakoutStream}),d.dispatchEvent(b)):a&&(b=Object(m.e)({type:"breakout-room-error",message:a}),d.dispatchEvent(b))})}):(a=Object(m.e)({type:"breakout-room-error"},{message:"mute room request failed"}),d.dispatchEvent(a))})}else a=Object(m.e)({type:"join-breakout-room",message:{room_id:b.room_id,requestor:b.requestor}}),d.dispatchEvent(a)};d.rejectBreakoutRoomInvite=function(b,a){a=void 0===a?function(){}:a;k["default"].info("Rejecting the breakout room invite ",
b);b?d.socket.sendMessage("reject-breakout-room",b,function(b){b&&(k["default"].info("Reject breakout room, result: "+JSON.stringify(b)),a(b))}):(k["default"].info("Invalid value room_id"),a&&a(r.a.error_1155))};var pd=function(b){k["default"].info("Recieved user joined breakout room "+JSON.stringify(b));b=Object(m.e)({type:"user-joined-breakout-room",message:{clientId:b.client}});d.dispatchEvent(b)},qd=function(b){k["default"].info("USER DISCONNECTED BREAKOUT ROOM "+JSON.stringify(b));b=Object(m.e)({type:"user-disconnected-breakout-room",
message:{name:b.name,clientId:b.clientId,room:b.room}});d.dispatchEvent(b)},rd=function(b){k["default"].info("BREAKOUT ROOM DESTROYED"+JSON.stringify(b));b=Object(m.e)({type:"breakout-room-destroyed",message:{room_id:b.room_id}});d.dispatchEvent(b)},sd=function(b){k["default"].debug("Received Analytics events: "+JSON.stringify(b));b=Object(m.e)({type:"meeting-summary-events",message:{data:b}});d.dispatchEvent(b)},td=function(b){k["default"].info("Received Meeting Summary Subscription Event : "+JSON.stringify(b));
b=Object(m.e)({type:"meeting-summary-subscription",message:{data:b}});d.dispatchEvent(b)},ud=function(b){k["default"].debug("Received transcription events: "+JSON.stringify(b));"transcription-started"===b.type?("room"===b.transcription_type?d.liveRoomTranscription=!0:d.liveTranscription=!0,d.transcriptionLanguage=b.language):"transcription-stopped"===b.type&&("room"===b.transcription_type?d.liveRoomTranscription=!1:d.liveTranscription=!1);b=Object(m.e)({type:"transcription-events",message:{data:b}});
d.dispatchEvent(b)};d.extendConferenceDuration=function(b){b=void 0===b?function(){}:b;"function"===typeof b?d.socket.emitEvent(v.a.RoomEvent.extend_conference_duration,{},function(a){b(a)}):k["default"].error("extendConferenceDuration() : failed Invalid param. callback is not function")};d.subscribeMediaStats=function(b,a){a=void 0===a?function(){}:a;if(void 0!==b&&"string"===typeof b&&"function"===typeof a)if(2!==d.state||d.mediaStatsMode==b||"disable"!=b&&"notify"!=b&&"display"!=b&&"notify-display"!=
b){var g=2!==d.state?r.a.error_1171:d.mediaStatsMode==b?r.a.error_1188:r.a.error_1155;k["default"].error("that.subscribeMediaStats () error: "+JSON.stringify(g));a(g)}else{var c=function(b){var a=document.querySelectorAll(".stats-container"),g=document.querySelectorAll(".stats-overlay");a.forEach(function(a){void 0!==a&&null!==a&&(a.style.display=b)});g.forEach(function(a){void 0!==a&&null!==a&&(a.style.display=b)})};"disable"==b||"disable"==d.mediaStatsMode?W.forEach(function(a,g){a.ifCanvas()||
a.ifScreen()||y.sendMessage("subscribeStreamStatsForClient",{streamId:g,statsEnabled:"disable"!=b},function(a){void 0!=a&&("Success"===a.status&&c("display"==b||"notify-display"==b?"block":"none"),d.mediaStatsMode=b)})}):(c("display"==b||"notify-display"==b?"block":"none"),d.mediaStatsMode=b)}else k["default"].error("that.subscribeMediaStats () invalid param "),"function"===typeof a&&a(r.a.error_1155)};d.subscribeStreamStatsForClient=function(b,a,c){c=void 0===c?function(){}:c;var g=function(b){var a=
document.querySelectorAll(".stats-container"),g=document.querySelectorAll(".stats-overlay");d.mediaStatsMode=b?"display":"disable";d.subscribeSessionStats=b;a.forEach(function(a){void 0!==a&&null!==a&&(a.style.display=b?"block":"none")});g.forEach(function(a){void 0!==a&&null!==a&&(a.style.display=b?"block":"none")})};if("chrome-stable"===x.a.browser_info.name||x.a.browser_info.name)g(a),d.getStats(a,{intervalSecs:2,log:!1},function(b){}),c({status:"Success"});else{if(!y)return"Error getting stats - no socket";
if(!b)return"Error getting stats - no stream";y.sendMessage("subscribeStreamStatsForClient",{streamId:b.getID(),statsEnabled:a},function(b){if(b){var g=document.querySelectorAll(".stats-container"),f=document.querySelectorAll(".stats-overlay");"Success"===b.status&&!0===a?(d.mediaStatsMode="display",d.subscribeSessionStats=!0,g.forEach(function(b){void 0!==b&&null!==b&&(b.style.display="block")}),f.forEach(function(b){void 0!==b&&null!==b&&(b.style.display="block")})):(d.mediaStatsMode="disable",
d.subscribeSessionStats=!1,g.forEach(function(b){void 0!==b&&null!==b&&(b.style.display="none")}),f.forEach(function(b){void 0!==b&&null!==b&&(b.style.display="none")}));c(b)}})}};d.subscribeForTalkerNotification=function(b,a){a=void 0===a?function(){}:a;if("function"===typeof a){if(!y)return"Error subscribing - no socket";d.setAdvancedOptions([{id:"speaker-notification",enable:b}],a)}else k["default"].error("subscribeForTalkerNotification() invalid param - Callback")};d.manageStatsSubscription=function(b){"disable"!=
d.mediaStatsMode?(b=d.mediaStatsMode,d.mediaStatsMode="disable",d.subscribeMediaStats(b,function(b){})):!0===d.subscribeSessionStats?(k["default"].info("resubscribe session stats"),d.subscribeStreamStatsForClient(b,d.subscribeSessionStats)):k["default"].info("session stats not subscribed")};d.reconPubSubFailed=function(b){k["default"].info("reconnect publish or subscribe failed",b);va(!0,!1,"reconnectPubSubFailed")};d.manageNumTalker=function(){k["default"].info("Reset the preferred number of active talkers");
-1!==V?d.setTalkerCount(V,function(b){k["default"].info("reset active talker",b)}):k["default"].info("Use default prefrence of number of active talkers")};d.startLiveMeetingSummary=function(b,a){var g={};void 0===b||void 0===a?(k["default"].error("subscribeForLiveTranscription() invalid parameters"),void 0!==b&&"function"===typeof b&&a(response.error_1155)):(k["default"].info("Starting the live meeting analytics for the room"),g.language=void 0!==b&&void 0!==b.language?b.language:"english_us",g.moderator_only=
void 0!==b&&void 0!==b.moderator_only&&"boolean"===typeof b.moderator_only?b.moderator_only:!1,g.record_summary=void 0!==b&&void 0!==b.record_summary&&"boolean"===typeof b.record_summary?b.record_summary:!1,!1===d.liveMeetingAnalytics?d.socket.sendMessage("startLiveMeetingAnalytics",g,function(b){b&&0===b.result&&(k["default"].info("Setting the live meeting analytics for room"),d.liveMeetingAnalytics=!0);a&&(k["default"].info("Sending the callbacks"),a(b))}):a&&a(r.a.error_8003))};d.stopLiveMeetingSummary=
function(b){b=void 0===b?function(){}:b;var a={};!0===d.liveMeetingAnalytics||!0===d.isAnalyticsStarted?d.socket.sendMessage("stopLiveMeetingAnalytics",a,function(a){d.liveMeetingAnalytics=!1;3001===a.result?b(r.a.error_8004):b(a)}):b(r.a.error_8004)};d.subscribeForLiveSummary=function(b,a){var g={};void 0===b||void 0===a?(k["default"].error("subscribeForLiveSummary() invalid parameters"),void 0!==b&&"function"===typeof b&&a(r.a.error_1155)):(g.enable=void 0!==b&&void 0!==b.enable&&"boolean"===typeof b.enable?
b.enable:!1,k["default"].info("subscribe for live summary "+b.enable),d.socket.sendMessage("subscribeForLiveSummary",g,function(b){a(b)}))};d.getLiveMeetingSummary=function(b,a){a=void 0===a?function(){}:a;var g={};void 0===b||void 0===a?(k["default"].info("getLiveMeetingSummary invalid parameters"),a(r.a.error_1155)):(g.operation=void 0!==b?b:"abstract_summary",-1!==C.indexOf(b)?(k["default"].info("get the live meeting analytics for the room"),d.socket.sendMessage("getLiveMeetingAnalytics",g,function(b){k["default"].info("getLiveMeetingAnalytics returned "+
b);a(b)})):a(r.a.error_1155))};d.startLiveTranscription=function(b,a){var g={};k["default"].info("Starting the live transcription for the room");void 0===b&&void 0===a?(g.language="english_us",g.room=!0):void 0===a?b&&"function"===typeof b?(a=b,g.room=!0,g.language="english_us",k["default"].info("Parameter null callback is params",JSON.stringify(g))):(g.room=!0,void 0===b?(k["default"].error("Language parameter undefined, going ahead with default english_us"),g.language="english_us"):(g.language=
b,k["default"].info("Parameter null callback is params",JSON.stringify(g)))):(g.room=!0,g.language=b);!1===d.liveRoomTranscription?d.socket.sendMessage("startLiveTranscription",g,function(b){b&&0===b.result&&(k["default"].info("Setting the live transcription for room"),d.liveRoomTranscription=!0);a&&(k["default"].info("Sending the callbacks"),a(b))}):a&&a(r.a.error_8001)};d.subscribeForLiveTranscription=function(b,a){var g={};void 0===b||void 0===a?(k["default"].error("subscribeForLiveTranscription() invalid parameters"),
void 0!==b&&"function"===typeof b&&b(response.error_1155)):void 0!==b&&void 0!==b.enable&&"boolean"===typeof b.enable?!0===b.enable?(!0===d.liveRoomTranscription?g.language=d.transcriptionLanguage:void 0!==b.language&&(g.language=b.language),!1===d.liveTranscription?d.socket.sendMessage("startLiveTranscription",g,function(b){b&&0===b.result&&(d.liveTranscription=!0);a&&a(b)}):a&&a(r.a.error_8001)):(b={client:!0},!0===d.liveTranscription?d.socket.sendMessage("stopLiveTranscription",b,function(b){d.liveTranscription=
!1;a(b)}):a(r.a.error_8002)):a(response.error_1155)};d.stopLiveTranscription=function(b){b=void 0===b?function(){}:b;var a={};!0===d.liveRoomTranscription?(a.room=!0,d.socket.sendMessage("stopLiveTranscription",a,function(a){d.liveRoomTranscription=!1;b(a)})):b(r.a.error_8002)};d.makeOutboundCall=function(a,c,f,e){e=void 0===e?function(){}:e;if("function"===typeof e){var g=!(d.subscription&&!1===d.subscription.sip_outbound),h={};void 0===f?h.silent_join=!0:(void 0!==f.name&&(h.name=f.name),void 0!==
f.early_media&&"boolean"==typeof f.early_media?h.early_media=f.early_media:h.silent_join=void 0!==f.silent_join&&"boolean"==typeof f.silent_join?f.silent_join:!0);!0===g?null!=a&&(console.log("Options: "+JSON.stringify(h)),d.socket.sendMessage("makeOutboundCall",{number:a,caller_id:c,options:h},function(b){b&&0===b.result?(d.dialOutList.set(a,{initiator:!0,state:"initiated"}),k["default"].info("Outbound call initiated for the number: "+a)):b&&1141===b.result?k["default"].error("Outbound call is in progress for the number: "+
a):k["default"].info("Received "+JSON.stringify(b)+" for outbound number: "+a);e&&e(b)})):!g&&e&&(b.a.error("room-event",p.a.event_general_failed,{message:"makeOutboundCall - not allowed"}),e(r.a.error_1170))}else k["default"].error("makeOutboundCall() invalid param - callback")};d.sendDTMF=function(b,a){if(void 0==b&&void 0==a)k["default"].error("Invalid options");else if(b&&void 0!=b.number){var g=d.dialOutList.get(b.number);k["default"].debug("dialState: "+JSON.stringify(g));"connected"!=g.state?
(k["default"].error("wrong dial state"),a&&a(error_1201)):b&&b.digits?d.socket.sendMessage("sendDTMF",{number:b.number,digits:b.digits},function(b){k["default"].debug("sendDTMF response is "+JSON.stringify(b));a&&a(b)}):(k["default"].error("Invalid options, digits is missing"),a&&a(error_1155))}else k["default"].error("Invalid options, number is missing"),a&&a(error_1155)};d.cancelOutboundCall=function(a,c){var g=d.dialOutList.get(a);void 0===g?"moderator"===d.me.role?d.socket.sendMessage("cancelOutboundCall",
{number:a},function(a){k["default"].info("Cancel outbound call, response received is "+JSON.stringify(a));b.a.info("room-event",p.a.event_general_success,{message:"cancelOutboundCall - success"});c&&c(a)}):c&&(b.a.error("room-event",p.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),c({result:1705,msg:"Insufficient Privileges"})):"moderator"===d.me.role||!0===g.initiator?d.socket.sendMessage("cancelOutboundCall",{number:a},function(a){k["default"].info("Cancel outbound call, response received is "+
JSON.stringify(a));b.a.info("room-event",p.a.event_general_success,{message:"cancelOutboundCall - success"});c&&c(a)}):(k["default"].error(" You need to be moderator or the initiator of the oubound call to disconnect the call."),b.a.error("room-event",p.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),c&&c({result:1705,msg:"Insufficient Privileges"}))};var vd=function(b){k["default"].debug("recieved dialStateEvents");var a=d.dialOutList.get(b.number);switch(b.status){case "dialing":void 0===
a&&(a={initiator:!1,state:"dialing"},d.dialOutList.set(b.number,a));break;case "proceeding":case "connected":a.state=b.status;break;case "failed":case "timeout":case "disconnected":d.dialOutList.delete(b.number);break;default:k["default"].debug("Unknown response received")}b=Object(m.e)({type:"dial-state-events",message:{number:b.number,state:b.status,description:b.description}});k["default"].debug("Dispatching dial state event: "+JSON.stringify(b));d.dispatchEvent(b)};d.pingBack=function(b){d.socket.sendMessage("pingBack",
{},function(a){b&&b(a)})};d.startClientUsage=function(b,a){d.socket.sendMessage("startClientUsage",b,function(b){a&&a(b)})};d.stopClientUsage=function(b,a){d.socket.sendMessage("stopClientUsage",b,function(b){k["default"].info("callback received "+JSON.stringify(b));a&&a(b)})};d.createBreakOutRoom=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c&&"object"===typeof a&&a.hasOwnProperty("participants")?a&&0<a.participants?d.socket.sendMessage("create-breakout-room",a,function(a){a&&(k["default"].info("Create breakout room, result: "+
JSON.stringify(a)),b.a.info("room-event",p.a.event_general_success,{message:"createBreakOutRoom - success"}),c(a))}):(k["default"].info("Invalid value for participants "+JSON.stringify(a)),b.a.error("room-event",p.a.event_general_failed,{message:"createBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),c&&c(r.a.error_1155)):k["default"].error("createBreakOutRoom() invalid param - callback/RoomDefinition")};d.createAndInviteBreakOutRoom=function(a,c){a&&0<a.max_rooms?(a.force_join=
!0,d.socket.sendMessage("create-invite-breakout-room",a,function(a){a&&(k["default"].info("Create breakout room, result: "+JSON.stringify(a)),b.a.info("room-event",p.a.event_general_success,{message:"createAndInviteBreakOutRoom - success"}),c(a))})):(k["default"].info("Invalid value for participants "+JSON.stringify(a)),b.a.error("room-event",p.a.event_general_failed,{message:"createAndInviteBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),c&&c(r.a.error_1155))};d.joinBreakOutRoom=
function(a,c,f){f=void 0===f?function(){}:f;"function"===typeof f?a&&null!==a.room_id&&null!==a.role?d.socket.sendMessage("join-breakout-room",a,function(g){g&&0===g.result?d.breakOutRoom.joinRoom(g.token,c,function(a,g){a&&(k["default"].info("****Join Breakout Room Success****, sending user-joined-event****"+JSON.stringify(a.roomData)),d.socket.sendMessage("user-joined-breakout-room",{name:a.roomData.name}),b.a.info("room-event",p.a.event_general_success,{message:"joinBreakOutRoom - success"}),f&&
f(a,null));g&&(b.a.error("room-event",p.a.event_general_failure,{message:"joinBreakOutRoom - failure"}),f&&f(null,g))}):(k["default"].error("Invalid data, room id not found "+JSON.stringify(a)),b.a.error("room-event",p.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+JSON.stringify(a)}),f&&f(r.a.error_1155))}):(k["default"].error("Invalid data, room id not found"+JSON.stringify(a)),b.a.error("room-event",p.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+
JSON.stringify(a)}),f&&f(r.a.error_1155)):k["default"].error("joinBreakoutRoom() invalid param - callback")};d.inviteToBreakoutRoom=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c&&"object"===typeof a&&a.hasOwnProperty("room_id")?void 0===a||void 0===a.room_id?(k["default"].info("Invalid data, room id not found"+JSON.stringify(a)),b.a.error("room-event",p.a.event_general_failure,{message:"inviteToBreakoutRoom - Invalid data, room id not found "+JSON.stringify(a)}),c&&c(r.a.error_1155)):
d.socket.sendMessage("invite-breakout-room",a,function(a){a&&(k["default"].info("Create breakout room, result:"+JSON.stringify(a)),b.a.info("room-event",p.a.event_general_success,{message:"inviteToBreakoutRoom - success"}),c&&c(a))}):k["default"].error("inviteToBreakoutRoom() invalid param - callback/invitee")};d.clearAllBreakOutSession=function(b){void 0!==b&&"function"===typeof b&&(d.breakOutRoom.disconnectAll(),d.resumeRoom(b))};d.destroyAllBreakOutSession=function(b){"moderator"===d.me.role&&
(d.breakOutRoom.destroyAll(),d.resumeRoom(b))};var wd=function(a,c,f){c=void 0===c?{isMobile:!1,broadcast:!0,clientList:[]}:c;var g,e,h,q,w,v,l,x,z,oa,u;return $jscomp.asyncExecutePromiseGeneratorProgram(function(J){if(1==J.nextAddress)return k["default"].info(" init file upload "),g=Q.size,e={messageType:"upload-started",result:0,description:"upload started",response:{uploadStatus:"started",upJobId:g,uploadInfo:{upJobId:g,name:a.name,size:a.size,type:a.type}}},J.setCatchFinallyBlocks(2),h=new F.a,
q={sender:h,status:"started"},Q.set(g,q),w=Object(m.e)({type:"fs-upload-result",message:e}),d.dispatchEvent(w),J.yield(h.upload(a),4);if(2!=J.nextAddress){v=J.yieldResult;l=v.toJSON();q.status="completed";Q.set(g,q);e.messageType="upload-completed";e.response.uploadStatus=q.status;e.response.upJobId=g;e.description=" upload completed";e.response.uploadInfo={upJobId:g,name:l.name,size:l.size,speed:l.speed,createdAt:l.createdAt,dlimit:l.dlimit,time:l.time,expiresAt:l.expiresAt,timeLimit:l.timeLimit};
if(!0===c.isMobile)return k["default"].info(" file sharing mobile client "),e.response.uploadInfo=l,e.response.uploadInfo.upJobId=g,K.push(l),x=JSON.parse(JSON.stringify(l)),x.index=K.length-1,d.availableFiles.push(x),w=Object(m.e)({type:"fs-upload-result",message:e}),d.dispatchEvent(w),f(e),J.return();k["default"].info(" is mobile  false ",c.isMobile);!0===d.showFsUi&&null!==document.getElementById(O)&&Va(l,document.getElementById(O),"fs-file-uploaded");tb(l,"fs-file-available",c.broadcast,c.clientList,
function(b){e.response.sentStatus=b;k["default"].info("sent message to all participants: file is available for download ",b,"fupload result",e);K.push(l);b=JSON.parse(JSON.stringify(l));b.index=K.length-1;d.availableFiles.push(b);k["default"].info("file upload fs-file-available name: "+b.name+" id: "+(b.id?b.id:"undefined"));w=Object(m.e)({type:"fs-upload-result",message:e});d.dispatchEvent(w);f(e)});w=Object(m.e)({type:"fs-upload-result",message:e});d.dispatchEvent(w);b.a.error("room-event",p.a.event_file_shared_success,
{error:{}});f(e);return J.leaveTryBlock(0)}z=J.enterCatchBlock();k["default"].info("upload to file server failed",z);Q.delete(g);e.messageType="upload-failed";e.response.uploadStatus="failed";e.description=" upload failed";e.result=1;oa=Object(m.e)({type:"fs-upload-result",message:e});d.dispatchEvent(oa);k["default"].error("exception in file upload ",z);u=r.a.error_1182;k["default"].info(" send file failed",u);b.a.error("room-event",p.a.event_file_shared_failed,{error:{}});f(u);J.jumpToEnd()})};d.sendFiles=
function(a,c,f){a=void 0===a?[]:a;c=void 0===c?{isMobile:!1,broadcast:!0,clientList:[]}:c;k["default"].info("Send file called options "+JSON.stringify(c)+" file object "+JSON.stringify(a));if(0===d.state&&!1===c.isMobile)a=r.a.error_1180,k["default"].info(" file upload: room is disconnected, file operations are not allowed"),b.a.error("room-event",p.a.event_file_shared_failed,{message:"file upload: room is disconnected, file operations are not allowed"}),f(a);else if(f&&"function"===typeof f?k["default"].info("send file called with callback "):
f=function(b){k["default"].info("SDK defined callback send file response ",b)},0<a.length){k["default"].info("preparing to upload files");d.filesToUpload=a;try{if(0>=d.filesToUpload[d.filesToUpload.length-1].size)k["default"].info(" file size is 0 bytes ",d.filesToUpload[d.filesToUpload.length-1].size),f(r.a.error_1186+d.filesToUpload[d.filesToUpload.length-1].size);else{if(!c.isMobile){if(d.filesToUpload[d.filesToUpload.length-1].size>T){k["default"].info(" file upload limit exceeded. max allowed limit is ",
T);f(r.a.error_1187+T);return}var g={};g.data=a;!0===d.showFsUi&&null!==document.getElementById(O)&&Va(g,document.getElementById(O),"fs-upload-init");tb(g,"fs-upload-started",c.broadcast,c.clientList,function(b){k["default"].info(" file-upload-started sent to all participants",b)})}var e=new z.a(a);wd(e,c,f);b.a.info("room-event",p.a.event_file_shared_success,{error:{}})}}catch(Pb){k["default"].error("exception occured in send file ",Pb),a=r.a.error_1182,k["default"].info(" send file failed",a),b.a.error("room-event",
p.a.event_file_shared_failed,{error:{}}),f(a)}}else c=r.a.error_1185,k["default"].info(" input file list to upload is empty",c," length of file array",a.length),f(c)};d.recvFiles=function(a,c,f){c=void 0===c?{isMobile:!1}:c;f=void 0===f?function(){}:f;var g,e,h,q,w,v,l,x,z,oa,u,J,aa,n,ea;return $jscomp.asyncExecutePromiseGeneratorProgram(function(F){switch(F.nextAddress){case 1:if("function"!==typeof f){k["default"].error("recvFiles() invalid param - callback");F.jumpTo(0);break}if(0===d.state&&!1===
c.isMobile)return g=r.a.error_1180,k["default"].info(" file download: room is disconnected file operations are not allowed"),void 0!=f&&f(g),F.return();if(a>K.length)return e=r.a.error_1181,k["default"].info(" file download: file is not available"),void 0!=f&&f(e),F.return();h={messageType:"download-started",result:0,description:"download-started",response:{downloadStatus:"started",jobId:a,downloadInfo:d.availableFiles[a]}};F.setCatchFinallyBlocks(3);q=K[a];w=q.url.split("#")[0];return F.yield(fetch(w),
5);case 5:return v=F.yieldResult,l=v.headers.get("WWW-Authenticate"),x=l.replace("send-v1 ",""),z=new M.a({secretKey:q.secretKey,id:q.id,nonce:x,requiresPassword:!1}),oa={receiver:z,status:"started"},Z.set(a,oa),u=Object(m.e)({type:"fs-download-result",message:h}),d.dispatchEvent(u),F.yield(z.getMetadata(),6);case 6:return F.yield(z.download(c),7);case 7:J=F.yieldResult;k["default"].info(" file downloaded successfully ",J);oa.status="completed";Z.set(a,oa);h.messageType="download-completed";h.response.downloadStatus=
oa.status;h.response.jobId=a;h.description=" upload completed";u=Object(m.e)({type:"fs-download-result",message:h});b.a.info("room-event",p.a.event_file_download_success,{error:{}});d.dispatchEvent(u);void 0!=f&&f(J);F.leaveTryBlock(0);break;case 3:aa=F.enterCatchBlock(),k["default"].info(" file download failed",aa),Z.delete(a),h.messageType="download-failed",h.response.downloadStatus="failed",h.description=" download failed",h.result=1,n=Object(m.e)({type:"fs-download-result",message:h}),d.dispatchEvent(n),
ea=r.a.error_1183,b.a.error("room-event",p.a.event_file_download_failed,{error:r.a.error_1183.desc}),void 0!=f&&f(ea),F.jumpToEnd()}})};d.mobileSetAvailableFile=function(b,a){k["default"].info("mobile sdk wants to set the available file list ",b);"fs-file-available"===b.message.type&&(K.push(b.message),d.availableFiles.push({name:b.message.name,size:b.message.size,speed:b.message.speed,createdAt:b.message.createdAt,dlimit:b.message.dlimit,time:b.message.time,expiresAt:b.message.expiresAt,timeLimit:b.message.timeLimit,
index:K.length-1}));a(!0)};d.setFsEndPoint=function(b){b=void 0===b?{isMobile:!1,fsDetails:{}}:b;!0===b.isMobile&&Object(J.f)(b.fsDetails,b.callInfo)};d.inJectFsUI=function(b){(b=void 0===b?{enable:!0,uploadElToAppend:"",recvElToAppend:""}:b)&&!0===b.enable&&""!==b.uploadElToAppend&&null!==document.getElementById(b.uploadElToAppend)&&""!==b.recvElToAppend&&null!==document.getElementById(b.recvElToAppend)?(k["default"].info(" show file sharing UI "),d.showFsUi=!0,ha=b.uploadElToAppend,O=b.recvElToAppend,
d.testFT()):k["default"].info(" file UI injection failed")};d.testFT=function(){if(!1===d.showFsUi||!0===d.showFsUi&&null===document.getElementById(ha))k["default"].info(" file upload  UI can not be appended");else{var b=document.createElement("INPUT");b.setAttribute("type","file");b.setAttribute("id","filesID");document.getElementById(ha).appendChild(b);document.getElementById("filesID").addEventListener("change",function(b){b=b.target.files;d.sendFiles(b);for(var a=0,g;g=b[a];a++)console.log(g)},
!1);document.getElementById("filesID").addEventListener("click",function(b){b.target.value=null},!1)}};d.cancelUploads=function(b,a,c){b=void 0===b?!1:b;var g={description:"failed",result:1};if(void 0===a&&!1===b){if(k["default"].error(" upJobId must be defined for cancelling a particular upload "),g.description="upJobId is undefined.",g.result=1,void 0!==c)return c(g)}else if(!0===b){a=$jscomp.makeIterator(Q);for(b=a.next();!b.done;b=a.next())b=$jscomp.makeIterator(b.value),b.next(),b=b.next().value,
"started"===b.status?(b.sender.cancel(),k["default"].info(" running jobs are",b)):k["default"].info(" status is ",b.status);g.description="Cancelled all uploads";g.result=0;void 0!==c&&c(g)}else void 0!=a&&(k["default"].info("cancelling specified upload with id",a),b=Q.get(a),void 0!=b?"started"===b.status?(k["default"].info("canceled upload",a),b.sender.cancel(),g.description="Cancelled upload "+a,g.result=0,void 0!=c&&c(g)):"completed"===b.status&&(k["default"].info("upload can not be cancelled because it is already completed"),
g.description="upload is already completed.",g.result=1,void 0!=c&&c(g)):(k["default"].info("Uplode id is invalid"),g.description="Uplode id is invalid. ",g.result=1,void 0!=c&&c(g)))};d.cancelDownloads=function(b,a,c){b=void 0===b?!1:b;var g={description:"failed",result:1};if(void 0===a&&!1===b){if(k["default"].error("ID must be defined for cancelling a particular upload "),g.description="ID is undefined.",g.result=1,void 0!==c)return c(g)}else if(!0===b){a=$jscomp.makeIterator(Z);for(b=a.next();!b.done;b=
a.next())b=$jscomp.makeIterator(b.value),b.next(),b=b.next().value,"started"===b.status?(b.receiver.cancel(),k["default"].info(" running jobs are",b)):k["default"].info(" status is ",b.status);g.description="Cancelled all downloads";g.result=0;void 0!==c&&c(g)}else void 0!=a&&(k["default"].info("cancelling specified download with id",a),a=a.toString(),b=Z.get(a),void 0!=b?"started"===b.status?(k["default"].info("cancelling download",a),b.receiver.cancel(),g.description="Cancelled download "+a,g.result=
0,void 0!=c&&c(g)):"completed"===b.status&&(k["default"].info("Download can not be cancelled because it is already completed"),g.description="download is already completed.",g.result=1,void 0!=c&&c(g)):(k["default"].info("download id is invalid"),g.description="Download id is invalid. ",g.result=1,void 0!=c&&c(g)))};d.testFtMobile=function(b){b=void 0===b?!1:b;var a=document.createElement("INPUT");a.setAttribute("type","file");a.setAttribute("id","files-mobile");var g="";g=!1===b?document.getElementById("chat_btn"):
document.body;g.appendChild(a);document.getElementById("files-mobile").addEventListener("change",function(b){b=b.target.files;k["default"].info("mobile list of files to upload",b[0]);d.filesToUpload=b;for(var a=0,g;g=b[a];a++)console.log("iterating file list",g)},!1)};var xd=function(b){k["default"].debug("onstreamingnotification events"+JSON.stringify(b));b=Object(m.e)({type:b.type,message:b.data});d.dispatchEvent(b)},yd=function(b){k["default"].debug("socketOnHlsStreamingNotificationToPublisher events"+
JSON.stringify(b));b=Object(m.e)({type:b.type,message:b.data});d.dispatchEvent(b)},zd=function(b){b=Object(m.e)({type:b.type,message:b.data});d.dispatchEvent(b)},Ad=function(b){var a=b.type,g=aa.onLiveRecordingNotification&&aa.onLiveRecordingNotification==a?!0:!1;g||(aa.onLiveRecordingNotification=a);console.log("isAlreadyNotified() id: onLiveRecordingNotification val: "+a+" forceSet: true ret: "+g);g||d.dispatchEvent(Object(m.e)({type:b.type,message:b.data}))};"IE"!==u.a.browserEngineCheck()&&(y.on(v.a.SocketEvent.onAddStream,
B.bind(null,Vb)),y.on(v.a.SocketEvent.media_engine_connecting,B.bind(null,bc)),y.on(v.a.SocketEvent.signaling_message_peer,B.bind(null,cc)),y.on(v.a.SocketEvent.publish_me,B.bind(null,dc)),y.on(v.a.SocketEvent.unpublish_me,B.bind(null,ec)),y.on(v.a.SocketEvent.onBandwidthAlert,B.bind(null,sb)),y.on(v.a.SocketEvent.onBandwidthEvents,B.bind(null,fc)),y.on(v.a.SocketEvent.onSelfBandwidthAlert,B.bind(null,rb)),y.on(v.a.SocketEvent.onDataStream,B.bind(null,gc)),y.on(v.a.SocketEvent.onUpdateAttributeStream,
B.bind(null,ic)),y.on(v.a.SocketEvent.onRemoveStream,B.bind(null,jc)),y.on(v.a.SocketEvent.disconnect,B.bind(null,kc)),y.on(v.a.SocketEvent.connection_failed,B.bind(null,lc)),y.on(v.a.SocketEvent.error,B.bind(null,mc)),y.on(v.a.SocketEvent.onRemoveTrack,B.bind(null,Wb)),y.on(v.a.SocketEvent.user_connected,B.bind(null,qb)),y.on(v.a.SocketEvent.user_updated,B.bind(null,Xb)),y.on(v.a.SocketEvent.user_disconnected,B.bind(null,Yb)),y.on(v.a.SocketEvent.user_subscribed,B.bind(null,Zb)),y.on(v.a.SocketEvent.user_unsubscribed,
B.bind(null,$b)),y.on(v.a.SocketEvent.floor_management_events,B.bind(null,wc)),y.on(v.a.SocketEvent.dial_state_events,B.bind(null,vd)),y.on(v.a.UserEvent.user_awaited,B.bind(null,Bc)),y.on(v.a.SocketEvent.data_stream_room,B.bind(null,hc)),y.on(v.a.RoomEvent.room_awaited,B.bind(null,Ac)),y.on(v.a.RoomEvent.room_connected,B.bind(null,Cc)),y.on(v.a.RoomEvent.room_disconnected,B.bind(null,Dc)),y.on(v.a.RoomEvent.room_record_on,B.bind(null,Rc)),y.on(v.a.RoomEvent.room_record_off,B.bind(null,Sc)),y.on(v.a.RoomEvent.change_layout,
B.bind(null,Wc)),y.on(v.a.RoomEvent.new_active_talker,B.bind(null,Fb)),y.on(v.a.RoomEvent.hard_mute_audio,B.bind(null,Ec)),y.on(v.a.RoomEvent.hard_unmute_audio,B.bind(null,Fc)),y.on(v.a.RoomEvent.hard_mute_video,B.bind(null,Gc)),y.on(v.a.RoomEvent.hard_unmute_video,B.bind(null,Hc)),y.on(v.a.RoomEvent.auxilary_publish_events,B.bind(null,Ic)),y.on(v.a.RoomEvent.share_started,B.bind(null,Db)),y.on(v.a.RoomEvent.share_stopped,B.bind(null,Cb)),y.on(v.a.RoomEvent.screen_share_override,B.bind(null,Mc)),
y.on(v.a.RoomEvent.stop_sharing,B.bind(null,Kc)),y.on(v.a.RoomEvent.update_layout,B.bind(null,Lc)),y.on(v.a.RoomEvent.share_state_events,B.bind(null,id)),y.on(v.a.RoomEvent.custom_data_saved,B.bind(null,ad)),y.on(v.a.RoomEvent.custom_data_updated,B.bind(null,bd)),y.on(v.a.RoomEvent.canvas_started,B.bind(null,fd)),y.on(v.a.RoomEvent.canvas_stopped,B.bind(null,gd)),y.on(v.a.RoomEvent.canvas_state_events,B.bind(null,hd)),y.on(v.a.RoomEvent.generic_events,B.bind(null,jd)),y.on(v.a.RoomEvent.user_role_changed,
B.bind(null,kd)),y.on(v.a.RoomEvent.user_role_management_events,B.bind(null,ld)),y.on(v.a.RoomEvent.switch_codec,B.bind(null,Jc)),y.on(v.a.RoomEvent.invite_breakout_room,B.bind(null,od)),y.on(v.a.RoomEvent.user_joined_breakout_room,B.bind(null,pd)),y.on(v.a.RoomEvent.user_left_breakout_room,B.bind(null,qd)),y.on(v.a.RoomEvent.breakout_room_destroyed,B.bind(null,rd)),y.on(v.a.RoomEvent.transcription_events,B.bind(null,ud)),y.on(v.a.RoomEvent.analytics_events,B.bind(null,sd)),y.on(v.a.RoomEvent.meeting_summary_subscription_events,
B.bind(null,td)),y.on(v.a.UserEvent.user_audio_muted,B.bind(null,Nc)),y.on(v.a.UserEvent.user_audio_unmuted,B.bind(null,Oc)),y.on(v.a.UserEvent.user_video_muted,B.bind(null,Pc)),y.on(v.a.UserEvent.user_video_unmuted,B.bind(null,Qc)),y.on(v.a.SocketEvent.room_management_events,B.bind(null,nd)),y.on(v.a.SocketEvent.hard_mute,B.bind(null,xc)),y.on(v.a.SocketEvent.hard_mute_room,B.bind(null,zc)),y.on(v.a.SocketEvent.hard_unmute_room,B.bind(null,yc)),y.on(v.a.SocketEvent.onStatSubscription,B.bind(null,
oc)),y.on(v.a.SocketEvent.onStreamingNotification,B.bind(null,zd)),y.on(v.a.SocketEvent.onHlsStreamingNotification,B.bind(null,xd)),y.on(v.a.SocketEvent.onHlsStreamingNotificationToPublisher,B.bind(null,yd)),y.on(v.a.SocketEvent.onLiveRecordingNotification,B.bind(null,Ad)),y.on(v.a.SocketEvent.onRoomLiveRecordingOn,B.bind(null,Tc)),y.on(v.a.SocketEvent.onRoomLiveRecordingOff,B.bind(null,Uc)),y.on(v.a.SocketEvent.onRoomLiveRecordingFailed,B.bind(null,Vc)),y.on(v.a.SocketEvent.switched_room,B.bind(null,
md)),y.on(v.a.RoomEvent.room_transcription_on,B.bind(null,Xc)),y.on(v.a.RoomEvent.room_transcription_off,B.bind(null,Yc)),y.on(v.a.RoomEvent.self_transcription_on,B.bind(null,Zc)),y.on(v.a.RoomEvent.self_transcription_off,B.bind(null,$c)));return d}k["default"].info("Failed - Webrtc support is missing ")}},function(l,t,n){function h(a){a=void 0===a?100:a;return new Promise(function(c){return setTimeout(c,a)})}var u=n(29),m=!("object"!==typeof Intl||!Intl||"function"!==typeof Intl.NumberFormat||"object"!==
typeof navigator),e=["bytes","kb","mb","gb"],a=function(){throw Error("uninitialized translate function. call setTranslate first");};l.exports={fadeOut:function(a){a=document.querySelector(a).classList;a.remove("effect--fadeIn");a.add("effect--fadeOut");return h(300)},delay:h,allowedCopy:function(){return document.queryCommandSupported?document.queryCommandSupported("copy"):!1},bytes:function(c){if(1>c)return"0B";var f=Math.min(Math.floor(Math.log10(c)/3),e.length-1);c=Number(c/Math.pow(1024,f));
var h=Math.floor(c)===c?0:1,q=c.toFixed(h);if(m)try{q=c.toLocaleString(locale(),{minimumFractionDigits:h,maximumFractionDigits:h})}catch(k){}return a("fileSize",{num:q,units:a(e[f])})},percent:function(a){if(m)try{return a.toLocaleString(locale(),{style:"percent"})}catch(f){}return Math.floor(100*a)+"%"},number:function(a){return m?a.toLocaleString(locale()):a.toString()},copyToClipboard:function(a){var c=document.createElement("input");c.setAttribute("value",a);c.contentEditable=!0;c.readOnly=!0;
document.body.appendChild(c);if(navigator.userAgent.match(/iphone|ipad|ipod/i)){var e=document.createRange();e.selectNodeContents(c);var h=getSelection();h.removeAllRanges();h.addRange(e);c.setSelectionRange(0,a.length)}else c.select();a=document.execCommand("copy");document.body.removeChild(c);return a},arrayToB64:function(a){return u.fromByteArray(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},b64ToArray:function(a){return u.toByteArray(a+"===".slice((a.length+3)%4))},isFile:function(a){return/^[0-9a-fA-F]{10,16}$/.test(a)},
openLinksInNewTab:function(a,f){f=void 0===f?!0:f;a=a||Array.from(document.querySelectorAll("a:not([target])"));f?a.forEach(function(a){a.setAttribute("target","_blank");a.setAttribute("rel","noopener noreferrer")}):a.forEach(function(a){a.removeAttribute("target");a.removeAttribute("rel")});return a},browserName:function(){try{return/firefox/i.test(navigator.userAgent)?"firefox":/edge/i.test(navigator.userAgent)?"edge":/trident/i.test(navigator.userAgent)?"ie":/chrome/i.test(navigator.userAgent)?
"chrome":/safari/i.test(navigator.userAgent)?"safari":/send android/i.test(navigator.userAgent)?"android-app":"other"}catch(c){return"unknown"}},streamToArrayBuffer:function(a,f){var c,e,k,h,m,l,p,b,u,n,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){switch(q.nextAddress){case 1:return c=a.getReader(),q.yield(c.read(),2);case 2:e=q.yieldResult;if(!f){q.jumpTo(3);break}k=new Uint8Array(f);h=0;case 4:if(e.done){q.jumpTo(5);break}k.set(e.value,h);h+=e.value.length;return q.yield(c.read(),
6);case 6:e=q.yieldResult;q.jumpTo(4);break;case 5:return q.return(k.buffer);case 3:m=[],l=0;case 7:if(e.done){q.jumpTo(8);break}m.push(e.value);l+=e.value.length;return q.yield(c.read(),9);case 9:e=q.yieldResult;q.jumpTo(7);break;case 8:p=0;b=new Uint8Array(l);u=$jscomp.makeIterator(m);for(n=u.next();!n.done;n=u.next())z=n.value,b.set(z,p),p+=z.length;return q.return(b.buffer)}})},list:function(a,f,e){f=void 0===f?"":f;e=void 0===e?"":e;a=a.map(function(a){return html($jscomp$templatelit$0,e,a)});
return html($jscomp$templatelit$1,f,a)},secondsToL10nId:function(a){return 3600>a?{id:"timespanMinutes",num:Math.floor(a/60)}:86400>a?{id:"timespanHours",num:Math.floor(a/3600)}:{id:"timespanDays",num:Math.floor(a/86400)}},timeLeft:function(a){if(1>a)return{id:"linkExpiredAlt"};a=Math.floor(a/1E3/60);var c=Math.floor(a/60),e=Math.floor(c/24);return 1<=e?{id:"expiresDaysHoursMinutes",days:e,hours:c%24,minutes:a%60}:1<=c?{id:"expiresHoursMinutes",hours:c,minutes:a%60}:0===c?0===a?{id:"expiresMinutes",
minutes:"< 1"}:{id:"expiresMinutes",minutes:a}:null},platform:function(){return"object"===typeof Android?"android":"web"},encryptedSize:function(a,f,e){e=(void 0===e?16:e)+1;return 21+a+e*Math.ceil(a/((void 0===f?65536:f)-e))},setTranslate:function(c){a=c}}},function(l,t){function n(h){this.max_=this.count_=this.sum_=this.startTime_=0;this.rampUpThreshold_=h;this.rampUpTime_=Infinity}var h;n.prototype={add:function(h,m){0===this.startTime_&&(this.startTime_=h);this.sum_+=m;this.max_=Math.max(this.max_,
m);Infinity===this.rampUpTime_&&m>this.rampUpThreshold_&&(this.rampUpTime_=h);this.count_+=1},getAverage:function(){return 0===this.count_?0:Math.round(this.sum_/this.count_)},getMax:function(){return this.max_},getRampUpTime:function(){return Math.round(this.rampUpTime_-this.startTime_)}};l.exports={arrayAverage:function(h){for(var m=h.length,e=0,a=0;a<m;a++)e+=h[a];return Math.floor(e/m)},arrayMax:function(h){return 0===h.length?NaN:Math.max.apply(Math,$jscomp.arrayFromIterable(h))},arrayMin:function(h){return 0===
h.length?NaN:Math.min.apply(Math,$jscomp.arrayFromIterable(h))},enumerateStats:function(h,m,e){var a={audio:{local:{audioLevel:0,bytesSent:0,clockRate:0,codecId:"",mimeType:"",packetsSent:0,payloadType:0,timestamp:0,trackId:"",transportId:""},remote:{audioLevel:0,bytesReceived:0,clockRate:0,codecId:"",fractionLost:0,jitter:0,mimeType:"",packetsLost:-1,packetsReceived:0,payloadType:0,timestamp:0,trackId:"",transportId:""}},video:{local:{bytesSent:0,clockRate:0,codecId:"",firCount:0,framesEncoded:0,
frameHeight:0,framesSent:-1,frameWidth:0,nackCount:0,packetsSent:-1,payloadType:0,pliCount:0,qpSum:0,timestamp:0,trackId:"",transportId:""},remote:{bytesReceived:-1,clockRate:0,codecId:"",firCount:-1,fractionLost:0,frameHeight:0,framesDecoded:0,framesDropped:0,framesReceived:0,frameWidth:0,nackCount:-1,packetsLost:-1,packetsReceived:0,payloadType:0,pliCount:-1,qpSum:0,timestamp:0,trackId:"",transportId:""}},connection:{availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,
localCandidateId:"",localCandidateType:"",localIp:"",localPort:0,localPriority:0,localProtocol:"",remoteCandidateId:"",remoteCandidateType:"",remoteIp:"",remotePort:0,remotePriority:0,remoteProtocol:"",requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,timestamp:0,totalRoundTripTime:0}};h&&(h.forEach(function(c,f){switch(c.type){case "outbound-rtp":c.hasOwnProperty("kind")&&("audio"==c.kind?(a.audio.local.bytesSent=c.bytesSent,a.audio.local.codecId=c.codecId,a.audio.local.packetsSent=
c.packetsSent,a.audio.local.timestamp=c.timestamp,a.audio.local.trackId=c.trackId,a.audio.local.transportId=c.transportId):"video"==c.kind&&(a.video.local.bytesSent=c.bytesSent,a.video.local.codecId=c.codecId,a.video.local.firCount=c.firCount,a.video.local.framesEncoded=c.framesEncoded,a.video.local.framesSent=c.framesSent,a.video.local.packetsSent=c.packetsSent,a.video.local.pliCount=c.pliCount,a.video.local.qpSum=c.qpSum,a.video.local.timestamp=c.timestamp,a.video.local.trackId=c.trackId,a.video.local.transportId=
c.transportId,a.video.local.frameHeight=c.frameHeight,a.video.local.frameWidth=c.frameWidth));break;case "inbound-rtp":var h,q;""!==e.audio&&(h=c.hasOwnProperty("trackId")?c.trackId.indexOf(e.audio):c.hasOwnProperty("trackIdentifier")?c.trackIdentifier==e.audio:void 0);""!==e.video&&(q=c.hasOwnProperty("trackId")?c.trackId.indexOf(e.video):c.hasOwnProperty("trackIdentifier")?c.trackIdentifier==e.video:void 0);if(h||q)h&&(a.audio.remote.bytesReceived=c.bytesReceived,a.audio.remote.codecId=c.codecId,
a.audio.remote.fractionLost=c.fractionLost,a.audio.remote.jitter=c.jitter,a.audio.remote.packetsLost=c.packetsLost,a.audio.remote.packetsReceived=c.packetsReceived,a.audio.remote.timestamp=c.timestamp,a.audio.remote.trackId=c.trackId,a.audio.remote.transportId=c.transportId),q&&(a.video.remote.bytesReceived=c.bytesReceived,a.video.remote.codecId=c.codecId,a.video.remote.firCount=c.firCount,a.video.remote.fractionLost=c.fractionLost,a.video.remote.nackCount=c.nackCount,a.video.remote.packetsLost=c.packetsLost,
a.video.remote.packetsReceived=c.packetsReceived,a.video.remote.pliCount=c.pliCount,a.video.remote.qpSum=c.qpSum,a.video.remote.timestamp=c.timestamp,a.video.remote.trackId=c.trackId,a.video.remote.transportId=c.transportId,a.video.remote.frameHeight=c.frameHeight,a.video.remote.frameWidth=c.frameWidth,a.video.remote.framesDecoded=c.framesDecoded,a.video.remote.framesDropped=c.framesDropped,a.video.remote.framesReceived=c.framesReceived);break;case "candidate-pair":c.hasOwnProperty("availableOutgoingBitrate")&&
(a.connection.availableOutgoingBitrate=c.availableOutgoingBitrate,a.connection.bytesReceived=c.bytesReceived,a.connection.bytesSent=c.bytesSent,a.connection.consentRequestsSent=c.consentRequestsSent,a.connection.currentRoundTripTime=c.currentRoundTripTime,a.connection.localCandidateId=c.localCandidateId,a.connection.remoteCandidateId=c.remoteCandidateId,a.connection.requestsReceived=c.requestsReceived,a.connection.requestsSent=c.requestsSent,a.connection.responsesReceived=c.responsesReceived,a.connection.responsesSent=
c.responsesSent,a.connection.timestamp=c.timestamp,a.connection.totalRoundTripTime=c.totalRoundTripTime)}}.bind()),h.forEach(function(c){switch(c.type){case "track":c.hasOwnProperty("trackIdentifier")&&(1!==c.trackIdentifier.indexOf(m.video)&""!==m.video&&(a.video.local.frameHeight=c.frameHeight,a.video.local.framesSent=c.framesSent,a.video.local.frameWidth=c.frameWidth),1!==c.trackIdentifier.indexOf(e.video)&""!==e.video&&(a.video.remote.frameHeight=c.frameHeight,a.video.remote.framesDecoded=c.framesDecoded,
a.video.remote.framesDropped=c.framesDropped,a.video.remote.framesReceived=c.framesReceived,a.video.remote.frameWidth=c.frameWidth),1!==c.trackIdentifier.indexOf(m.audio)&""!==m.audio&&(a.audio.local.audioLevel=c.audioLevel),1!==c.trackIdentifier.indexOf(e.audio)&""!==e.audio&&(a.audio.remote.audioLevel=c.audioLevel));break;case "codec":c.hasOwnProperty("id")&&(1!==c.id.indexOf(a.audio.local.codecId)&""!==m.audio&&(a.audio.local.clockRate=c.clockRate,a.audio.local.mimeType=c.mimeType,a.audio.local.payloadType=
c.payloadType),1!==c.id.indexOf(a.audio.remote.codecId)&""!==e.audio&&(a.audio.remote.clockRate=c.clockRate,a.audio.remote.mimeType=c.mimeType,a.audio.remote.payloadType=c.payloadType),1!==c.id.indexOf(a.video.local.codecId)&""!==m.video&&(a.video.local.clockRate=c.clockRate,a.video.local.mimeType=c.mimeType,a.video.local.payloadType=c.payloadType),1!==c.id.indexOf(a.video.remote.codecId)&""!==e.video&&(a.video.remote.clockRate=c.clockRate,a.video.remote.mimeType=c.mimeType,a.video.remote.payloadType=
c.payloadType));break;case "local-candidate":c.hasOwnProperty("id")&&-1!==c.id.indexOf(a.connection.localCandidateId)&&(a.connection.localIp=c.ip,a.connection.localPort=c.port,a.connection.localPriority=c.priority,a.connection.localProtocol=c.protocol,a.connection.localType=c.candidateType);break;case "remote-candidate":c.hasOwnProperty("id")&&-1!==c.id.indexOf(a.connection.remoteCandidateId)&&(a.connection.remoteIp=c.ip,a.connection.remotePort=c.port,a.connection.remotePriority=c.priority,a.connection.remoteProtocol=
c.protocol,a.connection.remoteType=c.candidateType)}}.bind()));return a},doGetUserMedia:function(h,m,e){try{navigator.mediaDevices.getUserMedia(h).then(function(a){a.onremovetrack=function(){};m(a)}).catch(function(a){e(a)})}catch(a){e(a.message)}},setTimeoutWithProgressBar:function(l,m){var e=window.performance.now(),a=setInterval(function(){var a=window.performance.now();h.setProgress(100*(a-e)/m)},100),c=function(){clearInterval(a);h.setProgress(100);l()},f=setTimeout(c,m);return function(){clearTimeout(f);
c()}},setActiveTest:function(l){h=l},appendSourceId:function(h,m,e){""!==h&&(!0===e[m]?e[m]={optional:[{sourceId:h}]}:"object"===typeof e[m]&&("undefined"===typeof e[m].optional&&(e[m].optional=[]),e[m].optional.push({sourceId:h})))},StatisticsAggregate:n,enumerateStatsFirefox:function(h){var m={audio:{local:{bytesSent:0,packetsSent:0},remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,jitter:0,roundTripTime:0,timestamp:0}},video:{local:{bytesSent:0,packetsSent:-1,bitrateMean:0,bitrateStdDev:0,
qpSum:0},remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,bitrateMean:0,bitrateStdDev:0,roundTripTime:0,timestamp:0}},connection:{bytesSent:0,bytesReceived:0,timestamp:0}};h&&h.forEach(function(e,a){switch(e.type){case "outbound-rtp":"audio"==e.mediaType?(m.audio.local.bytesSent=e.bytesSent,m.audio.local.packetsSent=e.packetsSent):"video"==e.mediaType&&(m.video.local.bytesSent=e.bytesSent,m.video.local.packetsSent=e.packetsSent,m.video.local.bitrateMean=e.bitrateMean,m.video.local.bitrateStdDev=
e.bitrateStdDev,m.video.local.qpSum=e.qpSum);break;case "remote-outbound-rtp":"audio"==e.mediaType?(m.audio.local.bytesSent=e.bytesSent,m.audio.local.packetsSent=e.packetsSent):"video"==e.mediaType&&(m.video.local.bytesSent=e.bytesSent,m.video.local.packetsSent=e.packetsSent);break;case "inbound-rtp":"audio"==e.mediaType?(m.audio.remote.bytesReceived=e.bytesReceived,m.audio.remote.packetsLost=e.packetsLost,m.audio.remote.packetsReceived=e.packetsReceived,m.audio.remote.jitter=e.jitter):"video"==e.mediaType&&
(m.video.remote.bytesReceived=e.bytesReceived,m.video.remote.packetsLost=e.packetsLost,m.video.remote.packetsReceived=e.packetsReceived,m.video.remote.bitrateMean=e.bitrateMean,m.video.remote.bitrateStdDev=e.bitrateStdDev,m.video.remote.qpSum=e.qpSum);break;case "remote-inbound-rtp":"audio"==e.mediaType?(m.audio.remote.bytesReceived=e.bytesReceived,m.audio.remote.packetsLost=e.packetsLost,m.audio.remote.packetsReceived=e.packetsReceived,m.audio.remote.jitter=e.jitter,m.audio.remote.roundTripTime=
e.roundTripTime,m.audio.remote.timestamp=e.timestamp):"video"==e.mediaType&&(m.video.remote.bytesReceived=e.bytesReceived,m.video.remote.packetsLost=e.packetsLost,m.video.remote.packetsReceived=e.packetsReceived,m.video.remote.roundTripTime=e.roundTripTime,m.video.remote.timestamp=e.timestamp);break;case "candidate-pair":m.connection.bytesReceived=e.bytesReceived,m.connection.bytesSent=e.bytesSent,m.connection.timestamp=e.timestamp}}.bind());return m}}},function(l,t,n){var h=n(4),u=n(43),m=n(27),
e=n(7),a=n(0),c=n(26),f=n(6),w=n(5);n(28);var q=n(8),k=n(9);l=n(1);var v=n.n(l);n=n(52);if(1==v.a.noise_analysis)var r=new n.a;t.a=function(l,p){if(v.a.is_supported()){var b=Object(h.c)(p);b.config=p;b.stream=p.stream;b.url=p.url;b.recording=p.recording;b.recordingId=void 0;b.room=void 0;b.showing=!1;b.local=!1;b.video=p.video;b.audio=p.audio;b.screen=p.screen;b.videoSize=p.videoSize;b.videoFrameRate=p.videoFrameRate;b.extensionId=p.extensionId;b.desktopStreamId=p.desktopStreamId;b.recordingId=p.recordingId;
b.clientId=p.clientId;b.videoMutedDueToBw=!1;b.hardAudioMuted=!1;b.hardVideoMuted=!1;b.softVideoMuted=!1;b.selfMuteVideo=!1;b.selfMuteAudio=!1;b.ATVideoMuted=!1;b.selfPausedVideo=!1;b.selfPausedAudio=!1;b.audioOnlyModeEnabled=!1;b.processingVideoMute=!1;b.attributes=p.attributes;b.Connection=void 0===l?e.a:l;b.playerDivs=[];b.canvas=p.canvas;b.transactions=new Map;b.audioStream=p.audioStream;b.audioStreamClone=void 0;b.videoStream=p.videoStream;b.recordedBlobs=[];b.negotiatedMedia={audio:void 0!=
p.audio,video:void 0!=p.video};b.state="idle";var x={},n=!1,z=!1,M=!1;b.inputMediaSource={audio:{},video:{user:null,self:null,selected:"self"}};void 0==b.config.videoMuted&&(b.config.videoMuted=!1);void 0==b.config.audioMuted&&(b.config.audioMuted=!1);b.abwdEnabled=!0;b.abwdNotification="sdk";b.abwdLanguage="en";var A="none",t="none",G=!1,N="none",X;b.maxVideoBwKbpsReqByUser=0;b.maxVideoBwKbpsReqByServer=0;b.maxVideoBwKbpsSet=0;b.reconnect=!1;b.reconnectAttempt=0;b.reconnectsTotal=0;b.pcmInputBuf=
void 0;b.pcmOutputBuf=void 0;b.pcmInputIndex=void 0;b.rnn=void 0;b.bufferResidue=new Float32Array([]);b.scoreArrayVoice=[];b.scoreArrayNoise=[];b.audioLevelArray=[];b.processing_voice_while_mute=!1;b.processing_noise_detection=!1;b.audioContext=void 0;var H={videoFps:{set:0,max:{user:0,server:0},min:{user:0,server:0}},videoBw:{set:0,max:{user:0,server:0},min:{user:0,server:0}}};void 0===p.local||!0===p.local?(b.local=!0,b.config.videoMuted&&(z=!0),b.config.audioMuted&&(n=!0)):n=z=!0;b.isAudioMuted=
function(){return n};b.isVideoMuted=function(){return z||b.config.videoMuted};b.setID=function(a){(p.streamID=a)&&b.player&&b.player.streamUpdated(a)};b.getID=function(){return b.local&&!p.streamID?"local":p.streamID};b.getAttributes=function(){return p.attributes};b.setAttributes=function(c){b.local?b.emit(Object(h.f)({type:"internal-set-attributes",stream:b,attrs:c})):a["default"].error("Error! Stream Object is not published. Failed to update attributes.")};b.updateLocalAttributes=function(b){p.attributes=
b};b.ifAudio=function(){return!1!==p.audio&&void 0!==p.audio?!0:!1};b.ifVideo=function(){return!1!==p.video&&void 0!==p.video?!0:!1};b.ifData=function(){return!1!==p.data&&void 0!==p.data?!0:!1};b.ifScreen=function(){return p.screen};b.ifMedia=function(){return!1!==p.audio&&void 0!==p.audio||!1!==p.video&&void 0!==p.video||!1!==p.screen?!0:!1};b.ifExternal=function(){return void 0!==b.url||void 0!==b.recording?!0:!1};b.ifCanvas=function(){return p.canvas};b.sendData=function(c){b.local&&b.ifData()?
b.emit(Object(h.f)({type:"internal-send-data",stream:b,msg:c})):(a["default"].error("Error! Stream Object is not published. Failed to send data."),k.a.error("stream-event",q.a.event_send_data_failed,{error:"Error! Stream Object is not published. Failed to send data."}))};b.handleMediaDeviceChangeNotify=function(c,d,e,k){d=void 0===d?!0:d;e=void 0===e?!1:e;k=void 0===k?function(){}:k;c=void 0!=c?c+"_handleMediaDeviceChangeNotify":"stream_handleMediaDeviceChangeNotify";var q="stream_handleMediaDeviceChangeNotify"!=
c?"stream_handleMediaDeviceChangeNotify":!1,m={mic:d,cam:d,speaker:e};if(e){void 0==p.params&&(p.params={});if(void 0==p.params.set||void 0==p.params.config)void 0==p.params.set&&(p.params.set={}),void 0==p.params.config&&(p.params.config={});void 0==p.params.set.speaker&&p.speaker&&(p.params.set.speaker=JSON.parse(JSON.stringify(p.speaker)),p.params.config.speaker=JSON.parse(JSON.stringify(p.speaker)))}b.local&&d&&(b.video||(m.cam=!1),b.audio||(m.mic=!1));b.Connection.mediaDeviceUpdate(q,m,c,function(c){var d=
c.current,e=c.added;c=c.removed;var q=function(b,a,c,d,f,e){var k=!1,h=!1,q="object"==typeof d.deviceId?d.deviceId.exact:d.deviceId,m=d.groupId,p="object"==typeof f.deviceId?f.deviceId.exact:f.deviceId,r=f.groupId;console.log(" selectDevice2Switch() currentDevices: "+JSON.stringify(b)+" addedDevices: "+JSON.stringify(c)+" removedDevices: "+JSON.stringify(a)+" deviceSetParams: "+JSON.stringify(d)+" deviceConfigParams: "+JSON.stringify(f));for(var w in a)"default"!=q&&a[w].deviceId!=q||a[w].groupId!=
m||(k=!1),"default"!=p&&a[w].deviceId!=p||a[w].groupId!=r||(h=!1);for(var v in b)"default"!=q&&b[v].deviceId!=q||b[v].groupId!=m||(k=!0),"default"!=p&&b[v].deviceId!=p||b[v].groupId!=r||(h=!0);if(!k||!h)for(var l in c)"default"!=q&&c[l].deviceId!=q||c[l].groupId!=m||(k=!0),"default"!=p&&c[l].deviceId!=p||c[l].groupId!=r||(h=!0);if((q!=p||m!=r||!e)&&h)return{deviceId:p,groupId:r};if(!k){if(c.length)return{deviceId:c[0].deviceId,groupId:c[0].groupId};if(b.length)return{deviceId:b[0].deviceId,groupId:b[0].groupId}}};
if(p.params){if(m.speaker){var r=q(d.speaker,c.speaker,e.speaker,p.params.set.speaker,p.params.config.speaker,!1);k({type:"speaker",info:r})}else console.log("that.handleMediaDeviceChangeNotify() NOT SET selectDevice2Switch for speaker");if(m.cam||m.mic){var w=r=null;if(p.params.set.video&&b.videoStream){var l=!1;b.videoStream.getVideoTracks().forEach(function(b){"ended"!=b.readyState&&(l=!0)});var x=q(d.cam,c.cam,e.cam,p.params.set.video,p.params.config.video,l);x&&(r=x.deviceId)}else a["default"].error("spec.params.set.video not defined");
console.log("handleMediaDeviceChangeNotify() pec.params.set.audio: "+p.params.set.audio+"that.audioStream: "+b.audioStream);if(p.params.set.audio&&b.audioStream){var z=!1;b.audioStream.getAudioTracks().forEach(function(b){"ended"!=b.readyState&&(z=!0)});if(d=q(d.mic,c.mic,e.mic,p.params.set.audio,p.params.config.audio,z))w=d.deviceId}else a["default"].error("spec.params.set.audio not defined");var J,u;void 0!=w?(b.selfMuteAudio||b.hardAudioMuted||(J=w),b.selectedMicId=w):b.selectedMicId=p.params.set.audio.deviceId;
void 0!=r?(b.selfMuteVideo||b.hardVideoMuted||(u={deviceId:r}),b.selectedCam={deviceId:r}):b.selectedCam={deviceId:"object"==typeof p.params.set.video.deviceId?p.params.set.video.deviceId.exact:p.params.set.video.deviceId};void 0==u&&void 0==J||ja(b,J,u,!0,function(c){if(c.result===f.a.error_000.result)c={},void 0!=u&&(K(b.inputMediaSource.video[b.inputMediaSource.video.selected]),c.video={deviceId:u.deviceId}),void 0!=J&&(c.audio={deviceId:J}),c=Object(h.f)({type:"media-device-updated",evntDetails:c}),
b.dispatchEvent(c);else if(a["default"].error("setMediaDevicesTrack() returned failure : "+JSON.stringify(c)),c.result===f.a.error_1145&&"mobile"==v.a.browser_info.device_type&&void 0!==b.room)b.room.onMediaDeviceStateChanged(b,{type:"mic",state:"inactive",error:c})})}}else a["default"].error("spec.params not defined")})};var fa=function(a){"mobile"!=v.a.browser_info.device_type&&(a.width={},a.height={},void 0!==b.videoSize?(a.width.min=b.videoSize[0],a.height.min=b.videoSize[1],a.width.max=b.videoSize[2],
a.height.max=b.videoSize[3]):(a.width.min=v.a.video_resolution_range.Default.min.wdith,a.height.min=v.a.video_resolution_range.Default.min.height,a.width.max=v.a.video_resolution_range.Default.max.width,a.height.max=v.a.video_resolution_range.Default.max.height),"chrome-stable"===e.a.browserEngineCheck()&&(a.width.ideal=a.width.max,a.height.ideal=a.height.max))};b.init=function(){try{if(a["default"].info("requested getUsermedia options: "+JSON.stringify(p)),p.audio||p.video||p.screen||p.canvas||void 0===
p.url){a["default"].info("Note! Requested access to local media");var c=!1,d=!1,f=!1;p.video&&!1!==p.video&&(void 0!=p.disableGUMOptions&&p.disableGUMOptions?c=!0:(c={},fa(c),void 0!==b.videoFrameRate&&(c.frameRate={min:b.videoFrameRate[0],max:b.videoFrameRate[1]}),"object"===typeof p.video&&(void 0!==p.video.deviceId&&""!==p.video.deviceId&&(c.deviceId="safari"!==e.a.browserEngineCheck()?{exact:p.video.deviceId}:p.video.deviceId),void 0!==p.video.facingMode&&""!==p.video.facingMode&&"mobile"==v.a.browser_info.device_type&&
(c.facingMode=p.video.facingMode))));p.screen&&!1!==p.screen&&(c=!0);p.canvas&&!1!==p.canvas&&(f={},f=void 0===b.videoSize?{width:{min:b.videoSizeForCanvas[0],max:b.videoSizeForCanvas[2]},height:{min:b.videoSizeForCanvas[1],max:b.videoSizeForCanvas[3]},canvasId:p.div,fps:p.fps}:{width:{min:b.videoSize[0],max:b.videoSize[2]},height:{min:b.videoSize[1],max:b.videoSize[3]},canvasId:p.div,fps:p.fps});p.audio&&!1!==p.audio&&(void 0!=p.disableGUMOptions&&p.disableGUMOptions?d=!0:(d={echoCancellation:{exact:!0},
googEchoCancellation:{exact:!0},autoGainControl:{exact:!0},noiseSuppression:{exact:!0},googHighpassFilter:{exact:!0},googExperimentalNoiseSuppression:{exact:!0},googExperimentalEchoCancellation:{exact:!0},googExperimentalAutoGainControl:{exact:!0}},"object"===typeof p.audio&&p.audio.deviceId&&""!==p.audio.deviceId&&(d.deviceId=p.audio.deviceId)));var m={video:c,audio:d,screen:p.screen,canvas:f,fake:p.fake,extensionId:b.extensionId,desktopStreamId:b.desktopStreamId};p.screen&&!1!==p.screen&&(m.fps=
p.fps);p.canvas&&!1!==p.canvas?(b.state="initing",b.Connection.GetCanvasStream(m,function(c){b.videoStream=c;b.stream=c;a["default"].debug("Got stream from canvas opt: "+m+" refreshFn: "+p.refreshFn);b.state="inited";b.videoStream.getTracks().forEach(function(c){a["default"].info("getTracks canvas: ",c);c.onended=function(){b.videoStream.getTracks().forEach(function(b){b.onended=null});var a=Object(h.f)({type:"stream-ended",stream:b,msg:c.kind});b.dispatchEvent(a)}});c=Object(h.f)({type:"media-access-allowed",
stream:b});b.dispatchEvent(c);k.a.info("stream-event",q.a.event_media_access_success,{error:{}})},function(c){a["default"].error("GetCanvasStream: ",c);var d=Object(h.f)({type:"media-access-denied",msg:c});b.dispatchEvent(d);k.a.error("stream-event",q.a.event_media_access_denied,{error:c})})):(a["default"].debug("Note!! calling getUserMedia "+JSON.stringify(m)),!p.screen&&b.local&&void 0==p.params&&(p.params={},p.params.config=JSON.parse(JSON.stringify(m)),p.params.set=JSON.parse(JSON.stringify(m))),
b.state="initing",da(m,function(c,d){d?(b.ifScreen(),a["default"].error("Error! local media access Failed - share: "+b.ifScreen()+" Err : "+JSON.stringify(d)),b.dispatchEvent(Object(h.f)({type:"media-access-denied",msg:d})),k.a.error("stream-event",q.a.event_media_access_denied,{error:d})):(void 0==p.params&&(p.params={set:{},config:{}}),a["default"].info("Note!!!!! User has granted access to local media."),k.a.info("stream-event",q.a.event_media_access_success,{error:{}}),b.stream=c,b.stream.getTracks().forEach(function(d,
f){"video"===d.kind?(b.videoStream=c,b.ifScreen()&&(d.contentHint="detail"),b.inputMediaSource.video.self=c,a["default"].info(" GUM success vidtrack muted : "+d.muted+" state: "+d.readyState+" enabled: "+d.enabled),"object"!==typeof p.video&&(p.video={}),p.video.trackIndex=f,d.getSettings().deviceId&&(p.video.deviceId=d.getSettings().deviceId,p.params.set.video={},p.params.config.video={},p.params.config.video.deviceId="safari"!==e.a.browserEngineCheck()?{exact:p.video.deviceId}:p.video.deviceId,
p.params.config.video.groupId=d.getSettings().groupId,p.params.set.video=JSON.parse(JSON.stringify(p.params.config.video))),a["default"].info(" Checking and setting soft video muted : "+b.config.videoMuted+" firstGumcall: "+b.firstGumCall),b.config.videoMuted&&void 0===b.firstGumCall&&(d.enabled=!1,b.softVideoMuted=!0,a["default"].debug(" soft muted video "))):"audio"===d.kind&&(b.audioStream=c,"object"!==typeof p.audio&&(p.audio={}),p.audio.trackIndex=f,d.getSettings().deviceId&&(p.audio.deviceId=
d.getSettings().deviceId,p.params.set.audio={},p.params.config.audio={},p.params.config.audio.deviceId=(e.a.browserEngineCheck(),p.audio.deviceId),p.params.config.audio.groupId=d.getSettings().groupId,p.params.set.audio=JSON.parse(JSON.stringify(p.params.config.audio))),b.config.audioMuted&&void 0===b.firstGumCall&&(d.enabled=!1,n=!0,b.selfMuteAudio=!0,a["default"].debug(" soft muted aduio")));!b.local||b.ifScreen()||b.ifCanvas()||"mobile"==v.a.browser_info.device_type||"safari"==e.a.browserEngineCheck()||
b.handleMediaDeviceChangeNotify();a["default"].info("getTracks",d," kind: ",d.kind);d.onended=function(){b.stream.getTracks().forEach(function(b){b.onended=null});var a=Object(h.f)({type:"stream-ended",stream:b,msg:d.kind});b.dispatchEvent(a)}}),null==b.videoStream&&(b.config.videoMuted=!0),null==b.audioStream&&(b.audio=!1,b.config.audioMuted=!0),!0!==p.audio&&!0!==p.video||(!1!==b.audio||b.ifScreen)&&!1!==b.video||(d={},!1===b.video&&(d.video=b.video),!1===b.audio&&(d.audio=b.audio),d=Object(h.f)({type:"media-access-failed",
evntDetails:d}),b.dispatchEvent(d)),b.state="inited",d=Object(h.f)({type:"media-access-allowed",stream:b}),b.dispatchEvent(d),k.a.info("stream-event",q.a.event_media_access_success,{error:{}}));b.fistGumCall=!0}))}else c=Object(h.f)({type:"media-access-allowed"}),b.dispatchEvent(c),k.a.info("stream-event",q.a.event_media_access_success,{error:{}})}catch(ia){a["default"].error("Error! Failed to get access to local media. Error was "+ia+"."),c=Object(h.f)({type:"media-access-denied",msg:ia}),b.dispatchEvent(c),
k.a.error("stream-event",q.a.event_media_access_denied,{error:ia})}};b.initRemoteStream=function(c,d){if(!b.local)if(b.stream=c,d)"audio"==d.kind&&(b.ifAudio()||b.audioOnly)&&(void 0==b.audioStream?b.audioStream=new MediaStream:b.audioStream.getAudioTracks().forEach(function(a){b.audioStream.removeTrack(a)}),b.audioStream.addTrack(d),console.log("initRemoteStream () stremId: "+b.getID()+" audio stream created and added track")),void 0==b.mediaStream?b.mediaStream=new MediaStream:("audio"==d.kind?
b.mediaStream.getAudioTracks():b.mediaStream.getVideoTracks()).forEach(function(a){b.mediaStream.removeTrack(a)}),console.log("initRemoteStream () media stream stremId: "+b.getID()+" added "+d.kind+" track"),b.mediaStream.addTrack(d);else{if(b.ifAudio()||b.audioOnly)b.audioStream=new MediaStream,b.stream.getAudioTracks().forEach(function(a){b.audioStream.addTrack(a)}),console.log("initRemoteStream () stremId: "+b.getID()+" track null ,audio stream track from stream");b.mediaStream=new MediaStream;
b.stream.getTracks().forEach(function(a){b.mediaStream.addTrack(a)});a["default"].info("remote stream initialized audio stream and tracks id: "+b.getID())}};b.close=function(){b.local&&(void 0!==b.room&&b.room.unpublish(b),b.hide(),void 0!==b.videoStream&&(b.videoStream.getVideoTracks().forEach(function(b){b.enabled=!1;b.onended=null;b.stop()}),b.videoStream=void 0),void 0!==b.audioStream&&(b.audioStream.getAudioTracks().forEach(function(b){b.onended=null;b.stop()}),b.audioStream=void 0),b.pc&&void 0!==
b.pc.peerConnection&&b.pc.peerConnection.close(),b.stream=void 0,b.state="idle")};b.disableTrack=function(a){b.room.removeTrack(a)};b.attachMediaStream=function(b,c){if(!b)return null;if(b.isWebRtcPlugin)return b.src=c,b;if("video"===b.nodeName.toLowerCase()){a["default"].info("Checked element is video");if(!b.pluginObj&&c){a["default"].info("Plugins and stream validated");var d=document.createElement("object");if(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||
"ActiveXObject"in window){a["default"].info("Browser IE validated");var f=document.createElement("param");f.setAttribute("name","windowless");f.setAttribute("value",!0);d.appendChild(f);d.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53")}else a["default"].info("Other browser got"),d.setAttribute("type","application/webrtc-everywhere");b.pluginObj=d;d.setAttribute("className",b.className);d.setAttribute("innerHTML",b.innerHTML);f=b.getAttribute("width");var e=b.getAttribute("height"),
k=b.getBoundingClientRect();f||(f=k.right-k.left);e||(e=k.bottom-k.top);"getComputedStyle"in window&&(a["default"].info("computing style"),k=window.getComputedStyle(b,null),f||"auto"==k.width||"0px"==k.width||(f=k.width),e||"auto"==k.height||"0px"==k.height||(e=k.height));f?d.setAttribute("width",f):d.setAttribute("autowidth",!0);e?d.setAttribute("height",e):d.setAttribute("autoheight",!0);document.body.appendChild(d);b.parentNode&&(a["default"].info("parent node found"),b.parentNode.replaceChild(d,
b),document.body.appendChild(b),b.style.visibility="hidden")}b.pluginObj&&(a["default"].info("plugin object found"),b.pluginObj.bindEventListener("play",function(a){b.pluginObj&&(b.pluginObj.getAttribute("autowidth")&&a.videoWidth&&b.pluginObj.setAttribute("width",a.videoWidth),b.pluginObj.getAttribute("autoheight")&&a.videoHeight&&b.pluginObj.setAttribute("height",a.videoHeight))}),b.pluginObj.src=c);return b.pluginObj}if("audio"===b.nodeName.toLowerCase())return b};var Q=1,da=function(d,f,e){e=
void 0===e?!0:e;var h=JSON.parse(JSON.stringify(d));a["default"].info("getusermedia called  opt "+JSON.stringify(h));(d=b.Connection.getSupportedDeviceConstraints())&&h.video&&"object"==typeof h.video&&("mobile"==v.a.browser_info.device_type?(d.hasOwnProperty("facingMode")&&h.video.facingMode?h.video.deviceId&&delete h.video.deviceId:(d.hasOwnProperty("deviceId")&&h.video.deviceId||h.video.deviceId&&delete h.video.deviceId,h.video.facingMode&&delete h.video.facingMode),h.video.height&&delete h.video.height,
h.video.width&&delete h.video.width):d.hasOwnProperty("deviceId")&&h.video.deviceId?h.video.facingMode&&delete h.video.facingMode:d.hasOwnProperty("facingMode")&&h.video.facingMode?h.video.deviceId&&delete h.video.deviceId:(h.video.deviceId&&delete h.video.deviceId,h.video.facingMode&&delete h.video.facingMode),d.hasOwnProperty("frameRate")||void 0==h.video.frameRate||delete h.video.frameRate);a["default"].debug("calling gum with options: "+JSON.stringify(h));b.Connection.GetUserMedia(h,function(b){a["default"].info("getUserMedia success");
k.a.info("stream-event",q.a.event_gum_success,{error:{}});Q=0;f(b)},function(d){a["default"].error("Get User Media screen  failed streamId: ",b.getID()," Error ",d);d=Object(c.a)(d);h.video.height&&h.video.height.min&&h.video.width&&h.video.width.min&&(a["default"].info("getUserMedia failed error: "+d.result+" min Res: "+h.video.height.min+"X"+h.video.width.min),k.a.error("stream-event",q.a.event_gum_failed,{error:d}));var m={};Object.assign(m,h);switch(d.result){case 1143:case 1144:a["default"].error(" ERROR : "+
d.result+" newOpt: "+JSON.stringify(m));m.screen||p.media_order&&"exact"==p.media_order?(a["default"].error("getUserMedia() Failed with device denied/unvailable . no retry "),e=!1):m.video&&m.audio?(a["default"].error("getUserMedia() Failed with device denied/unvailable .. retrying with audio only"),m.video=!1):e=!1;break;case 1147:case 1148:case 1149:switch(m.video.height.min){case 720:m.video.height.min=540;m.video.width.min=960;break;case 540:m.video.height.min=540;m.video.width.min=960;break;
case 480:m.video.height.min=360;m.video.width.min=480;break;default:e=!1}break;case 1145:a["default"].error(" ERROR : "+d.result+" Opt: "+JSON.stringify(m)+" check and retry");break;default:a["default"].error(" ERROR Default : "+d.result+" newOpt: "+JSON.stringify(m)),e=!1}!b.ifScreen()&&!0===e&&5>=Q?(Q+=1,a["default"].info("getUserMedia() failed retry count: "+Q),da(m,f)):(a["default"].error("getUserMedia() failed for screen or no retry allowed  or retry count exceeded: "),Q=0,f(void 0,d))})};b.setQualityLayers=
function(c){b.pc&&b.stream&&b.local&&b.pc.peerConnection&&b.pc.peerConnection.getSenders?(a["default"].info(" that.setQulaityLayers numSpatialLayers:"+c),b.pc.peerConnection.getSenders().forEach(function(b){if(b.track&&"video"===b.track.kind){var d=b.getParameters();if(void 0!=d&&void 0!=d.encodings){for(var f=0;f<d.encodings.length;f++)c>f?(a["default"].info(" Layer :"+f+" enabled"),d.encodings[f].active=!0):(a["default"].info(" Layer :"+f+" disabled"),d.encodings[f].active=!1);b.setParameters(d)}else a["default"].info(" that.setQulaityLayers: no sender params/encodings-  Not in simulcast mod")}})):
a["default"].info("setQulaityLayers Failed invalid stream :"+b.stream+" local: "+b.local)};b.getSelectedCandidateType=function(a){var c,d={},f=!1;b.pc&&b.pc.peerConnection?b.pc.peerConnection.getStats(null).then(function(b){b.forEach(function(b){"candidate-pair"==b.type?b.nominated&&(d[b.localCandidateId]?(a(d[b.localCandidateId].candidateType),f=!0):c=b):"local-candidate"==b.type&&(c?c.localCandidateId==b.id&&(a(b.candidateType),f=!0):d[b.id]=b)});f||a("none")}):a("none")};b.onConnectionStateChanged=
function(c){a["default"].debug(" that.onConnectionStateChanged() active : "+c+" ");if(b.local)if(c)if(b.ifCanvas()){if(void 0!==p.refreshFn){p.refreshFn();var d=p.fps>p.maxCanvasRefreshRate?1E3/p.maxCanvasRefreshRate:1E3/p.fps;a["default"].info(" that.onConnectionStateChanged ()  timerVal : "+d+" spec.fps: "+p.fps);b.refreshTimer=setInterval(function(){a["default"].debug("refresh called timer ");p.refreshFn()},d)}}else b.ifScreen()||(b.negotiatedMedia.video=void 0!=b.videoStream,b.negotiatedMedia.audio=
void 0!=b.audioStream,b.video&&b.negotiatedMedia.video&&(0>=b.maxVideoLayers?(H.videoBw.set=H.videoFps.set=0,la(H.videoBw,H.videoFps)):b.videoStream.getVideoTracks().forEach(function(c){var d=c.getConstraints();d.height.max=b.videoSize[3];d.height.ideal=b.videoSize[3];d.width.max=b.videoSize[2];d.width.ideal=b.videoSize[2];d.frameRate={max:26};c.applyConstraints(d).then(function(){a["default"].debug("applying constraints for simulcast video success")}).catch(function(b){a["default"].error(" error in applying constraints for simulcast video error: "+
b)})})));else b.ifCanvas()&&void 0!=b.refreshTimer&&(clearInterval(b.refreshTimer),b.refreshTimer=void 0);else b.ifScreen()&&(b.stream.getVideoTracks()[0].contentHint="detail");c&&(b.state="connected")};b.setVideoQuality=function(c,d){d=void 0===d?function(){}:d;b.local&&b.ifVideo()&&!b.ifScreen()&&!b.ifCanvas()&&c&&"object"==typeof c&&c.maxKbps?b.setVideoParamsRange(c.maxKbps,void 0,void 0,void 0,!1,d):(c=JSON.parse(JSON.stringify(f.a.error_1155)),!b.local||b.ifScreen()||b.ifCanvas()?(a["default"].error("setVideoQuality() Invalid stream , stream should be publisher video"),
c.error="Invalid stream , stream should be publisher video"):b.ifVideo()?(a["default"].error("Invalid options , should be :- {maxKbps: <max kbps>}"),c.error="Invalid options , should be :- {maxKbps: <max kbps>}"):(a["default"].error("setVideoQuality() video not supported in publisher stream"),c.error="Invalid stream media , video not supported in publisher stream"),d(c))};b.setVideoParamsRange=function(c,d,f,e,k,h){1<b.maxVideoLayers||(k?(void 0!==c&&(H.videoBw.max.server=parseInt(c)),void 0!==f&&
(H.videoFps.max.server=parseInt(f)),void 0!==d&&(H.videoBw.min.server=parseInt(d)),void 0!==e&&(H.videoFps.min.server=parseInt(e))):(void 0!==c&&(H.videoBw.max.user=parseInt(c)),void 0!==f&&(H.videoFps.max.user=parseInt(f)),void 0!==d&&(H.videoBw.min.user=parseInt(d)),void 0!==e&&(H.videoFps.min.user=parseInt(e))),a["default"].debug("setVideoParamsRange() id: "+b.getID()+" :: "+c+": "+d+":"+f+":"+e+":"+k),la(H.videoBw,H.videoFps,h))};var la=function(c,d,h){var m=0,p=0;m=c.max.user&&c.max.user<c.min.user?
c.min.user:c.max.user&&(!c.max.server||c.max.user<=c.max.server)?c.max.user:c.max.server&&c.max.server<c.min.user?c.min.user:c.max.server&&c.max.server<c.min.server?c.min.server:c.max.server;p=d.max.user<d.min.user?d.min.user:d.max.user&&(!d.max.server||d.max.user<=d.max.server)?d.max.user:d.max.server&&d.max.server<d.min.user?d.min.user:d.max.server&&d.max.server<d.min.server?d.min.server:d.max.server;if(void 0==b.pc||void 0==b.pc.peerConnection||void 0==b.room)a["default"].error("setVideoParams() not set pc/room not defined "+
JSON.stringify(H)+" b2Set: "+m+" fps2Set: "+p),h&&h(f.a.error_1131);else{if(m&&c.min.server!=m&&c.max.server!=m){var r=[{id:"publisher-video-bw-update",streamId:b.getID(),min:c.min.user,max:c.max.user}];b.room.setAdvancedOptions(r,function(){})}a["default"].debug(" setVideoParams: id: "+b.getID()+" b2Set "+m+" fps2Set "+p+" bwrange: "+JSON.stringify(c));if(m&&c.set!=m||p&&d.set!=p)if(r=e.a.browserEngineCheck(),"chrome-stable"===r||"mozilla"===r&&!e.a.isCurrentVerLess(w.a.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)||
"safari"===r&&!e.a.isCurrentVerLess(w.a.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)){b.pc.peerConnection.getSenders().forEach(function(e){if(e.track&&"video"===e.track.kind){var k=e.getParameters();if(void 0!=k){k.encodings||(k.encodings=[{}]);for(var q=0;q<k.encodings.length;q++)m&&(a["default"].info(" that.setMaxVideoBitarte id: "+b.getID()+" bw: "+m),k.encodings[q].maxBitrate=1E3*m,c.set=m),p&&(a["default"].info(" that.setMaxVideoFramerate id: "+b.getID()+" fps: ",p),k.encodings[q].maxFramerate=
p,d.set=p);e.setParameters(k);h&&h(f.a.error_000)}else h&&h(f.a.error_1133),a["default"].error(" that.setMaxVideoBitarte: no sender params/encodings-  ")}});var l=function(b,a,c,d,f,e,k,h){if(d<c.length){var m=b.getConstraints(),q=!1;a.height&&(a.height.max=c[d].res[f].height,a.height.ideal=c[d].res[f].height,m.height&&m.height.max&&m.height.max==a.height.max||(q=!0));a.width&&(a.width.max=c[d].res[f].width,a.width.ideal=c[d].res[f].width,m.width&&m.width.max&&m.width.max==a.width.max||(q=!0));a.frameRate=
{max:e};m.frameRate&&m.frameRate.max&&m.frameRate.max==a.frameRate.max||(q=!0);q?b.applyConstraints(a).then(function(){h(a,k)}).catch(function(m){k.push({res:c[d].res[f],error:m});c[d].res.length<f+1?f++:(d++,f=0,e=30);l(b,a,c,d,f,e,k,h)}):h(a,k)}else h(null,k)};b.ifScreen()||b.ifCanvas()||"safari"===r?a["default"].error("setVideoParams() : video stream not exists"):b.videoStream&&b.videoStream.getVideoTracks().forEach(function(d){var f=v.a.getCamResTableToCheck(c.set),e=d.getConstraints();void 0==
f?(a["default"].error("reverting kbps: "+c.set+" constraints: curr: "+JSON.stringify(e)+" original: "+b.videoSize[3]+" X "+b.videoSize[2]),void 0==e.height||void 0==e.width||void 0!=e.height.max&&void 0!=e.width.max&&b.videoSize[3]==e.height.max&&b.videoSize[2]==e.width.max||(e.height.max=b.videoSize[3],e.height.ideal=b.videoSize[3],e.width.max=b.videoSize[2],e.width.ideal=b.videoSize[2],e.frameRate={max:26},d.applyConstraints(e).then(function(){a["default"].info("apply constraints to original value")}).catch(function(b){a["default"].error("failed  - apply constraints to original value")}))):
(e.height&&e.width||(e.width={min:v.a.video_resolution_range.Default.min.width},e.height={min:v.a.video_resolution_range.Default.min.height}),l(d,e,f.resTable,0,0,f.fps,[],function(b,c){a["default"].debug("setVideoQualityConstraints() "+(null!=b?"Succes":"Failure")+" constraints old: "+JSON.stringify(e)+" new: "+JSON.stringify(b)+"  errors: "+JSON.stringify(c))}))})}else a["default"].error("Setting Max Bw  using sdp reneg videoBwKbps= ",videoBwKbps),r={maxVideoBW:m,Sdp:!0},c.set=m,b.pc.updateSpec(r,
function(){a["default"].info("that.setMaxVideoBitarte: sdp reneg success")}),k.a.warn("stream-event",q.a.event_incompatible_browser,{message:"Setting Max Bw  using traditional way of sdp renegotiation videoBwKbps= "+m});else h?(a["default"].error(" video quality params mismatch/ invalid range  bandwidth to set : "+m),h(f.a.error_1132)):a["default"].debug("setVideoParams Failed id: "+b.getID()+" b2Set "+m+" bwrange: "+JSON.stringify(c))}};b.getSelectedCandidatePair=function(){try{if(b.pc.peerConnection)if(b.pc.peerConnection.getSenders().length||
b.pc.peerConnection.getReceivers().length||b.pc.peerConnection.sctp&&null!=b.pc.peerConnection.sctp){var c=p.audio||p.video?b.local?b.pc.peerConnection.getSenders()[0]:b.pc.peerConnection.getReceivers()[0]:b.pc.peerConnection.sctp;if(c&&c.transport&&c.transport.iceTransport&&"function"==typeof c.transport.iceTransport.getSelectedCandidatePair){var d=c.transport.iceTransport.getSelectedCandidatePair();return{local:d.local.candidate,remote:d.remote.candidate}}a["default"].error("getSelectedCandidatePair() failed getSelectedCandidatePair API missing : "+
b.getID())}else a["default"].error("getSelectedCandidatePair() failed no transport set id: "+b.getID());else a["default"].error("getSelectedCandidatePair() failed no pc exists id: "+b.getID())}catch(Y){a["default"].error("getSelectedCandidatePair() failed exception id: "+b.getID()+" error: "+Y)}};b.setVideoQualityParams=function(c,d,f,k,h){b.videoStream.getVideoTracks().forEach(function(b){var m=b.getConstraints();a["default"].info("RESOLUTION Set track before constariants : "+JSON.stringify(m));
null!=c&&null!=d&&(void 0==m.width&&(m.width={}),void 0==m.height&&(m.height={}),m.width.min=c,m.height.min=d);null!=k&&null!=f&&(void 0==m.width&&(m.width={}),void 0==m.height&&(m.height={}),m.height.max=k,m.width.max=f,"chrome-stable"===e.a.browserEngineCheck()&&(m.width.ideal=f,m.height.ideal=k));if(m.width.min&&m.height.min&&m.width.max&&m.height.max&&m.width.min*m.height.min>m.width.max*m.height.max)return a["default"].error("setVideoResolution() : constraint mismatch : "+JSON.stringify(m)),
!1;null!=h&&(m.frameRate={max:h});b.applyConstraints(m).then(function(){a["default"].info("RESOLUTION Set track constariants success : "+JSON.stringify(m))}).catch(function(b){a["default"].error("RESOLUTION Set trac constraints failed: "+b+" constraints: "+JSON.stringify(m))})})};b.switchMicrophone=function(c,e,h,m){m=void 0===m?!0:m;b.negotiatedMedia.audio?0==d("setMicrophoneTrack")?(k.a.warn("stream-event",q.a.event_general_failed,{message:"switchMicrophone - Previous similar request in process"}),
h(f.a.error_1140)):(b.selfMuteAudio||b.hardAudioMuted)&&m?(x.switchMicrophone={newStream:c,deviceInfo:e},E("setMicrophoneTrack"),h({result:0,msg:"set but not active"})):ja(c,e,void 0,!0,function(d){E("setMicrophoneTrack");a["default"].error("setMediaDevicesTrack() in switch mic returned failure : "+JSON.stringify(d)+"device type: "+v.a.browser_info.device_type);if(d.result===f.a.error_1145&&"mobile"==v.a.browser_info.device_type)if(void 0!==b.room)b.room.onMediaDeviceStateChanged(c,{type:"mic",state:"inactive",
error:d});else h(d);else h(0===d.result?c:d)}):(k.a.error("stream-event",q.a.event_general_failed,{message:"switchMicrophone - Stream not found"}),h(f.a.error_1159))};b.switchCamera=function(c,e,h,m,p){h=void 0===h?function(){}:h;m=void 0===m?!0:m;p=void 0===p?!0:p;if("function"===typeof h)if(void 0==b.stream)h(f.a.error_1159);else if(1!==b.stream.getVideoTracks().length)h(f.a.error_1159);else if(b.negotiatedMedia.video)if(0==d("setCameraTrack"))k.a.warn("stream-event",q.a.event_general_failed,{message:"switchCamera - Previous similar request in process"}),
h(f.a.error_1140);else if((b.selfMuteVideo||b.hardVideoMuted)&&!M&&m)x.switchCamera={newStream:c,deviceInfo:e},h({result:0,msg:"set but not active"}),E("setCameraTrack");else{var r={};if(void 0!=e){if("string"===typeof e)r.deviceId=e;else if("object"===typeof e){if(b.sendMessage("cameraSwitched",{}),void 0!=e.deviceId&&"string"===typeof e.deviceId&&(r.deviceId=e.deviceId),void 0!=e.facingMode&&"string"===typeof e.facingMode&&(r.facingMode=e.facingMode),void 0==r.deviceId&&void 0==r.facingMode){a["default"].error("Error switchCamera(), error: invalid camera options "+
JSON.stringify(e));k.a.error("stream-event",q.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options "+JSON.stringify(e)});h(f.a.error_1155);return}}else{a["default"].error("Error switchCamera(), error: invalid camera options type "+JSON.stringify(e));k.a.error("stream-event",q.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options type "+JSON.stringify(e)});h(f.a.error_1155);E("setCameraTrack");return}b.stream.getVideoTracks().forEach(function(d){d.enabled=
!1;d.stop();d.onended=ja(c,void 0,r,p,function(d){var e=!1;c.stream.getVideoTracks().forEach(function(b){e=b.readyState});if(0===d.result)K(b.inputMediaSource.video[b.inputMediaSource.video.selected]),E("setCameraTrack"),h(0===d.result?c:d);else if(1150===d.result)"live"==e&&(K(b.inputMediaSource.video[b.inputMediaSource.video.selected]),E("setCameraTrack"),h(c));else if(E("setCameraTrack"),a["default"].error("setMediaDevicesTrack() switch cam returned failure : "+JSON.stringify(d)+"device type: "+
v.a.browser_info.device_type),d.result===f.a.error_1145&&"mobile"==v.a.browser_info.device_type)if(void 0!==b.room)b.room.onMediaDeviceStateChanged(c,{type:"cam",state:"inactive",error:d});else h(d);else E("setCameraTrack"),h(d)})})}else a["default"].error("Error switchCamera(), error: camera options undefined"),k.a.error("stream-event",q.a.event_general_failed,{message:"Error switchCamera(), error: camera options undefined"}),h(f.a.error_1155),E("setCameraTrack")}else k.a.error("stream-event",q.a.event_general_failed,
{message:"switchCamera - Stream not found"}),h(f.a.error_1159);else a["default"].error("switchCamera() invalid param - callback")};b.switchMediaDevices=function(c,e,h,m){if(b.negotiatedMedia.audio&&b.negotiatedMedia.video){if(void 0!==h){if(b.selfMuteVideo||b.hardVideoMuted){k.a.warn("stream-event",q.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in video mute state"});m(f.a.error_1189);return}if(0==d("setCameraTrack")){k.a.warn("stream-event",q.a.event_general_failed,
{message:"switchMediaDevices - Previous similar request in process"});m(f.a.error_1140);return}}if(void 0!==e){if(b.selfMuteAudio||b.hardAudioMuted){k.a.warn("stream-event",q.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in audio mute state"});m(f.a.error_1189);void 0!==h&&E("setCameraTrack");return}if(0==d("setMicrophoneTrack")){void 0!==h&&E("setCameraTrack");m(f.a.error_1140);k.a.warn("stream-event",q.a.event_general_failed,{message:"switchMediaDevices - Previous similar request in process"});
return}}var p={};if(void 0!=h)if("string"===typeof h)p.deviceId=h;else if("object"===typeof h){if(void 0!=h.deviceId&&"string"===typeof h.deviceId&&(p.deviceId=h.deviceId),void 0!=h.facingMode&&"string"===typeof h.facingMode&&(p.facingMode=h.facingMode),void 0==p.deviceId&&void 0==p.facingMode){a["default"].error("Error switchMediaDevices(), error: invalid camera options "+JSON.stringify(h));k.a.error("stream-event",q.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options "+
JSON.stringify(h)});m(f.a.error_1155);return}}else{a["default"].error("Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(h));k.a.error("stream-event",q.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(h)});m(f.a.error_1155);return}else p=void 0;void 0==b.stream?(m(f.a.error_1159),E("setCameraTrack")):b.stream.getVideoTracks().forEach(function(a){a.stop();a.onended=ja(c,e,p,!0,function(a){var d=!1;c.stream.getVideoTracks().forEach(function(b){d=
b.readyState});if(0===a.result)K(b.inputMediaSource.video[b.inputMediaSource.video.selected]),E("setCameraTrack"),E("setMicrophoneTrack"),m(0===a.result?c:a);else if(1150===a.result)K(b.inputMediaSource.video[b.inputMediaSource.video.selected]),m(c),"live"==d?(K(b.inputMediaSource.video[b.inputMediaSource.video.selected]),E("setCameraTrack"),E("setMicrophoneTrack"),m(c)):(E("setCameraTrack"),E("setMicrophoneTrack"),m(a));else if(E("setCameraTrack"),E("setMicrophoneTrack"),console.log("setMediaDevicesTrack() switch media dev  failure : "+
JSON.stringify(a)+"device type: "+v.a.browser_info.device_type),a.result===f.a.error_1145&&"mobile"==v.a.browser_info.device_type)if(void 0!==b.room)b.room.onMediaDeviceStateChanged(c,{type:"mic",state:"inactive",error:a});else m(a);else m(a)})})}else k.a.error("stream-event",q.a.event_general_failed,{message:"switchMediaDevices - Stream not found"}),m(f.a.error_1159)};b.setSpeaker=function(c,d){var f=!0,e="",k=b.getPlayerId();void 0!==document.querySelector("#"+k.stream)&&null!==document.querySelector("#"+
k.stream)?document.querySelectorAll("#"+k.stream).forEach(function(b){"function"===typeof b.setSinkId&&void 0!=c?(b.setSinkId(c),f=!1):c&&(e+=" setSinkId is not a function");void 0!=d&&(b.volume=d)}):e+=" selector Id undefined id: ";f?a["default"].info("setSpeaker () failed for streamId: "+b.getID()+" error: "+e):a["default"].info(" setSpeaker ()  success  for streamId: "+b.getID())};var d=function(c){if(!b.transactions.get(c))return b.transactions.set(c,{state:"inprogress"}),!0;a["default"].error("Invalid state: previous request in progress. transId: "+
c);k.a.warn("stream-event",q.a.event_general_failed,{message:"setTrasactionIfNotExists - Invalid state: previous request in progress. transId: "+c});return!1},E=function(a){return b.transactions.delete(a)},ja=function(c,d,e,h,m){var r=new MediaStream;if(!c||!0!==c.local||c.ifScreen()||c.ifCanvas())a["default"].info("Cannot switch devices over invalid stream"),k.a.error("stream-event",q.a.event_general_failed,{message:"setMediaDevicesTrack - Cannot switch devices over invalid stream"}),m(f.a.error_1155);
else{var w={};w.audio=void 0!==d?"none"!==d?{deviceId:d}:!0:!1;void 0!==e?(w.video={},fa(w.video),void 0!=e.deviceId&&"none"!==e.deviceId&&(w.video={deviceId:{exact:e.deviceId}}),void 0!=e.facingMode&&(w.video={facingMode:{exact:e.facingMode}}),void 0!==b.videoFrameRate&&(w.video.frameRate={min:b.videoFrameRate[0],max:b.videoFrameRate[1]})):w.video=!1;da(w,function(l,v){void 0==v?(c.pc&&c.pc.peerConnection&&h&&(e?(v="user"===b.inputMediaSource.video.selected?b.inputMediaSource.video.user:l,b.inputMediaSource.video.self=
l):v=l,Z(c,void 0!==d,void 0!==e,v,"self"==b.inputMediaSource.video.selected)),e?(c.videoStream=l,p.params.set.video&&"object"==typeof p.params.set.video||(p.params.set.video={}),b.inputMediaSource.video.self=l,l.getVideoTracks().forEach(function(b,a){r.addTrack(b);p.params.set.video.groupId=b.getSettings().groupId}),void 0!=e.deviceId?"none"!==e.deviceId&&(p.video.deviceId=e.deviceId,p.params.set.video.deviceId=JSON.parse(JSON.stringify(w.video.deviceId))):l.getVideoTracks().forEach(function(b,a){void 0!=
b.getSettings().deviceId&&(p.video.deviceId=b.getSettings().deviceId);r.addTrack(b)}),a["default"].log("Got video access from devices:- ",p.video.deviceId),k.a.info("stream-event",q.a.event_gum_success,{message:"Got video access from devices:- "+p.video.deviceId})):c.videoStream&&c.videoStream.getVideoTracks().forEach(function(b,a){r.addTrack(b)}),d?(c.audioStream=l,l.getAudioTracks().forEach(function(b,a){r.addTrack(b);p.params.set.audio.groupId=b.getSettings().groupId}),"none"!==d&&(p.audio&&(p.audio.deviceId=
d),p.params.set.audio.deviceId=JSON.parse(JSON.stringify(w.audio.deviceId))),a["default"].log("Got audio access from devices:- ",d),k.a.info("stream-event",q.a.event_gum_success,{message:"Got audio access from devices:- "+d})):c.audioStream&&c.audioStream.getAudioTracks().forEach(function(b){return r.addTrack(b)}),m(f.a.error_000)):(l=e?e.deviceId:"null",a["default"].info("Error getUserMedia(), error: "+v+" cam: "+l+" mic: ",d),k.a.error("stream-event",q.a.event_gum_failed,{cam_id:l,mic_id:d}),m(v));
c.stream=r})}},Z=function(b,c,d,f,e,h){e=void 0===e?!0:e;h=void 0===h?!0:h;var m=!1,r=!1;b.pc&&b.pc.peerConnection?b.pc.peerConnection.getSenders().forEach(function(a,k){a.track&&(d&&"video"===a.track.kind?("object"!==typeof p.video&&(p.video={}),p.video.trackIndex=k,r=!0,f?f.getVideoTracks().forEach(function(b){b.enabled=!0;a.replaceTrack(b)}):a.replaceTrack(null),e&&b.videoStream.getVideoTracks().forEach(function(b){b.enabled=!1;b.onended=null;b.stop()})):c&&"audio"===a.track.kind&&(p.audio.trackIndex=
k,m=!0,f?f.getAudioTracks().forEach(function(b){b.enabled=!0;a.replaceTrack(b)}):a.replaceTrack(null),h&&b.audioStream&&b.audioStream.getAudioTracks().forEach(function(b){b.enabled=!1;b.onended=null;b.stop()})))}):(d&&b.videoStream&&e&&b.videoStream.getVideoTracks().forEach(function(b){console.log("without replace track setting current videotracks to stop");b.enabled=!1;b.onended=null;b.stop()}),c&&b.audioStream&&h&&b.audioStream.getAudioTracks().forEach(function(b){b.enabled=!1;b.onended=null;b.stop()}));
b.pc&&b.pc.peerConnection&&(c&&!m||d&&!r)&&(b.pc.peerConnection.getSenders().forEach(function(b,a){!b.track&&f&&(c&&!m&&void 0!==p.audio.trackIndex&&a===p.audio.trackIndex&&(m=!0,f.getAudioTracks().forEach(function(a){a.enabled=!0;b.replaceTrack(a)})),d&&!r&&void 0!==p.video.trackIndex&&a===p.video.trackIndex&&(r=!0,f.getVideoTracks().forEach(function(a){a.enabled=!0;b.replaceTrack(a)})))}),c&&!m||d&&!r)&&(a["default"].error("Error: Not finding sender track::  audio: "+c+" found: "+m+" index: "+p.audio.trackIndex+
" video: "+d+" found: "+r+" index: "+p.video.trackIndex),k.a.error("stream-event",q.a.event_general_failed,{message:"replaceNewMediaStreamTrack - Not finding sender track::  audio: "+c+" found: "+m+" index: "+p.audio.trackIndex+" video: "+d+" found: "+r+" index: "+p.video.trackIndex}),b.pc.peerConnection.getSenders().forEach(function(b,c){a["default"].error("index : "+c+" sender.track: "+b.track+" kind : "+(b.track?b.track.kind:"none"))}))},ea=function(b,a,c){return b&&(t==a||"none"==t)&&("video"==
A||"audiovideo"==A||G&&!c)};b.getPlayerId=function(a){a=void 0===a?null:a;var c=b.getID();a=a?a:b.room;a="breakout-room"===(a&&a.roomSettings&&a.roomSettings.room_type?a.roomSettings.room_type:null)?"br_"+a.roomID+"_":"";return{stream:a+"stream"+c,player:a+"player_"+c}};b.reloadPlayer=function(c,d){var f=c.mediatype,h=c.clientId,m=b.mediaStream?"mediastream: true":"mediastream: false";m+=b.audioStream?" aduioStream : true ":" audioStream : false";m+=b.pc?" pc : true ":" pc : false";a["default"].info("reloadPlayer() id: "+
b.getID()+" newMediaType: "+f+m);if(!(A!=f||G||d&&"none"!=N&&N!=c.reason)){a["default"].debug("reloadPlayer() id : "+b.getID()+" no change in media type: "+f);if("none"===t)switch(A){case "audio":case "audioOnly":n=!1;z=!0;break;case "video":n=!0;z=!1;break;case "audiovideo":n=z=!1;break;default:n=z=!0}t=h;X={talkerInfo:JSON.parse(JSON.stringify(c)),imageOnVideoMute:d};if("audio"!=f&&"audioOnly"!=f||!(b.player&&b.player.video&&b.player.video.paused))return}a["default"].debug("reloadPlayer() streamId: "+
b.getID()+" mediatype:( "+f+" , "+A+" ), clientId:( "+h+" , "+t+" ), reason:( "+c.reason+" , "+N+" )  imageOnVideoMute: "+d);b.getID();m=b.getPlayerId();if(void 0!==document.querySelector("#"+m.stream)&&null!==document.querySelector("#"+m.stream)){var p=!1;document.querySelectorAll("#"+m.stream).forEach(function(m){try{switch(f){case "audio":if(N=c.reason,ea(d,h,"user"==c.reason)){b.mediaStream&&0==b.mediaStream.getAudioTracks().length&&(b.audioStreamTrack?b.mediaStream.addTrack(b.audioStreamTrack):
b.stream.getAudioTracks().forEach(function(a){b.mediaStream.addTrack(a)}));p=G=!0;n=!1;z=!0;break}case "audioOnly":b.audioStream?(m.srcObject=b.audioStream,G=!1,p=!0,n=!1,z=!0):(a["default"].error("reloadPlayer() failed id : "+b.getID()+" audiostream null medtype - curr: "+(A+" new: "+f)),k.a.error("stream-event",q.a.event_stream_media_failed,{id:b.getID(),err:"audiostream null"}));break;case "video":b.mediaStream?("audiovideo"==A?(0==b.mediaStream.getVideoTracks().length&&b.stream.getVideoTracks().forEach(function(a){b.mediaStream.addTrack(a)}),
0!=b.mediaStream.getAudioTracks().length&&b.mediaStream.getAudioTracks().forEach(function(a){b.audioStreamTrack=a;b.mediaStream.removeTrack(a)})):m.srcObject=b.mediaStream,G=!1,N="none",n=p=!0,z=!1):(k.a.error("stream-event",q.a.event_stream_media_failed,{id:b.getID(),err:"videostream null"}),a["default"].error("reloadPlayer() failed id : "+b.getID()+" videostream null, medtype - curr: "+A+" new: "+f));break;case "audiovideo":if(b.mediaStream){0==b.mediaStream.getAudioTracks().length&&(b.audioStreamTrack?
b.mediaStream.addTrack(b.audioStreamTrack):b.audioStream.getAudioTracks().forEach(function(a){b.mediaStream.addTrack(a)}));0==b.mediaStream.getVideoTracks().length&&b.stream.getVideoTracks().forEach(function(a){b.mediaStream.addTrack(a)});if("video"!=A||"safari"===e.a.browserEngineCheck())m.srcObject=b.mediaStream;G=!1;N="none";p=!0;n=z=!1}else k.a.error("stream-event",q.a.event_stream_media_failed,{id:b.getID(),err:"stream null"}),a["default"].error("reloadPlayer() failed id : "+b.getID()+" stream null, medtype - curr: "+
A+" new: "+f);break;default:N=c.reason,n=z=!0,ea(d,h,"user"==c.reason)?G=!0:(m.srcObject=null,G=!1),p=!0}}catch(na){a["default"].error("reloadPlayer() id : "+b.getID()+" NULL set medtype - curr: "+A+" new: "+f)}});p&&(A=f,t=h)}else a["default"].error("reloadPlayer() id : "+b.getID()+" ID selector  - "+m.stream+" null medtype - curr: "+A+" new: "+f+" storing AT req");X={talkerInfo:JSON.parse(JSON.stringify(c)),imageOnVideoMute:d}};b.setBandwidthAlert=function(a){b.getID();b.player&&!0===b.abwdEnabled&&
("low"===a.bw?"sdk"===b.abwdNotification?b.player.setBwAlert(!0,a.type,a.name):(a=Object(h.f)({type:"bw-alert",stream:b,stream_type:a.type,msg:"subscriber"===a.type?"subscriber low":a.name+" publisher low"}),b.dispatchEvent(a)):"sdk"===b.abwdNotification?b.player.setBwAlert(!1):(a=Object(h.f)({type:"bw-restored",stream:b}),b.dispatchEvent(a)))};b.setVideoMutedMessage=function(a){null!=b.player&&(!0===a.videomuted&&"bw"===a.reason?(b.videoMutedDueToBw=!0,b.player.setVideoMutedMsg(a)):!0===b.videoMutedDueToBw&&
b.player.setVideoMutedMsg(a))};var K=function(c){for(var d=0;d<b.playerDivs.length;d++){var f=document.getElementById(b.playerDivs[d].elementId);f&&(f=f.querySelectorAll("video"),0<f.length&&document.querySelectorAll("#"+f[0].id).forEach(function(d){try{d.srcObject=c}catch(ia){a["default"].error("Exception:: attachStreamOnPlayerDivs() streamId: "+b.getID()+" error: "+ia)}}))}};b.muteSubscriberStreamVideo=function(a){b.stream&&!b.local&&b.stream.getVideoTracks().forEach(function(b){b.enabled=!a})};
b.updateVideo=function(c,d){c=b.getPlayerId();void 0!==document.querySelector("#"+c.stream)&&null!==document.querySelector("#"+c.stream)?(void 0==b.player&&d&&(b.player=d),a["default"].info("Player element exists and playing the video",""+c.stream),b.ifScreen()||b.ifCanvas()?b.htmlPlay(""+c.stream):!b.local&&b.player&&b.player.video?b.player.video.srcObject=b.mediaStream:a["default"].error("player/player video not exist for streamId: "+b.getID())):a["default"].info("Player element does not exist")};
b.play=function(c,d){if("object"===typeof d&&d.hasOwnProperty("player")){a["default"].debug("Element ID is "+c);var f=d||{};b.elementID=c;d.player&&d.player.abwd&&(void 0!==d.player.abwd.enabled&&(b.abwdEnabled=d.player.abwd.enabled),!0===b.abwdEnabled&&d.player.abwd.notification&&(b.abwdNotification=d.player.abwd.notification,"sdk"===b.abwdNotification&&void 0!==d.player.abwd.language&&(b.abwdLanguage="en"===d.player.abwd.language||"zh"===d.player.abwd.language?d.player.abwd.language:"en")));if(b.ifVideo()||
b.ifScreen()||b.audioOnly||b.ifAudio())if(void 0!==c&&null!==document.getElementById(c)){var k={autoplay:!0};"safari"===e.a.browserEngineCheck()&&(k.playsinline=!0);f=Object(m.a)({id:b.getID(),stream:b,elementID:c,options:f,extraPlayerOptions:k,vroom:b.room?b.room:null,videoSource:b.local?b.inputMediaSource.video[b.inputMediaSource.video.selected]:b.mediaStream});b.local?f.video.muted=!0:b.playerDivs=[];b.player=f;b.showing=!0;a["default"].info("that.play() video player successfull streamId: "+b.getID());
b.playerDivs.push({elementId:c,options:d});void 0!==X&&(a["default"].debug("stream.play currentActiveTalkerList : calling reload player()"),b.reloadPlayer(X.talkerInfo,X.imageOnVideoMute));b.local||void 0==b.room||"audiovideo"!=A&&"audio"!=A||void 0==b.room.speakerInfo.id&&1==b.room.speakerInfo.volume||(b.setSpeaker(b.room.speakerInfo.id,b.room.speakerInfo.volume),a["default"].info("that.play() setting speaker for streamId: "+b.getID()+" speakerInfo: "+JSON.stringify(b.room.speakerInfo)+" sinkId set:  "+
b.player.video.sinkId))}else a["default"].error("that.play() faild, streamId: "+b.getID()+" error:  Element not found ");else b.ifAudio()||b.audioOnly?(f=Object(u.a)({id:b.getID(),stream:b,elementID:c,options:f,vroom:b.room?b.room:null}),b.local?f.audio.muted=!0:b.playerDivs=[],b.player=f,b.showing=!0,b.playerDivs.push({elementId:c,options:d}),A="audio",a["default"].info("that.play() audio player successfull streamId: "+b.getID())):a["default"].error("that.play() failed invalid stream streamId: "+
b.getID());b.reload&&delete b.reload;void 0!==b.room?!0===b.room.subscribeSessionStats?b.ShowSessionStats(!0):b.ShowSessionStats(!1):a["default"].info("that.play() failed streamId: "+b.getID()+" room not allocated to stream , stats UI not shown")}else a["default"].error("play() invalid param - callback/RoomDefinition")};b.resetMediaConfiguration=function(a){b.pc.resetSDP(a)};b.htmlPlay=function(c,d){b.elementID=c;(b.ifVideo()||b.ifScreen())&&void 0!==c&&document.querySelectorAll("#"+c).forEach(function(c){try{c.srcObject=
b.local?b.videoStream:b.mediaStream,void 0!==b.player&&(b.player.video.srcObject=c.srcObject)}catch(ka){c.src=URL.createObjectURL(b.local?b.videoStream:b.stream)}c.play().then(function(){}).catch(function(b){a["default"].error("Error playing video stream: "+b)})})};b.stop=function(a){if(b.showing){if(void 0!=a&&(b.playerDivs=b.playerDivs.filter(function(b){return b.elementId!=a}),!b.playerDivs.length))return;void 0!==b.player&&(b.player.destroy(),b.showing=!1)}};b.show=b.play;b.hide=b.stop;var T=
function(a){if(void 0!==b.player&&void 0!==b.stream){var c=document.defaultView.getComputedStyle(b.player.video),d=parseInt(c.getPropertyValue("width"),10),f=parseInt(c.getPropertyValue("height"),10);parseInt(c.getPropertyValue("left"),10);parseInt(c.getPropertyValue("top"),10);c="object"===typeof b.elementID&&"function"===typeof b.elementID.appendChild?b.elementID:document.getElementById(b.elementID);var e=document.defaultView.getComputedStyle(c);c=parseInt(e.getPropertyValue("width"),10);e=parseInt(e.getPropertyValue("height"),
10);if(document.getElementById(a))var k=document.getElementById(a);else k=document.createElement("canvas"),k.id=a,k.width=c,k.height=e,k.className="canvas_input",k.setAttribute("style","position: absolute;top: 15%;left: 45%;z-index: 897;"),document.body.appendChild(k);b.inputContext=k.getContext("2d");b.inputContext.drawImage(b.player.video,0,0,d,f);return k}return null};b.getVideoFrameURL=function(b){var a=T();return null!==a?b?a.toDataURL.apply(a,$jscomp.arrayFromIterable(b)):a.toDataURL():null};
b.getVideoFrameImage=function(b){b=T(b);return null!==b?b.getContext("2d").getImageData(10,10,b.width,b.height):null};b.checkOptions=function(c,d){if(!0===d){if(c.audio||c.screen)a["default"].warning("Error! Cannot update type of subscription"),c.audio=void 0,c.screen=void 0}else!1===b.local&&(!0===c.video&&!1===b.ifVideo()&&(a["default"].warning("Error! Stream doesn't have Video Track. Can't subscribe to Video"),c.video=!1),!0===c.audio&&!1===b.ifAudio()&&(a["default"].warning("Error! Stream doesn't have Audio Track. Can't subscribe to Audio"),
c.audio=!1));!1!==b.local||b.ifVideo()||!0!==c.slideShowMode||(a["default"].warning("Error! Stream doesn't have Video Track. Cannot enable slideShowMode. Check parameters"),c.slideShowMode=!1)};var ha=function(c,h,m){m=void 0===m?function(){}:m;console.log("Muting the stream : enable "+c);if(b.negotiatedMedia.audio)if(c===n)k.a.error("stream-event",q.a.event_general_failed,{message:"muteStreamAudio - MediaDevice state is already in same state"}),m(f.a.error_1177);else if(0==d("setMicrophoneTrack"))k.a.error("stream-event",
q.a.event_general_failed,{message:"muteStreamAudio - Previous similar request in process"}),m(f.a.error_1140);else{var r=function(c,d){try{var h=!1;if("safari"===e.a.browserEngineCheck()){var m=b.pc.peerConnection.getSenders().find(function(b){return b.track&&"audio"===b.track.kind||null===b.track});m&&b.audioStream.getAudioTracks().forEach(function(a){a.enabled=!c;c||"live"==a.readyState?m.replaceTrack(c?null:b.audioStream.getAudioTracks()[0]):(console.log(" setAudioTrack(): safari trackstate: ended"),
h=!0)})}else b.audioStream.getAudioTracks().forEach(function(b){b.enabled=!c;h||"ended"!=b.readyState||(h=!0);console.log(" setAudioTrack(): trackstate: ",b.readyState)});n=c;E("setMicrophoneTrack");void 0!=b.selectedMicId&&console.log("that.selectedMicId: "+b.selectedMicId);if(!c&&h){var r=void 0!=b.selectedMicId?b.selectedMicId:p.audio.deviceId;r?ja(b,r,void 0,!0,function(a){console.log("setMediaDevicesTrack : audio  status: "+a);a.result===f.a.error_000.result&&("safari"===e.a.browserEngineCheck()&&
(b.pc.peerConnection.getSenders().find(function(b){return b.track&&"audio"===b.track.kind||null===b.track}).replaceTrack(b.audioStream.getAudioTracks()[0]),n=c),d(a))}):(k.a.error("stream-event",q.a.event_general_failed,{message:"muteStreamAudio - error - stream ended"}),d(f.a.error_1191))}else n=c,k.a.info("stream-event",q.a.event_general_success,{message:"muteStreamAudio - success"}),d(f.a.error_000)}catch(Aa){a["default"].error("Excpetion happend : "+Aa),E("setMicrophoneTrack"),k.a.error("stream-event",
q.a.event_general_failed,{message:"muteStreamAudio - error - "+Aa}),d(f.a.error_1150)}};h?setTimeout(r,h,c,m):r(c,m)}else k.a.error("stream-event",q.a.event_general_failed,{message:"muteStreamAudio - Stream not found"}),m(f.a.error_1159)},O=function(a,c,e,h){h=void 0===h?function(){}:h;!a||b.negotiatedMedia.video||e?a!==z||e?0==d("setCameraTrack")?h(f.a.error_1140):(console.log("muteSTreamVideo() enable: "+a+" localVideoOn: "+M),e=function(a,c){try{if(a)Z(b,!1,!0,null,!M),z=a,E("setCameraTrack"),
c(f.a.error_000);else if(M)z=a,b.pc&&b.pc.peerConnection&&Z(b,!1,!0,b.videoStream,!1),E("setCameraTrack"),c(f.a.error_000);else{var d={};void 0!=p.video.deviceId?d.deviceId=p.video.deviceId:void 0!==p.video.facingMode&&"mobile"==v.a.browser_info.device_type&&(d.facingMode=p.video.facingMode);void 0==d.deviceId&&void 0==d.facingMode&&(d.deviceId="none");ja(b,void 0,d,!0,function(b){if(b.result===f.a.error_000.result)z=a;else{var d=v.a.getLocalStorageItem("vcxRTCLib-log");null!=d&&(d=JSON.parse(d),
k.a.error("stream-event",a?q.a.event_mute_self_video_failed:q.a.event_unmute_self_video_failed,{message:d}))}E("setCameraTrack");c(b)})}}catch(na){console.log("Excpetion happend : "+na),E("setCameraTrack"),d=v.a.getLocalStorageItem("vcxRTCLib-log"),null!=d&&(d=JSON.parse(d),k.a.error("stream-event",a?q.a.event_mute_self_video_failed:q.a.event_unmute_self_video_failed,{message:d})),c(f.a.error_1150)}},c?setTimeout(e,c,a,h):e(a,h)):(k.a.error("stream-event",q.a.event_general_failed,{message:"muteStreamVideo - MediaDevice state is already in same state"}),
h(f.a.error_1177)):(k.a.error("stream-event",q.a.event_general_failed,{message:"muteStreamVideo - Stream not found"}),h(f.a.error_1159))};b.muteAudio=function(c,d,e,k,h){c=void 0===c?function(){}:c;d=void 0===d?!0:d;e=void 0===e?0:e;k=void 0===k?!0:k;h=void 0===h?!1:h;"function"===typeof c?(console.log("muteAudio() selfSet : "+k+" selfMuteAudio: "+b.selfMuteAudio+" hardAudioMuted: "+b.hardAudioMuted+" audioMuted: "+n+" paused: "+b.selfPausedAudio+" config.audioMuted: "+b.config.audioMuted),k&&b.selfMuteAudio||
!k&&(b.hardAudioMuted||b.selfPausedAudio)?(!0===h&&(b.selfPausedAudio=!0),d&&b.sendEvent("user-audio-muted"),c(f.a.error_1177)):void 0!==b.pc&&null!=b.pc||void 0==b.audioStream?ha(!0,e,function(a){if(a.result===f.a.error_000.result||a.result===f.a.error_1177.result)k?b.selfMuteAudio=!0:h?b.selfPausedAudio=!0:b.hardAudioMuted=!0,a.result===f.a.error_000.result&&d?b.sendEvent("user-audio-muted"):d||(a=f.a.error_000);c(a)}):(b.audioStream.getAudioTracks().forEach(function(b){b.onended=null;b.enabled=
!1}),n=!0,k?(b.selfMuteAudio=!0,b.config.audioMuted=!0):h?b.selfPausedAudio=!0:b.hardAudioMuted=!0,c(f.a.error_000))):a["default"].error("muteAudio() invalid param - callback")};b.setMediaDeviceMuteState=function(a,c,d,e,k){try{if(c){if(a===n){k(f.a.error_1177);return}b.audioStream.getAudioTracks().forEach(function(b){b.enabled=!a});n=a;e&&b.sendEvent(n?"user-audio-muted":"user-audio-unmuted")}if(d){if(a===z){k(f.a.error_1177);return}b.stream.getVideoTracks().forEach(function(b){b.enabled=!a});z=
a;e&&b.sendEvent(z?"user-video-muted":"user-video-unmuted")}k(f.a.error_000)}catch(qa){console.log("Excpetion happend : "+qa),k(f.a.error_1150)}};b.muteAudioNotSelf=function(a,c){ha(!0,0,void 0===a?function(){}:a);void 0!==c&&!1===c||b.sendEvent("user-audio-muted")};b.getPlayerStats=function(){var a={};return b.player&&b.player.video?(a.vol=b.player.video.volume,a.muted=b.player.video.muted,b.player.video.srcObject&&(a.aTracks=b.player.video.srcObject.getAudioTracks().length,a.vTracks=b.player.video.srcObject.getVideoTracks().length),
a):!1};var pa=function(a){a.data&&0<a.data.size&&b.recordedBlobs.push(a.data)};b.startLocalRecord=function(c){c=void 0===c?function(){}:c;if(b.mediaRecorder)a["default"].error("Recording started already:"),c(f.a.error_1174);else try{b.mediaRecorder=new MediaRecorder(b.stream,{mimeType:"video/webm"}),b.mediaRecorder.ondataavailable=pa,b.recordedBlobs=[],b.mediaRecorder.start(10),c(f.a.error_000)}catch(ma){a["default"].error("Exception while creating MediaRecorder:",ma),c(f.a.error_000)}};b.stopLocalRecord=
function(a){a=void 0===a?function(){}:a;if(b.mediaRecorder&&0<b.recordedBlobs.length){var c=new Date,d=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();c=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();d="stream_"+b.getID()+"_"+d+"::"+c+".webm";c=new Blob(b.recordedBlobs,{type:"video/webm"});c=window.URL.createObjectURL(c);var e=document.createElement("a");e.style.display="none";e.href=c;e.download=d;e.click();window.URL.revokeObjectURL(c);a(f.a.error_000)}else a(f.a.error_1175);b.mediaRecorder=
void 0;b.recordedBlobs=[]};b.sendEvent=function(a){b.room&&b.room.socket.sendEvent(a,function(b){})};b.sendMessage=function(a,c,d){d=void 0===d?function(){}:d;b.room&&b.room.socket.emitEvent(a,c,function(b){d(b)})};b.unmuteAudio=function(c,d,e,k,h){c=void 0===c?function(){}:c;d=void 0===d?!0:d;e=void 0===e?0:e;k=void 0===k?!0:k;h=void 0===h?!1:h;if("function"===typeof c)if(console.log("unmuteAudio() selfSet : "+k+" selfMuteAudio: "+b.selfMuteAudio+" hardAudioMuted: "+b.hardAudioMuted+" audioMuted: "+
n+" paused: "+b.selfPausedAudio+" config.audioMuted: "+b.config.audioMuted),(!k||b.selfMuteAudio||!b.hardAudioMuted||b.selfPausedAudio||b.room&&b.room.isModerator())&&(k||b.hardAudioMuted||b.selfPausedAudio))if(!k||!b.hardAudioMuted||b.selfPausedAudio||b.room&&b.room.isModerator())if(!k&&b.selfMuteAudio)b.hardAudioMuted=!1,h&&(b.selfPausedAudio=!1),c(f.a.error_000);else if(k&&b.selfMuteAudio&&b.hardAudioMuted)b.selfMuteAudio=!1,h&&(b.selfPausedAudio=!1),c(f.a.error_000);else if(void 0!=x.switchMicrophone){var m=
x.switchMicrophone;b.switchMicrophone(m.newStream,m.deviceInfo,function(a){delete x.switchMicrophone;void 0==a.result?c(f.a.error_000):b.unmuteAudio(c,d,e,k,h)},!1)}else void 0!==b.pc&&null!=b.pc||void 0==b.audioStream?ha(!1,e,function(a){if(a.result===f.a.error_000.result||a.result===f.a.error_1177.result)k?b.selfMuteAudio=!1:h?b.selfPausedAudio=!1:b.hardAudioMuted=!1,a.result===f.a.error_000.result&&d?b.sendEvent("user-audio-unmuted"):d||(a=f.a.error_000);c(a)}):(b.audioStream.getAudioTracks().forEach(function(b){b.enabled=
!0}),!0===b.config.audioMuted&&(b.config.audioMuted=!1),n=!1,k?b.selfMuteAudio=!1:h?b.selfPausedAudio=!1:b.hardAudioMuted=!1,c(f.a.error_000));else c(f.a.error_1176);else console.log(" that.unmuteAudio() error177: selfSet: "+k+"  that.selfMuteAudio: "+b.selfMuteAudio+" that.hardAudioMuted: "+b.hardAudioMuted+" that.selfPausedAudio: "+b.selfPausedAudio),!d||b.selfMuteAudio||b.hardAudioMuted||b.sendEvent("user-audio-unmuted"),b.hardAudioMuted?c(f.a.error_1201):!k&&b.selfMuteAudio?c(f.a.error_1203):
c(f.a.error_1177);else a["default"].error("unmuteAudio() invalid param - callback")};b.hardMuteAudio=function(a){b.room&&!b.local&&b.sendMessage("hardmute-user-audio",{clientId:b.clientId})};b.hardUnmuteAudio=function(a){b.room&&!b.local&&b.sendMessage("hardunmute-user-audio",{clientId:b.clientId})};b.hardMuteVideo=function(a){b.room&&!b.local&&b.sendMessage("hardmute-user-video",{clientId:b.clientId})};b.hardUnmuteVideo=function(a){b.room&&!b.local&&b.sendMessage("hardunmute-user-video",{clientId:b.clientId})};
b.muteNonATPubVideo=function(a){b.videoStream&&(b.ATVideoMuted=!0,b.videoStream.getVideoTracks().forEach(function(b){b.enabled=!1}))};b.unmuteNonATPubVideo=function(a){b.videoStream&&!1===b.hardAudioMuted&&!1===b.selfMuteVideo&&!0===b.ATVideoMuted&&(b.ATVideoMuted=!1,b.videoStream.getVideoTracks().forEach(function(b){b.enabled=!0}))};var y=function(a,c,d){z=b.softVideoMuted=a;a||(b.softVideoMuted=!1);switch(c){case "self":b.selfMuteVideo=a;!a&&b.hardVideoMuted&&b.room&&b.room.isModerator()&&(b.hardVideoMuted=
!1);break;case "hard":b.hardVideoMuted=a;break;case "audioOnly":b.audioOnlyModeEnabled=a}d&&b.sendEvent(a?"user-video-muted":"user-video-unmuted")};b.muteVideo=function(c,d,e,k,h){c=void 0===c?function(){}:c;d=void 0===d?!0:d;e=void 0===e?0:e;k=void 0===k?"self":k;h=void 0===h?!1:h;if("function"===typeof c){console.log(" selfMuteVideo: "+b.selfMuteVideo+" audioOnlyEnabled: "+b.audioOnlyModeEnabled+" reason: "+k);switch(k){case "self":if(b.selfMuteVideo)var m=f.a.error_1177;break;case "hard":b.hardVideoMuted&&
(m=f.a.error_1177);break;case "audioOnly":b.audioOnlyModeEnabled&&(m=f.a.error_1177)}!m&&b.videoMuted&&(m=f.a.error_000);m?(d&&b.sendEvent("user-video-muted"),c(m)):void 0!==b.pc&&null!=b.pc||void 0==b.room||void 0==b.videoStream?h?(M||b.videoStream.getVideoTracks().forEach(function(b){b.enabled=!1}),b.softVideoMuted=!0,y(!0,k,d),c(f.a.error_000)):O(!0,e,!1,function(b){if(b.result===f.a.error_000.result||b.result===f.a.error_1177.result)y(!0,k,d),b.result===f.a.error_000.result?M||K(null):b=f.a.error_000;
c(b)}):(M||b.videoStream.getVideoTracks().forEach(function(b){b.onended=null;b.enabled=!1}),y(!0,k,d),c(f.a.error_000))}else a["default"].error("muteVideo() invalid param - callback")};b.unmuteVideo=function(c,d,e,k,h){c=void 0===c?function(){}:c;d=void 0===d?!0:d;e=void 0===e?0:e;k=void 0===k?"self":k;h=void 0===h?!1:h;if("function"===typeof c){console.log("unmuteVideo() that.selfMuteVideo: "+b.selfMuteVideo+" that.softVideoMuted: "+b.softVideoMuted+" that.hardVideoMuted: "+b.hardVideoMuted+" paused: "+
b.selfPausedAudio+"audioOnlyEnabled: "+b.audioOnlyModeEnabled);h||b.selfMuteVideo||b.softVideoMuted||b.hardVideoMuted||b.selfPausedVideo||b.audioOnlyModeEnabled||(d&&b.sendEvent("user-video-unmuted"),c(f.a.error_1177));switch(k){case "self":if(!b.selfMuteVideo)if(b.audioOnlyModeEnabled)var m=f.a.error_1152;else b.hardVideoMuted&&b.room&&!b.room.isModerator()&&(m=f.a.error_1168);else if(b.audioOnlyModeEnabled||b.hardVideoMuted&&b.room&&!b.room.isModerator())m=f.a.error_000,b.selfMuteVideo=!1;break;
case "hard":if(!b.hardVideoMuted)b.audioOnlyModeEnabled?m=f.a.error_1152:b.selfMuteVideo&&(m=f.a.error_1203);else if(b.audioOnlyModeEnabled||b.selfMuteVideo)m=f.a.error_000,b.hardVideoMuted=!1;break;case "audioOnly":if(!b.audioOnlyModeEnabled){if(b.selfMuteVideo||b.hardVideoMuted)m=f.a.error_1168}else if(b.selfMuteVideo||b.hardVideoMuted&&b.room&&!b.room.isModerator())m=f.a.error_000,b.audioOnlyModeEnabled=!1}m?c(m):void 0!=x.switchCamera?(m=x.switchCamera,b.switchCamera(m.newStream,m.deviceInfo,
function(a){delete x.switchCamera;void 0==a.result?(y(!1,k,d),console.log("unmuteVideo() switchCamera () NOT attaching playerdivs"),c(f.a.error_000)):b.unmuteVideo(c,d,e,selfSet)},!1,!0)):void 0!==b.pc&&null!=b.pc||!b.room||void 0==b.videoStream?O(!1,e,h,function(a){if(a.result===f.a.error_000.result||a.result===f.a.error_1177.result)if(a.result===f.a.error_000.result?(y(!1,k,d),console.log("unmuteVideo() muteStreamVideo() success"),M||K(b.inputMediaSource.video[b.inputMediaSource.video.selected])):
a=f.a.error_000,b.room&&!h){b.room.onMediaDeviceStateChanged(b,{type:"cam",state:"active"},c);return}c(a)}):(b.videoStream.getVideoTracks().forEach(function(b){b.enabled=!0}),!0===b.config.videoMuted&&(b.config.videoMuted=!1),y(!1,k,!1),c(f.a.error_000))}else a["default"].error("unmuteVideo() invalid param - callback")};b.setLocalView=function(c,e){e=void 0===e?function(){}:e;if("function"===typeof e)if(M==c)a["default"].error("setLocalVideo() already in same state"),e(f.a.error_1177);else if(0==
d("setCameraTrack"))k.a.warn("stream-event",q.a.event_general_failed,{message:"setLocalVideo - Previous similar camera request in process"}),e(f.a.error_1140);else if(console.log("setLocalView() enable : "+c),c)if(b.isVideoMuted()){var h={};p.params&&p.params.set.video&&"object"===typeof p.params.set.video.deviceId&&(h.deviceId=p.params.set.video.deviceId.exact);if(void 0!=x.switchCamera){var m=x.switchCamera;b.switchCamera(m.newStream,m.deviceInfo,function(a){delete x.switchCamera;void 0==a.result?
M=!0:b.setLocalView(c,e)},!1,!1)}else m=JSON.parse(JSON.stringify(p.video)),p.params&&p.params.set&&p.params.set.video&&(p.params.set.video.deviceId?m.deviceId="object"==typeof p.params.set.video.deviceId?p.params.set.video.deviceId.exact:p.params.set.video.deviceId:p.params.set.video.facingMode&&(m.facingMode="object"==typeof p.params.set.video.facingMode?p.params.set.video.facingMode.exact:p.params.set.video.facingMode)),void 0!=m.deviceId?h.deviceId=m.deviceId:void 0!==m.facingMode&&"mobile"==
v.a.browser_info.device_type&&(h.facingMode=m.facingMode),void 0==h.deviceId&&void 0==h.facingMode&&(h.deviceId="none"),ja(b,void 0,h,!1,function(c){c.result===f.a.error_000.result?(console.log("setMediaDevicesTrack() success attaching playerdiv "),M=!0,K(b.inputMediaSource.video[b.inputMediaSource.video.selected])):(console.log("setMediaDevicesTrack() failed "),a["default"].info("Error setMediaDevicesTrack(), error: "+JSON.stringify(c)+" cam: "+h.deviceId));E("setCameraTrack");e(c,M?b.videoStream:
null)})}else b.negotiatedMedia.video&&void 0!=b.videoStream?(M=!0,E("setCameraTrack"),console.log("not muted sending stream "),e(f.a.error_000,b.videoStream)):(E("setCameraTrack"),console.log("error not muted but no video stream"),e(f.a.error_1159));else M=!1,b.isVideoMuted()&&(console.log("muted disabling localview by replace track"),void 0!==b.videoStream&&b.videoStream.getTracks().forEach(function(b){b.enabled=!1;b.onended=null;b.stop()})),console.log("disabling localview detaching player divs"),
K(null),E("setCameraTrack"),e(f.a.error_000);else a["default"].error("setLocalView() invalid param - callback")};b.checkHealth=function(){var c={result:!1,resultStr:" video Muted"};if(!n||!z){var d=function(b){var a=b.enabled&&!b.muted&&"live"==b.readyState;return{result:a,resultStr:a?" isTrackOn() success enabled :"+b.enabled+" muted: "+b.muted+" readyState: "+b.readyState:"isTrackOn() failed enabled :"+b.enabled+" muted: "+b.muted+" readyState: "+b.readyState}},f=function(a,c,d){var f=!1,e="isPlayerOn() ";
b.player&&b.player.video&&!b.player.video.ended&&!b.player.video.paused&&b.player.video.srcObject?(c=c?b.player.video.srcObject.getAudioTracks()[0]:b.player.video.srcObject.getVideoTracks()[0])?c.id==a.id?e=(f=d?b.player.video.sinkId&&b.player.video.volume:!0)?e+(" success trackId: "+a.id):e+(" failed trackId: "+a.id+" spaker failed: sinkId: "+(b.player.video.sinkId?b.player.video.sinkId:" null")+" volume: "+b.player.video.volume):e+=" failed, track Id mismatch track Id -  player: "+c.id+" stream: "+
a.id:e+=" failed,  player track missing track Id - "+a.id:e+=b.player?b.player.video?b.player.video.srcObject?b.player.video.ended?" player.video.ended ":b.player.video.paused?" player.video.paused ":" ":" player.video.srcObject missing ":" that.player.video missing ":" that.player missing";return{result:f,resultStr:e}},e=function(a,c,d){var f=!1;if(b.pc&&b.pc.peerConnection){var e=parseInt(c);if(b.local){var k=b.pc.peerConnection.getSenders();e=d?0:1}else k=b.pc.peerConnection.getReceivers(),e=d?
2*(e-1):2*(e-1)+1;k&&k[e]&&k[e].track?a=(f=k[e].track.id==a.id)?" success trackId: "+a.id+" strmId : "+c+" audio: "+d:" failed  trackId mismacth trackId transceiver: "+k[e].track.id+" streamTrack: "+a.id+" strmId : "+c+" audio: "+d:(a=" failed rtp transceiver ",a=k?k[e]?a+(" array undefined index: "+e):a+(" track undefined index: "+e):a+" undefined")}else a=" failed pc/pc.peerConnection null trackId: "+a.id+" strmId : "+c+" audio: "+d;return{result:f,resultStr:a}};if(!n&&b.audioStream){a["default"].info(" checkHealth() checking audio ");
var k=d(b.audioStream.getAudioTracks()[0]);k.result?(b.local||(k=f(b.audioStream.getAudioTracks()[0],!0,!0)),k.result?(k=e(b.audioStream.getAudioTracks()[0],b.getID(),!0),k.result?a["default"].info(" checkHealth() success for streamId: "+b.getID()+" audio true  local: "+b.local):a["default"].error(" checkHealth() isPCStreamTrackMatch() failed streamId: "+b.getID()+" audio true "+k.resultStr+" local: "+b.local)):a["default"].error(" checkHealth() isPlayerOn() failed streamId: "+b.getID()+" audio true "+
k.resultStr+" local: "+b.local)):a["default"].error(" checkHealth() isTrackOn() failed streamId: "+b.getID()+" audio true "+k.resultStr+" local: "+b.local)}!z&&(a["default"].info(" checkHealth() checking video "),k=b.local?b.videoStream:b.mediaStream)&&(c=d(k.getVideoTracks()[0]),c.result?(b.local||(c=f(k.getVideoTracks()[0],!1,!0)),c.result?(c=e(k.getVideoTracks()[0],b.getID(),!1),c.result?a["default"].info(" checkHealth() success for streamId: "+b.getID()+" video true  local: "+b.local):a["default"].error(" checkHealth() isPCStreamTrackMatch() failed streamId: "+
b.getID()+" video true "+c.resultStr+" local: "+b.local)):a["default"].error(" checkHealth() isPlayerOn() failed streamId: "+b.getID()+" video true "+c.resultStr+" local: "+b.local)):a["default"].error(" checkHealth() isTrackOn() failed streamId: "+b.getID()+" audio true "+c.resultStr+" local: "+b.local))}return{id:b.getID(),audio:{result:!1,resultStr:" audio Muted"},video:c}};b._setStaticQualityLayer=function(c,d,f){f=void 0===f?function(){}:f;b.room&&b.room.p2p?(a["default"].warning("Error! p2p streams don't support setStaticQualityLayer"),
f("error")):(c={qualityLayer:{spatialLayer:c,temporalLayer:d}},b.checkOptions(c,!0),b.pc.updateSpec(c,f))};b._setDynamicQualityLayer=function(c){if(b.room&&b.room.p2p)a["default"].warning("Error! p2p streams don't support setDynamicQualityLayer"),c("error");else{var d={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};b.checkOptions(d,!0);b.pc.updateSpec(d,c)}};var D=function(a,c,d){!0!==c&&(c=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&b.room.sendControlMessage(b,"control",
{name:"controlhandlers",enable:d,publisherSide:c,handlers:a})};b.disableHandlers=function(b,a){D(b,a,!1)};b.enableHandlers=function(b,a){D(b,a,!0)};b.updateSimulcastLayersBitrate=function(a,c){b.pc&&b.local&&(b.pc.updateSimulcastLayersBitrate(a),c&&(config.maxVideoLayeredBitrates=a))};b.updateConfiguration=function(a,c){c=void 0===c?function(){}:c;if(void 0!==a)if(b.pc)if(b.checkOptions(a,!0),b.local)if(b.room.p2p)for(var d=0;d<b.pc.length;d+=1)b.pc[d].updateSpec(a,c);else void 0!=a.maxVideoBW||void 0!=
a.minVideoBW||void 0!=a.maxVideoFps||void 0!=a.minVideoFps?1>=b.maxVideoLayers&&b.setVideoParamsRange(a.maxVideoBW,a.minVideoBW,a.maxVideoFps,a.minVideoFps,!1):b.pc.updateSpec(a,c);else b.pc.updateSpec(a,c);else c("Error! This stream has no peerConnection attached, Skipping")};b.ShowSessionStats=function(c){!0===c?void 0!==b.player?b.player.ShowSessionStats(!0):a["default"].info("stream does not have a player to show stats"):void 0!==b.player?b.player.ShowSessionStats(!1):a["default"].info("stream does not have a player to hide stats")};
b.changeInputMediaSource=function(c,e){e=void 0===e?function(){}:e;if("function"!==typeof e)a["default"].error("changeInputMediaSource() invalid param - callback");else if(!b.local||b.ifCanvas()||b.ifScreen())a["default"].error("changeInputMediaSource() not supported "),e(f.a.error_1156);else if(void 0==c||"object"!==typeof c||void 0==c.video&&void 0==c.audio)a["default"].error("changeInputMediaSource() invalid param - options"),e(f.a.error_1155);else if(c.video)if(!c.stream||c.stream.getVideoTracks()&&
c.stream.getVideoTracks().length)if(0==d("setCameraTrack"))k.a.warn("stream-event",q.a.event_general_failed,{message:"changeInputMediaSource() - Previous similar camera request in process"}),e(f.a.error_1140);else{b.inputMediaSource.video.user=void 0!=c.stream&&null!=c.stream?c.stream:null;if(null!=b.inputMediaSource.video.user){c=b.inputMediaSource.video.user;var h="user"}else c=b.inputMediaSource.video.self,h="self";b.isVideoMuted()||b.inputMediaSource.video.selected==h||(Z(b,!1,!0,c,!1),K(c));
b.inputMediaSource.video.selected=h;E("setCameraTrack");e(f.a.error_000)}else a["default"].error("changeInputMediaSource() video tracks not found"),e(f.a.error_1156)};b.replaceLocalTrack=function(b,a){b.pc.peerConnection.getSenders().forEach(function(c,d){c.track&&("video"===c.track.kind?a&&a.getVideoTracks().forEach(function(b){console.log(b);b.enabled=!0;c.replaceTrack(b)}):"audio"===c.track.kind&&b&&b.audioStream.getAudioTracks().forEach(function(b){console.log(b);b.enabled=!0;c.replaceTrack(b)}))})};
b.enableNoiseSuppression=function(c){c=void 0===c?function(){}:c;if("function"!=typeof c)a["default"].error("Incorrect type for callback, it should be a function");else{if(!r)return c(f.a.error_1170);if(void 0==b.audioStream)return a["default"].debug("audio stream/tracks coming as undefined !!"),c(f.a.error_1198);if(0==r.isAlreadyStarted())r.startNoiseProcessing(b.audioStream).then(function(a){Z(b,!0,!1,a,!1,!1);return c(f.a.error_000)}).catch(function(){return c(f.a.error_1198)});else return c(f.a.error_1188)}};
b.disableNoiseSuppression=function(c){c=void 0===c?function(){}:c;if("function"!=typeof c)a["default"].error("Incorrect type for callback, it should be a function");else{if(!r)return c(f.a.error_1170);if(0==r.isAlreadyStarted())return c(f.a.error_1188);1==r.isAlreadyStarted()&&r.stopNoiseProcessing().then(function(){Z(b,!0,!1,b.audioStream,!1,!1);return c(f.a.error_000)}).catch(function(){return c(f.a.error_1199)})}};b.noiseProcessingFeatureExists=function(){return r?new Promise(function(b,a){r.checkFileExists().then(function(a){b(a)}).catch(function(b){a(b)})}):
callback(f.a.error_1170)};return b}console.log("Webrtc not supported")}},function(l,t,n){t.a=function(){return{player:{default:{autoplay:"autoplay",name:"",nameDisplayMode:"",frameFitMode:"bestFit",skin:"default",class:"",height:"240px",width:"320px",minHeight:"200px",minWidth:"250px",aspectRatio:"16:9",volume:5,media:"",loader:{show:!0,style:"default",class:""}}},brand:{default:{display:!0,url:"http://www.vcloudx.com",logo:"/assets/favicon.png",show:!0,target:"_blank",title:"VCloudX Infotech"}},
toolbar:{default:{skin:"default",buttons:{play:!0,resize:!0,share:!0,mic:!0,volume:!0,mute:!0,record:!0,playtime:!0,zoom:!0},position:"bottom",class:"",displayMode:!0,autoDisplayTimeout:0}}}}},function(l,t,n){function h(b,a){var c={"Content-Type":"application/json"};a&&(c.Authentication="Bearer "+a);return{method:"POST",headers:new Headers(c),body:JSON.stringify(b)}}function u(b,a,c){var f,e,k,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){if(1==m.nextAddress)return f={},a=a||{},
m.yield(c.authHeader(),2);if(3!=m.nextAddress)return e=m.yieldResult,a.headers=new Headers({Authorization:e}),m.yield(fetch(b,a),3);k=m.yieldResult;f.response=k;f.ok=k.ok;h=(k.headers.get("WWW-Authenticate")||"").split(" ")[1];f.shouldRetry=401===k.status&&h!==c.nonce;c.nonce=h;return m.return(f)})}function m(b,a,c){var f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(u(b,a,c),2);f=e.yieldResult;return f.shouldRetry?e.return(u(b,a,c)):e.return(f)})}
function e(a){return new Promise(function(c,f){try{var e=new WebSocket(a);e.addEventListener("open",function(){return c(e)},{once:!0})}catch(G){v["default"].info("asyncInitWebSocket exception while creating websocket",G),f(new b(!1))}})}function a(a,c){return new Promise(function(f,e){function k(f){a.removeEventListener("message",h);e(new b(c.cancelled))}function h(b){a.removeEventListener("close",k);try{var c=JSON.parse(b.data);if(c.error)throw v["default"].error(" listenForResponse throw exception ",
c.error),Error(c.error);f(c)}catch(fa){v["default"].error(" listenForResponse exception ",fa),e(fa)}}a.addEventListener("message",h,{once:!0});a.addEventListener("close",k,{once:!0})})}function c(b,c,f,h,m,w,l,J,u){var z,n,M,d,A,t,Z,ea,K,C,N,G,H,y,X;return $jscomp.asyncExecutePromiseGeneratorProgram(function(T){switch(T.nextAddress){case 1:return z=0,n=Date.now(),M="https:"===window.location.protocol?"wss:":"ws:",d="file:"===window.location.protocol?r:M+"//"+x+(p?":":"")+p+"/api/ws",T.yield(e(d),
2);case 2:A=T.yieldResult;T.setCatchFinallyBlocks(3,4);t=Object(q.arrayToB64)(new Uint8Array(c));Z={};var ha=l;ha=void 0===ha?{}:ha;F.file_meta=ha;F.trans_dt=Date.now();Z=F;ea={fileMetadata:t,authorization:"send-v1 "+f,bearer:w,timeLimit:h,dlimit:m,callInfo:Z};K=a(A,u);A.send(JSON.stringify(ea));return T.yield(K,6);case 6:return C=T.yieldResult,N=a(A,u),G=b.getReader(),T.yield(G.read(),7);case 7:H=T.yieldResult;case 8:if(H.done){T.jumpTo(9);break}u.cancelled&&(v["default"].info(" websocket upload cancelled"),
A.close());if(A.readyState!==WebSocket.OPEN){T.jumpTo(9);break}y=H.value;A.send(y);J(z);z+=y.length;return T.yield(G.read(),10);case 10:H=T.yieldResult;case 11:if(!(A.bufferedAmount>2*k.a&&A.readyState===WebSocket.OPEN)||u.cancelled){T.jumpTo(8);break}return T.yield(Object(q.delay)(),11);case 9:return A.readyState===WebSocket.OPEN&&A.send(new Uint8Array([0])),T.yield(N,14);case 14:return C.duration=Date.now()-n,T.return(C);case 4:T.enterFinallyBlock();[WebSocket.CLOSED,WebSocket.CLOSING].includes(A.readyState)||
A.close();T.leaveFinallyBlock(0);break;case 3:throw X=T.enterCatchBlock(),X.size=z,X.duration=Date.now()-n,v["default"].info(" websocket upload failed",X),X;}})}function f(b,a,c,f){var e,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(a.authHeader(),2);e=h.yieldResult;k=new XMLHttpRequest;f.oncancel=function(){k.abort()};return h.return(new Promise(function(h,m){k.addEventListener("loadend",function(){f.oncancel=function(){};var b=k.getResponseHeader("WWW-Authenticate");
b&&(a.nonce=(b||"").split(" ")[1]);if(200!==k.status)return m(Error(k.status));b=new Blob([k.response]);h(b)});k.addEventListener("progress",function(b){200===b.target.status&&c(b.loaded)});k.open("get",J+("/api/download/blob/"+b));k.setRequestHeader("Authorization",e);k.responseType="blob";k.send();c(0)}))})}function w(b,a,c,e,k){k=void 0===k?2:k;var h,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){if(1==q.nextAddress)return q.setCatchFinallyBlocks(2),q.yield(f(b,a,c,e),4);if(2!=
q.nextAddress)return h=q.yieldResult,q.return(h);m=q.enterCatchBlock();if("401"===m.message&&0<--k)return q.return(w(b,a,c,e,k));throw m;})}t.d=function(b){return J+b};t.f=function(b){void 0!=b&&void 0!=b.url&&void 0!=b.hostName&&void 0!=b.port&&(J=b.url,x=b.hostName,p=b.port,r="wss://"+x+":"+p+"/api/ws",b=b.callInfo,v["default"].info(" file sharing service call details",b),F.userName=b.userName,F.room_id=b.room_id,F.conf_num=b.conf_num,F.call_num=b.call_num,F.service_id=b.service_id)};t.a=function(b,
a){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return f.yield(fetch(J+("/api/delete/"+b),h({owner_token:a})),2);c=f.yieldResult;return f.return(c.ok)})};t.g=function(b,a,c,f){var e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return k.yield(fetch(J+("/api/params/"+b),h({owner_token:a,dlimit:f.dlimit},c)),2);e=k.yieldResult;return k.return(e.ok)})};t.c=function(b,a){var c,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){switch(e.nextAddress){case 1:return e.yield(fetch(J+
("/api/info/"+b),h({owner_token:a})),2);case 2:c=e.yieldResult;if(!c.ok){e.jumpTo(3);break}return e.yield(c.json(),4);case 4:return f=e.yieldResult,e.return(f);case 3:throw Error(c.status);}})};t.e=function(b,a){var c,f,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return k.yield(m(J+("/api/metadata/"+b),{method:"GET"},a),2);case 2:c=k.yieldResult;if(!c.ok){k.jumpTo(3);break}return k.yield(c.response.json(),4);case 4:return f=k.yieldResult,k.yield(a.decryptMetadata(Object(q.b64ToArray)(f.metadata)),
5);case 5:return e=k.yieldResult,k.return({size:e.size,ttl:f.ttl,iv:e.iv,name:e.name,type:e.type,manifest:e.manifest});case 3:throw Error(c.response.status);}})};t.h=function(b,a,c){var f,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return k.yield(c.authKeyB64(),2);if(3!=k.nextAddress)return f=k.yieldResult,k.yield(fetch(J+("/api/password/"+b),h({owner_token:a,auth:f})),3);e=k.yieldResult;return k.return(e.ok)})};t.i=function(b,a,f,e,k,h,m,q){var p={cancelled:!1};
return{cancel:function(){p.cancelled=!0},result:c(b,a,f,e,k,h,m,q,p)}};t.b=function(b,a,c){var f={oncancel:function(){}};return{cancel:function(){f.oncancel()},result:w(b,a,c,f)}};var q=n(12);n.n(q);var k=n(30),v=n(0),r=null,x="",p="";r||(r="");var b=function(b,a,c){var f=Error.call(this,b?"0":"connection closed");this.message=f.message;"stack"in f&&(this.stack=f.stack);this.cancelled=b;this.duration=a;this.size=c};$jscomp.inherits(b,Error);var J="",F={}},function(l,t,n){(function(h){function l(){try{var b=
new Uint8Array(1);b.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===b.foo()&&"function"===typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(ea){return!1}}function m(b,a){if((e.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<a)throw new RangeError("Invalid typed array length");e.TYPED_ARRAY_SUPPORT?(b=new Uint8Array(a),b.__proto__=e.prototype):(null===b&&(b=new e(a)),b.length=a);return b}function e(b,c,d){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(b,
c,d);if("number"===typeof b){if("string"===typeof c)throw Error("If encoding is specified then the first argument must be a string");return f(this,b)}return a(this,b,c,d)}function a(b,a,c,d){if("number"===typeof a)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&a instanceof ArrayBuffer){a.byteLength;if(0>c||a.byteLength<c)throw new RangeError("'offset' is out of bounds");if(a.byteLength<c+(d||0))throw new RangeError("'length' is out of bounds");a=
void 0===c&&void 0===d?new Uint8Array(a):void 0===d?new Uint8Array(a,c):new Uint8Array(a,c,d);e.TYPED_ARRAY_SUPPORT?(b=a,b.__proto__=e.prototype):b=w(b,a);return b}if("string"===typeof a){d=b;b=c;if("string"!==typeof b||""===b)b="utf8";if(!e.isEncoding(b))throw new TypeError('"encoding" must be a valid string encoding');c=v(a,b)|0;d=m(d,c);a=d.write(a,b);a!==c&&(d=d.slice(0,a));return d}return q(b,a)}function c(b){if("number"!==typeof b)throw new TypeError('"size" argument must be a number');if(0>
b)throw new RangeError('"size" argument must not be negative');}function f(b,a){c(a);b=m(b,0>a?0:k(a)|0);if(!e.TYPED_ARRAY_SUPPORT)for(var d=0;d<a;++d)b[d]=0;return b}function w(b,a){var c=0>a.length?0:k(a.length)|0;b=m(b,c);for(var d=0;d<c;d+=1)b[d]=a[d]&255;return b}function q(b,a){if(e.isBuffer(a)){var c=k(a.length)|0;b=m(b,c);if(0===b.length)return b;a.copy(b,0,0,c);return b}if(a){if("undefined"!==typeof ArrayBuffer&&a.buffer instanceof ArrayBuffer||"length"in a)return(c="number"!==typeof a.length)||
(c=a.length,c=c!==c),c?m(b,0):w(b,a);if("Buffer"===a.type&&d(a.data))return w(b,a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function k(b){if(b>=(e.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return b|0}function v(b,a){if(e.isBuffer(b))return b.length;if("undefined"!==typeof ArrayBuffer&&
"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(b)||b instanceof ArrayBuffer))return b.byteLength;"string"!==typeof b&&(b=""+b);var c=b.length;if(0===c)return 0;for(var d=!1;;)switch(a){case "ascii":case "latin1":case "binary":return c;case "utf8":case "utf-8":case void 0:return H(b).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*c;case "hex":return c>>>1;case "base64":return da.toByteArray(X(b)).length;default:if(d)return H(b).length;a=(""+a).toLowerCase();d=
!0}}function r(b,a,c){var d=!1;if(void 0===a||0>a)a=0;if(a>this.length)return"";if(void 0===c||c>this.length)c=this.length;if(0>=c)return"";c>>>=0;a>>>=0;if(c<=a)return"";for(b||(b="utf8");;)switch(b){case "hex":b=a;a=c;c=this.length;if(!b||0>b)b=0;if(!a||0>a||a>c)a=c;d="";for(c=b;c<a;++c)b=d,d=this[c],d=16>d?"0"+d.toString(16):d.toString(16),d=b+d;return d;case "utf8":case "utf-8":return J(this,a,c);case "ascii":b="";for(c=Math.min(this.length,c);a<c;++a)b+=String.fromCharCode(this[a]&127);return b;
case "latin1":case "binary":b="";for(c=Math.min(this.length,c);a<c;++a)b+=String.fromCharCode(this[a]);return b;case "base64":return a=0===a&&c===this.length?da.fromByteArray(this):da.fromByteArray(this.slice(a,c)),a;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":a=this.slice(a,c);c="";for(b=0;b<a.length;b+=2)c+=String.fromCharCode(a[b]+256*a[b+1]);return c;default:if(d)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase();d=!0}}function x(b,a,c){var d=b[a];b[a]=b[c];b[c]=d}
function p(a,c,d,f,k){if(0===a.length)return-1;"string"===typeof d?(f=d,d=0):2147483647<d?d=2147483647:-2147483648>d&&(d=-2147483648);d=+d;isNaN(d)&&(d=k?0:a.length-1);0>d&&(d=a.length+d);if(d>=a.length){if(k)return-1;d=a.length-1}else if(0>d)if(k)d=0;else return-1;"string"===typeof c&&(c=e.from(c,f));if(e.isBuffer(c))return 0===c.length?-1:b(a,c,d,f,k);if("number"===typeof c)return c&=255,e.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?k?Uint8Array.prototype.indexOf.call(a,
c,d):Uint8Array.prototype.lastIndexOf.call(a,c,d):b(a,[c],d,f,k);throw new TypeError("val must be string, number or Buffer");}function b(b,a,c,d,f){function e(b,a){return 1===k?b[a]:b.readUInt16BE(a*k)}var k=1,h=b.length,m=a.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>b.length||2>a.length)return-1;k=2;h/=2;m/=2;c/=2}if(f)for(d=-1;c<h;c++)if(e(b,c)===e(a,-1===d?0:c-d)){if(-1===d&&(d=c),c-d+1===m)return d*k}else-1!==d&&(c-=c-d),d=-1;
else for(c+m>h&&(c=h-m);0<=c;c--){h=!0;for(d=0;d<m;d++)if(e(b,c+d)!==e(a,d)){h=!1;break}if(h)return c}return-1}function J(b,a,c){c=Math.min(b.length,c);for(var d=[];a<c;){var f=b[a],e=null,k=239<f?4:223<f?3:191<f?2:1;if(a+k<=c)switch(k){case 1:128>f&&(e=f);break;case 2:var h=b[a+1];128===(h&192)&&(f=(f&31)<<6|h&63,127<f&&(e=f));break;case 3:h=b[a+1];var m=b[a+2];128===(h&192)&&128===(m&192)&&(f=(f&15)<<12|(h&63)<<6|m&63,2047<f&&(55296>f||57343<f)&&(e=f));break;case 4:h=b[a+1];m=b[a+2];var q=b[a+3];
128===(h&192)&&128===(m&192)&&128===(q&192)&&(f=(f&15)<<18|(h&63)<<12|(m&63)<<6|q&63,65535<f&&1114112>f&&(e=f))}null===e?(e=65533,k=1):65535<e&&(e-=65536,d.push(e>>>10&1023|55296),e=56320|e&1023);d.push(e);a+=k}b=d.length;if(b<=E)d=String.fromCharCode.apply(String,d);else{c="";for(a=0;a<b;)c+=String.fromCharCode.apply(String,d.slice(a,a+=E));d=c}return d}function F(b,a,c){if(0!==b%1||0>b)throw new RangeError("offset is not uint");if(b+a>c)throw new RangeError("Trying to access beyond buffer length");
}function z(b,a,c,d,f,k){if(!e.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>f||a<k)throw new RangeError('"value" argument is out of bounds');if(c+d>b.length)throw new RangeError("Index out of range");}function M(b,a,c,d){0>a&&(a=65535+a+1);for(var f=0,e=Math.min(b.length-c,2);f<e;++f)b[c+f]=(a&255<<8*(d?f:1-f))>>>8*(d?f:1-f)}function A(b,a,c,d){0>a&&(a=4294967295+a+1);for(var f=0,e=Math.min(b.length-c,4);f<e;++f)b[c+f]=a>>>8*(d?f:3-f)&255}function C(b,a,c,d,
f,e){if(c+d>b.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range");}function G(b,a,c,d,f){f||C(b,a,c,4,3.4028234663852886E38,-3.4028234663852886E38);la.write(b,a,c,d,23,4);return c+4}function N(b,a,c,d,f){f||C(b,a,c,8,1.7976931348623157E308,-1.7976931348623157E308);la.write(b,a,c,d,52,8);return c+8}function X(b){b=b.trim?b.trim():b.replace(/^\s+|\s+$/g,"");b=b.replace(ja,"");if(2>b.length)return"";for(;0!==b.length%4;)b+="=";return b}function H(b,a){a=
a||Infinity;for(var c,d=b.length,f=null,e=[],k=0;k<d;++k){c=b.charCodeAt(k);if(55295<c&&57344>c){if(!f){if(56319<c){-1<(a-=3)&&e.push(239,191,189);continue}else if(k+1===d){-1<(a-=3)&&e.push(239,191,189);continue}f=c;continue}if(56320>c){-1<(a-=3)&&e.push(239,191,189);f=c;continue}c=(f-55296<<10|c-56320)+65536}else f&&-1<(a-=3)&&e.push(239,191,189);f=null;if(128>c){if(0>--a)break;e.push(c)}else if(2048>c){if(0>(a-=2))break;e.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(a-=3))break;e.push(c>>12|
224,c>>6&63|128,c&63|128)}else if(1114112>c){if(0>(a-=4))break;e.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return e}function fa(b){for(var a=[],c=0;c<b.length;++c)a.push(b.charCodeAt(c)&255);return a}function Q(b,a,c,d){for(var f=0;f<d&&!(f+c>=a.length||f>=b.length);++f)a[f+c]=b[f];return f}var da=n(29),la=n(55),d=n(56);t.Buffer=e;t.SlowBuffer=function(b){+b!=b&&(b=0);return e.alloc(+b)};t.INSPECT_MAX_BYTES=50;e.TYPED_ARRAY_SUPPORT=void 0!==h.TYPED_ARRAY_SUPPORT?
h.TYPED_ARRAY_SUPPORT:l();t.kMaxLength=e.TYPED_ARRAY_SUPPORT?2147483647:1073741823;e.poolSize=8192;e._augment=function(b){b.__proto__=e.prototype;return b};e.from=function(b,c,d){return a(null,b,c,d)};e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&($jscomp.initSymbol(),Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})));
e.alloc=function(b,a,d){c(b);b=0>=b?m(null,b):void 0!==a?"string"===typeof d?m(null,b).fill(a,d):m(null,b).fill(a):m(null,b);return b};e.allocUnsafe=function(b){return f(null,b)};e.allocUnsafeSlow=function(b){return f(null,b)};e.isBuffer=function(b){return!(null==b||!b._isBuffer)};e.compare=function(b,a){if(!e.isBuffer(b)||!e.isBuffer(a))throw new TypeError("Arguments must be Buffers");if(b===a)return 0;for(var c=b.length,d=a.length,f=0,k=Math.min(c,d);f<k;++f)if(b[f]!==a[f]){c=b[f];d=a[f];break}return c<
d?-1:d<c?1:0};e.isEncoding=function(b){switch(String(b).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=function(b,a){if(!d(b))throw new TypeError('"list" argument must be an Array of Buffers');if(0===b.length)return e.alloc(0);var c;if(void 0===a)for(c=a=0;c<b.length;++c)a+=b[c].length;a=e.allocUnsafe(a);var f=0;for(c=0;c<b.length;++c){var k=b[c];
if(!e.isBuffer(k))throw new TypeError('"list" argument must be an Array of Buffers');k.copy(a,f);f+=k.length}return a};e.byteLength=v;e.prototype._isBuffer=!0;e.prototype.swap16=function(){var b=this.length;if(0!==b%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<b;a+=2)x(this,a,a+1);return this};e.prototype.swap32=function(){var b=this.length;if(0!==b%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<b;a+=4)x(this,a,a+3),x(this,a+
1,a+2);return this};e.prototype.swap64=function(){var b=this.length;if(0!==b%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<b;a+=8)x(this,a,a+7),x(this,a+1,a+6),x(this,a+2,a+5),x(this,a+3,a+4);return this};e.prototype.toString=function(){var b=this.length|0;return 0===b?"":0===arguments.length?J(this,0,b):r.apply(this,arguments)};e.prototype.equals=function(b){if(!e.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===e.compare(this,
b)};e.prototype.inspect=function(){var b="",a=t.INSPECT_MAX_BYTES;0<this.length&&(b=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(b+=" ... "));return"<Buffer "+b+">"};e.prototype.compare=function(b,a,c,d,f){if(!e.isBuffer(b))throw new TypeError("Argument must be a Buffer");void 0===a&&(a=0);void 0===c&&(c=b?b.length:0);void 0===d&&(d=0);void 0===f&&(f=this.length);if(0>a||c>b.length||0>d||f>this.length)throw new RangeError("out of range index");if(d>=f&&a>=c)return 0;if(d>=f)return-1;
if(a>=c)return 1;a>>>=0;c>>>=0;d>>>=0;f>>>=0;if(this===b)return 0;var k=f-d,h=c-a,m=Math.min(k,h);d=this.slice(d,f);b=b.slice(a,c);for(a=0;a<m;++a)if(d[a]!==b[a]){k=d[a];h=b[a];break}return k<h?-1:h<k?1:0};e.prototype.includes=function(b,a,c){return-1!==this.indexOf(b,a,c)};e.prototype.indexOf=function(b,a,c){return p(this,b,a,c,!0)};e.prototype.lastIndexOf=function(b,a,c){return p(this,b,a,c,!1)};e.prototype.write=function(b,a,c,d){if(void 0===a)d="utf8",c=this.length,a=0;else if(void 0===c&&"string"===
typeof a)d=a,c=this.length,a=0;else if(isFinite(a))a|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var f=this.length-a;if(void 0===c||c>f)c=f;if(0<b.length&&(0>c||0>a)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(f=!1;;)switch(d){case "hex":a:{a=Number(a)||0;d=this.length-a;c?(c=Number(c),c>d&&(c=d)):c=d;d=b.length;if(0!==d%2)throw new TypeError("Invalid hex string");
c>d/2&&(c=d/2);for(d=0;d<c;++d){f=parseInt(b.substr(2*d,2),16);if(isNaN(f)){b=d;break a}this[a+d]=f}b=d}return b;case "utf8":case "utf-8":return Q(H(b,this.length-a),this,a,c);case "ascii":return Q(fa(b),this,a,c);case "latin1":case "binary":return Q(fa(b),this,a,c);case "base64":return Q(da.toByteArray(X(b)),this,a,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=b;f=this.length-a;for(var e=[],k=0;k<d.length&&!(0>(f-=2));++k){var h=d.charCodeAt(k);b=h>>8;h%=256;e.push(h);e.push(b)}return Q(e,
this,a,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();f=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;e.prototype.slice=function(b,a){var c=this.length;b=~~b;a=void 0===a?c:~~a;0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c);0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c);a<b&&(a=b);if(e.TYPED_ARRAY_SUPPORT)a=this.subarray(b,a),a.__proto__=e.prototype;else{c=a-b;a=new e(c,void 0);for(var d=0;d<c;++d)a[d]=this[d+b]}return a};
e.prototype.readUIntLE=function(b,a,c){b|=0;a|=0;c||F(b,a,this.length);c=this[b];for(var d=1,f=0;++f<a&&(d*=256);)c+=this[b+f]*d;return c};e.prototype.readUIntBE=function(b,a,c){b|=0;a|=0;c||F(b,a,this.length);c=this[b+--a];for(var d=1;0<a&&(d*=256);)c+=this[b+--a]*d;return c};e.prototype.readUInt8=function(b,a){a||F(b,1,this.length);return this[b]};e.prototype.readUInt16LE=function(b,a){a||F(b,2,this.length);return this[b]|this[b+1]<<8};e.prototype.readUInt16BE=function(b,a){a||F(b,2,this.length);
return this[b]<<8|this[b+1]};e.prototype.readUInt32LE=function(b,a){a||F(b,4,this.length);return(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]};e.prototype.readUInt32BE=function(b,a){a||F(b,4,this.length);return 16777216*this[b]+(this[b+1]<<16|this[b+2]<<8|this[b+3])};e.prototype.readIntLE=function(b,a,c){b|=0;a|=0;c||F(b,a,this.length);c=this[b];for(var d=1,f=0;++f<a&&(d*=256);)c+=this[b+f]*d;c>=128*d&&(c-=Math.pow(2,8*a));return c};e.prototype.readIntBE=function(b,a,c){b|=0;a|=0;c||F(b,
a,this.length);c=a;for(var d=1,f=this[b+--c];0<c&&(d*=256);)f+=this[b+--c]*d;f>=128*d&&(f-=Math.pow(2,8*a));return f};e.prototype.readInt8=function(b,a){a||F(b,1,this.length);return this[b]&128?-1*(255-this[b]+1):this[b]};e.prototype.readInt16LE=function(b,a){a||F(b,2,this.length);b=this[b]|this[b+1]<<8;return b&32768?b|4294901760:b};e.prototype.readInt16BE=function(b,a){a||F(b,2,this.length);b=this[b+1]|this[b]<<8;return b&32768?b|4294901760:b};e.prototype.readInt32LE=function(b,a){a||F(b,4,this.length);
return this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24};e.prototype.readInt32BE=function(b,a){a||F(b,4,this.length);return this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]};e.prototype.readFloatLE=function(b,a){a||F(b,4,this.length);return la.read(this,b,!0,23,4)};e.prototype.readFloatBE=function(b,a){a||F(b,4,this.length);return la.read(this,b,!1,23,4)};e.prototype.readDoubleLE=function(b,a){a||F(b,8,this.length);return la.read(this,b,!0,52,8)};e.prototype.readDoubleBE=function(b,a){a||F(b,8,this.length);
return la.read(this,b,!1,52,8)};e.prototype.writeUIntLE=function(b,a,c,d){b=+b;a|=0;c|=0;d||z(this,b,a,c,Math.pow(2,8*c)-1,0);d=1;var f=0;for(this[a]=b&255;++f<c&&(d*=256);)this[a+f]=b/d&255;return a+c};e.prototype.writeUIntBE=function(b,a,c,d){b=+b;a|=0;c|=0;d||z(this,b,a,c,Math.pow(2,8*c)-1,0);d=c-1;var f=1;for(this[a+d]=b&255;0<=--d&&(f*=256);)this[a+d]=b/f&255;return a+c};e.prototype.writeUInt8=function(b,a,c){b=+b;a|=0;c||z(this,b,a,1,255,0);e.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));this[a]=b&
255;return a+1};e.prototype.writeUInt16LE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,2,65535,0);e.TYPED_ARRAY_SUPPORT?(this[a]=b&255,this[a+1]=b>>>8):M(this,b,a,!0);return a+2};e.prototype.writeUInt16BE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,2,65535,0);e.TYPED_ARRAY_SUPPORT?(this[a]=b>>>8,this[a+1]=b&255):M(this,b,a,!1);return a+2};e.prototype.writeUInt32LE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,4,4294967295,0);e.TYPED_ARRAY_SUPPORT?(this[a+3]=b>>>24,this[a+2]=b>>>16,this[a+1]=b>>>8,this[a]=b&255):
A(this,b,a,!0);return a+4};e.prototype.writeUInt32BE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,4,4294967295,0);e.TYPED_ARRAY_SUPPORT?(this[a]=b>>>24,this[a+1]=b>>>16,this[a+2]=b>>>8,this[a+3]=b&255):A(this,b,a,!1);return a+4};e.prototype.writeIntLE=function(b,a,c,d){b=+b;a|=0;d||(d=Math.pow(2,8*c-1),z(this,b,a,c,d-1,-d));d=0;var f=1,e=0;for(this[a]=b&255;++d<c&&(f*=256);)0>b&&0===e&&0!==this[a+d-1]&&(e=1),this[a+d]=(b/f>>0)-e&255;return a+c};e.prototype.writeIntBE=function(b,a,c,d){b=+b;a|=0;d||(d=
Math.pow(2,8*c-1),z(this,b,a,c,d-1,-d));d=c-1;var f=1,e=0;for(this[a+d]=b&255;0<=--d&&(f*=256);)0>b&&0===e&&0!==this[a+d+1]&&(e=1),this[a+d]=(b/f>>0)-e&255;return a+c};e.prototype.writeInt8=function(b,a,c){b=+b;a|=0;c||z(this,b,a,1,127,-128);e.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));0>b&&(b=255+b+1);this[a]=b&255;return a+1};e.prototype.writeInt16LE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,2,32767,-32768);e.TYPED_ARRAY_SUPPORT?(this[a]=b&255,this[a+1]=b>>>8):M(this,b,a,!0);return a+2};e.prototype.writeInt16BE=
function(b,a,c){b=+b;a|=0;c||z(this,b,a,2,32767,-32768);e.TYPED_ARRAY_SUPPORT?(this[a]=b>>>8,this[a+1]=b&255):M(this,b,a,!1);return a+2};e.prototype.writeInt32LE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,4,2147483647,-2147483648);e.TYPED_ARRAY_SUPPORT?(this[a]=b&255,this[a+1]=b>>>8,this[a+2]=b>>>16,this[a+3]=b>>>24):A(this,b,a,!0);return a+4};e.prototype.writeInt32BE=function(b,a,c){b=+b;a|=0;c||z(this,b,a,4,2147483647,-2147483648);0>b&&(b=4294967295+b+1);e.TYPED_ARRAY_SUPPORT?(this[a]=b>>>24,this[a+
1]=b>>>16,this[a+2]=b>>>8,this[a+3]=b&255):A(this,b,a,!1);return a+4};e.prototype.writeFloatLE=function(b,a,c){return G(this,b,a,!0,c)};e.prototype.writeFloatBE=function(b,a,c){return G(this,b,a,!1,c)};e.prototype.writeDoubleLE=function(b,a,c){return N(this,b,a,!0,c)};e.prototype.writeDoubleBE=function(b,a,c){return N(this,b,a,!1,c)};e.prototype.copy=function(b,a,c,d){c||(c=0);d||0===d||(d=this.length);a>=b.length&&(a=b.length);a||(a=0);0<d&&d<c&&(d=c);if(d===c||0===b.length||0===this.length)return 0;
if(0>a)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);b.length-a<d-c&&(d=b.length-a+c);var f=d-c;if(this===b&&c<a&&a<d)for(d=f-1;0<=d;--d)b[d+a]=this[d+c];else if(1E3>f||!e.TYPED_ARRAY_SUPPORT)for(d=0;d<f;++d)b[d+a]=this[d+c];else Uint8Array.prototype.set.call(b,this.subarray(c,c+f),a);return f};e.prototype.fill=function(b,a,c,d){if("string"===
typeof b){"string"===typeof a?(d=a,a=0,c=this.length):"string"===typeof c&&(d=c,c=this.length);if(1===b.length){var f=b.charCodeAt(0);256>f&&(b=f)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!e.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof b&&(b&=255);if(0>a||this.length<a||this.length<c)throw new RangeError("Out of range index");if(c<=a)return this;a>>>=0;c=void 0===c?this.length:c>>>0;b||(b=0);if("number"===
typeof b)for(d=a;d<c;++d)this[d]=b;else for(b=e.isBuffer(b)?b:H((new e(b,d)).toString()),f=b.length,d=0;d<c-a;++d)this[d+a]=b[d%f];return this};var ja=/[^+\/0-9A-Za-z-_]/g}).call(t,n(20))},function(l,t,n){function h(e,a){this.test=a;this.statsGatheringRunning=!1;this.pc1=new RTCPeerConnection(e);this.pc2=new RTCPeerConnection(e);this.pc1.addEventListener("icecandidate",this.onIceCandidate_.bind(this,this.pc2));this.pc2.addEventListener("icecandidate",this.onIceCandidate_.bind(this,this.pc1));this.iceCandidateFilter_=
h.noFilter}var u=n(13),m=n(1);h.prototype={establishConnection:function(){this.pc1.createOffer().then(this.gotOffer_.bind(this),this.test.reportFatal.bind(this.test))},close:function(){this.pc1.close();this.pc2.close()},setIceCandidateFilter:function(e){this.iceCandidateFilter_=e},constrainVideoBitrate:function(e){this.constrainVideoBitrateKbps_=e},disableVideoFec:function(){this.constrainOfferToRemoveVideoFec_=!0},gatherStats:function(e,a,c,f){function h(){"closed"===e.signalingState?(b.statsGatheringRunning=
!1,f(l,x,r,p)):(e.getStats(null).then(k).catch(function(a){b.test.reportError("Could not gather stats: "+a);b.statsGatheringRunning=!1;f(l,x)}),a&&a.getStats().then(m))}function m(a){"chrome"===adapter.browserDetails.browser||"safari"===adapter.browserDetails.browser?(a=u.enumerateStats(a,b.localTrackIds,b.remoteTrackIds),r.push(a),p.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=u.enumerateStatsFirefox(a),r.push(a),p.push(Date.now())):b.test.reportError("Only Firefox and Chrome getStats implementations are supported.")}
function k(a){"chrome"===adapter.browserDetails.browser||"safari"===adapter.browserDetails.browser?(a=u.enumerateStats(a,b.localTrackIds,b.remoteTrackIds),l.push(a),x.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=u.enumerateStatsFirefox(a),l.push(a),x.push(Date.now())):b.test.reportError("Only Firefox and Chrome getStats implementations are supported.");setTimeout(h,100)}var l=[],r=[],x=[],p=[],b=this;b.localTrackIds={audio:"",video:""};b.remoteTrackIds={audio:"",video:""};e.getSenders().forEach(function(a){"audio"===
a.track.kind?b.localTrackIds.audio=a.track.id:"video"===a.track.kind&&(b.localTrackIds.video=a.track.id)});a&&a.getReceivers().forEach(function(a){"audio"===a.track.kind?b.remoteTrackIds.audio=a.track.id:"video"===a.track.kind&&(b.remoteTrackIds.video=a.track.id)});this.statsGatheringRunning=!0;h()},gotOffer_:function(e){this.constrainOfferToRemoveVideoFec_&&(e.sdp=e.sdp.replace(/(m=video 1 [^\r]+)(116 117 118)(\r\n)/g,"$1\r\n"),e.sdp=e.sdp.replace(/a=rtpmap:116 red\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=rtpmap:118 ulpfec\/90000\r\n/g,
""),e.sdp=e.sdp.replace(/a=rtpmap:117 rtx\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=fmtp:117 apt=116\r\n/g,""));this.pc1.setLocalDescription(e);this.pc2.setRemoteDescription(e);this.pc2.createAnswer().then(this.gotAnswer_.bind(this),this.test.reportFatal.bind(this.test))},gotAnswer_:function(e){this.constrainVideoBitrateKbps_&&(e.sdp=e.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+this.constrainVideoBitrateKbps_+"\r\n"));this.pc2.setLocalDescription(e);this.pc1.setRemoteDescription(e)},onIceCandidate_:function(e,
a){if(a.candidate){var c=h.parseCandidate(a.candidate.candidate);this.iceCandidateFilter_(c)&&e.addIceCandidate(a.candidate)}}};h.noFilter=function(){return!0};h.isRelay=function(e){return"relay"===e.type};h.isNotHostCandidate=function(e){return"host"!==e.type};h.isReflexive=function(e){return"srflx"===e.type};h.isHost=function(e){return"host"===e.type};h.isIpv6=function(e){return void 0!==e.address&&-1!==e.address.indexOf(":")};h.parseCandidate=function(e){var a=e.indexOf("candidate:")+10;e=e.substr(a).split(" ");
return{type:e[7],protocol:e[2],address:e[4]}};h.cachedIceServers_=null;h.cachedIceConfigFetchTime_=null;h.asyncCreateTurnConfig=function(e,a,c,f){a=m.ice_servers[c];if(""!==a.turnURI){c={username:a.turnUsername,credential:a.turnCredential,urls:a.turnURI};if(void 0===f?0:f)c.urls=a.turnUdpURI;setTimeout(e.bind(null,{iceServers:[c]}),0)}};h.asyncCreateStunConfig=function(e,a,c){a=m.ice_servers[c];""!==a.stunURI&&setTimeout(e.bind(null,{iceServers:[{urls:a.stunURI}]}),0)};l.exports=h},function(l,t,n){l=
function(){for(var h,l,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),e=[],a=0;a<m.length;a+=1)e[m[a]]=a;var c=function(){if(!h||l>=h.length)return-1;var a=h.charCodeAt(l)&255;l+=1;return a},f=function(){if(!h)return-1;for(;;){if(l>=h.length)return-1;var a=h.charAt(l);l+=1;if(e[a])return e[a];if("A"===a)return 0}},w=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var f;h=a;l=0;a="";var e=Array(3);var q=0;
for(f=!1;!f&&-1!==(e[0]=c());)e[1]=c(),e[2]=c(),a+=m[e[0]>>2],-1!==e[1]?(a+=m[e[0]<<4&48|e[1]>>4],-1!==e[2]?(a+=m[e[1]<<2&60|e[2]>>6],a+=m[e[2]&63]):(a+=m[e[1]<<2&60],a+="=",f=!0)):(a+=m[e[0]<<4&48],a+="=",a+="=",f=!0),q+=4,76<=q&&(a+="\n",q=0);return a},decodeBase64:function(a){var c;h=a;l=0;a="";var e=Array(4);for(c=!1;!c&&-1!==(e[0]=f())&&-1!==(e[1]=f());)e[2]=f(),e[3]=f(),a+=w(e[0]<<2&255|e[1]>>4),-1!==e[2]?(a+=w(e[1]<<4&255|e[2]>>2),-1!==e[3]?a+=w(e[2]<<6&255|e[3]):c=!0):c=!0;return a}}}();t.a=
l},function(l,t){t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(n){"object"===typeof window&&(t=window)}l.exports=t},function(l,t,n){t.c=function(h,e,a){try{return h.pipeThrough(new TransformStream(e))}catch(f){var c=h.getReader();return new ReadableStream({start:function(a){if(e.start)return e.start(a)},pull:function(a){var f,k,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){switch(m.nextAddress){case 1:f=!1,k={enqueue:function(c){f=!0;a.enqueue(c)}};
case 2:if(f){m.jumpTo(0);break}return m.yield(c.read(),4);case 4:h=m.yieldResult;if(!h.done){m.jumpTo(5);break}if(!e.flush){m.jumpTo(6);break}return m.yield(e.flush(a),6);case 6:return m.return(a.close());case 5:return m.yield(e.transform(h.value,k),2)}})},cancel:function(c){h.cancel(c);a&&a(c)}})}};t.a=function(m,e){return new ReadableStream(new h(m,e))};t.b=function(h){return new ReadableStream(new u(h))};var h=function(h,e){this.blob=h;this.index=0;this.chunkSize=e||65536};h.prototype.pull=function(h){var e=
this;return new Promise(function(a,c){var f=e.blob.size-e.index;if(0>=f)return h.close(),a();f=Math.min(e.chunkSize,f);var m=e.blob.slice(e.index,e.index+f),q=new FileReader;q.onload=function(){h.enqueue(new Uint8Array(q.result));a()};q.onerror=c;q.readAsArrayBuffer(m);e.index+=f})};var u=function(h){this.streams=h;this.index=0;this.reader=null;this.nextReader()};u.prototype.nextReader=function(){var h=this.streams[this.index++];this.reader=h&&h.getReader()};u.prototype.pull=function(h){var e=this,
a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return e.reader?c.yield(e.reader.read(),2):c.return(h.close());a=c.yieldResult;if(a.done)return e.nextReader(),c.return(e.pull(h));h.enqueue(a.value);c.jumpToEnd()})}},function(l,t){function n(h,l){if(!h)throw Error(l||"AssertionError");}n.notEqual=function(h,l,m){n(h!=l,m)};n.notOk=function(h,l){n(!h,l)};n.equal=function(h,l,m){n(h==l,m)};n.ok=n;l.exports=n},function(l,t,n){var h=n(12);n.n(h);var u=n(30),m=new TextEncoder,
e=new TextDecoder;l=function(a,c){this._nonce=c||"yRCdyQ1EMSA3mo4rqSkuNQ==";this.rawSecret=a?Object(h.b64ToArray)(a):crypto.getRandomValues(new Uint8Array(16));this.secretKeyPromise=crypto.subtle.importKey("raw",this.rawSecret,"HKDF",!1,["deriveKey"]);this.metaKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:m.encode("metadata"),hash:"SHA-256"},a,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])});this.authKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",
salt:new Uint8Array,info:m.encode("authentication"),hash:"SHA-256"},a,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign"])})};l.prototype.setPassword=function(a,c){this.authKeyPromise=crypto.subtle.importKey("raw",m.encode(a),{name:"PBKDF2"},!1,["deriveKey"]).then(function(a){return crypto.subtle.deriveKey({name:"PBKDF2",salt:m.encode(c),iterations:100,hash:"SHA-256"},a,{name:"HMAC",hash:"SHA-256"},!0,["sign"])})};l.prototype.setAuthKey=function(a){this.authKeyPromise=crypto.subtle.importKey("raw",Object(h.b64ToArray)(a),
{name:"HMAC",hash:"SHA-256"},!0,["sign"])};l.prototype.authKeyB64=function(){var a=this,c,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(a.authKeyPromise,2);if(3!=e.nextAddress)return c=e.yieldResult,e.yield(crypto.subtle.exportKey("raw",c),3);f=e.yieldResult;return e.return(Object(h.arrayToB64)(new Uint8Array(f)))})};l.prototype.authHeader=function(){var a=this,c,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(a.authKeyPromise,
2);if(3!=e.nextAddress)return c=e.yieldResult,e.yield(crypto.subtle.sign({name:"HMAC"},c,Object(h.b64ToArray)(a.nonce)),3);f=e.yieldResult;return e.return("send-v1 "+Object(h.arrayToB64)(new Uint8Array(f)))})};l.prototype.encryptMetadata=function(a){var c=this,f,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.yield(c.metaKeyPromise,2);if(3!=h.nextAddress)return f=h.yieldResult,h.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},
f,m.encode(JSON.stringify({name:a.name,size:a.size,type:a.type||"application/octet-stream",manifest:a.manifest||{},roomMeta:a.roomMeta||{}}))),3);e=h.yieldResult;return h.return(e)})};l.prototype.encryptStream=function(a){return Object(u.c)(a,this.rawSecret)};l.prototype.decryptStream=function(a){return Object(u.b)(a,this.rawSecret)};l.prototype.decryptMetadata=function(a){var c=this,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){if(1==m.nextAddress)return m.yield(c.metaKeyPromise,
2);if(3!=m.nextAddress)return f=m.yieldResult,m.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},f,a),3);h=m.yieldResult;return m.return(JSON.parse(e.decode(h)))})};$jscomp.global.Object.defineProperties(l.prototype,{nonce:{configurable:!0,enumerable:!0,get:function(){return this._nonce},set:function(a){a&&a!==this._nonce&&(this._nonce=a)}}});t.a=l},function(l,t,n){var h=n(25),u=n(0),m=n(7),e=n(5);n(8);n(9);l=n(1);var a=n.n(l);t.a=function(c){function f(b,a,c){b=$jscomp.makeIterator(b);
for(var f=b.next();!f.done;f=b.next())if(f=f.value,f.media.toLowerCase()===a.toLowerCase()){f=$jscomp.makeIterator(f.codecs);for(var e=f.next();!e.done;e=f.next())if(e=e.value,e.name.toLowerCase()===c.toLowerCase())return e}}var w={},q;w.remoteDesc=void 0;u["default"].info("Starting Base stack",c);w.pcConfig={iceServers:[],sdpSemantics:"unified-plan"};w.con={};void 0!==c.iceServers&&(w.pcConfig.iceServers=c.iceServers);!0===c.forceTurn&&(w.pcConfig.iceTransportPolicy="relay");w.pcConfig.bundlePolicy=
"max-bundle";void 0===c.audio&&(c.audio=!0);void 0===c.video&&(c.video=!0);c.remoteCandidates=[];c.localCandidates=[];c.remoteDescriptionSet=!1;w.mediaConstraints={offerToReceiveVideo:void 0!==c.video&&!1!==c.video,offerToReceiveAudio:void 0!==c.audio&&!1!==c.audio};w.peerConnection=new RTCPeerConnection(w.pcConfig,w.con);var k=function(b,a,c){u["default"].error("message:",c,"in baseStack at",b);void 0!==a&&a("error")},l=function(b,a){q=a;b||(q.sdp=w.enableSimulcast(q.sdp));b||"safari"!==m.a.browserEngineCheck()||
(q.sdp=q.sdp.replace("a=sendrecv","a=sendonly"));q.sdp=h.a.setMaxBW(q.sdp,c);c.callback({type:q.type,sdp:q.sdp})},r=function(b,a){var c={};c.sdp=b.sdp;c.type=b.type;if(a===e.a.constant.H264_CODEC)a=f(b.media,"video","vp8"),b=f(b.media,"video","h264");else if(a===e.a.constant.default)a=f(b.media,"video","h264"),b=f(b.media,"video","vp8"),void 0!=a&&(c.sdp=c.sdp.replace("a=fmtp:"+a.payload+" level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\n",""));else return c;void 0!=a&&(c.sdp=
c.sdp.replace("a=rtpmap:"+a.payload+" "+a.name+"/90000\r\n",""),c.sdp=c.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+b.payload+" "+a.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+b.payload+"\r\n"),c.sdp=c.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+" "+b.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+b.payload+"\r\n"),c.sdp=c.sdp.replace("a=rtcp-fb:"+a.payload+" ccm fir\r\n",""),c.sdp=c.sdp.replace("a=rtcp-fb:"+a.payload+" nack\r\n",""),c.sdp=c.sdp.replace("a=rtcp-fb:"+a.payload+" nack pli\r\n",
""),c.sdp=c.sdp.replace("a=rtcp-fb:"+a.payload+" goog-remb\r\n",""));return c};w.resetSDP=function(b){var a=r(w.remoteDesc,b);w.peerConnection.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!0,iceRestart:!1}).then(function(b){u["default"].info("OFFER: - \n"+b.sdp);u["default"].info("RECVD ANSWER B4: - \n"+w.remoteDesc.sdp);w.peerConnection.setLocalDescription(b).then(function(){u["default"].info("ANSWER: - \n"+a.sdp);w.peerConnection.setRemoteDescription(new RTCSessionDescription(a))}).catch(k.bind(null,
"processAnswer",void 0))}).catch(function(b){u["default"].info(b)})};var x=function(b,f){var m=b;u["default"].info("Set remote and local description");u["default"].debug("Remote Description",m.sdp);u["default"].debug("Local Description",q.sdp);m.sdp=h.a.setMaxBW(m.sdp,c);w.remoteDesc=JSON.parse(JSON.stringify(m));u["default"].debug("Remote Description",w.remoteDesc.sdp);w.peerConnection.setLocalDescription(q).then(function(){m="safari"===a.a.browser_info.name&&a.a.browser_info.version>=e.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&
f!==e.a.constant.H264_CODEC?r(m,e.a.constant.default):"safari"===a.a.browser_info.name&&a.a.browser_info.version<=e.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&f!==e.a.constant.H264_CODEC?r(m,e.a.constant.H264_CODEC):r(m,e.a.constant.default);u["default"].debug("Remote Description",w.remoteDesc.sdp);w.peerConnection.setRemoteDescription(new RTCSessionDescription(m)).then(function(){c.remoteDescriptionSet=!0;u["default"].info("Candidates to be added: ",c.remoteCandidates.length,c.remoteCandidates);
for(var b={};0<c.remoteCandidates.length;)b.$jscomp$loop$prop$cand$256=c.remoteCandidates.shift(),w.peerConnection.addIceCandidate(b.$jscomp$loop$prop$cand$256).then(function(b){return function(){u["default"].debug("process answer adding remote ice cand Success: "+JSON.stringify(b.$jscomp$loop$prop$cand$256))}}(b)).catch(function(b){return function(a){u["default"].error("process answer Failed addIceCandidate(): "+a+" cand: "+JSON.stringify(b.$jscomp$loop$prop$cand$256))}}(b)),b={$jscomp$loop$prop$cand$256:b.$jscomp$loop$prop$cand$256};
for(u["default"].info("Local candidates to send:",c.localCandidates.length);0<c.localCandidates.length;)c.callback({type:"candidate",candidate:c.localCandidates.shift()})}).catch(k.bind(null,"processAnswer",void 0))}).catch(k.bind(null,"processAnswer",void 0))},p=function(b){try{var a="object"===typeof b.candidate?b.candidate:JSON.parse(b.candidate);if("end"===a.candidate)console.log("end candidates: ignore");else{a.candidate=a.candidate.replace(/a=/g,"");a.sdpMLineIndex=parseInt(a.sdpMLineIndex,
10);a.sdpMid="audio"!=a.sdpMid&&c.audio?1:0;var f=new RTCIceCandidate(a);c.remoteDescriptionSet?w.peerConnection.addIceCandidate(f).then(function(){u["default"].info("IN adding remote ice candidate Success: "+JSON.stringify(a))}).catch(function(b){u["default"].error("addIceCandidate() Failed err: "+b+" cand: "+JSON.stringify(a))}):(u["default"].debug("queuing candidates since remote description not set: "+JSON.stringify(a)),c.remoteCandidates.push(f))}}catch(z){u["default"].error("Error parsing candidate error: "+
z+" cand:"+b.candidate)}};w.peerConnection.onicecandidate=function(b){(b=b.candidate)?b={sdpMLineIndex:b.sdpMLineIndex,sdpMid:b.sdpMid,candidate:"a="+b.candidate}:(u["default"].info("Gathered all candidates. Sending END candidate"),b={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});c.remoteDescriptionSet?c.callback({type:"candidate",candidate:b}):(c.localCandidates.push(b),u["default"].info("Storing candidate: ",c.localCandidates.length,b))};w.peerConnection.onaddstream=function(b){if(w.onaddstream)w.onaddstream(b)};
w.peerConnection.ontrack=function(b){if(w.ontrack)w.ontrack(b)};w.peerConnection.onremovestream=function(b){if(w.onremovestream)w.onremovestream(b)};w.peerConnection.oniceconnectionstatechange=function(b){w.oniceconnectionstatechange&&(u["default"].debug("ICE connection state changed",b.currentTarget.iceConnectionState),u["default"].debug("ICE gathering state changed",b.currentTarget.iceGatheringState),w.oniceconnectionstatechange(b.currentTarget.iceConnectionState))};w.peerConnection.onconnectionstatechange=
function(b){w.onconnectionstatechange&&(u["default"].debug("Peer connection state changed",w.peerConnection.connectionState),w.onconnectionstatechange(w.peerConnection.connectionState))};w.enableSimulcast=function(b){u["default"].error("Simulcast not implemented");return b};w.updateSimulcastLayersBitrate=function(b){w.simulcast&&(w.simulcast.spatialLayerBitrates=b,w.setSimulcastLayersBitrate())};w.setSimulcastLayersBitrate=function(){u["default"].error("Simulcast not implemented")};w.setSimulcast=
function(b){w.simulcast=b};w.close=function(){w.state="closed";w.peerConnection.close()};w.updateSpec=function(b,a){a=void 0===a?function(){}:a;if(b.maxVideoBW||b.maxAudioBW)b.maxVideoBW&&(u["default"].debug("Maxvideo Requested:",b.maxVideoBW,"limit:",c.limitMaxVideoBW),b.maxVideoBW>c.limitMaxVideoBW&&(b.maxVideoBW=c.limitMaxVideoBW),c.maxVideoBW=b.maxVideoBW,u["default"].debug("Result",c.maxVideoBW)),b.maxAudioBW&&(b.maxAudioBW>c.limitMaxAudioBW&&(b.maxAudioBW=c.limitMaxAudioBW),c.maxAudioBW=b.maxAudioBW),
q.sdp=h.a.setMaxBW(q.sdp,c),b.Sdp||b.maxAudioBW?(u["default"].debug("Updating with SDP renegotiation",c.maxVideoBW,c.maxAudioBW),w.peerConnection.setLocalDescription(q).then(function(){w.remoteDesc.sdp=h.a.setMaxBW(w.remoteDesc.sdp,c);return w.peerConnection.setRemoteDescription(new RTCSessionDescription(w.remoteDesc))}).then(function(){c.remoteDescriptionSet=!0;c.callback({type:"updatestream",sdp:q.sdp})}).catch(k.bind(null,"updateSpec",a))):(u["default"].debug("Updating without SDP renegotiation, newVideoBW:",
c.maxVideoBW,"newAudioBW:",c.maxAudioBW),c.callback({type:"updatestream",sdp:q.sdp}));if(b.minVideoBW||void 0!==b.slideShowMode||void 0!==b.muteStream||void 0!==b.qualityLayer||void 0!==b.video)u["default"].debug("MinVideo Changed to ",b.minVideoBW),u["default"].debug("SlideShowMode Changed to ",b.slideShowMode),u["default"].debug("muteStream changed to ",b.muteStream),u["default"].debug("Video Constraints",b.video),c.callback({type:"updatestream",config:b})};w.createDataConnectionOffer=function(){u["default"].debug("Creating offer for data channel");
w.peerConnection.createOffer().then(l.bind(null,"data")).catch(k.bind(null,"Create Offer",void 0))};w.createOffer=function(b,a,c){c=void 0===c?[]:c;if(!0!==b){if(w.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1},c[0].transceivers||(c[0].transceivers={}),c[0].audio&&c[0].audioStream&&(c[0].transceivers.audio=w.peerConnection.addTransceiver(c[0].audioStream.getAudioTracks()[0],{direction:"sendonly",streams:[c[0].audioStream]})),c[0].video&&c[0].videoStream&&(c[0].transceivers.video=
w.peerConnection.addTransceiver(c[0].videoStream.getVideoTracks()[0],{direction:"sendonly",streams:[c[0].videoStream]}),c[0].transceivers.video.setCodecPreferences&&"function"==typeof c[0].transceivers.video.setCodecPreferences))try{c[0].transceivers.video.setCodecPreferences([{clockRate:9E4,mimeType:"video/VP8"}])}catch(M){u["default"].debug("Error transceivers.video.setCodecPreferences not supported streamId 0 error: "+M)}}else for(var f=0;f<c.length;f++)if(void 0==c[f].transceivers&&(c[f].transceivers=
{}),c[f].audio&&(c[f].transceivers.audio=w.peerConnection.addTransceiver("audio",{direction:"recvonly"})),c[f].video&&(c[f].transceivers.video=w.peerConnection.addTransceiver("video",{direction:"recvonly"}),c[f].transceivers.video.setCodecPreferences&&"function"==typeof c[f].transceivers.video.setCodecPreferences))try{c[f].transceivers.video.setCodecPreferences([{clockRate:9E4,mimeType:"video/VP8",payloadType:96}])}catch(M){u["default"].error("Error transceivers.video.setCodecPreferences streamId: "+
f+" error: "+M)}a&&(w.mediaConstraints.iceRestart=a);u["default"].debug("Creating offer :-"+JSON.stringify(w.mediaConstraints));w.peerConnection.createOffer(w.mediaConstraints).then(l.bind(null,b)).catch(k.bind(null,"Create Offer",void 0))};w.addStream=function(b){w.peerConnection.addStream(b)};w.addTrack=function(b){w.peerConnection.addTrack(b)};w.createDataChannel=function(b){return w.peerConnection.createDataChannel("data",{negotiated:!0,id:"0"})};w.processSignalingMessage=function(b,a){"answer"===
b.type?x(b,a):"candidate"===b.type&&p(b)};return w}},function(l,t,n){t.a={addSim:function(h){var l="a=ssrc-group:SIM";h.forEach(function(h){l+=" "+h});return l+"\r\n"},addGroup:function(h,l){return"a=ssrc-group:FID "+h+" "+l+"\r\n"},addSpatialLayer:function(h,l,m,e,a,c){return"a=ssrc:"+a+" cname:"+h+"\r\na=ssrc:"+(a+" msid:"+l+"\r\na=ssrc:")+(a+" mslabel:"+m+"\r\na=ssrc:")+(a+" label:"+e+"\r\na=ssrc:")+(c+" cname:"+h+"\r\na=ssrc:")+(c+" msid:"+l+"\r\na=ssrc:")+(c+" mslabel:"+m+"\r\na=ssrc:")+(c+" label:"+
e+"\r\n")},setMaxBW:function(h,l){var m=h;if(l.video&&l.maxVideoBW){m=m.replace(/b=AS:.*\r\n/g,"");var e=m.match(/m=video.*\r\n/);null==e&&(e=m.match(/m=video.*\n/));e&&0<e.length&&(h=e[0]+"b=AS:"+l.maxVideoBW+"\r\n",m=m.replace(e[0],h))}l.audio&&l.maxAudioBW&&(e=m.match(/m=audio.*\r\n/),null==e&&(e=m.match(/m=audio.*\n/)),e&&0<e.length&&(h=e[0]+"b=AS:"+l.maxAudioBW+"\r\n",m=m.replace(e[0],h)));return m},enableOpusNacks:function(h){var l=h.match(/a=rtpmap:(.*)opus.*\r\n/);null!==l&&(h=h.replace(l[0],
l[0]+"a=rtcp-fb:"+l[1]+"nack\r\n"));return h}}},function(l,t,n){var h=n(6);t.a=function(l){return"OverconstrainedError"===l.name&&"deviceId"===l.constraint?h.a.error_1142:"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||"width"!==l.constraint?"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||"height"!==l.constraint?"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||l.constraint?"NotFoundError"==l.name||"DevicesNotFoundError"==l.name?h.a.error_1143:
"NotReadableError"==l.name||"TrackStartError"==l.name?h.a.error_1145:"NotAllowedError"==l.name||"PermissionDeniedError"==l.name?h.a.error_1144:"TypeError"==l.name||"TypeError"==l.name?h.a.error_1146:h.a.error_1150:h.a.error_1149:h.a.error_1148:h.a.error_1147}},function(l,t,n){var h=n(2),u=n(15),m=n(3),e=n(28);l=n(1);var a=n.n(l);t.a=function(c){var f=Object(h.a)({}),l=Object(u.a)().player.default;if(m.a.checkParam(c.options)&&m.a.checkParam(c.options.player)){var q=c.options.player;m.a.checkParam(q.autoplay)&&
(l.autoplay=q.autoplay);m.a.checkParam(q.name)&&(l.name=q.name);m.a.checkParam(q.nameDisplayMode)&&(l.nameDisplayMode=q.nameDisplayMode);m.a.checkParam(q.frameFitMode)&&(l.frameFitMode=q.frameFitMode);m.a.checkParam(q.skin)&&(l.skin=q.skin);m.a.checkParam(q.class)&&(l.class=q.class);m.a.checkParam(q.height)&&(l.height=q.height);m.a.checkParam(q.width)&&(l.width=q.width);m.a.checkParam(q.minHeight)&&(l.minHeight=q.minHeight);m.a.checkParam(q.minWidth)&&(l.minWidth=q.minWidth);m.a.checkParam(q.aspectRatio)&&
(l.aspectRatio=q.aspectRatio);m.a.checkParam(q.volume)&&(l.volume=q.volume);m.a.checkParam(q.backgroundImg)&&(l.backgroundImg=q.backgroundImg);m.a.checkParam(q.media)&&(l.media=q.media);m.a.checkParam(q.loader)&&(q=q.loader,m.a.checkParam(q.url)&&(l.loader.url=q.url),l.loader.show=q.show,m.a.checkParam(q.class)&&(l.loader.class=q.class),m.a.checkParam(q.style)&&(l.loader.style=q.style))}f.id=c.id;f.stream=c.videoSource;f.elementID=c.elementID;f.abwd={};f.abwd.notification=!0;f.abwd.lang="en";m.a.checkParam(c.options)&&
m.a.checkParam(c.options.player)&&m.a.checkParam(c.options.player.abwd)&&(q=c.options.player.abwd,!1===q.enabled?f.abwd.notification=!1:!0===q.enabled&&"sdk"===q.notification?(f.abwd.notification=!0,f.abwd.lang="en"===q.language||"zh"===q.language?q.language:"en"):!0===q.enabled&&"app"===q.notification&&(f.abwd.notification=!1,f.abwd.lang=""));q=m.a.getById(c.elementID);q.style.height=l.height;q.style.width=l.width;q.style.minHeight=l.minHeight;q.style.minWidth=l.minWidth;var k=function(b,a,c,e){(e?
1/b*a>c:1/b*a<c)?(f.video.style.width=a+"px",f.video.style.height=1/b*a+"px",f.video.style.top=-(1/b*a/2-c/2)+"px",f.video.style.left="0px"):(f.video.style.height=c+"px",f.video.style.width=b*c+"px",f.video.style.left=-(b*c/2-a/2)+"px",f.video.style.top="0px");f.video.style.overflow="hidden"};f.destroy=function(){console.log("video player destroy ");f.video.pause();if(a.a.csp_enabled)f.container.removeChild(f.div);else{delete f.resizer;try{f.div.removeChild(v),f.div.removeChild(p)}catch(M){console.log("error videoplayer.destroy() removeChild err: "+
M)}}};f.resize=function(){var b=f.container.offsetWidth,a=f.container.offsetHeight;c.stream.screen||!1===c.options.crop||c.stream.canvas?k(16/9,b,a,!1):(b!==f.containerWidth||a!==f.containerHeight)&&k(4/3,b,a,!0);f.containerWidth=b;f.containerHeight=a};q=c.stream.getPlayerId(c.vroom?c.vroom:c.stream.room);f.div=a.a.csp_enabled?Object(m.a)({name:"div",id:""+q.player,class:"vcx_player "+l.skin+"_vcx_player"}):Object(m.a)({name:"div",id:""+q.player,class:"vcx_player "+l.skin+"_vcx_player",style:{"object-position":"65% 50%"}});
l.loader.url&&(f.loader=Object(m.a)({name:"img",src:l.loader.url,id:"back_"+f.id,class:"vcx_player_loader "+l.loader.class+" "+l.skin+"_vcx_player_loader"}),l.loader.show||(f.loader.style.display="none"));l.backgroundImg&&(f.screenSaver=Object(m.a)({name:"img",src:l.backgroundImg,id:"screen_saver_"+f.id,class:"vcx_player_screen_saver "+l.skin+"_vcx_player_screen_saver"}),f.screenSaver.style.display="none");l={name:"video",id:""+q.stream,class:"vcx_stream "+l.skin+"_vcx_stream"};c.extraPlayerOptions.autoplay&&
(l.autoplay=c.extraPlayerOptions.autoplay);c.extraPlayerOptions.playsinline&&(l.playsinline=c.extraPlayerOptions.playsinline);f.video=Object(m.a)(l);c.stream.local&&(f.video.volume=0);f.container=void 0!==f.elementID?"object"===typeof f.elementID&&"function"===typeof f.elementID.appendChild?f.elementID:m.a.getById(f.elementID):document.body;f.container.appendChild(f.div);f.parentNode=f.div.parentNode;var v=void 0,r=void 0,x=void 0,p=void 0,b=void 0,n=void 0,t=void 0;if(!a.a.csp_enabled){r=document.createElement("div");
r.setAttribute("id","stats-container-"+f.id);r.setAttribute("class","stats-container");r.setAttribute("style","display:none;");v=document.createElement("div");v.setAttribute("id","bw-notif-"+f.id);v.setAttribute("class","bw-notification");v.setAttribute("style","display:none;");if(a.a.alertNotifyInfo&&a.a.alertNotifyInfo.mode&&"image"==a.a.alertNotifyInfo.mode){var z=document.createElement("div");z.setAttribute("id","icon-bw-low-"+f.id);z.setAttribute("class","icon-bw");z.innerHTML=window.lowBwIcon;
v.appendChild(z)}x=document.createElement("div");x.setAttribute("id","stats-button-"+f.id);x.setAttribute("class","stats-button");x.setAttribute("title","Click to see stats");x.innerHTML=window.statsIcon;r.appendChild(x);p=document.createElement("div");p.setAttribute("class","stats-overlay");p.setAttribute("id","stats-overlay-"+f.id);p.setAttribute("style","display: none;\n            position: absolute;z-index: 3;\n            padding: 5px;top: 0px;right: 0px;\n            background: linear-gradient(90deg,rgb(204 41 42 / 62%),#a20a90b0);\n            border-radius: 5px;color: #fff;width: 100%;");
b=document.createElement("div");b.setAttribute("class","stats-overlay-inner");b.setAttribute("id","stats-overlay-inner-"+f.id);n=document.createElement("div");t=document.createElement("div");n.setAttribute("class","stats-left-partition");n.setAttribute("id","stats-left-part-"+f.id);t.setAttribute("class","stats-right-partition");t.setAttribute("id","stats-right-part-"+f.id);x.addEventListener("click",function(){p.style.display="none"===p.style.display?"block":"none"});f.div.parentNode.style.position=
"relative";f.div.appendChild(r);f.div.appendChild(p);p.appendChild(b);f.div.appendChild(v);b.appendChild(n);b.appendChild(t)}f.loader&&f.div.appendChild(f.loader);f.screenSaver&&f.div.appendChild(f.screenSaver);f.div.appendChild(f.video);f.containerWidth=0;f.containerHeight=0;!a.a.csp_enabled&&c.options&&!1!==c.options.resizer&&(f.resizer=L.ResizeSensor(f.container,f.resize),f.resize());!1===c.options.bar&&(f.media=f.video);f.video.srcObject=f.stream;f.ShowSessionStats=function(b){a.a.csp_enabled||
(!0===b?(r.setAttribute("style","display:block;"),p.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):(r.setAttribute("style","display:none;"),p.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")))};f.streamUpdated=function(a){a!=f.id&&(f.id=a,f.video&&(a=c.stream.getPlayerId(c.vroom?c.vroom:c.stream.room),f.div.setAttribute("id",""+a.player),
f.video.setAttribute("id",""+a.stream),void 0!=f.loader&&f.loader.setAttribute("id","back_"+f.id),void 0!=f.screenSaver&&f.screenSaver.setAttribute("id","screen_saver_"+f.id),void 0!=r&&r.setAttribute("id","stats-container-"+f.id),void 0!=v&&v.setAttribute("id","bw-notif-"+f.id),void 0!=z&&z.setAttribute("id","icon-bw-low-"+f.id),void 0!=x&&x.setAttribute("id","bw-notif-"+f.id),void 0!=p&&p.setAttribute("id","stats-overlay-"+f.id),void 0!=b&&b.setAttribute("id","stats-overlay-inner-"+f.id),void 0!=
n&&n.setAttribute("id","stats-left-part-"+f.id),void 0!=t&&t.setAttribute("id","stats-right-part-"+f.id)))};f.setBwAlert=function(b,c,k){!1===f.abwd.notification||a.a.csp_enabled||(!0===b?(b="Low Bandwidth",a.a.alertNotifyInfo.customLowBw?b=a.a.alertNotifyInfo.customLowBw:f.abwd.lang&&""!=f.abwd.lang&&(b="subscriber"===c?e.a.abwd[f.abwd.lang].bw_alert_subscriber:k+e.a.abwd[f.abwd.lang].bw_alert_publisher),"text"==a.a.alertNotifyInfo.mode?(console.log("videoPlayer - setBwAlert(): setting  text id: "+
f.id),v.innerText=b,v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%"),v.setAttribute("style","transform:translateX(50%);background:rgba(0,0,0,0.29)"),v.setAttribute("style","border-radius:5px;color:rgb(255,255,255)")):"image"==a.a.alertNotifyInfo.mode&&(console.log("videoPlayer - setBwAlert(): setting  image id: "+f.id),z.setAttribute("title",b),v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px;bottom:5%;right:5%"))):
(console.log("videoPlayer - setBwAlert(): removing image/text  id: "+f.id),v.setAttribute("style","display:none")))};f.setVideoMutedMsg=function(b){if(!1!==f.abwd.notification&&!a.a.csp_enabled)if(!0===b.videomuted&&"bw"===b.reason){var c="Video Muted";a.a.alertNotifyInfo.customVideoMute?c=a.a.alertNotifyInfo.customVideoMute:f.abwd.lang&&""!=f.abwd.lang&&(c=b.name+" "+e.a.abwd[f.abwd.lang].video_muted);"text"==a.a.alertNotifyInfo.mode?(v.innerText=c,v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%"),
v.setAttribute("style","transform:translateX(50%);background:rgba(0,0,0,0.29)"),v.setAttribute("style","border-radius:5px;color:rgb(255,255,255)")):"image"==a.a.alertNotifyInfo.mode&&(z.setAttribute("title",c),v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px"))}else v.setAttribute("style","display:none")};return f}},function(l,t,n){t.a={abwd:{en:{bw_alert_publisher:" Low upload bandwidth",bw_alert_subscriber:" Low Download bandwidth",video_muted:" Video muted due to low bandwidth"},
zh:{bw_alert_publisher:" \u7f51\u7edc\u4e0d\u597d",bw_alert_subscriber:"\u4f60\u7684\u4e0b\u8f7d\u5e26\u5bbd\u5f88\u4f4e",video_muted:" \u60a8\u7684\u89c6\u9891\u56e0\u5e26\u5bbd\u800c\u9759\u97f3"}}}},function(l,t,n){function h(a){var c=a.length;if(0<c%4)throw Error("Invalid string. Length must be a multiple of 4");a=a.indexOf("=");-1===a&&(a=c);return[a,a===c?0:4-a%4]}function u(a,f,e){for(var c=[],k=f;k<e;k+=3)f=(a[k]<<16&16711680)+(a[k+1]<<8&65280)+(a[k+2]&255),c.push(m[f>>18&63]+m[f>>12&63]+
m[f>>6&63]+m[f&63]);return c.join("")}t.byteLength=function(a){a=h(a);var c=a[1];return 3*(a[0]+c)/4-c};t.toByteArray=function(c){var f=h(c);var m=f[0];f=f[1];for(var q=new a(3*(m+f)/4-f),k=0,l=0<f?m-4:m,r=0;r<l;r+=4)m=e[c.charCodeAt(r)]<<18|e[c.charCodeAt(r+1)]<<12|e[c.charCodeAt(r+2)]<<6|e[c.charCodeAt(r+3)],q[k++]=m>>16&255,q[k++]=m>>8&255,q[k++]=m&255;2===f&&(m=e[c.charCodeAt(r)]<<2|e[c.charCodeAt(r+1)]>>4,q[k++]=m&255);1===f&&(m=e[c.charCodeAt(r)]<<10|e[c.charCodeAt(r+1)]<<4|e[c.charCodeAt(r+
2)]>>2,q[k++]=m>>8&255,q[k++]=m&255);return q};t.fromByteArray=function(a){for(var c=a.length,e=c%3,h=[],k=0,l=c-e;k<l;k+=16383)h.push(u(a,k,k+16383>l?l:k+16383));1===e?(a=a[c-1],h.push(m[a>>2]+m[a<<4&63]+"==")):2===e&&(a=(a[c-2]<<8)+a[c-1],h.push(m[a>>10]+m[a>>4&63]+m[a<<2&63]+"="));return h.join("")};var m=[],e=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array;for(l=0;64>l;++l)m[l]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l],e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(l)]=
l;e[45]=62;e[95]=63},function(l,t,n){(function(h){t.c=function(f,e,h,k){h=void 0===h?65536:h;void 0===k&&(k=new Uint8Array(16),crypto.getRandomValues(k),k=k.buffer);f=Object(m.c)(f,new c(h,"encrypt"));return Object(m.c)(f,new a("encrypt",e,h,k))};t.b=function(f,e,h){h=void 0===h?65536:h;f=Object(m.c)(f,new c(h,"decrypt"));return Object(m.c)(f,new a("decrypt",e,h))};var l=n(17);n.n(l);var m=n(21);t.a=65536;var e=new TextEncoder,a=function(a,c,e,k){this.mode=a;this.prevChunk;this.seq=0;this.firstchunk=
!0;this.rs=e;this.ikm=c.buffer;this.salt=k};a.prototype.generateKey=function(){var a=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return f.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);c=f.yieldResult;return f.return(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:e.encode("Content-Encoding: aes128gcm\x00"),hash:"SHA-256"},c,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]))})};a.prototype.generateNonceBase=function(){var a=
this,c,m,k,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);case 2:return c=f.yieldResult,m=crypto.subtle,k=m.exportKey,f.yield(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:e.encode("Content-Encoding: nonce\x00"),hash:"SHA-256"},c,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]),4);case 4:return f.yield(k.call(m,"raw",f.yieldResult),3);case 3:return l=f.yieldResult,
f.return(h.from(l.slice(0,12)))}})};a.prototype.generateNonce=function(a){if(4294967295<a)throw Error("record sequence number exceeds limit");var c=h.from(this.nonceBase),f=c.readUIntBE(c.length-4,4);c.writeUIntBE((f^a)>>>0,c.length-4,4);return c};a.prototype.pad=function(a,c){var f=a.length;if(f+16>=this.rs)throw Error("data too large for record size");if(c)return c=h.alloc(1),c.writeUInt8(2,0),h.concat([a,c]);c=h.alloc(this.rs-f-16);c.fill(0);c.writeUInt8(1,0);return h.concat([a,c])};a.prototype.unpad=
function(a,c){for(var f=a.length-1;0<=f;f--)if(a[f]){if(c){if(2!==a[f])throw Error("delimiter of final record is not 2");}else if(1!==a[f])throw Error("delimiter of not final record is not 1");return a.slice(0,f)}throw Error("no delimiter found");};a.prototype.createHeader=function(){var a=h.alloc(5);a.writeUIntBE(this.rs,0,4);a.writeUIntBE(0,4,1);return h.concat([h.from(this.salt),a])};a.prototype.readHeader=function(a){if(21>a.length)throw Error("chunk too small for reading header");var c={};c.salt=
a.buffer.slice(0,16);c.rs=a.readUIntBE(16,4);a=a.readUInt8(20);c.length=a+16+5;return c};a.prototype.encryptRecord=function(a,c,e){var f=this,m,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return m=f.generateNonce(c),k.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:m},f.key,f.pad(a,e)),2);q=k.yieldResult;return k.return(h.from(q))})};a.prototype.decryptRecord=function(a,c,e){var f=this,m,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==
k.nextAddress)return m=f.generateNonce(c),k.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:m,tagLength:128},f.key,a),2);q=k.yieldResult;return k.return(f.unpad(h.from(q),e))})};a.prototype.start=function(a){var c=this,f,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress){if("encrypt"!==c.mode){if("decrypt"!==c.mode)throw Error("mode must be either encrypt or decrypt");return k.jumpTo(0)}f=c;return k.yield(c.generateKey(),3)}if(4!=k.nextAddress)return f.key=k.yieldResult,
e=c,k.yield(c.generateNonceBase(),4);e.nonceBase=k.yieldResult;a.enqueue(c.createHeader());k.jumpToEnd()})};a.prototype.transformPrevChunk=function(a,c){var f=this,e,h,m,l,p,b,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:if("encrypt"===f.mode)return b=c,w=b.enqueue,k.yield(f.encryptRecord(f.prevChunk,f.seq,a),9);if(0===f.seq)return m=f.readHeader(f.prevChunk),f.salt=m.salt,f.rs=m.rs,l=f,k.yield(f.generateKey(),7);e=c;h=e.enqueue;return k.yield(f.decryptRecord(f.prevChunk,
f.seq-1,a),6);case 6:h.call(e,k.yieldResult);k.jumpTo(5);break;case 7:return l.key=k.yieldResult,p=f,k.yield(f.generateNonceBase(),8);case 8:p.nonceBase=k.yieldResult;case 5:f.seq++;k.jumpTo(0);break;case 9:w.call(b,k.yieldResult),f.seq++,k.jumpToEnd()}})};a.prototype.transform=function(a,c){var f=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return f.firstchunk?e.jumpTo(2):e.yield(f.transformPrevChunk(!1,c),2);f.firstchunk=!1;f.prevChunk=h.from(a.buffer);
e.jumpToEnd()})};a.prototype.flush=function(a){var c=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){return c.prevChunk?f.yield(c.transformPrevChunk(!0,a),0):f.jumpTo(0)})};var c=function(a,c){this.mode=c;this.rs=a;this.chunkSize="encrypt"===c?a-17:21;this.partialChunk=new Uint8Array(this.chunkSize);this.offset=0};c.prototype.send=function(a,c){c.enqueue(a);21===this.chunkSize&&"decrypt"===this.mode&&(this.chunkSize=this.rs);this.partialChunk=new Uint8Array(this.chunkSize);this.offset=
0};c.prototype.transform=function(a,c){var f=0;if(0<this.offset){var e=Math.min(a.byteLength,this.chunkSize-this.offset);this.partialChunk.set(a.slice(0,e),this.offset);this.offset+=e;f+=e;this.offset===this.chunkSize&&this.send(this.partialChunk,c)}for(;f<a.byteLength;)e=a.byteLength-f,e>=this.chunkSize?(e=a.slice(f,f+this.chunkSize),f+=this.chunkSize,this.send(e,c)):(e=a.slice(f,f+e),f+=e.byteLength,this.partialChunk.set(e),this.offset=e.byteLength)};c.prototype.flush=function(a){0<this.offset&&
a.enqueue(this.partialChunk.slice(0,this.offset))}}).call(t,n(17).Buffer)},function(l,t,n){function h(a){if(!(this instanceof h))return new h(a);this._name=a||"nanobus";this._starListeners=[];this._listeners={}}var u=n(58),m=n(59),e=n(22);l.exports=h;h.prototype.emit=function(a){e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.emit: eventName should be type string or symbol");for(var c=[],f=1,h=arguments.length;f<h;f++)c.push(arguments[f]);f=m(this._name+"('"+a.toString()+"')");(h=this._listeners[a])&&
0<h.length&&this._emit(this._listeners[a],c);0<this._starListeners.length&&this._emit(this._starListeners,a,c,f.uuid);f();return this};h.prototype.on=h.prototype.addListener=function(a,c){e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.on: eventName should be type string or symbol");e.equal(typeof c,"function","nanobus.on: listener should be type function");"*"===a?this._starListeners.push(c):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(c));return this};h.prototype.prependListener=
function(a,c){e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependListener: eventName should be type string or symbol");e.equal(typeof c,"function","nanobus.prependListener: listener should be type function");"*"===a?this._starListeners.unshift(c):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].unshift(c));return this};h.prototype.once=function(a,c){function f(){c.apply(h,arguments);h.removeListener(a,f)}e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.once: eventName should be type string or symbol");
e.equal(typeof c,"function","nanobus.once: listener should be type function");var h=this;this.on(a,f);return this};h.prototype.prependOnceListener=function(a,c){function f(){c.apply(h,arguments);h.removeListener(a,f)}e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependOnceListener: eventName should be type string or symbol");e.equal(typeof c,"function","nanobus.prependOnceListener: listener should be type function");var h=this;this.prependListener(a,f);return this};h.prototype.removeListener=
function(a,c){function f(a,c){if(a&&(c=a.indexOf(c),-1!==c))return u(a,c,1),!0}e.ok("string"===typeof a||"symbol"===typeof a,"nanobus.removeListener: eventName should be type string or symbol");e.equal(typeof c,"function","nanobus.removeListener: listener should be type function");if("*"===a)return this._starListeners=this._starListeners.slice(),f(this._starListeners,c);"undefined"!==typeof this._listeners[a]&&(this._listeners[a]=this._listeners[a].slice());return f(this._listeners[a],c)};h.prototype.removeAllListeners=
function(a){a?"*"===a?this._starListeners=[]:this._listeners[a]=[]:(this._starListeners=[],this._listeners={});return this};h.prototype.listeners=function(a){a="*"!==a?this._listeners[a]:this._starListeners;var c=[];if(a)for(var f=a.length,e=0;e<f;e++)c.push(a[e]);return c};h.prototype._emit=function(a,c,f,e){if("undefined"!==typeof a&&0!==a.length)for(void 0===f&&(f=c,c=null),c&&(f=void 0!==e?[c].concat(f,e):[c].concat(f)),c=a.length,e=0;e<c;e++){var h=a[e];h.apply(h,f)}}},function(l,t,n){(function(h){var n=
function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof h)return h;throw Error("unable to locate global object");}();if(l.exports=t=n.fetch)t.default=n.fetch.bind(n);t.Headers=n.Headers;t.Request=n.Request;t.Response=n.Response}).call(t,n(20))},function(l,t,n){Object.defineProperty(t,"__esModule",{value:!0});l=n(0);var h=n(11),u=n(4),m=n(14),e=n(15),a=n(27),c=n(69),f=n(1);f=n.n(f);var w=n(70),q=n(79),k=n(80);k=n.n(k);n(81);f.a.csp_enabled||
n(83);n={Logger:l["default"],clientDiagnostics:w.a.clientDiagnostics,clientBitrate:w.a.clientBitrate,appData:q.a,audience:k.a,EnxRoom:h.a.bind(null,void 0,void 0),Event:u.b,RoomEvent:u.e,StreamEvent:u.f,EnxStream:m.a.bind(null,void 0),VideoPlayer:a.a,ViewProperties:e.a,isSupported:f.a.is_supported,version:f.a.product.version,getDevices:c.a.getDevice,switchMediaDevice:c.a.switchMediaDevice,notifyDeviceUpdate:c.a.notifyDeviceUpdate,joinRoom:c.a.joinRoom,listParticipants:c.a.listParticipants,getRoom:c.a.getRoom,
browserInfo:f.a.browser_info};t["default"]=n},function(l,t,n){!function(h,n){l.exports=n()}(this,function(){var h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,l=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=function(a,c,f){var b=String(a);return!b||b.length>=c?a:""+Array(c+1-b.length).join(f)+a},e={s:m,z:function(a){a=-a.utcOffset();var c=Math.abs(a),f=c%60;return(0>=a?"+":"-")+m(Math.floor(c/60),2,"0")+":"+
m(f,2,"0")},m:function b(a,c){if(a.date()<c.date())return-b(c,a);var f=12*(c.year()-a.year())+(c.month()-a.month()),e=a.clone().add(f,"month"),k=0>c-e;a=a.clone().add(f+(k?-1:1),"month");return+(-(f+(c-e)/(k?e-a:a-e))||0)},a:function(a){return 0>a?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:"month",y:"year",w:"week",d:"day",D:"date",h:"hour",m:"minute",s:"second",ms:"millisecond",Q:"quarter"}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return void 0===a}},a="en",c={};
c[a]={name:"en",weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),months:"January February March April May June July August September October November December".split(" "),ordinal:function(a){var c=["th","st","nd","rd"],b=a%100;return"["+a+(c[(b-20)%10]||c[b]||c[0])+"]"}};var f=function(a){return a instanceof k||!(!a||!a.$isDayjsObject)},w=function F(f,b,e){var k;if(!f)return a;if("string"==typeof f){var h=f.toLowerCase();c[h]&&(k=h);b&&(c[h]=b,k=h);f=f.split("-");if(!k&&
1<f.length)return F(f[0])}else k=f.name,c[k]=f;return!e&&k&&(a=k),k||!e&&a},q=function(a,b){if(f(a))return a.clone();var c="object"==typeof b?b:{};return c.date=a,c.args=arguments,new k(c)};e.l=w;e.i=f;e.w=function(a,b){return q(a,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var k=function(){function a(b){this.$L=w(b.locale,null,!0);this.parse(b);this.$x=this.$x||b.x||{};this.$isDayjsObject=!0}var b=a.prototype;return b.parse=function(b){this.$d=function(b){var a=b.date;b=b.utc;if(null===a)return new Date(NaN);
if(e.u(a))return new Date;if(a instanceof Date)return new Date(a);if("string"==typeof a&&!/Z$/i.test(a)){var c=a.match(h);if(c){a=c[2]-1||0;var f=(c[7]||"0").substring(0,3);return b?new Date(Date.UTC(c[1],a,c[3]||1,c[4]||0,c[5]||0,c[6]||0,f)):new Date(c[1],a,c[3]||1,c[4]||0,c[5]||0,c[6]||0,f)}}return new Date(a)}(b);this.init()},b.init=function(){var b=this.$d;this.$y=b.getFullYear();this.$M=b.getMonth();this.$D=b.getDate();this.$W=b.getDay();this.$H=b.getHours();this.$m=b.getMinutes();this.$s=b.getSeconds();
this.$ms=b.getMilliseconds()},b.$utils=function(){return e},b.isValid=function(){return"Invalid Date"!==this.$d.toString()},b.isSame=function(b,a){b=q(b);return this.startOf(a)<=b&&b<=this.endOf(a)},b.isAfter=function(b,a){return q(b)<this.startOf(a)},b.isBefore=function(b,a){return this.endOf(a)<q(b)},b.$g=function(b,a,c){return e.u(b)?this[a]:this.set(c,b)},b.unix=function(){return Math.floor(this.valueOf()/1E3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(b,a){var c=this,
f=!!e.u(a)||a,k=e.p(b);b=function(b,a){b=e.w(c.$u?Date.UTC(c.$y,a,b):new Date(c.$y,a,b),c);return f?b:b.endOf("day")};var h=function(b,a){return e.w(c.toDate()[b].apply(c.toDate("s"),(f?[0,0,0,0]:[23,59,59,999]).slice(a)),c)},m=this.$W;a=this.$M;var q=this.$D,p="set"+(this.$u?"UTC":"");switch(k){case "year":return f?b(1,0):b(31,11);case "month":return f?b(1,a):b(0,a+1);case "week":return k=this.$locale().weekStart||0,m=(m<k?m+7:m)-k,b(f?q-m:q+(6-m),a);case "day":case "date":return h(p+"Hours",0);
case "hour":return h(p+"Minutes",1);case "minute":return h(p+"Seconds",2);case "second":return h(p+"Milliseconds",3);default:return this.clone()}},b.endOf=function(b){return this.startOf(b,!1)},b.$set=function(b,a){var c;b=e.p(b);var f="set"+(this.$u?"UTC":"");f=(c={},c.day=f+"Date",c.date=f+"Date",c.month=f+"Month",c.year=f+"FullYear",c.hour=f+"Hours",c.minute=f+"Minutes",c.second=f+"Seconds",c.millisecond=f+"Milliseconds",c)[b];a="day"===b?this.$D+(a-this.$W):a;"month"===b||"year"===b?(c=this.clone().set("date",
1),c.$d[f](a),c.init(),this.$d=c.set("date",Math.min(this.$D,c.daysInMonth())).$d):f&&this.$d[f](a);return this.init(),this},b.set=function(b,a){return this.clone().$set(b,a)},b.get=function(b){return this[e.p(b)]()},b.add=function(b,a){var c,f=this;b=Number(b);a=e.p(a);var k=function(a){var c=q(f);return e.w(c.date(c.date()+Math.round(a*b)),f)};if("month"===a)return this.set("month",this.$M+b);if("year"===a)return this.set("year",this.$y+b);if("day"===a)return k(1);if("week"===a)return k(7);a=(c=
{},c.minute=6E4,c.hour=36E5,c.second=1E3,c)[a]||1;c=this.$d.getTime()+b*a;return e.w(c,this)},b.subtract=function(b,a){return this.add(-1*b,a)},b.format=function(b){var a=this,c=this.$locale();if(!this.isValid())return c.invalidDate||"Invalid Date";var f=b||"YYYY-MM-DDTHH:mm:ssZ",k=e.z(this),h=this.$H,m=this.$m,q=this.$M,p=c.weekdays,v=c.months,w=function(b,c,d,e){return b&&(b[c]||b(a,f))||d[c].slice(0,e)},n=c.meridiem||function(b,a,c){b=12>b?"AM":"PM";return c?b.toLowerCase():b};return f.replace(l,
function(b,f){return f||function(b){switch(b){case "YY":return String(a.$y).slice(-2);case "YYYY":return e.s(a.$y,4,"0");case "M":return q+1;case "MM":return e.s(q+1,2,"0");case "MMM":return w(c.monthsShort,q,v,3);case "MMMM":return w(v,q);case "D":return a.$D;case "DD":return e.s(a.$D,2,"0");case "d":return String(a.$W);case "dd":return w(c.weekdaysMin,a.$W,p,2);case "ddd":return w(c.weekdaysShort,a.$W,p,3);case "dddd":return p[a.$W];case "H":return String(h);case "HH":return e.s(h,2,"0");case "h":return e.s(h%
12||12,1,"0");case "hh":return e.s(h%12||12,2,"0");case "a":return n(h,m,!0);case "A":return n(h,m,!1);case "m":return String(m);case "mm":return e.s(m,2,"0");case "s":return String(a.$s);case "ss":return e.s(a.$s,2,"0");case "SSS":return e.s(a.$ms,3,"0");case "Z":return k}return null}(b)||k.replace(":","")})},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(b,a,c){a=e.p(a);b=q(b);var f=6E4*(b.utcOffset()-this.utcOffset()),k=this-b;switch(a){case "year":a=
e.m(this,b)/12;break;case "month":a=e.m(this,b);break;case "quarter":a=e.m(this,b)/3;break;case "week":a=(k-f)/6048E5;break;case "day":a=(k-f)/864E5;break;case "hour":a=k/36E5;break;case "minute":a=k/6E4;break;case "second":a=k/1E3;break;default:a=k}return c?a:e.a(a)},b.daysInMonth=function(){return this.endOf("month").$D},b.$locale=function(){return c[this.$L]},b.locale=function(b,a){if(!b)return this.$L;var c=this.clone();b=w(b,a,!0);return b&&(c.$L=b),c},b.clone=function(){return e.w(this.$d,this)},
b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},a}(),v=k.prototype;return q.prototype=v,[["$ms","millisecond"],["$s","second"],["$m","minute"],["$H","hour"],["$W","day"],["$M","month"],["$y","year"],["$D","date"]].forEach(function(a){v[a[1]]=function(b){return this.$g(b,a[0],a[1])}}),q.extend=function(a,b){return a.$i||(a(b,
k,q),a.$i=!0),q},q.locale=w,q.isDayjs=f,q.unix=function(a){return q(1E3*a)},q.en=c[a],q.Ls=c,q.p={},q})},function(l,t,n){(function(h){function l(a,f){for(var c=0,e=a.length-1;0<=e;e--){var k=a[e];"."===k?a.splice(e,1):".."===k?(a.splice(e,1),c++):c&&(a.splice(e,1),c--)}if(f)for(;c--;c)a.unshift("..");return a}function m(a,f){if(a.filter)return a.filter(f);for(var c=[],e=0;e<a.length;e++)f(a[e],e,a)&&c.push(a[e]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;t.resolve=
function(){for(var a="",f=!1,e=arguments.length-1;-1<=e&&!f;e--){var q=0<=e?arguments[e]:h.cwd();if("string"!==typeof q)throw new TypeError("Arguments to path.resolve must be strings");q&&(a=q+"/"+a,f="/"===q.charAt(0))}a=l(m(a.split("/"),function(a){return!!a}),!f).join("/");return(f?"/":"")+a||"."};t.normalize=function(c){var f=t.isAbsolute(c),e="/"===a(c,-1);(c=l(m(c.split("/"),function(a){return!!a}),!f).join("/"))||f||(c=".");c&&e&&(c+="/");return(f?"/":"")+c};t.isAbsolute=function(a){return"/"===
a.charAt(0)};t.join=function(){var a=Array.prototype.slice.call(arguments,0);return t.normalize(m(a,function(a,c){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};t.relative=function(a,f){function c(a){for(var c=0;c<a.length&&""===a[c];c++);for(var f=a.length-1;0<=f&&""===a[f];f--);return c>f?[]:a.slice(c,f-c+1)}a=t.resolve(a).substr(1);f=t.resolve(f).substr(1);a=c(a.split("/"));f=c(f.split("/"));for(var e=Math.min(a.length,f.length),k=e,
h=0;h<e;h++)if(a[h]!==f[h]){k=h;break}e=[];for(h=k;h<a.length;h++)e.push("..");e=e.concat(f.slice(k));return e.join("/")};t.sep="/";t.delimiter=":";t.dirname=function(a){var c=e.exec(a).slice(1);a=c[0];c=c[1];if(!a&&!c)return".";c&&(c=c.substr(0,c.length-1));return a+c};t.basename=function(a,f){a=e.exec(a).slice(1)[2];f&&a.substr(-1*f.length)===f&&(a=a.substr(0,a.length-f.length));return a};t.extname=function(a){return e.exec(a).slice(1)[3]};var a="b"==="ab".substr(-1)?function(a,f,e){return a.substr(f,
e)}:function(a,f,e){0>f&&(f=a.length+f);return a.substr(f,e)}}).call(t,n(36))},function(l,t){function n(){throw Error("setTimeout has not been defined");}function h(){throw Error("clearTimeout has not been defined");}function u(a){if(w===setTimeout)return setTimeout(a,0);if((w===n||!w)&&setTimeout)return w=setTimeout,setTimeout(a,0);try{return w(a,0)}catch(b){try{return w.call(null,a,0)}catch(J){return w.call(this,a,0)}}}function m(a){if(q===clearTimeout)return clearTimeout(a);if((q===h||!q)&&clearTimeout)return q=
clearTimeout,clearTimeout(a);try{return q(a)}catch(b){try{return q.call(null,a)}catch(J){return q.call(this,a)}}}function e(){v&&r&&(v=!1,r.length?k=r.concat(k):x=-1,k.length&&a())}function a(){if(!v){var a=u(e);v=!0;for(var b=k.length;b;){r=k;for(k=[];++x<b;)r&&r[x].run();x=-1;b=k.length}r=null;v=!1;m(a)}}function c(a,b){this.fun=a;this.array=b}function f(){}l=l.exports={};try{var w="function"===typeof setTimeout?setTimeout:n}catch(p){w=n}try{var q="function"===typeof clearTimeout?clearTimeout:h}catch(p){q=
h}var k=[],v=!1,r,x=-1;l.nextTick=function(f){var b=Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)b[e-1]=arguments[e];k.push(new c(f,b));1!==k.length||v||u(a)};c.prototype.run=function(){this.fun.apply(null,this.array)};l.title="browser";l.browser=!0;l.env={};l.argv=[];l.version="";l.versions={};l.on=f;l.addListener=f;l.once=f;l.off=f;l.removeListener=f;l.removeAllListeners=f;l.emit=f;l.prependListener=f;l.prependOnceListener=f;l.listeners=function(a){return[]};
l.binding=function(a){throw Error("process.binding is not supported");};l.cwd=function(){return"/"};l.chdir=function(a){throw Error("process.chdir is not supported");};l.umask=function(){return 0}},function(l,t){l.exports=function(l){if(!l.webpackPolyfill){var h=Object.create(l);h.children||(h.children=[]);Object.defineProperty(h,"loaded",{enumerable:!0,get:function(){return h.l}});Object.defineProperty(h,"id",{enumerable:!0,get:function(){return h.i}});Object.defineProperty(h,"exports",{enumerable:!0});
h.webpackPolyfill=1}return h}},function(l,t,n){var h=n(24),u=n(25),m=n(0);t.a=function(e){m["default"].info("Starting Chrome stable stack",e);var a=Object(h.a)(e);a.enableSimulcast=function(c){var f=c;if(!e.video||!e.simulcast)return f;a.simulcast=e.simulcast;c=f.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!c||0>=c.length)return f;var h=e.simulcast.numSpatialLayers||2;var k=parseInt(c[1],10),m=parseInt(c[2],10),l=f.match(new RegExp("a=ssrc:"+c[1]+" cname:(.*)\r?\n"))[1],x=f.match(new RegExp("a=ssrc:"+
c[1]+" msid:(.*)\r?\n"))[1],p=f.match(new RegExp("a=ssrc:"+c[1]+" mslabel:(.*)\r?\n"));p=null!=p?p[1]:void 0;var b=f.match(new RegExp("a=ssrc:"+c[1]+" label:(.*)\r?\n"));b=null!=b?b[1]:void 0;f.match(new RegExp("a=ssrc:"+c[1]+".*\r?\n","g")).forEach(function(b){f=f.replace(b,"")});f.match(new RegExp("a=ssrc:"+c[2]+".*\r?\n","g")).forEach(function(b){f=f.replace(b,"")});for(var n=[k],t=[m],z=1;z<h;z+=1)n.push(k+1E3*z),t.push(m+1E3*z);h=u.a.addSim(n);for(z=0;z<n.length;z+=1)k=n[z],m=t[z],h+=u.a.addGroup(k,
m);for(z=0;z<n.length;z+=1)k=n[z],m=t[z],h+=u.a.addSpatialLayer(l,x,p,b,k,m);return f.replace(c[0],h+"a=x-google-flag:conference\r\n")};var c=function(c){if("function"!==typeof c.getParameters||"function"!==typeof c.setParameters)m["default"].warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var f=c.getParameters();Object.keys(a.simulcast.spatialLayerBitrates).forEach(function(c){void 0!==f.encodings[c]&&(m["default"].error("Setting bitrate for layer "+
c+", bps: "+a.simulcast.spatialLayerBitrates[c]),f.encodings[c].maxBitrate=a.simulcast.spatialLayerBitrates[c],console.log("setting bitrate for layer "+c+" bitratebps: "+JSON.stringify(a.simulcast.spatialLayerBitrates[c])))});c.setParameters(f).then(function(a){m["default"].info("Success setting simulcast layer bitrates",a)}).catch(function(a){m["default"].warning("Error setting simulcast layer bitrates",a)})}};a.setSimulcastLayersBitrate=function(){a.simulcast&&a.simulcast.spatialLayerBitrates&&
a.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&c(a)})};a.setStartVideoBW=function(c){a.video&&e.startVideoBW&&(m["default"].debug("startVideoBW requested: "+e.startVideoBW),u.a.setParamForCodecs(c,"video","x-google-start-bitrate",e.startVideoBW))};a.setHardMinVideoBW=function(c){a.video&&e.hardMinVideoBW&&(m["default"].debug("hardMinVideoBW requested: "+e.hardMinVideoBW),u.a.setParamForCodecs(c,"video","x-google-min-bitrate",e.hardMinVideoBW))};return a}},function(l,t,n){var h=
n(0),u=n(24);t.a=function(m){h["default"].info("Starting Firefox stack");var e=Object(u.a)(m);e.enableSimulcast=function(a){if(!m.video||!m.simulcast)return a;e.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&(a.getParameters(),a.setParameters({encodings:[{rid:"spam",active:!0,priority:"high",maxBitrate:4E4,maxHeight:640,maxWidth:480},{rid:"egg",active:!0,priority:"medium",maxBitrate:1E4,maxHeight:320,maxWidth:240}]}))});return a};return e}},function(l,t,n){var h=n(0);t.a=
function(l){var m={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){h["default"].info("Close FcStack")},createOffer:function(){h["default"].debug("FCSTACK: CreateOffer")},addStream:function(e){h["default"].debug("FCSTACK: addStream",e)},addTrack:function(e){h["default"].debug("FCSTACK: addTrack",stream)},processSignalingMessage:function(e){h["default"].debug("FCSTACK: processSignaling",e);void 0!==m.signalCallback&&m.signalCallback(e)},sendSignalingMessage:function(e){h["default"].debug("FCSTACK: Sending signaling Message",
e);l.callback(e)},setSignalingCallback:function(e){e=void 0===e?function(){}:e;h["default"].debug("FCSTACK: Setting signalling callback");m.signalCallback=e}};return m}},function(l,t,n){n.d(t,"a",function(){return k});var h=n(5),u=n(42),m=n(0),e=n(8),a=n(9),c=n(6);l=n(1);var f=n.n(l),w=n(4),q=function(a,c){a=Object(w.b)({type:a});a.args=c.args;return a},k=function(k){var l=Object(w.c)(),v=function(){},p=[];$jscomp.initSymbol();l.CONNECTING=Symbol("connecting");$jscomp.initSymbol();l.CONNECTED=Symbol("connected");
$jscomp.initSymbol();l.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();l.DISCONNECTED=Symbol("disconnected");l.state=l.DISCONNECTED;l.IO=void 0===k?u.a:k;var b;l.stateToString=function(){switch(l.state){case l.CONNECTING:var b="connecting";break;case l.CONNECTED:b="connected";break;case l.RECONNECTING:b="reconnecting";break;case l.DISCONNECTED:b="disconnected"}return b};var n=function(b,a){for(var c=[],f=1;f<arguments.length;++f)c[f-1]=arguments[f];l.emit(q(b,{args:c}))},t=function(){m["default"].info("execute buffer");
l.state===l.CONNECTED&&p.forEach(function(b){l.sendMessage.apply(l,$jscomp.arrayFromIterable(b))})};l.checkSetSocketState=function(){console.log("checkSetSocketState() state: "+l.stateToString());if(l.socket&&l.socket.connected)return console.log("checkSetSocketState() sock connected"),l.state!=l.CONNECTED&&(l.state=l.CONNECTED),!0;console.log("checkSetSocketState() sock NOT connected");return!1};l.connect=function(k,q,p){q=void 0===q?v:q;p=void 0===p?v:p;var r=k.token,x={timeout:k.timeoutMs,secure:r.secure,
forceNew:!0,allowEIO4:!0,transports:["websocket"],rejectUnauthorized:!0};k.retryAttempts?(x.reconnection=!0,x.reconnectionAttempts=k.reconnectionAttempts):x.reconnection=!1;x.reconnection=k.retryAttempts?!0:!1;void 0!=f.a.socketiopath&&(x.path=f.a.socketiopath);k="https:"==window.location.protocol?"wss://":"ws://";var w=r.host;void 0==r.gateway||null==r.gateway||""==r.gateway?w=r.host:(w=r.gateway,x.query="X-Forwarded-Host="+r.host);m["default"].error("Connecting socket with option:- "+JSON.stringify(x));
console.log("Connecting socket with host:- "+w);l.state=l.CONNECTING;b&&b.io&&b.io.engine.transport&&b.io.engine.transport.ws?(m["default"].info("sock.connect() registering close handler  for old socket"),b.io.engine.transport.ws.onclose=function(b){m["default"].warning("Old WebSocket closed, Ignoring old sock code: "+b.code+" old sock id "+l.socket.id+" sock state old - connected: "+l.socket.connected+" disconnected: "+l.socket.disconnected)}):m["default"].info("sock.connect() no old socket pending");
b=l.IO.connect(k+w,x);var u=b.io.engine.transport.ws.onclose;b.io.engine.transport.ws.onclose=function(b){m["default"].warning("WebSocket closed, code: "+b.code+" curr sock undefined  or disconnected");u(b);n(h.a.SocketEvent.error);l.state==l.CONNECTING&&q(c.a.error_1161);l.state=l.DISCONNECTED};b.io.engine.transport.ws.onerror=function(b){};l.socket=b;b.on(h.a.UserEvent.user_awaited,n.bind(l,h.a.UserEvent.user_awaited));b.on(h.a.UserEvent.user_joined,n.bind(l,h.a.UserEvent.user_joined));b.on(h.a.RoomEvent.room_connected,
n.bind(l,h.a.RoomEvent.room_connected));b.on(h.a.RoomEvent.room_disconnected,n.bind(l,h.a.RoomEvent.room_disconnected));b.on(h.a.RoomEvent.new_active_talker,n.bind(l,h.a.RoomEvent.new_active_talker));b.on(h.a.SocketEvent.onAddStream,n.bind(l,h.a.SocketEvent.onAddStream));b.on(h.a.SocketEvent.signaling_message_peer,n.bind(l,h.a.SocketEvent.signaling_message_peer));b.on(h.a.SocketEvent.publish_me,n.bind(l,h.a.SocketEvent.publish_me));b.on(h.a.SocketEvent.unpublish_me,n.bind(l,h.a.SocketEvent.unpublish_me));
b.on(h.a.SocketEvent.onBandwidthAlert,n.bind(l,h.a.SocketEvent.onBandwidthAlert));b.on(h.a.SocketEvent.onBandwidthEvents,n.bind(l,h.a.SocketEvent.onBandwidthEvents));b.on(h.a.SocketEvent.onSelfBandwidthAlert,n.bind(l,h.a.SocketEvent.onSelfBandwidthAlert));b.on(h.a.SocketEvent.onRemoveTrack,n.bind(l,h.a.SocketEvent.onRemoveTrack));b.on(h.a.SocketEvent.onDataStream,n.bind(l,h.a.SocketEvent.onDataStream));b.on(h.a.RoomEvent.room_awaited,n.bind(l,h.a.RoomEvent.room_awaited));b.on(h.a.RoomEvent.room_record_on,
n.bind(l,h.a.RoomEvent.room_record_on));b.on(h.a.RoomEvent.room_record_off,n.bind(l,h.a.RoomEvent.room_record_off));b.on(h.a.RoomEvent.hard_mute_audio,n.bind(l,h.a.RoomEvent.hard_mute_audio));b.on(h.a.RoomEvent.hard_unmute_audio,n.bind(l,h.a.RoomEvent.hard_unmute_audio));b.on(h.a.RoomEvent.hard_mute_video,n.bind(l,h.a.RoomEvent.hard_mute_video));b.on(h.a.RoomEvent.hard_unmute_video,n.bind(l,h.a.RoomEvent.hard_unmute_video));b.on(h.a.RoomEvent.auxilary_publish_events,n.bind(l,h.a.RoomEvent.auxilary_publish_events));
b.on(h.a.RoomEvent.share_started,n.bind(l,h.a.RoomEvent.share_started));b.on(h.a.RoomEvent.share_stopped,n.bind(l,h.a.RoomEvent.share_stopped));b.on(h.a.RoomEvent.screen_share_override,n.bind(l,h.a.RoomEvent.screen_share_override));b.on(h.a.RoomEvent.stop_sharing,n.bind(l,h.a.RoomEvent.stop_sharing));b.on(h.a.RoomEvent.update_layout,n.bind(l,h.a.RoomEvent.update_layout));b.on(h.a.RoomEvent.custom_data_saved,n.bind(l,h.a.RoomEvent.custom_data_saved));b.on(h.a.RoomEvent.custom_data_updated,n.bind(l,
h.a.RoomEvent.custom_data_updated));b.on(h.a.RoomEvent.streaming_uri,n.bind(l,h.a.RoomEvent.streaming_uri));b.on(h.a.RoomEvent.canvas_started,n.bind(l,h.a.RoomEvent.canvas_started));b.on(h.a.RoomEvent.canvas_stopped,n.bind(l,h.a.RoomEvent.canvas_stopped));b.on(h.a.RoomEvent.invite_breakout_room,n.bind(l,h.a.RoomEvent.invite_breakout_room));b.on(h.a.RoomEvent.user_joined_breakout_room,n.bind(l,h.a.RoomEvent.user_joined_breakout_room));b.on(h.a.RoomEvent.user_left_breakout_room,n.bind(l,h.a.RoomEvent.user_left_breakout_room));
b.on(h.a.RoomEvent.breakout_room_destroyed,n.bind(l,h.a.RoomEvent.breakout_room_destroyed));b.on(h.a.RoomEvent.transcription_events,n.bind(l,h.a.RoomEvent.transcription_events));b.on(h.a.RoomEvent.analytics_events,n.bind(l,h.a.RoomEvent.analytics_events));b.on(h.a.RoomEvent.meeting_summary_subscription_events,n.bind(l,h.a.RoomEvent.meeting_summary_subscription_events));b.on(h.a.RoomEvent.user_role_management_events,n.bind(l,h.a.RoomEvent.user_role_management_events));b.on(h.a.SocketEvent.dial_state_events,
n.bind(l,h.a.SocketEvent.dial_state_events));b.on(h.a.UserEvent.user_audio_muted,n.bind(l,h.a.UserEvent.user_audio_muted));b.on(h.a.UserEvent.user_audio_unmuted,n.bind(l,h.a.UserEvent.user_audio_unmuted));b.on(h.a.UserEvent.user_video_muted,n.bind(l,h.a.UserEvent.user_video_muted));b.on(h.a.UserEvent.user_video_unmuted,n.bind(l,h.a.UserEvent.user_video_unmuted));b.on(h.a.SocketEvent.media_engine_connecting,n.bind(l,h.a.SocketEvent.media_engine_connecting));b.on(h.a.SocketEvent.onUpdateAttributeStream,
n.bind(l,h.a.SocketEvent.onUpdateAttributeStream));b.on(h.a.SocketEvent.onRemoveStream,n.bind(l,h.a.SocketEvent.onRemoveStream));b.on(h.a.SocketEvent.user_connected,n.bind(l,h.a.SocketEvent.user_connected));b.on(h.a.SocketEvent.user_updated,n.bind(l,h.a.SocketEvent.user_updated));b.on(h.a.SocketEvent.user_disconnected,n.bind(l,h.a.SocketEvent.user_disconnected));b.on(h.a.SocketEvent.user_subscribed,n.bind(l,h.a.SocketEvent.user_subscribed));b.on(h.a.SocketEvent.floor_requested,n.bind(l,h.a.SocketEvent.floor_requested));
b.on(h.a.SocketEvent.floor_granted,n.bind(l,h.a.SocketEvent.floor_granted));b.on(h.a.SocketEvent.floor_not_granted,n.bind(l,h.a.SocketEvent.floor_not_granted));b.on(h.a.SocketEvent.floor_released,n.bind(l,h.a.SocketEvent.floor_released));b.on(h.a.SocketEvent.hard_mute,n.bind(l,h.a.SocketEvent.hard_mute));b.on(h.a.SocketEvent.hard_mute_room,n.bind(l,h.a.SocketEvent.hard_mute_room));b.on(h.a.SocketEvent.hard_unmute_room,n.bind(l,h.a.SocketEvent.hard_unmute_room));b.on(h.a.SocketEvent.switched_room,
n.bind(l,h.a.SocketEvent.switched_room));b.on(h.a.SocketEvent.data_stream_room,n.bind(l,h.a.SocketEvent.data_stream_room));b.on(h.a.RoomEvent.user_role_changed,n.bind(l,h.a.RoomEvent.user_role_changed));b.on(h.a.SocketEvent.onStatSubscription,n.bind(l,h.a.SocketEvent.onStatSubscription));b.on(h.a.SocketEvent.onStreamingNotification,n.bind(l,h.a.SocketEvent.onStreamingNotification));b.on(h.a.SocketEvent.onHlsStreamingNotification,n.bind(l,h.a.SocketEvent.onHlsStreamingNotification));b.on(h.a.SocketEvent.onHlsStreamingNotificationToPublisher,
n.bind(l,h.a.SocketEvent.onHlsStreamingNotificationToPublisher));b.on(h.a.SocketEvent.onLiveRecordingNotification,n.bind(l,h.a.SocketEvent.onLiveRecordingNotification));b.on(h.a.SocketEvent.onRoomLiveRecordingOn,n.bind(l,h.a.SocketEvent.onRoomLiveRecordingOn));b.on(h.a.SocketEvent.onRoomLiveRecordingOff,n.bind(l,h.a.SocketEvent.onRoomLiveRecordingOff));b.on(h.a.SocketEvent.onRoomLiveRecordingFailed,n.bind(l,h.a.SocketEvent.onRoomLiveRecordingFailed));b.on(h.a.RoomEvent.switch_codec,n.bind(l,h.a.RoomEvent.switch_codec));
b.on(h.a.RoomEvent.generic_events,n.bind(l,h.a.RoomEvent.generic_events));b.on(h.a.SocketEvent.room_management_events,n.bind(l,h.a.SocketEvent.room_management_events));b.on(h.a.SocketEvent.floor_management_events,n.bind(l,h.a.SocketEvent.floor_management_events));b.on(h.a.RoomEvent.room_transcription_on,n.bind(l,h.a.RoomEvent.room_transcription_on));b.on(h.a.RoomEvent.room_transcription_on,n.bind(l,h.a.RoomEvent.room_transcription_on));b.on(h.a.RoomEvent.room_transcription_off,n.bind(l,h.a.RoomEvent.room_transcription_off));
b.on(h.a.RoomEvent.self_transcription_on,n.bind(l,h.a.RoomEvent.self_transcription_on));b.on(h.a.RoomEvent.self_transcription_off,n.bind(l,h.a.RoomEvent.self_transcription_off));b.on(h.a.SocketEvent.disconnect,function(a){m["default"].debug(h.a.SocketEvent.disconnect,l.id,a);b.close();n(h.a.SocketEvent.disconnect,a)});b.on(h.a.SocketEvent.connect_timeout,function(a){m["default"].warning(h.a.SocketEvent.connect_timeout+", id:",l.id,", error:",a.message);b.close();n(h.a.SocketEvent.disconnect,a.message)});
b.on(h.a.SocketEvent.connection_failed,function(){m["default"].error(h.a.SocketEvent.connection_failed+", id:",l.id);n(h.a.SocketEvent.connection_failed,{streamId:l.id})});b.on(h.a.SocketEvent.connect_error,function(b){m["default"].warning(h.a.SocketEvent.connect_error+", id:",l.id,", error:",b.message)});b.on(h.a.SocketEvent.error,function(b){m["default"].warning(h.a.SocketEvent.error+", id:",l.id,", error:",b.message);n(h.a.SocketEvent.error)});b.on(h.a.SocketEvent.reconnecting,function(b){m["default"].debug(h.a.SocketEvent.reconnecting+
", id:",l.id,", attempt:",b)});b.on(h.a.SocketEvent.reconnect,function(c){m["default"].debug(h.a.SocketEvent.reconnected+", id:",l.id,", attempt:",c);l.state=l.CONNECTED;b.emit(h.a.SocketEvent.reconnected,l.id);a.a.info("socket-event",e.a.event_reconnect_socket_success,{error:{}});t()});b.on(h.a.SocketEvent.reconnect_attempt,function(b){m["default"].debug(h.a.SocketEvent.reconnect_attempt+", id:",l.id,", attempt:",b)});b.on(h.a.SocketEvent.reconnect_failed,function(){m["default"].warning(h.a.SocketEvent.reconnect_failed+
", id:",l.id);l.state=l.DISCONNECTED;n(h.a.SocketEvent.disconnect,h.a.SocketEvent.reconnect_failed);a.a.error("socket-event",e.a.event_reconnect_socket_failed,{error:{}})});b.on(h.a.SocketEvent.reconnect_error,function(b){m["default"].debug(h.a.SocketEvent.reconnect_error+", id:",l.id,", error:",b.message)});l.sendMessage("token",r,function(b){l.state=l.CONNECTED;l.id=b.clientId;q(b)},p)};l.disconnect=function(){m["default"].debug("socket js disconnect the socket");l.state=l.DISCONNECTED;b&&b.disconnect()};
l.sendMessage=function(f,k,h,q){h=void 0===h?v:h;q=void 0===q?v:q;l.state===l.DISCONNECTED&&"token"!==f?(m["default"].error("Trying to send a message over a disconnected Socket"),h(c.a.error_1163)):l.state===l.RECONNECTING?(m["default"].debug("sendmessage socket state is reconnecting"),p.push([f,k,h,q]),h(c.a.error_1164)):(l.state!==l.CONNECTED&&(m["default"].info("sendMessage() socket state not connected and setting to connected type: "+f),l.state=l.CONNECTED),k?b.emit(f,k,function(b,k){"success"===
b?h(k):"error"===b?(a.a.error("socket-event",e.a.event_send_message_failed,{type:f,respType:b,resp:k}),q(k)):void 0!=k&&null!=k||void 0==b||!0!==b&&("object"!=typeof b||void 0==b.result||b.result!=c.a.error_000.result)&&void 0==b.status?(m["default"].debug(" sendMessage() not sucess : respType: "+JSON.stringify(b)+" resp: "+JSON.stringify(k)),h(void 0==k?b:k)):(m["default"].debug(" sendMessage() resp undefined but respType has result with sucees: "+JSON.stringify(b)),h(b))}):q(c.a.error_1155))};l.sendSDP=
function(c,f,k,h){h=void 0===h?v:h;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):b.emit(c,f,k,function(b,a){h(b,a)})};l.emitEvent=function(c,f,k){k=void 0===k?v:k;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):
b.emit(c,f,function(b,a){k(b,a)})};l.sendEvent=function(c,f){f=void 0===f?v:f;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):b.emit(c,function(b){f(b)})};l.sendParamEvent=function(c,f,k){k=void 0===k?v:k;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",e.a.event_send_message_failed,
{error:"Trying to send a message over a disconnected Socket"})):b.emit(c,f,function(b){k(b)})};return l}},function(l,t,n){function h(b){b=b.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!b||M))return new XMLHttpRequest}catch(xa){}if(!b)try{return new (A[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(xa){}}function u(b,a){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return c.reduce(function(a,c){return b.hasOwnProperty(c)&&(a[c]=b[c]),a},{})}function m(b,a){a.useNativeTimers?
(b.setTimeoutFn=C.bind(A),b.clearTimeoutFn=G.bind(A)):(b.setTimeoutFn=setTimeout.bind(A),b.clearTimeoutFn=clearTimeout.bind(A))}function e(b){if(b){for(var a in e.prototype)b[a]=e.prototype[a];return b}}function a(b){var a="";do a=ha[b%64]+a,b=Math.floor(b/64);while(0<b);return a}function c(){var b=a(+new Date);return b!==T?(pa=0,T=b):b+"."+a(pa++)}function f(){}function w(){for(var b in Y.requests)Y.requests.hasOwnProperty(b)&&Y.requests[b].abort()}function q(b){var a;if(a=Aa)(a=b instanceof ArrayBuffer)||
(a="function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(b):b.buffer instanceof ArrayBuffer);return a||Ha&&b instanceof Blob||Ia&&b instanceof File}function k(b,a){if(!b||"object"!=typeof b)return!1;if(Array.isArray(b)){for(var c=0,d=b.length;c<d;c++)if(k(b[c]))return!0;return!1}if(q(b))return!0;if(b.toJSON&&"function"==typeof b.toJSON&&1===arguments.length)return k(b.toJSON(),!0);for(c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&k(b[c]))return!0;return!1}function v(b,a){if(!b)return b;
if(q(b)){var c={_placeholder:!0,num:a.length};return a.push(b),c}if(Array.isArray(b)){c=Array(b.length);for(var d=0;d<b.length;d++)c[d]=v(b[d],a);return c}if("object"==typeof b&&!(b instanceof Date)){c={};for(d in b)b.hasOwnProperty(d)&&(c[d]=v(b[d],a));return c}return b}function r(b,a){if(!b)return b;if(b&&b._placeholder)return a[b.num];if(Array.isArray(b))for(var c=0;c<b.length;c++)b[c]=r(b[c],a);else if("object"==typeof b)for(c in b)b.hasOwnProperty(c)&&(b[c]=r(b[c],a));return b}function x(b,a,
c){return b.on(a,c),function(){b.off(a,c)}}function p(b){b=b||{};this.ms=b.min||100;this.max=b.max||1E4;this.factor=b.factor||2;this.jitter=0<b.jitter&&1>=b.jitter?b.jitter:0;this.attempts=0}function b(b,a){"object"==typeof b&&(a=b,b=void 0);var c=b;b=(a=a||{}).path||"/socket.io";b=void 0===b?"":b;var d=c;var f="undefined"!=typeof location&&location;null==c&&(c=f.protocol+"//"+f.host);"string"==typeof c&&("/"===c.charAt(0)&&(c="/"===c.charAt(1)?f.protocol+c:f.host+c),/^(https?|wss?):\/\//.test(c)||
(c=void 0!==f?f.protocol+"//"+c:"https://"+c),d=z(c));d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443"));d.path=d.path||"/";c=-1!==d.host.indexOf(":")?"["+d.host+"]":d.host;b=(d.id=d.protocol+"://"+c+":"+d.port+b,d.href=d.protocol+"://"+c+(f&&f.port===d.port?"":":"+d.port),d);f=b.source;d=b.id;c=b.path;c=sa[d]&&c in sa[d].nsps;var e;return a.forceNew||a["force new connection"]||!1===a.multiplex||c?e=new V(f,a):(sa[d]||(sa[d]=new V(f,a)),e=sa[d]),b.query&&
!a.query&&(a.query=b.queryKey),e.socket(b.path,a)}n.d(t,"a",function(){return b});var J=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,F="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),z=function(b){var a=b,c=b.indexOf("["),d=b.indexOf("]");-1!=c&&
-1!=d&&(b=b.substring(0,c)+b.substring(c,d).replace(/:/g,";")+b.substring(d,b.length));var f,e;b=J.exec(b||"");for(var k={},h=14;h--;)k[F[h]]=b[h]||"";return-1!=c&&-1!=d&&(k.source=a,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=!0),k.pathNames=function(b,a){b=a.replace(/\/{2,9}/g,"/").split("/");"/"!=a.substr(0,1)&&0!==a.length||b.splice(0,1);"/"==a.substr(a.length-1,1)&&b.splice(b.length-1,1);return b}(0,
k.path),k.queryKey=(f=k.query,e={},f.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(b,a,c){a&&(e[a]=c)}),e),k};l={};try{l="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(oa){l=!1}var M=l,A="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),C=setTimeout,G=clearTimeout;e.prototype.on=e.prototype.addEventListener=function(b,a){return this._callbacks=this._callbacks||{},(this._callbacks["$"+b]=this._callbacks["$"+b]||[]).push(a),this};
e.prototype.once=function(b,a){function c(){this.off(b,c);a.apply(this,arguments)}return c.fn=a,this.on(b,c),this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(b,a){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c,d=this._callbacks["$"+b];if(!d)return this;if(1==arguments.length)return delete this._callbacks["$"+b],this;for(var f=0;f<d.length;f++)if((c=d[f])===a||c.fn===a){d.splice(f,
1);break}return 0===d.length&&delete this._callbacks["$"+b],this};e.prototype.emit=function(b){this._callbacks=this._callbacks||{};for(var a=Array(arguments.length-1),c=this._callbacks["$"+b],d=1;d<arguments.length;d++)a[d-1]=arguments[d];if(c){d=0;for(var f=(c=c.slice(0)).length;d<f;++d)c[d].apply(this,a)}return this};e.prototype.emitReserved=e.prototype.emit;e.prototype.listeners=function(b){return this._callbacks=this._callbacks||{},this._callbacks["$"+b]||[]};e.prototype.hasListeners=function(b){return!!this.listeners(b).length};
var N=Object.create(null);N.open="0";N.close="1";N.ping="2";N.pong="3";N.message="4";N.upgrade="5";N.noop="6";var X=Object.create(null);Object.keys(N).forEach(function(b){X[N[b]]=b});var H={type:"error",data:"parser error"},fa="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Q="function"==typeof ArrayBuffer,da=function(b,a,c){var d=b.type;b=b.data;return fa&&b instanceof Blob?a?c(b):la(b,c):Q&&(b instanceof ArrayBuffer||(f=b,"function"==
typeof ArrayBuffer.isView?ArrayBuffer.isView(f):f&&f.buffer instanceof ArrayBuffer))?a?c(b):la(new Blob([b]),c):c(N[d]+(b||""));var f},la=function(b,a){var c=new FileReader;return c.onload=function(){var b=c.result.split(",")[1];a("b"+b)},c.readAsDataURL(b)},d="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(l=0;64>l;l++)d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(l)]=l;var E="function"==typeof ArrayBuffer,ja=function(b,a){if("string"!=typeof b)return{type:"message",
data:Z(b,a)};var c=b.charAt(0);if("b"===c){b=b.substring(1);if(E){var f=.75*b.length;c=b.length;var e=0;"="===b[b.length-1]&&(f--,"="===b[b.length-2]&&f--);var k=new ArrayBuffer(f),h=new Uint8Array(k);for(f=0;f<c;f+=4){var m=d[b.charCodeAt(f)];var l=d[b.charCodeAt(f+1)];var q=d[b.charCodeAt(f+2)];var p=d[b.charCodeAt(f+3)];h[e++]=m<<2|l>>4;h[e++]=(15&l)<<4|q>>2;h[e++]=(3&q)<<6|63&p}a=Z(k,a)}else a={base64:!0,data:b};a={type:"message",data:a}}else a=X[c]?1<b.length?{type:X[c],data:b.substring(1)}:
{type:X[c]}:H;return a},Z=function(b,a){return"blob"===a&&b instanceof ArrayBuffer?new Blob([b]):b},ea=String.fromCharCode(30),K=function(b){var a=e.call(this)||this;a.writable=!1;m(a,b);a.opts=b;a.query=b.query;a.readyState="";a.socket=b.socket;return a};$jscomp.inherits(K,e);K.prototype.onError=function(b,a){b=Error(b);return b.type="TransportError",b.description=a,e.prototype.emit.call(this,"error",b),this};K.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState=
"opening",this.doOpen()),this};K.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};K.prototype.send=function(b){"open"===this.readyState&&this.write(b)};K.prototype.onOpen=function(){this.readyState="open";this.writable=!0;e.prototype.emit.call(this,"open")};K.prototype.onData=function(b){b=ja(b,this.socket.binaryType);this.onPacket(b)};K.prototype.onPacket=function(b){e.prototype.emit.call(this,"packet",b)};K.prototype.onClose=
function(){this.readyState="closed";e.prototype.emit.call(this,"close")};for(var T,ha="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),O={},pa=0,y=0;64>y;y++)O[ha[y]]=y;c.encode=a;c.decode=function(b){var a=0;for(y=0;y<b.length;y++)a=64*a+O[b.charAt(y)];return a};var D={encode:function(b){var a="",c;for(c in b)b.hasOwnProperty(c)&&(a.length&&(a+="&"),a+=encodeURIComponent(c)+"="+encodeURIComponent(b[c]));return a},decode:function(b){var a={};b=b.split("&");for(var c=0,
d=b.length;c<d;c++){var f=b[c].split("=");a[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return a}},aa=function(){var b=K.apply(this,arguments)||this;b.polling=!1;return b};$jscomp.inherits(aa,K);aa.prototype.doOpen=function(){this.poll()};aa.prototype.pause=function(b){var a=this;this.readyState="pausing";var c=function(){a.readyState="paused";b()};if(this.polling||!this.writable){var d=0;this.polling&&(d++,this.once("pollComplete",function(){--d||c()}));this.writable||(d++,this.once("drain",
function(){--d||c()}))}else c()};aa.prototype.poll=function(){this.polling=!0;this.doPoll();this.emit("poll")};aa.prototype.onData=function(b){var a=this;(function(b,a){b=b.split(ea);for(var c=[],d=0;d<b.length;d++){var f=ja(b[d],a);if(c.push(f),"error"===f.type)break}return c})(b,this.socket.binaryType).forEach(function(b){if("opening"===a.readyState&&"open"===b.type&&a.onOpen(),"close"===b.type)return a.onClose(),!1;a.onPacket(b)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),
"open"===this.readyState&&this.poll())};aa.prototype.doClose=function(){var b=this,a=function(){b.write([{type:"close"}])};"open"===this.readyState?a():this.once("open",a)};aa.prototype.write=function(b){var a=this;this.writable=!1;(function(b,a){var c=b.length,d=Array(c),f=0;b.forEach(function(b,e){da(b,!1,function(b){d[e]=b;++f===c&&a(d.join(ea))})})})(b,function(b){a.doWrite(b,function(){a.writable=!0;a.emit("drain")})})};aa.prototype.uri=function(){var b=this.query||{},a=this.opts.secure?"https":
"http",d="";!1!==this.opts.timestampRequests&&(b[this.opts.timestampParam]=c());this.supportsBinary||b.sid||(b.b64=1);this.opts.port&&("https"===a&&443!==Number(this.opts.port)||"http"===a&&80!==Number(this.opts.port))&&(d=":"+this.opts.port);b=D.encode(b);return a+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+d+this.opts.path+(b.length?"?"+b:"")};$jscomp.global.Object.defineProperties(aa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"polling"}}});
var ma=null!=(new h({xdomain:!1})).responseType,Y=function(b,a){var c=e.call(this)||this;m(c,a);c.opts=a;c.method=a.method||"GET";c.uri=b;c.async=!1!==a.async;c.data=void 0!==a.data?a.data:null;c.create();return c};$jscomp.inherits(Y,e);Y.prototype.create=function(){var b=this,a=u(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");a.xdomain=!!this.opts.xd;a.xscheme=!!this.opts.xs;var c=this.xhr=new h(a);try{c.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){c.setDisableHeaderCheck&&
c.setDisableHeaderCheck(!0);for(var d in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(d)&&c.setRequestHeader(d,this.opts.extraHeaders[d])}}catch(ta){}if("POST"===this.method)try{c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(ta){}try{c.setRequestHeader("Accept","*/*")}catch(ta){}"withCredentials"in c&&(c.withCredentials=this.opts.withCredentials);this.opts.requestTimeout&&(c.timeout=this.opts.requestTimeout);c.onreadystatechange=function(){4===c.readyState&&(200===
c.status||1223===c.status?b.onLoad():b.setTimeoutFn(function(){b.onError("number"==typeof c.status?c.status:0)},0))};c.send(this.data)}catch(ta){return void this.setTimeoutFn(function(){b.onError(ta)},0)}"undefined"!=typeof document&&(this.index=Y.requestsCount++,Y.requests[this.index]=this)};Y.prototype.onSuccess=function(){this.emit("success");this.cleanup()};Y.prototype.onData=function(b){this.emit("data",b);this.onSuccess()};Y.prototype.onError=function(b){this.emit("error",b);this.cleanup(!0)};
Y.prototype.cleanup=function(b){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=f,b)try{this.xhr.abort()}catch(xa){}"undefined"!=typeof document&&delete Y.requests[this.index];this.xhr=null}};Y.prototype.onLoad=function(){var b=this.xhr.responseText;null!==b&&this.onData(b)};Y.prototype.abort=function(){this.cleanup()};if(Y.requestsCount=0,Y.requests={},"undefined"!=typeof document)"function"==typeof attachEvent?attachEvent("onunload",w):"function"==typeof addEventListener&&
addEventListener("onpagehide"in A?"pagehide":"unload",w,!1);var ka="function"==typeof Promise&&"function"==typeof Promise.resolve?function(b){return Promise.resolve().then(b)}:function(b,a){return a(b,0)},ia=A.WebSocket||A.MozWebSocket,qa="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ba=function(b){var a=K.call(this,b)||this;a.supportsBinary=!b.forceBase64;return a};$jscomp.inherits(ba,K);ba.prototype.doOpen=function(){if(this.check()){var b=
this.uri(),a=this.opts.protocols,c=qa?{}:u(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(c.headers=this.opts.extraHeaders);try{this.ws=qa?new ia(b,a,c):a?new ia(b,a):new ia(b)}catch(P){return this.emit("error",P)}this.ws.binaryType=this.socket.binaryType||"arraybuffer";this.addEventListeners()}};ba.prototype.addEventListeners=function(){var b=
this;this.ws.onopen=function(){b.opts.autoUnref&&b.ws._socket.unref();b.onOpen()};this.ws.onclose=this.onClose.bind(this);this.ws.onmessage=function(a){return b.onData(a.data)};this.ws.onerror=function(a){return b.onError("websocket error",a)}};ba.prototype.write=function(b){var a=this;this.writable=!1;for(var c={},d=0;d<b.length;c={$jscomp$loop$prop$n$156$258:c.$jscomp$loop$prop$n$156$258},d++){var f=b[d];c.$jscomp$loop$prop$n$156$258=d===b.length-1;da(f,this.supportsBinary,function(b){return function(c){try{a.ws.send(c)}catch(ib){}b.$jscomp$loop$prop$n$156$258&&
ka(function(){a.writable=!0;a.emit("drain")},a.setTimeoutFn)}}(c))}};ba.prototype.doClose=function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)};ba.prototype.uri=function(){var b=this.query||{},a=this.opts.secure?"wss":"ws",d="";this.opts.port&&("wss"===a&&443!==Number(this.opts.port)||"ws"===a&&80!==Number(this.opts.port))&&(d=":"+this.opts.port);this.opts.timestampRequests&&(b[this.opts.timestampParam]=c());this.supportsBinary||(b.b64=1);b=D.encode(b);return a+"://"+(-1!==this.opts.hostname.indexOf(":")?
"["+this.opts.hostname+"]":this.opts.hostname)+d+this.opts.path+(b.length?"?"+b:"")};ba.prototype.check=function(){return!(!ia||"__initialize"in ia&&this.name===ba.prototype.name)};$jscomp.global.Object.defineProperties(ba.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"websocket"}}});l=function(b){var a;if(a=aa.call(this,b)||this,"undefined"!=typeof location){var c="https:"===location.protocol,d=location.port;d||(d=c?"443":"80");a.xd="undefined"!=typeof location&&b.hostname!==
location.hostname||d!==b.port;a.xs=b.secure!==c}b=b&&b.forceBase64;a.supportsBinary=ma&&!b;return a};$jscomp.inherits(l,aa);l.prototype.request=function(b){b=void 0===b?{}:b;return Object.assign(b,{xd:this.xd,xs:this.xs},this.opts),new Y(this.uri(),b)};l.prototype.doWrite=function(b,a){var c=this;b=this.request({method:"POST",data:b});b.on("success",a);b.on("error",function(b){c.onError("xhr post error",b)})};l.prototype.doPoll=function(){var b=this,a=this.request();a.on("data",this.onData.bind(this));
a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};var na={websocket:ba,polling:l},U=function(b,a){a=void 0===a?{}:a;var c=e.call(this)||this;b&&"object"==typeof b&&(a=b,b=null);b?(b=z(b),a.hostname=b.host,a.secure="https"===b.protocol||"wss"===b.protocol,a.port=b.port,b.query&&(a.query=b.query)):a.host&&(a.hostname=z(a.host).host);m(c,a);c.secure=null!=a.secure?a.secure:"undefined"!=typeof location&&"https:"===location.protocol;a.hostname&&!a.port&&(a.port=c.secure?"443":"80");
c.hostname=a.hostname||("undefined"!=typeof location?location.hostname:"localhost");c.port=a.port||("undefined"!=typeof location&&location.port?location.port:c.secure?"443":"80");c.transports=a.transports||["polling","websocket"];c.readyState="";c.writeBuffer=[];c.prevBufferLen=0;c.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},a);
c.opts.path=c.opts.path.replace(/\/$/,"")+"/";"string"==typeof c.opts.query&&(c.opts.query=D.decode(c.opts.query));c.id=null;c.upgrades=null;c.pingInterval=null;c.pingTimeout=null;c.pingTimeoutTimer=null;"function"==typeof addEventListener&&(c.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){d.transport&&(d.transport.removeAllListeners(),d.transport.close())},!1),"localhost"!==c.hostname&&(c.offlineEventListener=function(){d.onClose("transport close")},addEventListener("offline",
c.offlineEventListener,!1)));c.open();var d=c;return c};$jscomp.inherits(U,e);U.prototype.createTransport=function(b){var a=this.opts.query,c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);c.EIO=4;c.transport=b;this.id&&(c.sid=this.id);a=Object.assign({},this.opts.transportOptions[b],this.opts,{query:c,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new na[b](a)};U.prototype.open=function(){var b=this;if(this.opts.rememberUpgrade&&U.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a=
"websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){b.emitReserved("error","No transports available")},0);a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(Ka){return this.transports.shift(),void this.open()}a.open();this.setTransport(a)};U.prototype.setTransport=function(b){var a=this;this.transport&&this.transport.removeAllListeners();this.transport=b;b.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",
this.onError.bind(this)).on("close",function(){a.onClose("transport close")})};U.prototype.probe=function(b){function a(){h||(h=!0,q(),k.close(),k=null)}function c(){l("transport closed")}function d(){l("socket closed")}function f(b){k&&b.name!==k.name&&a()}var e=this,k=this.createTransport(b),h=!1;U.priorWebsocketSuccess=!1;var m=function(){h||(k.send([{type:"ping",data:"probe"}]),k.once("packet",function(b){if(!h)if("pong"===b.type&&"probe"===b.data){if(e.upgrading=!0,e.emitReserved("upgrading",
k),k)U.priorWebsocketSuccess="websocket"===k.name,e.transport.pause(function(){h||"closed"!==e.readyState&&(q(),e.setTransport(k),k.send([{type:"upgrade"}]),e.emitReserved("upgrade",k),k=null,e.upgrading=!1,e.flush())})}else b=Error("probe error"),b.transport=k.name,e.emitReserved("upgradeError",b)}))},l=function(b){b=Error("probe error: "+b);b.transport=k.name;a();e.emitReserved("upgradeError",b)},q=function(){k.removeListener("open",m);k.removeListener("error",l);k.removeListener("close",c);e.off("close",
d);e.off("upgrading",f)};k.once("open",m);k.once("error",l);k.once("close",c);this.once("close",d);this.once("upgrading",f);k.open()};U.prototype.onOpen=function(){if(this.readyState="open",U.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var b=0,a=this.upgrades.length;b<a;b++)this.probe(this.upgrades[b])};U.prototype.onPacket=function(b){if("opening"===this.readyState||"open"===this.readyState||
"closing"===this.readyState)switch(this.emitReserved("packet",b),this.emitReserved("heartbeat"),b.type){case "open":this.onHandshake(JSON.parse(b.data));break;case "ping":this.resetPingTimeout();this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case "error":var a=Error("server error");a.code=b.data;this.onError(a);break;case "message":this.emitReserved("data",b.data),this.emitReserved("message",b.data)}};U.prototype.onHandshake=function(b){this.emitReserved("handshake",
b);this.id=b.sid;this.transport.query.sid=b.sid;this.upgrades=this.filterUpgrades(b.upgrades);this.pingInterval=b.pingInterval;this.pingTimeout=b.pingTimeout;this.onOpen();"closed"!==this.readyState&&this.resetPingTimeout()};U.prototype.resetPingTimeout=function(){var b=this;this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn(function(){b.onClose("ping timeout")},this.pingInterval+this.pingTimeout);this.opts.autoUnref&&this.pingTimeoutTimer.unref()};U.prototype.onDrain=
function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()};U.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))};U.prototype.write=function(b,a,c){return this.sendPacket("message",b,a,c),this};U.prototype.send=function(b,a,c){return this.sendPacket("message",
b,a,c),this};U.prototype.sendPacket=function(b,a,c,d){if("function"==typeof a&&(d=a,a=void 0),"function"==typeof c&&(d=c,c=null),"closing"!==this.readyState&&"closed"!==this.readyState)(c=c||{}).compress=!1!==c.compress,b={type:b,data:a,options:c},this.emitReserved("packetCreate",b),this.writeBuffer.push(b),d&&this.once("flush",d),this.flush()};U.prototype.close=function(){var b=this,a=function(){b.onClose("forced close");b.transport.close()},c=function(){b.off("upgrade",c);b.off("upgradeError",c);
a()},d=function(){b.once("upgrade",c);b.once("upgradeError",c)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){b.upgrading?d():a()}):this.upgrading?d():a()),this};U.prototype.onError=function(b){U.priorWebsocketSuccess=!1;this.emitReserved("error",b);this.onClose("transport error",b)};U.prototype.onClose=function(b,a){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),
this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",b,a),this.writeBuffer=[],this.prevBufferLen=0)};U.prototype.filterUpgrades=function(b){for(var a=[],c=0,d=b.length;c<d;c++)~this.transports.indexOf(b[c])&&a.push(b[c]);return a};U.protocol=4;U.protocol;var Aa="function"==typeof ArrayBuffer;
l=Object.prototype.toString;var Ha="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===l.call(Blob),Ia="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===l.call(File),R;!function(b){b[b.CONNECT=0]="CONNECT";b[b.DISCONNECT=1]="DISCONNECT";b[b.EVENT=2]="EVENT";b[b.ACK=3]="ACK";b[b.CONNECT_ERROR=4]="CONNECT_ERROR";b[b.BINARY_EVENT=5]="BINARY_EVENT";b[b.BINARY_ACK=6]="BINARY_ACK"}(R||(R={}));var ra=function(){return e.call(this)||this};$jscomp.inherits(ra,
e);ra.prototype.add=function(b){if("string"==typeof b)b=this.decodeString(b),b.type===R.BINARY_EVENT||b.type===R.BINARY_ACK?(this.reconstructor=new Ba(b),0===b.attachments&&e.prototype.emitReserved.call(this,"decoded",b)):e.prototype.emitReserved.call(this,"decoded",b);else{if(!q(b)&&!b.base64)throw Error("Unknown type: "+b);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(b=this.reconstructor.takeBinaryData(b))&&(this.reconstructor=null,e.prototype.emitReserved.call(this,
"decoded",b))}};ra.prototype.decodeString=function(b){var a=0,c={type:Number(b.charAt(0))};if(void 0===R[c.type])throw Error("unknown packet type "+c.type);if(c.type===R.BINARY_EVENT||c.type===R.BINARY_ACK){for(var d=a+1;"-"!==b.charAt(++a)&&a!=b.length;);d=b.substring(d,a);if(d!=Number(d)||"-"!==b.charAt(a))throw Error("Illegal attachments");c.attachments=Number(d)}if("/"===b.charAt(a+1)){for(d=a+1;++a&&","!==b.charAt(a)&&a!==b.length;);c.nsp=b.substring(d,a)}else c.nsp="/";d=b.charAt(a+1);if(""!==
d&&Number(d)==d){for(d=a+1;++a;){var f=b.charAt(a);if(null==f||Number(f)!=f){--a;break}if(a===b.length)break}c.id=Number(b.substring(d,a+1))}if(b.charAt(++a)){b=b.substr(a);try{var e=JSON.parse(b)}catch(ya){e=!1}if(!ra.isPayloadValid(c.type,e))throw Error("invalid payload");c.data=e}return c};ra.isPayloadValid=function(b,a){switch(b){case R.CONNECT:return"object"==typeof a;case R.DISCONNECT:return void 0===a;case R.CONNECT_ERROR:return"string"==typeof a||"object"==typeof a;case R.EVENT:case R.BINARY_EVENT:return Array.isArray(a)&&
0<a.length;case R.ACK:case R.BINARY_ACK:return Array.isArray(a)}};ra.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};var Ba=function(b){this.packet=b;this.buffers=[];this.reconPack=b};Ba.prototype.takeBinaryData=function(b){return(this.buffers.push(b),this.buffers.length===this.reconPack.attachments)?(b=this.reconPack,b=(b.data=r(b.data,this.buffers),b.attachments=void 0,b),this.finishedReconstruction(),b):null};Ba.prototype.finishedReconstruction=function(){this.reconPack=
null;this.buffers=[]};l=function(){};l.prototype.encode=function(b){return b.type!==R.EVENT&&b.type!==R.ACK||!k(b)?[this.encodeAsString(b)]:(b.type=b.type===R.EVENT?R.BINARY_EVENT:R.BINARY_ACK,this.encodeAsBinary(b))};l.prototype.encodeAsString=function(b){var a=""+b.type;return b.type!==R.BINARY_EVENT&&b.type!==R.BINARY_ACK||(a+=b.attachments+"-"),b.nsp&&"/"!==b.nsp&&(a+=b.nsp+","),null!=b.id&&(a+=b.id),null!=b.data&&(a+=JSON.stringify(b.data)),a};l.prototype.encodeAsBinary=function(b){var a=[];
a=(b.data=v(b.data,a),b.attachments=a.length,{packet:b,buffers:a});b=this.encodeAsString(a.packet);a=a.buffers;return a.unshift(b),a};var Ja=Object.freeze({__proto__:null,protocol:5,get PacketType(){return R},Encoder:l,Decoder:ra}),Qa=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),S=function(b,a,c){var d=e.call(this)||this;d.connected=!1;d.disconnected=!0;d.receiveBuffer=[];d.sendBuffer=[];d.ids=0;d.acks={};d.flags={};d.io=b;d.nsp=a;c&&c.auth&&
(d.auth=c.auth);d.io._autoConnect&&d.open();return d};$jscomp.inherits(S,e);S.prototype.subEvents=function(){if(!this.subs){var b=this.io;this.subs=[x(b,"open",this.onopen.bind(this)),x(b,"packet",this.onpacket.bind(this)),x(b,"error",this.onerror.bind(this)),x(b,"close",this.onclose.bind(this))]}};S.prototype.connect=function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this};S.prototype.open=function(){return this.connect()};
S.prototype.send=function(b){for(var a=[],c=0;c<arguments.length;++c)a[c-0]=arguments[c];return a.unshift("message"),this.emit.apply(this,a),this};S.prototype.emit=function(b,a){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(Qa.hasOwnProperty(b))throw Error('"'+b+'" is a reserved event name');c.unshift(b);d={type:R.EVENT,data:c,options:{}};if(d.options.compress=!1!==this.flags.compress,"function"==typeof c[c.length-1]){var f=this.ids++;c=c.pop();this._registerAckCallback(f,c);d.id=
f}c=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!c||!this.connected)||(this.connected?this.packet(d):this.sendBuffer.push(d)),this.flags={},this};S.prototype._registerAckCallback=function(b,a){var c=this,d=this.flags.timeout;if(void 0===d)return void(this.acks[b]=a);var f=this.io.setTimeoutFn(function(){delete c.acks[b];for(var d=0;d<c.sendBuffer.length;d++)c.sendBuffer[d].id===b&&c.sendBuffer.splice(d,1);a.call(c,Error("operation has timed out"))},
d);this.acks[b]=function(b){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];c.io.clearTimeoutFn(f);a.apply(c,[null].concat($jscomp.arrayFromIterable(d)))}};S.prototype.packet=function(b){b.nsp=this.nsp;this.io._packet(b)};S.prototype.onopen=function(){var b=this;"function"==typeof this.auth?this.auth(function(a){b.packet({type:R.CONNECT,data:a})}):this.packet({type:R.CONNECT,data:this.auth})};S.prototype.onerror=function(b){this.connected||this.emitReserved("connect_error",b)};S.prototype.onclose=
function(b){this.connected=!1;this.disconnected=!0;delete this.id;this.emitReserved("disconnect",b)};S.prototype.onpacket=function(b){if(b.nsp===this.nsp)switch(b.type){case R.CONNECT:if(b.data&&b.data.sid)this.onconnect(b.data.sid);else this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case R.EVENT:case R.BINARY_EVENT:this.onevent(b);
break;case R.ACK:case R.BINARY_ACK:this.onack(b);break;case R.DISCONNECT:this.ondisconnect();break;case R.CONNECT_ERROR:this.destroy();var a=Error(b.data.message);a.data=b.data.data;this.emitReserved("connect_error",a)}};S.prototype.onevent=function(b){var a=b.data||[];null!=b.id&&a.push(this.ack(b.id));this.connected?this.emitEvent(a):this.receiveBuffer.push(Object.freeze(a))};S.prototype.emitEvent=function(b){if(this._anyListeners&&this._anyListeners.length){var a=this._anyListeners.slice();a=$jscomp.makeIterator(a);
for(var c=a.next();!c.done;c=a.next())c.value.apply(this,b)}e.prototype.emit.apply(this,b)};S.prototype.ack=function(b){var a=this,c=!1;return function(d){for(var f=[],e=0;e<arguments.length;++e)f[e-0]=arguments[e];c||(c=!0,a.packet({type:R.ACK,id:b,data:f}))}};S.prototype.onack=function(b){var a=this.acks[b.id];"function"==typeof a&&(a.apply(this,b.data),delete this.acks[b.id])};S.prototype.onconnect=function(b){this.id=b;this.connected=!0;this.disconnected=!1;this.emitBuffered();this.emitReserved("connect")};
S.prototype.emitBuffered=function(){var b=this;this.receiveBuffer.forEach(function(a){return b.emitEvent(a)});this.receiveBuffer=[];this.sendBuffer.forEach(function(a){return b.packet(a)});this.sendBuffer=[]};S.prototype.ondisconnect=function(){this.destroy();this.onclose("io server disconnect")};S.prototype.destroy=function(){this.subs&&(this.subs.forEach(function(b){return b()}),this.subs=void 0);this.io._destroy(this)};S.prototype.disconnect=function(){return this.connected&&this.packet({type:R.DISCONNECT}),
this.destroy(),this.connected&&this.onclose("io client disconnect"),this};S.prototype.close=function(){return this.disconnect()};S.prototype.compress=function(b){return this.flags.compress=b,this};S.prototype.timeout=function(b){return this.flags.timeout=b,this};S.prototype.onAny=function(b){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(b),this};S.prototype.prependAny=function(b){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(b),this};S.prototype.offAny=
function(b){if(!this._anyListeners)return this;if(b)for(var a=this._anyListeners,c=0;c<a.length;c++){if(b===a[c])return a.splice(c,1),this}else this._anyListeners=[];return this};S.prototype.listenersAny=function(){return this._anyListeners||[]};$jscomp.global.Object.defineProperties(S.prototype,{active:{configurable:!0,enumerable:!0,get:function(){return!!this.subs}},volatile:{configurable:!0,enumerable:!0,get:function(){return this.flags.volatile=!0,this}}});p.prototype.duration=function(){var b=
this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),c=Math.floor(a*this.jitter*b);b=0==(1&Math.floor(10*a))?b-c:b+c}return 0|Math.min(b,this.max)};p.prototype.reset=function(){this.attempts=0};p.prototype.setMin=function(b){this.ms=b};p.prototype.setMax=function(b){this.max=b};p.prototype.setJitter=function(b){this.jitter=b};var V=function(b,a){var c;var d=e.call(this)||this;d.nsps={};d.subs=[];b&&"object"==typeof b&&(a=b,b=void 0);(a=a||{}).path=a.path||"/socket.io";
d.opts=a;m(d,a);d.reconnection(!1!==a.reconnection);d.reconnectionAttempts(a.reconnectionAttempts||1/0);d.reconnectionDelay(a.reconnectionDelay||1E3);d.reconnectionDelayMax(a.reconnectionDelayMax||5E3);d.randomizationFactor(null!==(c=a.randomizationFactor)&&void 0!==c?c:.5);d.backoff=new p({min:d.reconnectionDelay(),max:d.reconnectionDelayMax(),jitter:d.randomizationFactor()});d.timeout(null==a.timeout?2E4:a.timeout);d._readyState="closed";d.uri=b;b=a.parser||Ja;d.encoder=new b.Encoder;d.decoder=
new b.Decoder;d._autoConnect=!1!==a.autoConnect;d._autoConnect&&d.open();return d};$jscomp.inherits(V,e);V.prototype.reconnection=function(b){return arguments.length?(this._reconnection=!!b,this):this._reconnection};V.prototype.reconnectionAttempts=function(b){return void 0===b?this._reconnectionAttempts:(this._reconnectionAttempts=b,this)};V.prototype.reconnectionDelay=function(b){var a;return void 0===b?this._reconnectionDelay:(this._reconnectionDelay=b,null===(a=this.backoff)||void 0===a||a.setMin(b),
this)};V.prototype.randomizationFactor=function(b){var a;return void 0===b?this._randomizationFactor:(this._randomizationFactor=b,null===(a=this.backoff)||void 0===a||a.setJitter(b),this)};V.prototype.reconnectionDelayMax=function(b){var a;return void 0===b?this._reconnectionDelayMax:(this._reconnectionDelayMax=b,null===(a=this.backoff)||void 0===a||a.setMax(b),this)};V.prototype.timeout=function(b){return arguments.length?(this._timeout=b,this):this._timeout};V.prototype.maybeReconnectOnOpen=function(){!this._reconnecting&&
this._reconnection&&0===this.backoff.attempts&&this.reconnect()};V.prototype.open=function(b){var a=this;if(~this._readyState.indexOf("open"))return this;var c=this.engine=new U(this.uri,this.opts),d=this;this._readyState="opening";this.skipReconnect=!1;var f=x(c,"open",function(){d.onopen();b&&b()}),e=x(c,"error",function(c){d.cleanup();d._readyState="closed";a.emitReserved("error",c);b?b(c):d.maybeReconnectOnOpen()});if(!1!==this._timeout){var k=this._timeout;0===k&&f();var h=this.setTimeoutFn(function(){f();
c.close();c.emit("error",Error("timeout"))},k);this.opts.autoUnref&&h.unref();this.subs.push(function(){clearTimeout(h)})}return this.subs.push(f),this.subs.push(e),this};V.prototype.connect=function(b){return this.open(b)};V.prototype.onopen=function(){this.cleanup();this._readyState="open";this.emitReserved("open");var b=this.engine;this.subs.push(x(b,"ping",this.onping.bind(this)),x(b,"data",this.ondata.bind(this)),x(b,"error",this.onerror.bind(this)),x(b,"close",this.onclose.bind(this)),x(this.decoder,
"decoded",this.ondecoded.bind(this)))};V.prototype.onping=function(){this.emitReserved("ping")};V.prototype.ondata=function(b){this.decoder.add(b)};V.prototype.ondecoded=function(b){this.emitReserved("packet",b)};V.prototype.onerror=function(b){this.emitReserved("error",b)};V.prototype.socket=function(b,a){var c=this.nsps[b];return c||(c=new S(this,b,a),this.nsps[b]=c),c};V.prototype._destroy=function(b){b=Object.keys(this.nsps);b=$jscomp.makeIterator(b);for(var a=b.next();!a.done;a=b.next())if(this.nsps[a.value].active)return;
this._close()};V.prototype._packet=function(b){for(var a=this.encoder.encode(b),c=0;c<a.length;c++)this.engine.write(a[c],b.options)};V.prototype.cleanup=function(){this.subs.forEach(function(b){return b()});this.subs.length=0;this.decoder.destroy()};V.prototype._close=function(){this.skipReconnect=!0;this._reconnecting=!1;this.onclose("forced close");this.engine&&this.engine.close()};V.prototype.disconnect=function(){return this._close()};V.prototype.onclose=function(b){this.cleanup();this.backoff.reset();
this._readyState="closed";this.emitReserved("close",b);this._reconnection&&!this.skipReconnect&&this.reconnect()};V.prototype.reconnect=function(){var b=this;if(this._reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var c=this.backoff.duration();this._reconnecting=!0;var d=this.setTimeoutFn(function(){a.skipReconnect||(b.emitReserved("reconnect_attempt",
a.backoff.attempts),a.skipReconnect||a.open(function(c){c?(a._reconnecting=!1,a.reconnect(),b.emitReserved("reconnect_error",c)):a.onreconnect()}))},c);this.opts.autoUnref&&d.unref();this.subs.push(function(){clearTimeout(d)})}};V.prototype.onreconnect=function(){var b=this.backoff.attempts;this._reconnecting=!1;this.backoff.reset();this.emitReserved("reconnect",b)};var sa={};Object.assign(b,{Manager:V,Socket:S,io:b,connect:b})},function(l,t,n){var h=n(2),u=n(44);l=n(1);var m=n.n(l);t.a=function(e){var a=
Object(h.a)({});a.id=e.id;a.stream=e.stream.stream;a.elementID=e.elementID;var c=e.stream.getPlayerId(e.vroom?e.vroom:e.stream.room);a.audio=document.createElement("audio");a.audio.setAttribute("id",""+c.stream);a.audio.setAttribute("class","vcx_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");a.audio.setAttribute("autoplay","autoplay");e.stream.local&&(a.audio.volume=0);void 0!==a.elementID?(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)},
a.div=document.createElement("div"),a.div.setAttribute("id",""+c.player),a.div.setAttribute("class","vcx_player"),a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),a.container="object"===typeof a.elementID&&"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID),a.container.appendChild(a.div),a.parentNode=a.div.parentNode,a.div.appendChild(a.audio),!1!==e.options.bar?(a.bar=Object(u.a)({elementID:""+c.player,id:a.id,
stream:e.stream,media:a.audio,options:e.options}),a.div.onmouseover=void 0,a.div.onmouseout=void 0):a.media=a.audio):(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body);var f=void 0,l=e=void 0,q=c=void 0,k=void 0;m.a.csp_enabled||(f=document.createElement("div"),f.setAttribute("id","stats-container-"+a.id),f.setAttribute("class","stats-container"),f.setAttribute("style","display:none;"),e=document.createElement("div"),
e.setAttribute("id","stats-button-"+a.id),e.setAttribute("class","stats-button"),e.setAttribute("title","Click to see stats"),e.innerHTML=window.statsIcon,f.appendChild(e),l=document.createElement("div"),l.setAttribute("class","stats-overlay"),l.setAttribute("id","stats-overlay-"+a.id),l.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"),c=document.createElement("div"),c.setAttribute("class","stats-overlay-inner"),c.setAttribute("id",
"stats-overlay-inner-"+a.id),q=document.createElement("div"),k=document.createElement("div"),q.setAttribute("class","stats-left-partition"),q.setAttribute("id","stats-left-part-"+a.id),k.setAttribute("class","stats-right-partition"),k.setAttribute("id","stats-right-part-"+a.id),e.addEventListener("click",function(){l.style.display="none"===l.style.display?"block":"none"}),a.div.parentNode.style.position="relative",a.div.parentNode.appendChild(f),a.div.parentNode.appendChild(l),l.appendChild(c),c.appendChild(q),
c.appendChild(k));a.audio.srcObject=a.stream;a.ShowSessionStats=function(a){a?(f.setAttribute("style","display:block;"),l.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):(f.setAttribute("style","display:none;"),l.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"))};return a}},function(l,t,n){var h=n(15),u=n(2),m=n(3),e=n(45),a=n(46),c=
n(47),f=n(48),w=n(49),q=n(50),k=n(51),v=n(10);t.a=function(l){var n=Object(u.a)({});var p=Object(h.a)().toolbar.default;var b=!1;void 0!==l.options&&void 0!==l.options.player&&(n.playerProperties=l.options.player);if(l.options.toolbar){var r=l.options.toolbar;m.a.checkParam(r.position)&&(p.position=r.position);m.a.checkParam(r.class)&&(p.class=r.class);m.a.checkParam(r.skin)&&(p.skin=r.skin,b="default"===p.skin);m.a.checkParam(r.displayMode);p.displayMode=r.displayMode;m.a.checkParam(r.autoDisplayTimeout)&&
(p.autoDisplayTimeout=r.autoDisplayTimeout);r.buttons&&(p.buttons=r.buttons)}n.elementID=l.elementID;n.id=l.id;n.div=b?Object(m.a)({name:"div",id:"bar_"+n.id,class:"vcx_bar",style:v.a.vcx_bar}):Object(m.a)({name:"div",id:"bar_"+n.id,class:"vcx_bar "+p.skin+"_vcx_bar"});m.a.getById(n.elementID).appendChild(n.div);n.bar=b?Object(m.a)({name:"div",id:"subbar_"+n.id,class:"vcx_subbar "+p.class,style:v.a["vcx_subbar_"+p.position]}):Object(m.a)({name:"div",id:"subbar_"+n.id,class:"vcx_subbar "+p.skin+"_vcx_subbar_"+
p.position+" "+p.class});n.div.appendChild(n.bar);(function(b){function a(b){b=b||window.event;h=b.clientX;m=b.clientY;document.onmouseup=f;document.onmousemove=c}function c(a){a=a||window.event;e=h-a.clientX;k=m-a.clientY;h=a.clientX;m=a.clientY;b.style.top=b.offsetTop-k+"px";b.style.left=b.offsetLeft-e+"px"}function f(){document.onmouseup=null;document.onmousemove=null}var e=0,k=0,h=0,m=0;document.getElementById(b.id)?document.getElementById(b.id).onmousedown=a:b.onmousedown=a})(n.bar);p.buttons.play&&
(n.playIcon=Object(q.a)({stream:l.stream,skin:p.skin}),n.bar.appendChild(n.playIcon));p.buttons.zoom&&(n.zoomIcon=Object(a.a)({skin:p.skin,player:n.playerProperties}),n.bar.appendChild(n.zoomIcon));p.buttons.record&&(n.recIcon=Object(f.a)({skin:p.skin,stream:l.stream}),n.bar.appendChild(n.recIcon));p.buttons.share&&(n.shareIcon=Object(w.a)({skin:p.skin,stream:l.stream}),n.bar.appendChild(n.shareIcon));p.buttons.mic&&(n.micIcon=Object(k.a)({skin:p.skin,stream:l.stream}),n.bar.appendChild(n.micIcon));
b={};l.options&&l.options.toolbar&&l.options.toolbar.branding&&(b=l.options.toolbar.branding);b.skin=p.skin;n.brand=Object(c.a)(b);n.bar.appendChild(n.brand);!p.buttons.volume||l.stream.screen||void 0!==l.options&&void 0!==l.options.speaker&&!0!==l.options.speaker||(n.speaker=Object(e.a)({elementID:"subbar_"+n.id,id:n.id,stream:l.stream,media:l.media,position:p.position,skin:p.skin}));p.displayMode?"auto"==p.displayMode?(n.div.onmouseover=function(b){var a=b.currentTarget;setTimeout(function(){m.a.getByClass("vcx_subbar",
a).style.display="block"},1E3*parseInt(p.autoDisplayTimeout))},n.div.onmouseout=function(b){var a=b.currentTarget;setTimeout(function(){m.a.getByClass("vcx_subbar",a).style.display="none"},1E3*parseInt(p.autoDisplayTimeout))},m.a.getByClass("vcx_subbar",n.div).style.display="none"):m.a.getByClass("vcx_subbar",n.div).style.display="block":m.a.getByClass("vcx_subbar",n.div).style.display="none";return n}},function(l,t,n){var h=n(3),u=n(2),m=n(10);t.a=function(e){var a=Object(u.a)({}),c=50,f="default"===
e.skin;a.elementID=e.elementID;a.media=e.media;a.id=e.id;a.stream=e.stream;a.div=f?Object(h.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg",style:Object.assign(m.a.icon,m.a.icon_volume),id:"volume_"+a.id}):Object(h.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg "+e.skin+"_icon "+e.skin+"_icon_volume",id:"volume_"+a.id});h.a.setStyle(a.div,e.position,"0");a.div.onclick=function(){a.media.muted?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),a.div.classList.add("fa-volume-up"),a.stream.local?
a.stream.stream.getAudioTracks()[0].enabled=!0:(a.picker.value=c,a.media.volume=a.picker.value/100)):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"),a.stream.local?a.stream.stream.getAudioTracks()[0].enabled=!1:(c=a.picker.value,a.picker.value=0,a.media.volume=0))};if(!a.stream.local){a.picker=document.createElement("input");a.picker.setAttribute("id","picker_"+a.id);a.picker.setAttribute("style","position: absolute;max-width: 50px;margin: 1.1%;top:0;");
a.picker.type="range";a.picker.min=0;a.picker.max=1;a.picker.step=.1;a.picker.value=c;a.picker.setAttribute("orient","vertical");a.div.appendChild(a.picker);a.media.volume=a.picker.value;a.media.muted=!1;a.picker.onclick=function(){0<a.picker.value?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),a.div.classList.add("fa-volume-up")):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"));a.media.volume=a.picker.value};var l=function(c){a.picker.setAttribute("style",
"position: absolute;max-width: 50px;margin: 1.1%;margin-left:32px;top:0;display: "+c)};a.div.onmouseover=function(){l("block")};a.picker.onmouseout=function(){l("none")};l("none")}document.getElementById(a.elementID).appendChild(a.div);return a}},function(l,t,n){var h=n(3);n(2);var u=n(10),m=!1,e=function(a){var c=(m="default"===a.skin)?Object(h.a)({name:"i",title:"zoom",class:"fa fa-expand  fa-lg icon_zoom ",style:Object.assign(u.a.icon,u.a.icon_zoom)}):Object(h.a)({name:"i",title:"zoom",class:"fa fa-expand icon_zoom "+
a.skin+"_icon fa-lg "+a.skin+"_icon_zoom"});c.onclick=function(c){c.stopPropagation();e.click(c,a)};return c};e.click=function(a,c){var f=c.skin;c={height:c.player.height,width:c.player.width,position:"relative"};var e=a.currentTarget.classList;e.contains("fa-expand")?(a.currentTarget.classList.remove("fa-expand"),a.currentTarget.classList.add("fa-arrows-alt"),m?a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",h.a.getStyle(u.a.full_view)):a.currentTarget.parentNode.parentNode.parentNode.classList.add(f+
"_theater_view")):e.contains("fa-arrows-alt")?(a.currentTarget.classList.remove("fa-arrows-alt"),a.currentTarget.classList.add("fa-compress"),m?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",h.a.getStyle(u.a.full_view))):(a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.remove(f+"_theater_view"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.add(f+
"_full_view"))):e.contains("fa-compress")&&(a.currentTarget.classList.remove("fa-compress"),a.currentTarget.classList.add("fa-expand"),m?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",h.a.getStyle(c))):a.currentTarget.parentNode.parentNode.parentNode.classList.remove(f+"_full_view"))};t.a=e},function(l,t,n){var h=n(15),u=n(3),m=n(2),e=n(10);t.a=function(a){Object(m.a)({});var c=
!1,f=Object(h.a)().brand.default;a&&(u.a.checkParam(a.clickthru)&&(f.url=a.clickthru),a.target&&"current"==a.target&&(f.target="_self"),u.a.checkParam(a.logo)&&(f.logo=a.logo),u.a.checkParam(a.title)&&(f.title=a.title),void 0!==a.display&&(f.display=a.display),c="default"===a.skin);var l=Object(u.a)({name:"a",title:f.title,href:f.url,target:f.target});a=c?Object(u.a)({name:"img",src:f.logo,style:e.a.brand_logo}):Object(u.a)({name:"img",class:a.skin+"_brand_logo",src:f.logo});l.appendChild(a);u.a.checkParam(f.display)||
(l.style.display="none");return l}},function(l,t,n){var h=n(3),u=n(2),m=function(e){Object(u.a)({});var a=Object(h.a)({name:"i",title:"record",class:"fa fa-circle fa-fw fa-lg icon_record "+e.skin+"_icon "+e.skin+"_icon_record"});a.onclick=function(a){m.click(a,e.stream)};return a};m.click=function(e,a){var c=e.currentTarget.classList;c.contains("fa-circle")?(e.currentTarget.classList.remove("fa-circle"),e.currentTarget.classList.add("fa-stop-circle"),a.local||a.room.startRecording(a,function(a){})):
c.contains("fa-stop-circle")&&(e.currentTarget.classList.remove("fa-stop-circle"),e.currentTarget.classList.add("fa-circle"),a.recordingId&&a.room.stopRecording(a.recordingId,function(c){c&&(a.recordingId=void 0)}))};t.a=m},function(l,t,n){var h=n(3),u=n(2),m=function(e){Object(u.a)({});var a=e.stream;e=Object(h.a)({name:"i",title:"share screen",class:"fa fa-share-alt fa-fw fa-lg icon_share "+e.skin+"_icon "+e.skin+"_icon_share"});e.onclick=function(c){m.click(c,a)};return e};m.click=function(e,a){var c=
VcxRtc.Stream({screen:!0,data:!0,attributes:{name:"shareStream"}});c.init();c.addEventListener("media-access-allowed",function(){a.room.publish(c,{maxVideoBW:300},function(a,c){})});c.addEventListener("media-access-denied",function(a){})};t.a=m},function(l,t,n){var h=n(3),u=n(2);n(11);var m=n(10),e=function(a){Object(u.a)({});a="default"===a.skin?Object(h.a)({name:"i",title:"pause",class:"fa fa-pause fa-lg icon_play",style:Object.assign(m.a.icon,m.a.icon_play)}):Object(h.a)({name:"i",title:"pause",
class:"fa fa-pause fa-lg "+a.skin+"_icon icon_play "+a.skin+"_icon_play"});a.onclick=function(a){e.click(a)};return a};e.toggleVideo=function(a){a.srcObject.getTracks().forEach(function(a){return a.enabled=!a.enabled})};e.click=function(a){var c=a.currentTarget.classList;c.contains("fa-pause")?(a.currentTarget.classList.remove("fa-pause"),a.currentTarget.classList.add("fa-play"),c=a.currentTarget.parentNode.parentNode.parentNode,a=h.a.getById("stream"+c.id.split("_")[1]),c=h.a.getById("screen_saver_"+
c.id.split("_")[1]),e.toggleVideo(a),""!==c.src?c.style.display="block":a.pause()):c.contains("fa-play")&&(a.currentTarget.classList.remove("fa-play"),a.currentTarget.classList.add("fa-pause"),c=a.currentTarget.parentNode.parentNode.parentNode,a=h.a.getById("stream"+c.id.split("_")[1]),c=h.a.getById("screen_saver_"+c.id.split("_")[1]),e.toggleVideo(a),""!==c.src?c.style.display="none":a.play())};t.a=e},function(l,t,n){var h=n(3),u=n(2),m=n(10),e=function(a){Object(u.a)({});var c="default"===a.skin;
var f=a.stream;a=c?Object(h.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic",style:Object.assign(m.a.icon,m.a.icon_mic)}):Object(h.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic "+a.skin+"_icon "+a.skin+"_icon_mic"});a.onclick=function(a){e.click(a,f)};return a};e.click=function(a,c){var f=a.currentTarget.classList;f.contains("fa-microphone")?(c.muteAudio(),a.currentTarget.classList.remove("fa-microphone"),a.currentTarget.classList.add("fa-microphone-slash")):
f.contains("fa-microphone-slash")&&(c.unmuteAudio(),a.currentTarget.classList.remove("fa-microphone-slash"),a.currentTarget.classList.add("fa-microphone"))};t.a=e},function(l,t,n){l=n(1);var h=n.n(l),u=n(0).default,m;n=function(){this.audioDestination=this.modifiedStream=this.scriptProcessor=this.sourceStream=this.originalMediaTrack=this.audioContext=void 0;this.bufferResidue=new Float32Array([]);this.audioWorklet=void 0;this.bAnalysisStarted=!1;m=this};n.prototype.initAudioWorklet=function(){var e=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){return a.return(new Promise(function(a,f){var c,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return k.setCatchFinallyBlocks(2),k.yield(e.audioContext.resume(),4);case 4:c=h.a.noise_suppression_sdk_url;if(!(c&&0<c.trim().length)){u.debug("Error in initializing audio context (worklet URL configuration missing)");f();k.jumpTo(5);break}return k.yield(m.audioContext.audioWorklet.addModule(c),
6);case 6:a(new AudioWorkletNode(m.audioContext,"NoiseSuppressorWorklet"));case 5:k.leaveTryBlock(0);break;case 2:l=k.enterCatchBlock(),u.debug("Error while adding audio worklet module: ",l),f(),k.jumpToEnd()}})}))})};n.prototype.checkFileExists=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){return e.return(new Promise(function(a,c){var f,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){if(1==m.nextAddress)return m.setCatchFinallyBlocks(2),f=h.a.noise_suppression_sdk_url,
m.yield(fetch(f,{method:"HEAD"}),4);if(2!=m.nextAddress)return e=m.yieldResult,a(e.ok),m.leaveTryBlock(0);m.enterCatchBlock();c(!1);m.jumpToEnd()})}))})};n.prototype.startNoiseProcessing=function(e){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){u.info("Starting noise suppression...");return c.return(new Promise(function(c,h){try{a.audioContext=new (window.AudioContext||window.webkitAudioContext),a.initAudioWorklet().then(function(f){f?(a.audioWorklet=f,a.originalMediaTrack=
e.getAudioTracks()[0],a.sourceStream=a.audioContext.createMediaStreamSource(e),a.modifiedStream=new MediaStream,a.audioDestination=a.audioContext.createMediaStreamDestination(),a.outputMediaTrack=a.audioDestination.stream.getAudioTracks()[0],a.sourceStream.connect(a.audioWorklet),a.audioWorklet.connect(a.audioDestination),a.modifiedStream.addTrack(a.audioDestination.stream.getAudioTracks()[0]),a.outputMediaTrack.enabled=a.originalMediaTrack.enabled,a.outputMediaTrack.enabled=!0,a.bAnalysisStarted=
!0,c(a.modifiedStream)):(a.bAnalysisStarted=!1,u.debug("Error while starting noise processing (audio worklet is undefined)"),h())}).catch(function(c){a.bAnalysisStarted=!1;u.debug("Error while starting noise processing: ",c);h()})}catch(q){a.bAnalysisStarted=!1,u.debug("Error while starting noise processing: ",q),h()}}))})};n.prototype.stopNoiseProcessing=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){u.info("Stopping noise suppression...");return a.return(new Promise(function(a,
f){try{e.originalMediaTrack.enabled=e.outputMediaTrack.enabled,e.audioDestination.disconnect(),e.audioWorklet.disconnect(),e.sourceStream.disconnect(),e.audioContext.suspend(),e.bAnalysisStarted=!1,a()}catch(w){e.bAnalysisStarted=!1,u.debug("Error while stopping noise processing: ",w),f()}}))})};n.prototype.isAlreadyStarted=function(){return this.bAnalysisStarted};t.a=n},function(l,t,n){var h=n(0),u=n(7),m=n(11),e=n(19);n(14);l=n(1);var a=n.n(l),c=n(4);n(6);n(5);t.a=function(f,l){var q=Object(c.c)(l);
q.rooms=new Map;q.currentBreakOutRoom=null;q.joinRoom=function(f,l,n,x){x=void 0===x?{allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3}:x;var k=null,b=null;h["default"].info("SDK version is: ",a.a.product.version);if(null!=f){h["default"].info("=========== port of hope");f=JSON.parse(window.atob(f));f.version=a.a.product.version;var v=Object(m.a)(void 0,void 0,{token:e.a.encodeBase64(JSON.stringify(f)),reconnectInfo:x});f=function(){if("IE"===u.a.browserEngineCheck()){var a=document.getElementById("WebrtcEverywherePluginId");
a.addEventListener("room-connected",function(a){q.rooms.set(v.roomID,v);b={streams:a.data.streams,room:v,roomData:a.data.room,localStream:w};v.publish(w,{},function(a){0===a.result?(b.publishId=a.id,n(b,null)):n(null,a)})});a.addEventListener("room-error",function(a){n(b,a.data)});a.addEventListener("stream-added",function(b){v.subscribe(b.data.stream)})}else v.addEventListener("room-connected",function(a){h["default"].info("-----------BreakoutRoom-Connected--------");b={streams:a.streams,room:v,
roomData:a.room,localStream:w};n(b,null);v.publish(w,function(a){0===a.result?b.publishId=a.id:v.dispatchEvent(Object(c.e)({type:"room-error",message:a}))});for(a=0;a<b.streams.length;a++)v.subscribe(b.streams[a],{},function(b){!0===b?h["default"].info("breakout room-subscribe callback success"):(h["default"].info("breakout room-subscribe callback failed, could not subscribe streams",b),v.dispatchEvent(Object(c.e)({type:"room-error",message:b})))});q.rooms.set(v.roomID,v);a=Object(c.e)({type:"breakout-room-connected",
success:b});q.dispatchEvent(a)}),v.addEventListener("room-error",function(b){n(null,b)}),v.addEventListener("stream-added",function(b){v.subscribe(b.stream)}),v.addEventListener("room-disconnected",q.onBreakOutRoomDisconnect.bind(v));!1===v.reconnectionState&&0==v.reconnectAttempt?(h["default"].info("-----------BreakoutRoom-Connecting--------"),v.connect(x)):h["default"].debug(" Reconnection case in join room public api")};var r=function(a){k=a;n(b,k)};if(l.audio||l.video)var w=v.initPublishStream(l.div,
l,f,r);else h["default"].info(" No publish stream. audio and video are disabled.."),f()}return w};q.endBreakOutRoom=function(a){h["default"].info("Breakout Room ended, Disconnecting the room");q.rooms.get(a).disconnect()};q.onBreakOutRoomDisconnect=function(a){var f=Object(c.e)({type:"breakout-room-disconnect",message:{room_id:a.id}});q.rooms.delete(a.roomID);q.dispatchEvent(f)};q.onUserLeft=function(a,c){a=UserEvent({type:"user-disconnected",room_id:a.roomID,name:c.name,clientId:c.clientId,role:c.role,
permission:c.permissions});q.dispatchEvent(a)};q.onUserJoined=function(a,c){a=c.name;var f=c.role,e=c.permissions,k={name:c.name,permissions:c.permissions,role:c.role,user_ref:c.user_ref,videoMuted:c.videoMuted,audioMuted:c.audioMuted};q.userList.set(c.clientId,k);c=UserEvent({type:"user-connected",name:a,clientId:c.clientId,role:f,permission:e,user:k});q.dispatchEvent(c)};q.disconnectAll=function(){q.rooms.forEach(function(a,c){a&&a.disconnect()})};return q}},function(l,t,n){t.a=function(){var h=
{},l={};h.add=function(h,e){l[h]=e};h.get=function(h){return l[h]};h.getAll=function(){return l};h.clear=function(){h.forEach(function(m,e){h.remove(e)})};h.has=function(h){return void 0!==l[h]};h.size=function(){return Object.keys(l).length};h.forEach=function(h){for(var e=Object.keys(l),a=0;a<e.length;a+=1){var c=e[a];h(l[c],c)}};h.keys=function(){return Object.keys(l)};h.values=function(){return Object.values(l)};h.remove=function(h){delete l[h]};return h}},function(l,t){t.read=function(l,h,u,
m,e){var a=8*e-m-1;var c=(1<<a)-1,f=c>>1,n=-7;e=u?e-1:0;var q=u?-1:1,k=l[h+e];e+=q;u=k&(1<<-n)-1;k>>=-n;for(n+=a;0<n;u=256*u+l[h+e],e+=q,n-=8);a=u&(1<<-n)-1;u>>=-n;for(n+=m;0<n;a=256*a+l[h+e],e+=q,n-=8);if(0===u)u=1-f;else{if(u===c)return a?NaN:Infinity*(k?-1:1);a+=Math.pow(2,m);u-=f}return(k?-1:1)*a*Math.pow(2,u-m)};t.write=function(l,h,u,m,e,a){var c,f=8*a-e-1,n=(1<<f)-1,q=n>>1,k=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;a=m?0:a-1;var v=m?1:-1,r=0>h||0===h&&0>1/h?1:0;h=Math.abs(h);isNaN(h)||Infinity===
h?(h=isNaN(h)?1:0,m=n):(m=Math.floor(Math.log(h)/Math.LN2),1>h*(c=Math.pow(2,-m))&&(m--,c*=2),h=1<=m+q?h+k/c:h+k*Math.pow(2,1-q),2<=h*c&&(m++,c/=2),m+q>=n?(h=0,m=n):1<=m+q?(h=(h*c-1)*Math.pow(2,e),m+=q):(h=h*Math.pow(2,q-1)*Math.pow(2,e),m=0));for(;8<=e;l[u+a]=h&255,a+=v,h/=256,e-=8);m=m<<e|h;for(f+=e;0<f;l[u+a]=m&255,a+=v,m/=256,f-=8);l[u+a-v]|=128*r}},function(l,t){var n={}.toString;l.exports=Array.isArray||function(h){return"[object Array]"==n.call(h)}},function(l,t,n){l=n(31);var h=n.n(l),u=n(61),
m=n(23),e=n(12);n.n(e);var a=n(16),c=n(0);n=function(){var a=h.a.call(this,"FileSender")||this;a.keychain=new m.a;a.reset();return a};$jscomp.inherits(n,h.a);n.prototype.reset=function(){this.uploadRequest=null;this.msg="importingFile";this.progress=[0,1];this.cancelled=!1};n.prototype.cancel=function(){this.cancelled=!0;this.uploadRequest&&this.uploadRequest.cancel()};n.prototype.upload=function(f,h){var m=this,k,l,n,x,p,b,w,t,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){switch(q.nextAddress){case 1:if(m.cancelled)throw Error(0);
m.msg="encryptingFile";m.emit("encrypting");k=Object(e.encryptedSize)(f.size);return q.yield(m.keychain.encryptStream(f.stream),2);case 2:return l=q.yieldResult,q.yield(m.keychain.encryptMetadata(f),3);case 3:return n=q.yieldResult,q.yield(m.keychain.authKeyB64(),4);case 4:x=q.yieldResult;p={name:f.name,plainSize:f.size,type:f.type,totalSize:k};m.uploadRequest=Object(a.i)(l,n,x,f.timeLimit,f.dlimit,h,p,function(b){m.progress=[b,k];m.emit("progress")});if(m.cancelled)throw Error(0);m.msg="fileSizeProgress";
m.emit("progress");q.setCatchFinallyBlocks(5);return q.yield(m.uploadRequest.result,7);case 7:return b=q.yieldResult,m.msg="notifyUploadEncryptDone",m.uploadRequest=null,m.progress=[1,1],w=Object(e.arrayToB64)(m.keychain.rawSecret),t=new u.a({id:b.id,url:b.url+"#"+w,name:f.name,size:f.size,manifest:f.manifest,time:b.duration,speed:f.size/(b.duration/1E3),createdAt:Date.now(),expiresAt:Date.now()+1E3*f.timeLimit,secretKey:w,nonce:m.keychain.nonce,ownerToken:b.ownerToken,dlimit:f.dlimit,timeLimit:f.timeLimit,
mnounce:b.mnounce}),q.return(t);case 5:throw z=q.enterCatchBlock(),c["default"].info("upload request failed",z),m.msg="errorPageHeader",m.uploadRequest=null,z;}})};$jscomp.global.Object.defineProperties(n.prototype,{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return-1===["fileSizeProgress","notifyUploadEncryptDone"].indexOf(this.msg)}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(e.bytes)(this.progress[0]),
totalSize:Object(e.bytes)(this.progress[1])}}}});t.a=n},function(l,t,n){l.exports=function(h,l,m){var e=h.length;if(!(l>=e||0===m)){m=l+m>e?e-l:m;for(e-=m;l<e;++l)h[l]=h[l+m];h.length=e}}},function(l,t,n){function h(c){function f(f){var e="end-"+l+"-"+c;a.mark(e);m.push(function(){var k=null;try{a.measure(c+" ["+l+"]",q,e),a.clearMarks(q),a.clearMarks(e)}catch(x){k=x}f&&f(k,c)})}e.equal(typeof c,"string","nanotiming: name should be type string");if(h.disabled)return u;var l=(1E4*a.now()).toFixed()%
Number.MAX_SAFE_INTEGER,q="start-"+l+"-"+c;a.mark(q);f.uuid=l;return f}function u(a){a&&m.push(function(){a(Error("nanotiming: performance API unavailable"))})}var m=n(60)(),e=n(22);h.disabled=!0;try{var a=window.performance;h.disabled="true"===window.localStorage.DISABLE_NANOTIMING||!a.mark}catch(c){}l.exports=h},function(l,t,n){function h(e){this.method=(this.hasIdle=(this.hasWindow=e)&&window.requestIdleCallback)?window.requestIdleCallback.bind(window):this.setTimeout;this.scheduled=!1;this.queue=
[]}var u=n(22),m="undefined"!==typeof window;h.prototype.push=function(e){u.equal(typeof e,"function","nanoscheduler.push: cb should be type function");this.queue.push(e);this.schedule()};h.prototype.schedule=function(){if(!this.scheduled){this.scheduled=!0;var e=this;this.method(function(a){for(var c;e.queue.length&&0<a.timeRemaining();)c=e.queue.shift(),c(a);e.scheduled=!1;e.queue.length&&e.schedule()})}};h.prototype.setTimeout=function(e){setTimeout(e,0,{timeRemaining:function(){return 1}})};l.exports=
function(){if(m){window._nanoScheduler||(window._nanoScheduler=new h(!0));var e=window._nanoScheduler}else e=new h;return e}},function(l,t,n){var h=n(23),u=n(12);n.n(u);var m=n(16);l=function(e){if(!e.manifest)throw Error("invalid file object");this.id=e.id;this.url=e.url;this.name=e.name;this.size=e.size;this.manifest=e.manifest;this.time=e.time;this.speed=e.speed;this.createdAt=e.createdAt;this.expiresAt=e.expiresAt;this.ownerToken=e.ownerToken;this.dlimit=e.dlimit||1;this.dtotal=e.dtotal||0;this.keychain=
new h.a(e.secretKey,e.nonce);this._hasPassword=!!e.hasPassword;this.timeLimit=e.timeLimit;this.mnounce=e.mnounce};l.prototype.setPassword=function(e){var a=this,c,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.setCatchFinallyBlocks(2),a.password=e,a._hasPassword=!0,a.keychain.setPassword(e,a.url),h.yield(Object(m.h)(a.id,a.ownerToken,a.keychain),4);if(2!=h.nextAddress)return c=h.yieldResult,h.return(c);f=h.enterCatchBlock();a.password=null;a._hasPassword=
!1;throw f;})};l.prototype.del=function(){return Object(m.a)(this.id,this.ownerToken)};l.prototype.changeLimit=function(e,a){a=void 0===a?{}:a;return this.dlimit!==e?(this.dlimit=e,Object(m.g)(this.id,this.ownerToken,a.bearerToken,{dlimit:e})):Promise.resolve(!0)};l.prototype.updateDownloadCount=function(){var e=this,a,c,f,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){switch(l.nextAddress){case 1:return a=e.dtotal,c=e.dlimit,l.setCatchFinallyBlocks(2),l.yield(Object(m.c)(e.id,e.ownerToken),
4);case 4:f=l.yieldResult;e.dtotal=f.dtotal;e.dlimit=f.dlimit;l.leaveTryBlock(3);break;case 2:h=l.enterCatchBlock(),"404"===h.message&&(e.dtotal=e.dlimit);case 3:return l.return(a!==e.dtotal||c!==e.dlimit)}})};l.prototype.toJSON=function(){return{id:this.id,url:this.url,name:this.name,size:this.size,manifest:this.manifest,time:this.time,speed:this.speed,createdAt:this.createdAt,expiresAt:this.expiresAt,secretKey:Object(u.arrayToB64)(this.keychain.rawSecret),ownerToken:this.ownerToken,dlimit:this.dlimit,
dtotal:this.dtotal,hasPassword:this.hasPassword,timeLimit:this.timeLimit,mnounce:this.mnounce}};$jscomp.global.Object.defineProperties(l.prototype,{hasPassword:{configurable:!0,enumerable:!0,get:function(){return!!this._hasPassword}},expired:{configurable:!0,enumerable:!0,get:function(){return this.dlimit===this.dtotal||Date.now()>this.expiresAt}}});t.a=l},function(l,t,n){var h=n(21);l=function(h,m,e){h=void 0===h?[]:h;m=void 0===m?86400:m;e=void 0===e?{}:e;this.files=Array.from(h);this.timeLimit=
this.defaultTimeLimit=m;this.dlimit=10;this.password=null;this.roomMeta=e};l.prototype.addFiles=function(h,m,e){var a=this;if(this.files.length+h.length>e)throw Error("tooManyFiles");h=h.filter(function(c){var f;if(f=0<c.size){a:{f=$jscomp.makeIterator(a.files);for(var e=f.next();!e.done;e=f.next())if(e=e.value,c.name===e.name&&c.size===e.size&&c.lastModified===e.lastModified){c=!0;break a}c=!1}f=!c}return f});e=h.reduce(function(a,f){return a+f.size},0);if(this.size+e>m)throw Error("fileTooBig");
this.files=this.files.concat(h);return!0};l.prototype.remove=function(h){h=this.files.indexOf(h);-1<h&&this.files.splice(h,1)};l.prototype.clear=function(){this.files=[];this.dlimit=1;this.timeLimit=this.defaultTimeLimit;this.password=null;this.roomMeta={}};$jscomp.global.Object.defineProperties(l.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return 1<this.files.length?"Send-Archive.zip":this.files[0].name}},type:{configurable:!0,enumerable:!0,get:function(){return 1<this.files.length?
"send-archive":this.files[0].type}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(h,m){return h+m.size},0)}},numFiles:{configurable:!0,enumerable:!0,get:function(){return this.files.length}},manifest:{configurable:!0,enumerable:!0,get:function(){return{files:this.files.map(function(h){return{name:h.name,size:h.size,type:h.type}})}}},stream:{configurable:!0,enumerable:!0,get:function(){return Object(h.b)(this.files.map(function(l){return Object(h.a)(l)}))}}});
t.a=l},function(l,t,n){function h(a,c){c=void 0===c?!1:c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){return f.return(new Promise(function(f,e){var k={};k=new DataView(a.plaintext);k=new Blob([k],{type:a.type});if(!0===c)return w["default"].info(" download file mobile device",c),k={messageType:"download-success",result:0,description:"download-success",response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size,blob:k}},f(k);if(navigator.msSaveBlob)return console.log("nagivator service worker is present"),
navigator.msSaveBlob(k,a.name),f();if(/iPhone|fxios/i.test(navigator.userAgent)){var b=new FileReader;b.addEventListener("loadend",function(){if(b.error)return e(b.error);if(b.result){var c=document.createElement("a");c.href=b.result;c.download=a.name;document.body.appendChild(c);c.click()}f()});b.readAsDataURL(k)}else{k=URL.createObjectURL(k);var h=document.createElement("a");h.href=k;h.download=a.name;document.body.appendChild(h);h.click();URL.revokeObjectURL(k);k={messageType:"download-success",
result:0,description:"download-success",response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size}};setTimeout(f(k),100)}}))})}l=n(31);var u=n.n(l),m=n(23),e=n(12);n.n(e);var a=n(16),c=n(21),f=n(64),w=n(0);n=function(a){var c=u.a.call(this,"FileReceiver")||this;c.keychain=new m.a(a.secretKey,a.nonce);a.requiresPassword&&c.keychain.setPassword(a.password,a.url);c.fileInfo=a;c.reset();return c};$jscomp.inherits(n,u.a);n.prototype.cancel=function(){this.downloadRequest&&this.downloadRequest.cancel()};
n.prototype.reset=function(){this.msg="fileSizeProgress";this.state="initialized";this.progress=[0,1]};n.prototype.getMetadata=function(){var c=this,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(Object(a.e)(c.fileInfo.id,c.keychain),2);f=e.yieldResult;c.fileInfo.name=f.name;c.fileInfo.type=f.type;c.fileInfo.iv=f.iv;c.fileInfo.size=+f.size;c.fileInfo.manifest=f.manifest;c.state="ready";e.jumpToEnd()})};n.prototype.sendMessageToSw=function(a){return new Promise(function(c,
f){var e=new MessageChannel;e.port1.onmessage=function(a){void 0===a.data?f("bad response from serviceWorker"):void 0!==a.data.error?f(a.data.error):c(a.data)};navigator.serviceWorker.controller.postMessage(a,[e.port2])})};n.prototype.downloadBlob=function(m,k){m=void 0===m?!1:m;k=void 0===k?!1:k;var l=this,q,n,p,b,w,u,z,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(r){switch(r.nextAddress){case 1:return l.state="downloading",q=l,r.yield(Object(a.b)(l.fileInfo.id,l.keychain,function(b){l.progress=
[b,l.fileInfo.size];l.emit("progress")}),2);case 2:return q.downloadRequest=r.yieldResult,r.setCatchFinallyBlocks(3),r.yield(l.downloadRequest.result,5);case 5:return n=r.yieldResult,l.downloadRequest=null,l.msg="decryptingFile",l.state="decrypting",l.emit("decrypting"),p=l.fileInfo.size,b=l.keychain.decryptStream(Object(c.a)(n)),"send-archive"===l.fileInfo.type&&(w=new f.a(l.fileInfo.manifest,b),b=w.stream,p=w.size),r.yield(Object(e.streamToArrayBuffer)(b,p),6);case 6:u=r.yieldResult;z={};if(m){r.jumpTo(7);
break}return r.yield(h({plaintext:u,name:decodeURIComponent(l.fileInfo.name),type:l.fileInfo.type},k),8);case 8:z=r.yieldResult;case 7:return l.msg="downloadFinish",l.emit("complete"),l.state="complete",r.return(z);case 3:throw t=r.enterCatchBlock(),l.downloadRequest=null,t;}})};n.prototype.downloadStream=function(c){c=void 0===c?!1:c;var f=this,h,m,l,p,b,q,n,w,u,t,C,G;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return h=Date.now(),m=function(b){f.progress=
[b,f.fileInfo.size];f.emit("progress")},f.downloadRequest={cancel:function(){f.sendMessageToSw({request:"cancel",id:f.fileInfo.id})}},k.setCatchFinallyBlocks(2),f.state="downloading",l={request:"init",id:f.fileInfo.id,filename:f.fileInfo.name,type:f.fileInfo.type,manifest:f.fileInfo.manifest,key:f.fileInfo.secretKey,requiresPassword:f.fileInfo.requiresPassword,password:f.fileInfo.password,url:f.fileInfo.url,size:f.fileInfo.size,nonce:f.keychain.nonce,noSave:c},k.yield(f.sendMessageToSw(l),4);case 4:m(0);
if(!c){p="/api/download/"+f.fileInfo.id;b=Object(a.d)(p);b===p&&(b=location.protocol+"//"+location.host+p);q=document.createElement("a");q.href=b;document.body.appendChild(q);q.click();k.jumpTo(5);break}return k.yield(fetch(Object(a.d)("/api/download/"+f.fileInfo.id)),6);case 6:if(n=k.yieldResult,200!==n.status)throw Error(n.status);case 5:u=w=0;case 7:if(!(w<f.fileInfo.size)){f.downloadRequest=null;f.msg="downloadFinish";f.emit("complete");f.state="complete";k.leaveTryBlock(0);break}return k.yield(f.sendMessageToSw({request:"progress",
id:f.fileInfo.id}),9);case 9:t=k.yieldResult;t.progress===w?u++:u=0;if(30<u)throw C=Error("hung download"),C.duration=Date.now()-h,C.size=f.fileInfo.size,C.progress=w,C;w=t.progress;m(w);return k.yield(Object(e.delay)(1E3),7);case 2:G=k.enterCatchBlock();f.downloadRequest=null;if("cancelled"===G||"400"===G.message)throw Error(0);throw G;}})};n.prototype.download=function(a){return a.stream?this.downloadStream(a.noSave):this.downloadBlob(a.noSave,a.isMobile)};$jscomp.global.Object.defineProperties(n.prototype,
{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return"downloading"!==this.state}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(e.bytes)(this.progress[0]),totalSize:Object(e.bytes)(this.progress[1])}}}});t.a=n},function(l,t,n){function h(a,f,e){var c=new ArrayBuffer(22),k=new DataView(c);k.setUint32(0,101010256,!0);k.setUint16(4,0,!0);k.setUint16(6,
0,!0);k.setUint16(8,a,!0);k.setUint16(10,a,!0);k.setUint32(12,f,!0);k.setUint32(16,e,!0);k.setUint16(20,0,!0);return new Uint8Array(c)}var u=n(65),m=new TextEncoder,e=function(a){this.name=m.encode(a.name);this.size=a.size;this.bytesRead=0;this.crc=null;a=void 0;a=void 0===a?new Date:a;var c=a.getFullYear()-1980<<9,e=a.getMonth()+1<<5,h=a.getDate();c=c|e|h;e=a.getHours()<<11;h=a.getMinutes()<<5;a=Math.floor(a.getSeconds()/2);this.dateTime={date:c,time:e|h|a}};e.prototype.directoryRecord=function(a){var c=
new ArrayBuffer(46+this.name.byteLength),e=new DataView(c);e.setUint32(0,33639248,!0);e.setUint16(4,20,!0);e.setUint16(6,20,!0);e.setUint16(8,8,!0);e.setUint16(10,0,!0);e.setUint16(12,this.dateTime.time,!0);e.setUint16(14,this.dateTime.date,!0);e.setUint32(16,this.crc,!0);e.setUint32(20,this.size,!0);e.setUint32(24,this.size,!0);e.setUint16(28,this.name.byteLength,!0);e.setUint16(30,0,!0);e.setUint16(32,0,!0);e.setUint16(34,0,!0);e.setUint16(36,0,!0);e.setUint32(38,0,!0);e.setUint32(42,a,!0);for(a=
0;a<this.name.byteLength;a++)e.setUint8(46+a,this.name[a]);return new Uint8Array(c)};e.prototype.append=function(a,f){this.bytesRead+=a.byteLength;var c=a.byteLength-Math.max(this.bytesRead-this.size,0),e=a.slice(0,c);this.crc=Object(u.a)(e,this.crc);f.enqueue(e);if(c<a.byteLength)return a.slice(c,a.byteLength)};$jscomp.global.Object.defineProperties(e.prototype,{header:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(30+this.name.byteLength),f=new DataView(a);f.setUint32(0,67324752,
!0);f.setUint16(4,20,!0);f.setUint16(6,8,!0);f.setUint16(8,0,!0);f.setUint16(10,this.dateTime.time,!0);f.setUint16(12,this.dateTime.date,!0);f.setUint32(14,0,!0);f.setUint32(18,0,!0);f.setUint32(22,0,!0);f.setUint16(26,this.name.byteLength,!0);f.setUint16(28,0,!0);for(var e=0;e<this.name.byteLength;e++)f.setUint8(30+e,this.name[e]);return new Uint8Array(a)}},dataDescriptor:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(16),f=new DataView(a);f.setUint32(0,134695760,!0);f.setUint32(4,
this.crc,!0);f.setUint32(8,this.size,!0);f.setUint32(12,this.size,!0);return new Uint8Array(a)}},byteLength:{configurable:!0,enumerable:!0,get:function(){return this.size+this.name.byteLength+30+16}}});var a=function(a,f){this.files=a;this.fileIndex=0;this.file=null;this.reader=f.getReader();this.nextFile();this.extra=null};a.prototype.nextFile=function(){this.file=this.files[this.fileIndex++]};a.prototype.pull=function(a){var c=this,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==
f.nextAddress){if(!c.file){for(var k=c.files,m=0,l=0,q=0;q<k.length;q++){var p=k[q],b=p.directoryRecord(m);m+=p.byteLength;a.enqueue(b);l+=b.byteLength}a.enqueue(h(k.length,l,m));return f.return(a.close())}0===c.file.bytesRead&&(a.enqueue(c.file.header),c.extra&&(c.extra=c.file.append(c.extra,a)));return c.file.bytesRead>=c.file.size?(a.enqueue(c.file.dataDescriptor),c.nextFile(),f.return(c.pull(a))):f.yield(c.reader.read(),2)}e=f.yieldResult;if(e.done)return c.nextFile(),f.return(c.pull(a));c.extra=
c.file.append(e.value,a);f.jumpToEnd()})};l=function(a,f){this.files=a.files.map(function(a){return new e(a)});this.source=f};$jscomp.global.Object.defineProperties(l.prototype,{stream:{configurable:!0,enumerable:!0,get:function(){return new ReadableStream(new a(this.files,this.source))}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(a,f){return a+2*f.byteLength-f.size},0)+22}}});t.a=l},function(l,t,n){var h=n(17);n.n(h);var u=n(66);l=n(67);var m=[0,1996959894,
3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,
1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,
1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,
2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,
752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,
3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!==typeof Int32Array&&(m=new Int32Array(m));l=Object(l.a)("crc-32",function(e,a){h.Buffer.isBuffer(e)||(e=Object(u.a)(e));a=0===a?0:~~a^-1;for(var c=0;c<e.length;c++)a=m[(a^e[c])&255]^a>>>8;return a^-1});t.a=l},function(l,t,n){var h=n(17);n.n(h);t.a=h.Buffer.from&&h.Buffer.alloc&&h.Buffer.allocUnsafe&&
h.Buffer.allocUnsafeSlow?h.Buffer.from:function(l){return new h.Buffer(l)}},function(l,t,n){t.a=function(h,l){var m=function(e,a){return l(e,a)>>>0};m.signed=l;m.unsigned=m;m.model=h;return m}},function(l,t,n){t.a={isAnnotationStarted:!1,canvasOptions:{width:0,height:0},frameStyle:"display:block; user-select: none;z-index:0; position:absolute;top:0%",annotateStyle:"display:block; user-select: none;z-index:2; position:absolute;top:0%",annotationConfig:{toolType:"draw",isErase:!1,drawMethod:"pencil",
strokeColor:"#ff0000",lineWidth:3,hasInput:!1,lastMouseX:0,lastMouseY:0,canvasX:0,canvasY:0,mouseX:0,mouseY:0,mouseDown:!1,drawElement:null,drawCtx:null,canvasDomID:null,canvasVideoPlayerID:null,customCanvasID:"draw_veneer2",customframeID:"draw_frame",pausePlayTime:0,videoPlaying:!1,streamid:0,setTimeLoop:.3},setupAnnotationToolbar:function(){var h=document.createElement("div");h.setAttribute("id","annotationToolbarContainer");h.style="position: absolute;bottom: 0; z-index: 98;";var l=document.createElement("div");
l.setAttribute("id","toolbar");l.innerHTML='<div class="atn-btns">\n      <button id="annotate-draw">Draw</button>\n      <select id="selDrawMethod">\n        <option value="pencil" selected="selected">Pencil</option>\n        <option value="text">Text</option>\n      </select>\n      <input\n      type="color"\n      id="favcolor"\n      name="favcolor"\n      value="#ff0000"\n      \n    />\n    <select id="selWidth" >\n      <option value="1">1</option>\n      <option value="3" selected="selected">3</option>\n      <option value="5">5</option>\n      <option value="7">7</option>\n      <option value="9">9</option>\n      <option value="11">11</option>\n    </select>\n    <input type="button" id="eraseBtn" value="Erase" />\n    <input type="button" id="clearBtn" value="Clear" />\n    <input type="button" id="play" value="Play-Pause" />\n    \n      </div>';
h.append(l);return{toolbarCont:h,toolbar:l}},_QS:function(h,l){return(void 0===l?0:l)?document.querySelectorAll(""+h)?document.querySelectorAll(""+h):!1:document.querySelector(""+h)?document.querySelector(""+h):!1},bindEventListernersForTools:function(){var h=this;h._QS("#annotate-draw")&&h._QS("#annotate-draw").addEventListener("click",function(l){h.annotateToolAction("tool","draw")});h._QS("#selDrawMethod")&&h._QS("#selDrawMethod").addEventListener("change",function(l){h.annotateToolAction("drawMethod",
l.target.value)});h._QS("#selWidth")&&h._QS("#selWidth").addEventListener("change",function(l){h.annotateToolAction("lineWidth",l.target.value)});h._QS("#favcolor")&&h._QS("#favcolor").addEventListener("change",function(l){h.annotateToolAction("strokeColor",l.target.value)});h._QS("#eraseBtn")&&h._QS("#eraseBtn").addEventListener("click",function(l){h.annotateToolAction("erase")});h._QS("#clearBtn")&&h._QS("#clearBtn").addEventListener("click",function(l){h.annotateToolAction("clear")});h._QS("#play")&&
h._QS("#play").addEventListener("click",function(l){h.pause_play()})},annotateAddInput:function(h,l){var m=this,e=document.createElement("input");e.className="annotate-text";e.type="text";e.style.position="fixed";e.style.zIndex=50;e.style.left=h-4+"px";e.style.top=l-4+"px";e.onkeydown=function(a){var c=a.keyCode;13===c?(m.annotateDrawText(a.target.value),document.body.removeChild(a.target),m.annotationConfig.hasInput=!1):27===c&&(document.body.removeChild(a.target),m.annotationConfig.hasInput=!1)};
document.body.appendChild(e);e.focus();this.annotationConfig.hasInput=!0},pause_play:function(){var h=this;if(h.annotationConfig.videoPlaying)clearInterval(h.annotationConfig.pausePlayTime),h.annotationConfig.videoPlaying=!1;else{var l=document.getElementById("stream"+h.annotationConfig.streamid);if(l){var m=document.getElementById(h.annotationConfig.customframeID);if(m){var e=m.getContext("2d");h.annotationConfig.pausePlayTime=setInterval(function(){0<h.canvasOptions.width&&0<h.canvasOptions.height&&
e.drawImage(l,0,0,h.canvasOptions.width,h.canvasOptions.height)},h.annotationConfig.setTimeLoop);h.annotationConfig.videoPlaying=!0}}}},handleEnter:function(h){var l=h.keyCode;13===l?(this.annotateDrawText(h.target.value),document.body.removeChild(h.target),this.annotationConfig.hasInput=!1):27===l&&(document.body.removeChild(h.target),this.annotationConfig.hasInput=!1)},annotateDrawText:function(h){this.annotationConfig.drawCtx.textBaseline="top";this.annotationConfig.drawCtx.textAlign="left";this.annotationConfig.drawCtx.fillStyle=
this.annotationConfig.strokeColor;this.annotationConfig.drawCtx.font="14px sans-serif";this.annotationConfig.drawCtx.fillText(h,this.annotationConfig.lastMouseX-4,this.annotationConfig.lastMouseY-4)},reOffset:function(h){h=h.getBoundingClientRect();this.annotationConfig.canvasX=h.left;this.annotationConfig.canvasY=h.top},startFrame:function(){this.annotationConfig.videoPlaying=!1},getCanvasId:function(){return this.annotationConfig.customCanvasID},getVideoFrameId:function(){return this.annotationConfig.customframeID},
getCanvasWidth:function(){return this.canvasOptions.width},getCanvasHeight:function(){return this.canvasOptions.height},toolBarAction:function(h,l){if("tool"===h)this.annotationConfig.toolType=l,this.annotationConfig.isErase=!1;else if("erase"===h)this.annotationConfig.toolType=h,this.annotationConfig.isErase=!0;else if("strokeColor"===h)this.annotationConfig.strokeColor=l;else if("lineWidth"===h)this.annotationConfig.lineWidth=l;else if("drawMethod"===h)this.annotationConfig.drawMethod=l;else if("clear"===
h){for(h=document.getElementsByClassName("annotate-text");0<h.length;)h[0].remove();this.annotationConfig.drawCtx.clearRect(0,0,this.canvasOptions.width,this.canvasOptions.height)}},appendCustomCanvas:function(h,l,m,e){this.canvasOptions.width=m;this.canvasOptions.height=e;var a=document.createElement("canvas");a.id=this.annotationConfig.customCanvasID;a.width=m;a.height=e;a.className=l;a.setAttribute("style",this.annotateStyle);h&&(h.append(a),l=this.setupAnnotationToolbar(),h.append(l.toolbarCont))},
appendCanvasFrame:function(h,l,m,e,a){this.canvasOptions.width=m;this.canvasOptions.height=e;var c=document.createElement("canvas");c.getContext("2d");c.id=this.annotationConfig.customframeID;c.width=m;c.height=e;a&&(m=a.getID(),this.annotationConfig.streamid=m,document.getElementById("stream"+m)&&(c.className=l,c.setAttribute("style",this.frameStyle),h&&h.append(c)))},onDown:function(h,l){h.preventDefault();if("touchstart"==h.type||"touchmove"==h.type||"touchend"==h.type||"touchcancel"==h.type){h=
"undefined"===typeof h.originalEvent?h:h.originalEvent;l=h.touches[0]||h.changedTouches[0];var m=l.pageX;var e=l.pageY}else if("mousedown"==h.type||"mouseup"==h.type||"mousemove"==h.type||"mouseover"==h.type||"mouseout"==h.type||"mouseenter"==h.type||"mouseleave"==h.type)m=h.clientX,e=h.clientY;this.reOffset(this.annotationConfig.drawElement);this.annotationConfig.lastMouseX=this.annotationConfig.mouseX=parseInt(m-this.annotationConfig.canvasX);this.annotationConfig.lastMouseY=this.annotationConfig.mouseY=
parseInt(e-this.annotationConfig.canvasY);this.annotationConfig.mouseDown=!0;"text"===this.annotationConfig.drawMethod&&"draw"===this.annotationConfig.toolType&&this.annotateAddInput(m,e)},onMove:function(h,l,m){h.preventDefault();if("touchstart"==h.type||"touchmove"==h.type||"touchend"==h.type||"touchcancel"==h.type){h="undefined"===typeof h.originalEvent?h:h.originalEvent;m=h.touches[0]||h.changedTouches[0];var e=m.pageX;var a=m.pageY}else if("mousedown"==h.type||"mouseup"==h.type||"mousemove"==
h.type||"mouseover"==h.type||"mouseout"==h.type||"mouseenter"==h.type||"mouseleave"==h.type)e=h.clientX,a=h.clientY;this.annotationConfig.mouseX=parseInt(e-this.annotationConfig.canvasX);this.annotationConfig.mouseY=parseInt(a-this.annotationConfig.canvasY);this.annotationConfig.mouseDown&&"pencil"===this.annotationConfig.drawMethod&&(this.annotationConfig.drawCtx.beginPath(),"draw"===this.annotationConfig.toolType?(this.annotationConfig.drawCtx.globalCompositeOperation="source-over",this.annotationConfig.drawCtx.strokeStyle=
this.annotationConfig.strokeColor,this.annotationConfig.drawCtx.lineWidth=this.annotationConfig.lineWidth):(this.annotationConfig.drawCtx.globalCompositeOperation="destination-out",this.annotationConfig.drawCtx.lineWidth=10),this.annotationConfig.drawCtx.moveTo(this.annotationConfig.lastMouseX,this.annotationConfig.lastMouseY),this.annotationConfig.drawCtx.lineTo(this.annotationConfig.mouseX,this.annotationConfig.mouseY),this.annotationConfig.drawCtx.lineJoin=l.lineCap="round",this.annotationConfig.drawCtx.stroke());
this.annotationConfig.lastMouseX=this.annotationConfig.mouseX;this.annotationConfig.lastMouseY=this.annotationConfig.mouseY},onUp:function(h){h.preventDefault();this.annotationConfig.mouseDown=!1},annotateToolAction:function(h,l){this.toolBarAction(h,l)},mouseAnnotate:function(h,l,m,e){e=void 0===e?null:e;var a=this;e&&(a.stream=e);a.isAnnotationStarted=!0;a.annotationConfig.drawElement=document.getElementById(a.annotationConfig.customCanvasID);a.annotationConfig.drawCtx=a.annotationConfig.drawElement.getContext("2d");
a.annotationConfig.canvasDomID=h;a.annotationConfig.canvasVideoPlayerID=m;a.annotationConfig.drawElement.addEventListener("mousedown",function(c){a.onDown(c,!1)});a.annotationConfig.drawElement.addEventListener("touchstart",function(c){a.onDown(c,!0)});a.annotationConfig.drawElement.addEventListener("mousemove",function(c){a.onMove(c,l,!1)});a.annotationConfig.drawElement.addEventListener("touchmove",function(c){a.onMove(c,l,!0)});a.annotationConfig.drawElement.addEventListener("mouseup",function(c){a.onUp(c)});
a.annotationConfig.drawElement.addEventListener("touchcancel",function(c){a.onUp(c)});return a.annotationConfig.drawElement},stopAnnotation:function(){this.isAnnotationStarted=!1;var h=document.getElementById("canvas-wrapper");h&&h.remove();for(h=document.getElementsByClassName("annotate-text");0<h.length;)h[0].remove();h=document.querySelector(".annotate-div");var l=h.parentElement;l.prepend(h.firstElementChild);l.firstChild.style.height="100%";l.firstChild.style.width="100%";h.remove();this.annotationConfig.toolType=
"draw";this.annotationConfig.isErase=!1;this.annotationConfig.drawMethod="pencil";this.annotationConfig.strokeColor="#ff0000";this.annotationConfig.lineWidth=3},resize:function(){var h=this;h.isAnnotationStarted&&setTimeout(function(){var l=h.stream;if(l){var m=l.getID(),e=document.getElementById("stream"+m+"_veneer"),a=document.getElementById("draw_veneer2"),c=document.getElementById("draw_frame"),f=document.getElementById("canvas-wrapper");if(a&&c&&f){var n=a.getContext("2d"),q=n.getImageData(0,
0,a.width,a.height);l=l.stream.getVideoTracks()[0];l=l.getSettings()?l.getSettings():l.getConstraints();var k=l.height,v=l.width,r=document.querySelector(".annotate-div");m=document.querySelector("#player_"+m);l=r.clientHeight;r=r.clientWidth;if(l<r){var x=l/k,p=k*x;x*=v;x>r?(x=r/v,k*=x,v*=x):(k=p,v=x)}else x=r/v,p=k*x,x*=v,p>l?(x=l/k,k*=x,v*=x):(k=p,v=x);m.style.height=k+"px";m.style.width=v+"px";e.width=v;e.height=k;a.width=v;a.height=k;c.width=v;c.height=k;f.style.width=v+"px";f.style.height=k+
"px";createImageBitmap(q).then(function(b){n.drawImage(b,0,0,v,k)});h.canvasOptions.width=v;h.canvasOptions.height=k;h.reOffset(h.annotationConfig.drawElement)}}},100)}}},function(l,t,n){var h=n(0),u=n(7),m=n(11),e=n(19);n(14);l=n(1);var a=n.n(l),c=n(4),f=n(6);l=n(5);var w=n(9);n(8);var q=l.a.constant,k=void 0,v={default:{minVideoBW:80,maxVideoBW:1500,scheme:"notify-break-recover"},disconnectRoom:function(a){k=void 0;a&&a.disconnect()},getDevice:function(c,e){if(void 0!=c&&null!=c)if("function"===
typeof c){var k=c;var b={mic:!0,cam:!0,speaker:!1}}else"object"===typeof c&&(void 0!=c.mic&&"boolean"!==typeof c.mic||void 0!=c.cam&&"boolean"!==typeof c.cam||void 0!=c.speaker&&"boolean"!==typeof c.speaker||(b=c));else b={mic:!0,cam:!0,speaker:!1};k||void 0==e||null==e||"function"!==typeof e||(k=e);a.a.is_supported()&&b&&k?u.a.getDeviceList(b,k):a.a.is_supported()?(h["default"].error("Failed invalid param - callback or options"),k&&k(f.a.error_1155)):(h["default"].error("Failed Webrtc support is missing "),
k&&k(f.a.error_1000))},notifyDeviceUpdate:function(c,e){a.a.is_supported()?(!c||"object"===typeof c&&(c.mic||c.cam))&&e&&"function"===typeof e?u.a.mediaDeviceUpdate(!1,c,"vcxVcxQuickApi_notifyDeviceUpdate",function(a){e(a)}):e&&"function"===typeof e&&e(f.a.error_1155):h["default"].info("Failed Webrtc support is missing ")},switchMediaDevice:function(c,e,k,b){b=void 0===b?function(){}:b;"function"===typeof b?a.a.is_supported()?e&&"string"===typeof e&&k&&"string"===typeof k?c.switchMediaDevices(c,e,
k,b):(h["default"].info("Invalid Device Id"),b(!1)):(h["default"].info("Failed Webrtc support is missing "),b(f.a.error_1000)):h["default"].error("switchMediaDevice() invalid param - callback")},joinRoom:function(l,n,p,b){var r=function(){},x={},z={allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3};if(void 0==p&&void 0==b)h["default"].error("joinRoom() failed, callback is missing. invalid parameters");else{if(void 0!=p&&"function"===typeof p)r=p,void 0!=b&&(z=b);else if(void 0!=b&&"function"===
typeof b)if(r=b,void 0!=p)x=p;else{h["default"].error("joinRoom() failed, callback is missing. invalid parameters");return}if(a.a.is_supported())if(void 0==l||void 0==n)h["default"].error("joinRoom() failed, token/streamInfo is missing. invalid parameters"),r(null,f.a.error_1155);else{var t=null,A=null;h["default"].info("SDK version: "+a.a.product.version+" browser name: "+a.a.browser_type+" browser version: "+a.a.browser_info.version+" device type: "+a.a.browser_info.device_type);if(null!=l){l=JSON.parse(e.a.decodeBase64(l));
w.a.init(l);l.version=a.a.product.version;x.reconnectInfo=z;x.token=e.a.encodeBase64(JSON.stringify(l));x.data=void 0!=n.data&&0==n.data?!1:!0;var C=Object(m.a)(void 0,void 0,x);x=function(){"IE"!==u.a.browserEngineCheck()&&(C.addEventListener("room-connected",function(b){A={streams:b.streams,room:C,roomData:b.room,localStream:G};k=C;if(void 0!==b.me&&null!==b.me&&("lecture"!==C.mode||"participant"!==b.me.role||C.floorGranted)&&(n.audio||n.video)){var e={scheme:n.scheme?n.scheme:v.default.scheme,
maxVideoLayers:C.maxVideoLayers,forceTurn:n.forceTurn,audio:n.audio?n.audio:!1,video:n.video?n.video:!1};n.maxVideoBW&&(e.maxVideoBW=n.maxVideoBW);n.minVideoBW&&(e.minVideoBW=n.minVideoBW);n.maxVideoFps&&(e.maxVideoFps=n.maxVideoFps);n.maxVideoFps&&(e.maxVideoFps=n.maxVideoFps);n.audioMuted&&(e.audioMuted=n.audioMuted);n.videoMuted&&(e.videoMuted=n.videoMuted)}if("audience"===C.me.role&&C.subscription&&!C.subscription.hls)h["default"].error("Licence error :  HLS not supported !!");else if(!1===C.reconnectionState){n.video&&
C.subscription&&!C.subscription.audio_video&&(h["default"].error("Licence error : video not supported, ignoring video option"),n.video=!1);n.audio&&C.subscription&&!C.subscription.audio_only&&!C.subscription.audio_video&&(h["default"].error("Licence error : audio not supported, ignoring audio option"),n.audio=!1);var m=function(e,k){C.publish(G,e,function(e){0===e.result?(A.publishId=e.id,C.mediaConfiguration!==q.H264_CODEC&&"safari"===a.a.browser_info.name&&a.a.browser_info.version<=q.SAFARI_VERSION_NOT_SUPPORTING_VP8?
k(A,f.a.error_1152):k(A,null),b.mediaRecord&&C.dispatchEvent(Object(c.e)({type:"room-record-on",message:{}})),C.muteInfo.room.audio&&C.dispatchEvent(Object(c.e)({type:"room-muted",message:{}}))):e.result===f.a.error_1130.result?k(A,e):(e={type:"room-error",error:e.result,message:e.error},console.log("room publish error return joinRoom error respEvent: "+JSON.stringify(e)),k(null,e))})};void 0!=e&&!1===C.waitRoom&&"viewer"!=C.me.role&&"audience"!=C.me.role?m(e,r):"audience"!=C.me.role&&C.waitRoom?
(r(A,null),C.addEventListener("wait-room-disabled",function(b){C.dispatchEvent(Object(c.e)({type:"room-allowed",message:b.message}));"lecture"!==C.mode&&m(e,r)})):(h["default"].info("no audio&video"),G&&(n.audioMuted&&G.muteAudio(function(b){b.result==f.a.error_000.result&&C.dispatchEvent(Object(c.g)({type:"user-audio-muted",clientId:C.clientId}));h["default"].info("audioSelfMuteCallback: "+JSON.stringify(b))},!1,0,!0),n.videoMuted&&G.muteVideo(function(b){b.result!==f.a.error_000.result&&C.dispatchEvent(Object(c.g)({type:"user-video-muted",
clientId:C.clientId}));h["default"].info("videoSelfMuteCallback: "+JSON.stringify(b))},!1,0,!0)),r(A,null))}}),C.addEventListener("room-error",function(b){null==A&&r(A,b)}),C.addEventListener("stream-added",function(b){C.subscribe(b.stream)}),C.addEventListener("active-talkers-updated",function(b){b=b.message.activeList;var a=b.length;if(0<a)for(var f=0;f<a;f++)if("audio"===b[f].mediatype&&!0===b[f].muteDueToBw){C.remoteStreams.getAll()[b[f].streamId].audioOnly=!0;var e=Object(c.e)({type:"user-muted-due-to-bw-crunch",
message:{streamId:b[f].streamId,clientId:b[f].clientId,name:b[f].name}});C.dispatchEvent(e)}}));!1===C.reconnectionState&&0==C.reconnectAttempt?C.connect(z,function(b){h["default"].debug("room.connect callback resp: "+JSON.stringify(b));b.result!=f.a.error_000.result&&r(null,b)}):h["default"].debug(" Reconnection case in join room public api")};l=function(b){t=b;r(A,t)};if(void 0!=n.stream||n.audio||n.video)var G=C.initPublishStream(n.div,n,x,l);else h["default"].info(" No publish stream. audio and video are disabled.."),
x()}return G}else h["default"].info("Failed Webrtc support is missing "),r(null,f.a.error_1000)}},listParticipants:function(c){if(a.a.is_supported()){var f=[];c&&(f=c.userList);return f}console.log("Failed Webrtc support is missing ")},ReceiveMessage:function(a,c){a&&a.addEventListener("stream-data",function(a){})},sendMessage:function(a,c){a&&a.sendData(c)},getRoom:function(){return k}};t.a=v},function(l,t,n){function h(){fa=0;Q.splice(0,Q.length);da={};la={};d={};E={};ja={};Z={};ea={};K={};T=ha=
"";O=N.a.default_region;aa=N.a.proxy_api_url;ma=N.a.proxy_api_port;y=Y=!1;ka=N.a.data_throughput_duration;ia=N.a.video_bandwidth_duration;qa=N.a.audio_bandwidth_duration}function u(a){X.setActiveTest(a);var c={test_group:a.test_group,test_case:a.test_title,status:"started"};if("network"===a.test_group||"connectivity"===a.test_group||"throughput"===a.test_group||"bandwidth"===a.test_group||"signalling"===a.test_group||"connection"===this.test_group)c.test_region=a.region,c.test_server=a.server;a.start_time=
new Date;c=Object(G.a)({type:"client-diagnosis-status",message:c});!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(c):D.dispatchEvent(c);switch(a.test_title){case "audio_capture":Object(p.a)(a,T);break;case "check_resolution_240":case "check_resolution_480":case "check_resolution_720":case "check_supported_resolutions":case "no_resolution_check":Object(b.a)(a,ha);break;case "udp_enabled":case "tcp_enabled":case "ipv6_enabled":Object(J.a)(a);break;case "relay_connectivity":case "reflexive_connectivity":case "host_connectivity":Object(F.a)(a);
break;case "data_throughput":Object(z.a)(a,null,ka,na);break;case "audio_bandwidth":Object(z.a)(a,T,qa,na);break;case "video_bandwidth":Object(z.a)(a,ha,ia,na);break;case "signalling_connectivity":Object(M.a)(a,aa,ma);break;case "connectivity_check":Object(A.a)(a,aa,ma)}}function m(){if(!1===pa)x();else if(fa<Q.length)u(Q[fa]),fa+=1;else{var b={};Object.keys(da).length&&(b.microphone=da);Object.keys(la).length&&(b.camera=la);Object.keys(d).length&&(b.network=d);Object.keys(E).length&&(b.connectivity=
E);Object.keys(ja).length&&(b.throughput=ja);Object.keys(Z).length&&(b.bandwidth=Z);Object.keys(ea).length&&(b.signalling=ea);pa=!1;C["default"].info("All test case executed");b=Object(G.a)({type:"client-diagnosis-finished",message:b});!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(b):D.dispatchEvent(b);h()}}function e(b,a,c,d,f){c=void 0===c?null:c;d=void 0===d?null:d;f=void 0===f?!1:f;b=new U(b,a,m);b.region=c;b.server=d;b.bitrate_only=f;Q.push(b)}function a(){for(var b in O)H.includes(O[b])&&
(e("udp_enabled","network",O[b],"TURN"),e("tcp_enabled","network",O[b],"TURN"),e("ipv6_enabled","network",O[b],"TURN"))}function c(){for(var b in O)H.includes(O[b])&&(e("relay_connectivity","connectivity",O[b],"TURN"),e("reflexive_connectivity","connectivity",O[b],"TURN"),e("host_connectivity","connectivity",O[b],"TURN"))}function f(){for(var b in O)H.includes(O[b])&&e("data_throughput","throughput",O[b],"TURN")}function w(){for(var b in O)H.includes(O[b])&&(e("video_bandwidth","bandwidth",O[b],"TURN",
y),e("audio_bandwidth","bandwidth",O[b],"TURN",y))}function q(){for(var b in O)H.includes(O[b])&&e("signalling_connectivity","signalling",O[b],"TURN")}function k(){for(var b in O)H.includes(O[b])&&e("connectivity_check","connection",O[b],"TURN")}function v(){!1===pa&&0===Q.length&&x();pa=!1;return D}function r(){var b=Object(G.a)({type:"client-diagnosis-failed",message:{msg:"Invalid arguments"}});!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(b):D.dispatchEvent(b);h();C["default"].error("Invalid argument")}
function x(){var b=Object(G.a)({type:"client-diagnosis-stopped",message:{msg:"Diagnosis stopped."}});!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(b):D.dispatchEvent(b);h();C["default"].error("diagnosis stopped")}var p=n(71),b=n(72),J=n(74),F=n(75),z=n(76),M=n(77),A=n(78),C=n(0),G=n(4);l=n(1);var N=n.n(l),X=n(13),H=["IN","US","SG","DE"];n={};var fa=0,Q=[],da={},la={},d={},E={},ja={},Z={},ea={},K={},T="",ha="",O=[],pa=!1,y=!1,D=null,aa="",ma="",Y=!1,ka=0,ia=0,qa=0,ba=!1,na=!0,U=
function(b,a,c){this.test_title=b;this.test_group=a;this.started=!1;this.success_count=this.warning_count=this.error_count=0;this.finished_cb=c;this.region="IN";this.server="TURN";this.uri="";this.progress_value=0;this.state="not_tested";this.start_time=0;this.bitrate_only=!1;this.json_response={result:this.state,execution_time:"not_set",success:[],error:[],warning:[],info:[]};this.done=function(){this.state=0===this.error_count+this.warning_count&&0<this.success_count?"success":0<this.warning_count&&
0===this.error_count?"warning":this.isDisabled?"disabled":"failure";this.json_response.result=this.state;this.json_response.execution_time=new Date-this.start_time+" ms";var b={};switch(this.test_group){case "microphone":da[this.test_title]=this.json_response;b[this.test_title]=da[this.test_title];break;case "camera":la[this.test_title]=this.json_response;b[this.test_title]=la[this.test_title];break;case "network":this.setServer();b=this.fillResponse(d);break;case "connectivity":this.setServer();
b=this.fillResponse(E);break;case "throughput":this.setServer();b=this.fillResponse(ja);break;case "bandwidth":this.setServer(!na);b=this.fillResponse(Z);break;case "signalling":this.setServer();b=this.fillResponse(ea);break;case "connection":this.setServer(),b=this.fillResponse(K)}b={test_group:this.test_group,test_case:this.test_title,status:"finished",output:b};if("network"===this.test_group||"connectivity"===this.test_group||"throughput"===this.test_group||"bandwidth"===this.test_group||"signalling"===
this.test_group||"connection"===this.test_group)b.test_region=this.region,b.test_server=this.server;b=Object(G.a)({type:"client-diagnosis-status",message:b});!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(b):D.dispatchEvent(b);this.finished_cb()};this.fillResponse=function(b){var a={};b.hasOwnProperty(this.test_title)||(b[this.test_title]={});b[this.test_title].hasOwnProperty(this.region)||(b[this.test_title][this.region]={});b[this.test_title][this.region].hasOwnProperty(this.server)||
(b[this.test_title][this.region][this.server]={});b[this.test_title][this.region][this.server]=this.json_response;a[this.test_title]=this.json_response;return a};this.reportFatal=function(b){this.reportError(b);this.done()};this.reportSuccess=function(b){this.success_count+=1;C["default"].info("[ OK ]"+b);this.json_response.success.push({message:b})};this.setServer=function(b){this.json_response.server={};this.json_response.server.region=this.region;this.json_response.server.url="TURN"===this.server?
(void 0===b?0:b)?N.a.ice_servers[this.region].turnUdpURI:N.a.ice_servers[this.region].turnURI:N.a.ice_servers[this.region].stunURI};this.reportError=function(b){this.error_count+=1;C["default"].error("[ FAILED ]"+b);this.json_response.error.push({message:b})};this.reportWarning=function(b){this.warning_count+=1;C["default"].warning("[ WARN ]"+b);this.json_response.warning.push({message:b})};this.reportInfo=function(b){C["default"].info("[ INFO ]"+b);this.json_response.info.push({message:b})};this.fillBandwidth=
function(b){this.json_response.bandwidth_bps=b};this.fillPacketsLost=function(b){this.json_response.packets_lost_percentage=b};this.setProgress=function(b){this.progress_value=b};this.fillData=function(b,a){};this.reportByState=function(b,a){switch(a){case "poor":this.error_count+=1;C["default"].error("[ POOR ]"+b);this.json_response.error.push({message:b+" [BAD]"});break;case "moderate":this.warning_count+=1;C["default"].warning("[ MODERATE ]"+b);this.json_response.warning.push({message:b+" [ACCEPTABLE]"});
break;case "good":this.success_count+=1,C["default"].info("[ GOOD ]"+b),this.json_response.success.push({message:b+" [GOOD]"})}}};n.clientDiagnostics=function(b,d){var l={testNames:"microphone camera network connectivity throughput Signalling bandwidth".split(" "),testServerApiHost:"apiproxy.enablex.io",testServerApiPort:"443",stop:"false"};if("function"==typeof b||"function"==typeof d){if("function"==typeof b){var p=b;l.testNames=["microphone","camera","connection","bandwidth"];na=!1}else{p=d;if(Array.isArray(b)){var n=
b;na=!1}else if("object"==typeof b){if(b.testNames)if(Array.isArray(b.testNames))n=b.testNames;else{console.log("Error: invalid parameters options testNames shall be of type array");return}else l.testNames=["microphone","camera","connection","bandwidth"];if(b.restrictedNetwork)if("boolean"==typeof b.restrictedNetwork)na=b.restrictedNetwork;else{console.log("Error: invalid parameters options restrictedNetwork shall be of type bool");return}else na=!1}if(n){n.forEach(function(b,a){switch(b){case "microphone":case "camera":case "connection":case "bandwidth":break;
default:console.log("Error: invalid options values, correct options: "["microphone","camera","connection","bandwidth"])}});if(!n.length){console.log("Error: invalid options values, correct options: "["microphone","camera","connection","bandwidth"]);return}l.testNames=n}}if(!EnxRtc.isSupported()){console.log("Error: Browser not supported");p({browser:{supported:!1,supportedBrowser:"https://developer.enablex.io/docs/quickstart/video/browser-compatibility/index"}});return}if("firefox"===adapter.browserDetails.browser){console.log(" Firefox browser not supported these tests. Preferably use other browsers like Chrome/Edge/Safari");
p({browser:{supported:!1,supportedBrowser:"https://developer.enablex.io/docs/quickstart/video/browser-compatibility/index"}});return}}else b&&(l=b);ba=!1;l.hasOwnProperty("forIosVersion13")&&!0===l.forIosVersion13&&(ba=!0);if(l.hasOwnProperty("stop")&&!0===l.stop&&null!==D)return v(),D;if(pa||Q.length)if(p)C["default"].info("Diagnosis is already in progress. cancelling and starting afresh"),v();else return C["default"].error("Diagnosis is already in progress. Few resources are in use and may not be accessible."),
D;D=Object(G.c)();if(!l.hasOwnProperty("testNames")||!Array.isArray(l.testNames))return setTimeout(r,1),D;pa=!0;h();if(p){var x={};p({browser:{supported:!0}});D.addEventListener("client-diagnosis-status",function(b){if(b.message.hasOwnProperty("output")){switch(b.message.test_group){case "microphone":console.log(" microphone: "+JSON.stringify(b.message));x.microphone||da.audio_capture.success.length?x.microphone||(x.microphone={result:"passed"}):(x.microphone={result:"failed",reason:"unknown"},b.message.output.audio_capture&&
b.message.output.audio_capture.error&&b.message.output.audio_capture.error[0].message&&(x.microphone.reason=b.message.output.audio_capture.error[0].message));p({microphone:x.microphone});break;case "camera":b.message.output.hasOwnProperty("no_resolution_check")&&(x.camera="success"==b.message.output.no_resolution_check.result?{result:"passed"}:{result:"failed",reason:b.message.output.no_resolution_check.error},p({camera:x.camera}));break;case "bandwidth":void 0==x.bandwidth&&(x.bandwidth={result:"unknown",
stats:{}});if(b.message.output.video_bandwidth){x.bandwidth.stats.video={};var a=0,c=0;if(b.message.output.video_bandwidth.success.length){b=b.message.output.video_bandwidth.info;for(var d=0;d<b.length;d++)b[d].message.includes("videoBwKbps")&&(c=JSON.parse(b[d].message),x.bandwidth.stats.video={bitrateKbps:{recv:c.videoBwKbps.recv,send:c.videoBwKbps.send}},a=parseInt(c.videoBwKbps.send),c=parseInt(c.videoBwKbps.recv))}else console.log("video bwtest failed  "+b.message.output.video_bandwidth),x.bandwidth.stats.video=
{bitrateKbps:{send:0,recv:0},error:b.message.output.video_bandwidth.error},c=a=0;x.bandwidth.result=500<a&&500<c?"good":150<=a&&150<=c?"avarage":"bad"}else if(b.message.output.audio_bandwidth)if(x.bandwidth.stats.audio={},b.message.output.audio_bandwidth.success.length)for(a=b.message.output.audio_bandwidth.info,c=0;c<a.length;c++)a[c].message.includes("audioBwKbps")&&(b=JSON.parse(a[c].message),x.bandwidth.stats.audio={bitrateKbps:{recv:b.audioBwKbps.recv,send:b.audioBwKbps.send}});else x.bandwidth.stats.audio=
{bitrateKbps:{recv:0,send:0},error:b.message.output.audio_bandwidth.error};if(!x.bandwidth.stats.audio||!x.bandwidth.stats.video)return;p({bandwidth:{result:x.bandwidth.result,stats:x.bandwidth.stats}});break;case "connection":"success"==b.message.output.connectivity_check.result?x.connection={result:"passed"}:(a=b.message.output.connectivity_check,x.connection={result:"failed",reason:a.error&&a.error.length&&a.error[0].message?a.error[0].message:"room internal error"}),p({connection:x.connection})}Object.entries(x).length==
l.testNames.length&&(x.browser={supported:!0})}})}l.hasOwnProperty("audioDeviceId")&&(T=l.audioDeviceId);l.hasOwnProperty("videoDeviceId")&&(ha=l.videoDeviceId);l.hasOwnProperty("testServerApiHost")&&(aa=l.testServerApiHost);l.hasOwnProperty("testServerApiPort")&&(ma=l.testServerApiPort);if(l.hasOwnProperty("regionId"))if(Array.isArray(l.regionId))O=l.regionId||N.a.default_region;else return pa=!1,setTimeout(r,1),D;l.hasOwnProperty("forMobile")&&!0===l.forMobile&&(Y=!0);l.hasOwnProperty("bitrateOnly")&&
!0===l.bitrateOnly&&(y=!0);l.hasOwnProperty("testDurationDataThroughput")&&0<l.testDurationDataThroughput&&(ka=l.testDurationDataThroughput);60<ka&&(ka=60);l.hasOwnProperty("testDurationVideoBandwidth")&&0<l.testDurationVideoBandwidth&&(ia=l.testDurationVideoBandwidth);60<ia&&(ia=60);l.hasOwnProperty("testDurationAudioBandwidth")&&0<l.testDurationAudioBandwidth&&(qa=l.testDurationAudioBandwidth);60<qa&&(qa=60);b=l.testNames.map(function(b){b=b.toString();return b.toLowerCase()});d=new Set;if(b.includes("all"))d.add("microphone"),
d.add("camera"),d.add("network"),d.add("connectivity"),d.add("throughput"),d.add("bandwidth"),d.add("signalling");else for(var z in l.testNames)d.add(b[z]);z=$jscomp.makeIterator(d);for(b=z.next();!b.done;b=z.next())switch(b.value){case "microphone":e("audio_capture","microphone");break;case "camera":p?e("no_resolution_check","camera"):(!0!==Y&&(e("check_resolution_240","camera"),e("check_resolution_480","camera"),e("check_resolution_720","camera")),e("check_supported_resolutions","camera"));break;
case "network":a();break;case "connectivity":c();break;case "throughput":f();break;case "bandwidth":w();break;case "signalling":q();break;case "connection":k()}0<Q.length?setTimeout(m,1):(pa=!1,setTimeout(r,1));return D};n.clientBitrate=function(b){var a=Object(G.c)(),c="DE";void 0!==b&&b.hasOwnProperty("region")&&(b=b.region,H.includes(b)&&(c=b));c=EnxRtc.clientDiagnostics({testNames:["bandwidth"],regionId:[c],testDurationVideoBandwidth:40,testDurationAudioBandwidth:20,bitrateOnly:!0,stop:!1});var d=
{video:{bitrate_bps:"NA",connection:"NA"},audio:{bitrate_bps:"NA",connection:"NA"}};c.addEventListener("client-diagnosis-status",function(b){var c=Object(G.a)({type:"client-bitrate-status",message:b.message});b.message.hasOwnProperty("output")&&(b.message.output.hasOwnProperty("video_bandwidth")&&(b.message.output.video_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.video.bitrate_bps=b.message.output.video_bandwidth.bandwidth_bps),b.message.output.video_bandwidth.hasOwnProperty("packets_lost_percentage")&&
(d.video.connection=5<b.message.output.video_bandwidth.packets_lost_percentage?"unstable":"stable")),b.message.output.hasOwnProperty("audio_bandwidth")&&(b.message.output.audio_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.audio.bitrate_bps=b.message.output.audio_bandwidth.bandwidth_bps),b.message.output.audio_bandwidth.hasOwnProperty("packets_lost_percentage")&&(d.audio.connection=5<b.message.output.audio_bandwidth.packets_lost_percentage?"unstable":"stable")));!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(c):
a.dispatchEvent(c)});c.addEventListener("client-diagnosis-finished",function(b){b=Object(G.a)({type:"client-bitrate-finished",message:d});!0===ba?window.webkit.messageHandlers.callbackHandler.postMessage(b):a.dispatchEvent(b)});return a};t.a=n},function(l,t,n){function h(h,e){this.test=h;this.inputChannelCount=6;this.outputChannelCount=2;this.bufferSize=0;this.deviceId=e;this.constraints={audio:{optional:[{echoCancellation:!1}]}};this.collectSeconds=2;this.silentThreshold=1/32767;this.lowVolumeThreshold=
-60;this.monoDetectThreshold=1/65536;this.clipCountThreshold=6;this.clipThreshold=1;this.collectedAudio=[];for(h=this.collectedSampleCount=0;h<this.inputChannelCount;++h)this.collectedAudio[h]=[];this.audioContext=new (window.AudioContext||window.webkitAudioContext)}t.a=function(m,e){(new h(m,e)).run()};var u=n(13);h.prototype={run:function(){var h=this;this.audioContext.resume().then(function(){u.appendSourceId(h.deviceId,"audio",h.constraints);u.doGetUserMedia(h.constraints,h.gotStream.bind(h),
h.onFail.bind(h))}).catch(function(e){h.test.reportError("WebAudio run failure: "+e);h.test.done()})},onFail:function(h){this.test.reportError("getUserMedia failed with error: "+h);this.test.done()},gotStream:function(h){this.checkAudioTracks(h)?this.createAudioBuffer(h):this.test.done()},checkAudioTracks:function(h){this.stream=h;h=h.getAudioTracks();if(1>h.length)return this.test.reportError("No audio track in returned stream."),!1;this.test.reportSuccess("Audio track created using device="+h[0].label);
return!0},createAudioBuffer:function(){this.audioSource=this.audioContext.createMediaStreamSource(this.stream);this.scriptNode=this.audioContext.createScriptProcessor(this.bufferSize,this.inputChannelCount,this.outputChannelCount);this.audioSource.connect(this.scriptNode);this.scriptNode.connect(this.audioContext.destination);this.scriptNode.onaudioprocess=this.collectAudio.bind(this);this.stopCollectingAudio=u.setTimeoutWithProgressBar(this.onStopCollectingAudio.bind(this),5E3)},collectAudio:function(h){for(var e=
h.inputBuffer.length,a=!0,c=0;c<h.inputBuffer.numberOfChannels;c++){var f=h.inputBuffer.getChannelData(c),m=Math.abs(f[e-1]);Math.abs(f[0])>this.silentThreshold||m>this.silentThreshold?(m=new Float32Array(e),m.set(f),a=!1):m=new Float32Array;this.collectedAudio[c].push(m)}a||(this.collectedSampleCount+=e,this.collectedSampleCount/h.inputBuffer.sampleRate>=this.collectSeconds&&this.stopCollectingAudio())},onStopCollectingAudio:function(){this.stream.getAudioTracks()[0].stop();this.audioSource.disconnect(this.scriptNode);
this.scriptNode.disconnect(this.audioContext.destination);this.analyzeAudio(this.collectedAudio);this.test.done()},analyzeAudio:function(h){for(var e=[],a=0;a<h.length;a++)this.channelStats(a,h[a])&&e.push(a);0===e.length?this.test.reportError("No active input channels detected. Microphone is most likely muted or broken, please check if muted in the sound settings or physically on the device. Then rerun the test."):this.test.reportSuccess("Active audio input channels: "+e.length);2===e.length&&this.detectMono(h[e[0]],
h[e[1]])},channelStats:function(h,e){for(var a=0,c=0,f=0,m=0,l=0;l<e.length;l++){var k=e[l];if(0<k.length){for(var n,r=0,x=0;x<k.length;x++)n=Math.abs(k[x]),a=Math.max(a,n),r+=n*n,a>=this.clipThreshold?(f+=1,m=Math.max(m,f)):f=0;r=Math.sqrt(r/k.length);c=Math.max(c,r)}}return a>this.silentThreshold?(e=this.dBFS(a),c=this.dBFS(c),this.test.reportInfo("Channel "+h+" levels: "+e.toFixed(1)+" dB (peak), "+c.toFixed(1)+" dB (RMS)"),c<this.lowVolumeThreshold&&this.test.reportError("Microphone input level is low, increase input volume or move closer to the microphone."),
m>this.clipCountThreshold&&this.test.reportWarning("Clipping detected! Microphone input level is high. Decrease input volume or move away from the microphone."),!0):!1},detectMono:function(h,e){for(var a=0,c=0;c<h.length;c++){var f=h[c],m=e[c];if(f.length===m.length)for(var l,k=0;k<f.length;k++)l=Math.abs(f[k]-m[k]),l>this.monoDetectThreshold&&(a+=1);else a+=1}0<a?this.test.reportInfo("Stereo microphone detected."):this.test.reportInfo("Mono microphone detected.")},dBFS:function(h){return Math.round(Math.log(h)/
Math.log(10)*200)/10}}},function(l,t,n){function h(a,c,f){this.test=a;this.resolutions=c;this.currentResolution=0;this.isShuttingDown=this.isMuted=!1;this.deviceId=f}t.a=function(a,c){switch(a.test_title){case "no_resolution_check":(new h(a,[[0,0]],c)).run();break;case "check_resolution_240":(new h(a,[[320,240]],c)).run();break;case "check_resolution_480":(new h(a,[[640,480]],c)).run();break;case "check_resolution_720":(new h(a,[[1280,720]],c)).run();break;case "check_supported_resolutions":(new h(a,
[[160,120],[320,180],[320,240],[640,360],[640,480],[768,576],[1024,576],[1280,720],[1280,768],[1280,800],[1920,1080],[1920,1200],[3840,2160],[4096,2160]],c)).run()}};l=n(73);var u=n.n(l);l=n(18);var m=n.n(l),e=n(13);h.prototype={run:function(){this.startGetUserMedia(this.resolutions[this.currentResolution],this.deviceId);this.currentResolution+=1},startGetUserMedia:function(a,c){var f=this,e={audio:!1,video:{width:{exact:a[0]},height:{exact:a[1]},deviceId:c}};a[0]&&a[1]||(e.video=c?{deviceId:c}:!0);
navigator.mediaDevices.getUserMedia(e).then(function(c){!a[0]||!a[1]||1<f.resolutions.length?(a[0]&&a[1]?f.test.reportSuccess("Supported resolution: "+a[0]+"x"+a[1]):f.test.reportSuccess("success no resolution check. "),c.getTracks().forEach(function(a){a.stop()}),f.maybeContinueGetUserMedia()):f.collectAndAnalyzeStats(c,a)}).catch(function(c){1<f.resolutions.length?f.test.reportInfo(a[0]+"x"+a[1]+" not supported"):f.test.reportError("getUserMedia failed with error: "+c.name);f.maybeContinueGetUserMedia()})},
maybeContinueGetUserMedia:function(){this.currentResolution===this.resolutions.length?this.test.done():(this.startGetUserMedia(this.resolutions[this.currentResolution]),this.currentResolution+=1)},collectAndAnalyzeStats:function(a,c){var f=this,h=a.getVideoTracks();if(1>h.length)this.test.reportError("No video track in returned stream."),this.maybeContinueGetUserMedia();else{h=h[0];"function"===typeof h.addEventListener&&(h.addEventListener("ended",function(){f.isShuttingDown||f.test.reportError("Video track ended, camera stopped working")}),
h.addEventListener("mute",function(){f.isShuttingDown||(f.test.reportWarning("Your camera reported itself as muted."),f.isMuted=!0)}),h.addEventListener("unmute",function(){f.isShuttingDown||(f.test.reportInfo("Your camera reported itself as unmuted."),f.isMuted=!1)}));h=document.createElement("video");h.setAttribute("autoplay","");h.setAttribute("muted","");h.width=c[0];h.height=c[1];h.srcObject=a;var l=new u.a(h),k=new m.a(null,this.test);k.pc1.addStream(a);k.establishConnection();k.gatherStats(k.pc1,
null,a,this.onCallEnded.bind(this,c,h,a,l),100);e.setTimeoutWithProgressBar(this.endCall.bind(this,k,a),8E3)}},onCallEnded:function(a,c,f,e,h,k){this.analyzeStats(a,c,f,e,h,k);e.stop();this.test.done()},analyzeStats:function(a,c,f,h,l,k){var m=[],q=[],n=[],p={};h=h.frameStats;for(var b in l)"ssrc"===l[b].type&&0<parseInt(l[b].googFrameRateInput)&&(m.push(parseInt(l[b].googAvgEncodeMs)),q.push(parseInt(l[b].googFrameRateInput)),n.push(parseInt(l[b].googFrameRateSent)));p.cameraName=f.getVideoTracks()[0].label||
NaN;p.actualVideoWidth=c.videoWidth;p.actualVideoHeight=c.videoHeight;p.mandatoryWidth=a[0];p.mandatoryHeight=a[1];p.encodeSetupTimeMs=this.extractEncoderSetupTime(l,k);p.avgEncodeTimeMs=e.arrayAverage(m);p.minEncodeTimeMs=e.arrayMin(m);p.maxEncodeTimeMs=e.arrayMax(m);p.avgInputFps=e.arrayAverage(q);p.minInputFps=e.arrayMin(q);p.maxInputFps=e.arrayMax(q);p.avgSentFps=e.arrayAverage(n);p.minSentFps=e.arrayMin(n);p.maxSentFps=e.arrayMax(n);p.isMuted=this.isMuted;p.testedFrames=h.numFrames;p.blackFrames=
h.numBlackFrames;p.frozenFrames=h.numFrozenFrames;this.testExpectations(p)},endCall:function(a,c){this.isShuttingDown=!0;c.getTracks().forEach(function(a){a.stop()});a.close()},extractEncoderSetupTime:function(a,c){for(var f=0;f!==a.length;f++)if("ssrc"===a[f].type&&0<parseInt(a[f].googFrameRateInput))return JSON.stringify(c[f]-c[0]);return NaN},resolutionMatchesIndependentOfRotationOrCrop:function(a,c,f,e){var h=Math.min(f,e);return a===f&&c===e||a===e&&c===f||a===h&&e===h},testExpectations:function(a){var c=
[],f;for(f in a)a.hasOwnProperty(f)&&("number"===typeof a[f]&&isNaN(a[f])?c.push(f):this.test.reportInfo(f+": "+a[f]));0!==c.length&&this.test.reportInfo("Not available: "+c.join(", "));isNaN(a.avgSentFps)?this.test.reportInfo("Cannot verify sent FPS."):5>a.avgSentFps?this.test.reportError("Low average sent FPS: "+a.avgSentFps):this.test.reportSuccess("Average FPS above threshold");this.resolutionMatchesIndependentOfRotationOrCrop(a.actualVideoWidth,a.actualVideoHeight,a.mandatoryWidth,a.mandatoryHeight)?
this.test.reportSuccess("Captured video using expected resolution."):this.test.reportError("Incorrect captured resolution.");0===a.testedFrames?this.test.reportError("Could not analyze any video frame."):(a.blackFrames>a.testedFrames/3&&this.test.reportError("Camera delivering lots of black frames."),a.frozenFrames>a.testedFrames/3&&this.test.reportError("Camera delivering lots of frozen frames."))}}},function(l,t,n){function h(h){this.frameStats={numFrozenFrames:0,numBlackFrames:0,numFrames:0};this.running_=
!0;this.nonBlackPixelLumaThreshold=20;this.previousFrame_=[];this.identicalFrameSsimThreshold=.985;this.frameComparator=new u;this.canvas_=document.createElement("canvas");this.videoElement_=h;this.listener_=this.checkVideoFrame_.bind(this);this.videoElement_.addEventListener("play",this.listener_,!1)}function u(){}h.prototype={stop:function(){this.videoElement_.removeEventListener("play",this.listener_);this.running_=!1},getCurrentImageData_:function(){this.canvas_.width=this.videoElement_.width;
this.canvas_.height=this.videoElement_.height;var h=this.canvas_.getContext("2d");h.drawImage(this.videoElement_,0,0,this.canvas_.width,this.canvas_.height);return h.getImageData(0,0,this.canvas_.width,this.canvas_.height)},checkVideoFrame_:function(){if(this.running_&&!this.videoElement_.ended){var h=this.getCurrentImageData_();this.isBlackFrame_(h.data,h.data.length)&&(this.frameStats.numBlackFrames+=1);this.frameComparator.calculate(this.previousFrame_,h.data)>this.identicalFrameSsimThreshold&&
(this.frameStats.numFrozenFrames+=1);this.previousFrame_=h.data;this.frameStats.numFrames+=1;setTimeout(this.checkVideoFrame_.bind(this),20)}},isBlackFrame_:function(h,e){for(var a=this.nonBlackPixelLumaThreshold,c=0,f=4;f<e;f+=4)if(c+=.21*h[f]+.72*h[f+1]+.07*h[f+2],c>a*f/4)return!1;return!0}};u.prototype={statistics:function(h){var e=0,a;for(a=0;a<h.length;++a)e+=h[a];var c=e/(h.length-1);for(a=1;a<h.length;++a){var f=h[a-1]-c;e+=h[a]+f*f}return{mean:c,variance:e/h.length}},covariance:function(h,
e,a,c){for(var f=0,l=0;l<h.length;l+=1)f+=(h[l]-a)*(e[l]-c);return f/h.length},calculate:function(h,e){if(h.length!==e.length)return 0;var a=6.5025,c=58.5225,f=c/2,l=this.statistics(h),m=l.mean;l=l.variance;var k=Math.sqrt(l),n=this.statistics(e),r=n.mean;n=n.variance;var x=Math.sqrt(n);h=this.covariance(h,e,m,r);return(2*m*r+a)/(m*m+r*r+a)*((2*k*x+c)/(l+n+c))*((h+f)/(k*x+f))}};l.exports=h},function(l,t,n){function h(h,e,a,c){this.test=h;this.protocol=e;this.params=a;this.iceCandidateFilter=c}t.a=
function(l){switch(l.test_title){case "udp_enabled":(new h(l,"udp",null,u.a.isRelay)).run();break;case "tcp_enabled":(new h(l,"tcp",null,u.a.isRelay)).run();break;case "ipv6_enabled":(new h(l,null,{optional:[{googIPv6:!0}]},u.a.isIpv6)).run()}};l=n(18);var u=n.n(l);h.prototype={run:function(){this.iceCandidateFilter.toString()===u.a.isIpv6.toString()?this.gatherCandidates(null,this.params,this.iceCandidateFilter):"TURN"===this.test.server?u.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region):u.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(h){this.filterConfig(h,this.protocol);this.gatherCandidates(h,this.params,this.iceCandidateFilter)},filterConfig:function(h,e){var a=[],c=h.iceServers[0],f=[];e="transport="+e;e=c.urls.startsWith("turns")?c.urls+"?"+e:c.urls;f.push(e);c.urls=f;a.push(c);h.iceServers=a},gatherCandidates:function(h,e,a){var c=this;try{var f=new RTCPeerConnection(h,e)}catch(w){null!==
e&&e.optional[0].googIPv6?this.test.reportError("Failed to create peer connection, IPv6 might not be setup/supported on the network."):this.test.reportError("Failed to create peer connection: "+w);this.test.done();return}f.addEventListener("icecandidate",function(h){"closed"!==h.currentTarget.signalingState&&(h.candidate?(h=u.a.parseCandidate(h.candidate.candidate),a(h)&&(c.test.reportSuccess("Gathered candidate of Type: "+h.type+" Protocol: "+h.protocol+" Address: "+h.address),f.close(),f=null,c.test.done())):
(f.close(),f=null,null!==e&&e.optional[0].googIPv6?c.test.reportError("Failed to gather IPv6 candidates, it might not be setup/supported on the network."):c.test.reportError("Failed to gather specified candidates"),c.test.done()))});this.createAudioOnlyReceiveOffer(f)},createAudioOnlyReceiveOffer:function(h){function e(){}h.createOffer({offerToReceiveAudio:1}).then(function(a){h.setLocalDescription(a).then(e,e)},e)}}},function(l,t,n){function h(h,e){this.test=h;this.iceCandidateFilter=e;this.timeout=
null;this.parsedCandidates=[];this.call=null}t.a=function(l){switch(l.test_title){case "relay_connectivity":(new h(l,u.a.isRelay)).run();break;case "reflexive_connectivity":(new h(l,u.a.isReflexive)).run();break;case "host_connectivity":(new h(l,u.a.isHost)).start()}};l=n(18);var u=n.n(l);h.prototype={run:function(){"TURN"===this.test.server?u.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):u.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region)},start:function(h){var e=this;this.call=new u.a(h,this.test);this.call.setIceCandidateFilter(this.iceCandidateFilter);this.call.pc1.addEventListener("icecandidate",function(a){a.candidate&&(a=u.a.parseCandidate(a.candidate.candidate),e.parsedCandidates.push(a),e.iceCandidateFilter(a)&&e.test.reportInfo("Gathered candidate of Type: "+a.type+" Protocol: "+a.protocol+" Address: "+a.address))});var a=this.call.pc1.createDataChannel(null);a.addEventListener("open",function(){a.send("hello")});
a.addEventListener("message",function(a){"world"!==a.data?e.test.reportError("Invalid data transmitted."):e.test.reportSuccess("Data successfully transmitted between peers.");e.hangup()});this.call.pc2.addEventListener("datachannel",function(a){var c=a.channel;c.addEventListener("message",function(a){"hello"!==a.data?e.hangup("Invalid data transmitted."):c.send("world")})});this.call.establishConnection();this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),5E3)},filterConfig:function(h){var e=
[],a=h.iceServers[0],c=[],f=a.urls.startsWith("turns")?a.urls+"?transport=tcp":a.urls;c.push(f);a.urls=c;e.push(a);h.iceServers=e},findParsedCandidateOfSpecifiedType:function(h){for(var e in this.parsedCandidates)if(h(this.parsedCandidates[e]))return h(this.parsedCandidates[e])},hangup:function(h){h&&("Timed out"===h&&this.iceCandidateFilter.toString()===u.a.isReflexive.toString()&&this.findParsedCandidateOfSpecifiedType(u.a.isReflexive)?this.test.reportWarning("Could not connect using reflexive candidates, likely due to the network environment/configuration."):
this.test.reportError(h));clearTimeout(this.timeout);this.call.close();this.test.done()}}},function(l,t,n){function h(a,c,b){this.test=a;this.testDurationSeconds=1*c;this.startTime=null;this.receivedPayloadBytes=this.sentPayloadBytes=0;this.stopSending=!1;this.samplePacket="";for(a=0;1024!==a;++a)this.samplePacket+="h";this.maxNumberOfPacketsToSend=1;this.bytesToKeepBuffered=1024*this.maxNumberOfPacketsToSend;this.lastBitrateMeasureTime=null;this.lastReceivedPayloadBytes=0;this.receiveChannel=this.senderChannel=
this.call=null;this.restrictedNetwork=void 0===b?!0:b}function u(a,f,b,e){e=void 0===e?!0:e;this.test=a;this.maxVideoBitrateKbps=2E3;this.durationMs=1E3*b;this.statStepMs=100;this.bweStats=new c.StatisticsAggregate(750*this.maxVideoBitrateKbps);this.rttStats=new c.StatisticsAggregate;this.qpSum=this.pliCount=this.nackCount=this.packetsLost=-1;this.packetsReceived=this.packetsSent=0;this.bitrateMean=this.framesSent=this.videoBytesRecieved=this.videoBytesSent=this.framesDecoded=this.framesEncoded=-1;
this.videoStats=[];this.call=this.startTime=null;this.deviceId=f;this.bytesSent=0;this.constraints={audio:!1,video:{optional:[{minWidth:320},{minHeight:240}]}};this.restrictedNetwork=e}function m(a,c){this.test=a;this.candidateFilter=c;this.testDurationMs=3E5;this.sendIntervalMs=100;this.delays=[];this.recvTimeStamps=[];this.running=!1;this.receiveChannel=this.senderChannel=this.call=null}function e(a,f,b,e){e=void 0===e?!0:e;this.test=a;this.maxAudioBitrateKbps=2E3;this.durationMs=1E3*b;this.statStepMs=
100;this.bweStats=new c.StatisticsAggregate(750*this.maxAudioBitrateKbps);this.rttStats=new c.StatisticsAggregate;this.audioBytesRecieved=this.audioBytesSent=this.packetsReceived=this.packetsSent=this.packetsLost=-1;this.startTime=null;this.jitter=0;this.call=null;this.bytesSent=0;this.deviceId=f;this.constraints={audio:!0};this.restrictedNetwork=e}t.a=function(c,f,b,k){k=void 0===k?!0:k;switch(c.test_title){case "data_throughput":(new h(c,b,k)).run();break;case "video_bandwidth":(new u(c,f,b,k)).run();
break;case "audio_bandwidth":(new e(c,f,b,k)).run();break;case "network_latency":(new m(c,a.a.isNotHostCandidate)).run()}};l=n(18);var a=n.n(l),c=n(13),f=[2,6],w=[200,500],q=[200,500],k=[10,30],v=[250,500,800],r=[0,30];h.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region,!this.restrictedNetwork):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},
start:function(c){this.call=new a.a(c,this.test);this.call.setIceCandidateFilter(a.a.isRelay);this.senderChannel=this.call.pc1.createDataChannel(null);this.senderChannel.addEventListener("open",this.sendingStep.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),3E4)},hangup:function(a){a&&("Timed out"===a?this.test.reportError("maximum timeout"):this.test.reportError(a));
clearTimeout(this.timeout);this.call.close();this.test.done()},onReceiverChannel:function(a){this.receiveChannel=a.channel;this.receiveChannel.addEventListener("message",this.onMessageReceived.bind(this))},sendingStep:function(){clearTimeout(this.timeout);var a=new Date;this.startTime||(this.lastBitrateMeasureTime=this.startTime=a);for(var c=0;c!==this.maxNumberOfPacketsToSend&&!(this.senderChannel.bufferedAmount>=this.bytesToKeepBuffered);++c)this.sentPayloadBytes+=this.samplePacket.length,this.senderChannel.send(this.samplePacket);
a-this.startTime>=1E3*this.testDurationSeconds?(this.test.setProgress(100),this.stopSending=!0):(this.test.setProgress((a-this.startTime)/(10*this.testDurationSeconds)),setTimeout(this.sendingStep.bind(this),1))},onMessageReceived:function(a){this.receivedPayloadBytes+=a.data.length;a=new Date;if(1E3<=a-this.lastBitrateMeasureTime){var c=(this.receivedPayloadBytes-this.lastReceivedPayloadBytes)/(a-this.lastBitrateMeasureTime);c=Math.round(8E3*c)/1E3;this.test.reportSuccess("Transmitting at "+c+" kbps.");
this.lastReceivedPayloadBytes=this.receivedPayloadBytes;this.lastBitrateMeasureTime=a}this.stopSending&&this.sentPayloadBytes===this.receivedPayloadBytes&&(this.call.close(),this.call=null,this.test.reportSuccess("Total transmitted: "+8*this.receivedPayloadBytes/1E3+" kilo-bits in "+Math.round(10*(a-this.startTime))/1E4+" seconds."),this.test.done())}};u.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region,
!this.restrictedNetwork):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(f){this.call=new a.a(f,this.test);this.call.setIceCandidateFilter(a.a.isRelay);this.call.disableVideoFec();this.call.constrainVideoBitrate(this.maxVideoBitrateKbps);c.appendSourceId(this.deviceId,"video",this.constraints);c.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+
a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();this.startTime=new Date;this.localStream=a.getVideoTracks()[0];setTimeout(this.gatherStats.bind(this),this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/
this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,c,b,f){if("chrome"===adapter.browserDetails.browser||"safari"===adapter.browserDetails.browser)for(var e in a)"undefined"!==typeof a[e].connection&&(this.bweStats.add(a[e].connection.timestamp,parseInt(a[e].connection.availableOutgoingBitrate)),this.rttStats.add(a[e].connection.timestamp,parseInt(1E3*a[e].connection.currentRoundTripTime)),this.videoStats[0]=a[e].video.local.frameWidth,this.videoStats[1]=
a[e].video.local.frameHeight,this.nackCount=a[e].video.local.nackCount,this.packetsLost=b[e].video.remote.packetsLost,this.qpSum=b[e].video.remote.qpSum,this.pliCount=a[e].video.local.pliCount,this.packetsSent=a[e].video.local.packetsSent,this.packetsReceived=b[e].video.remote.packetsReceived,this.framesEncoded=a[e].video.local.framesEncoded,this.videoBytesSent=a[e].video.local.bytesSent,this.videoBytesRecieved=b[e].video.remote.bytesReceived,this.framesDecoded=b[e].video.remote.framesDecoded);else if("firefox"===
adapter.browserDetails.browser)for(var h in a)(c=1E3*a[h].video.remote.roundTripTime)&&this.rttStats.add(a[h].video.remote.timestamp,parseInt(c)),this.bytesSent+=a[h].connection.bytesSent,this.packetsSent=a[h].video.local.packetsSent,this.packetsLost=b[h].video.remote.packetsLost,this.packetsReceived=b[h].video.remote.packetsReceived,this.qpSum=b[h].video.remote.qpSum,this.bitrateMean=a[h].video.local.bitrateMean,this.videoBytesSent=a[h].video.local.bytesSent,this.videoBytesRecieved=b[h].video.remote.bytesReceived;
else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser||"safari"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3;if(2>this.videoStats[0]&&2>this.videoStats[1])this.test.reportError("Camera failure: "+this.videoStats[0]+"x"+this.videoStats[1]+
". Cannot test bandwidth without a working  camera.");else{this.test.reportSuccess("Video resolution: "+this.videoStats[0]+"x"+this.videoStats[1]);var c=Math.round(this.bweStats.getAverage()/1E3);var b=c<q[0]?"poor":c<q[1]?"moderate":"good";var e=c<v[0]?1:c<v[1]?2:c<v[2]?4:5;this.test.reportByState("Average Video bandwidth (Send): "+c+" kbps",b);!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());!1===this.test.bitrate_only&&(this.test.reportInfo("Recommended no. of incoming videos :"+
e),this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived),this.test.reportInfo("NACK count: "+this.nackCount),this.test.reportInfo("Picture loss indications: "+this.pliCount),this.test.reportInfo("Quality predictor sum: "+this.qpSum),this.test.reportInfo("Frames encoded: "+
this.framesEncoded),this.test.reportInfo("Frames decoded: "+this.framesDecoded));b=null;0<this.packetsSent&&(b=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,e=b<f[0]?"good":b<f[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+b.toFixed(2)+"%",e),!0===this.test.bitrate_only&&this.test.fillPacketsLost(b.toFixed(2)));e=(8*this.videoBytesSent/(1E3*a)).toFixed(2);a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2);var h=Math.round(c-c*b/100);console.log("sendBWEstimateAvg : "+
c+" recvBWEstimateAvg: "+h+" pktloss% "+b);this.test.reportInfo("Video Bitrate (Send) :"+e+" kbps");this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps");this.test.reportInfo(JSON.stringify({videoBwKbps:{recv:h,send:c}}))}}else"firefox"===adapter.browserDetails.browser&&(this.test.reportInfo("Bitrate Mean (Send): "+parseInt(this.bitrateMean)/1E3+" kbps"),c=(new Date-this.startTime)/1E3,a=(8*this.bytesSent/(1E3*c)).toFixed(2),this.test.reportByState("Average Video bandwidth (Send): "+a+" kbps",
a<q[0]?"poor":a<q[1]?"moderate":"good"),!0===this.test.bitrate_only&&this.test.fillBandwidth(1E3*a),!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived)),0<this.packetsSent&&(b=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,a=b<f[0]?"good":b<f[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+b.toFixed(2)+"%",a),!0===this.test.bitrate_only&&this.test.fillPacketsLost(b.toFixed(2))),
a=(8*this.videoBytesSent/(1E3*c)).toFixed(2),c=(8*this.videoBytesRecieved/(1E3*c)).toFixed(2),this.test.reportInfo("Video Bitrate (Send) :"+a+" kbps"),this.test.reportInfo("Video Bitrate (Receive) :"+c+" kbps"),this.test.reportInfo(JSON.stringify({videoBwKbps:{recv:c,send:a}})));c=this.rttStats.getAverage();this.test.reportByState("RTT average: "+c+" ms",c<w[0]?"good":c<w[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}};
m.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region,!this.restrictedNetwork):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(f){this.filterConfig(f);this.running=!0;this.call=new a.a(f,this.test);this.call.setIceCandidateFilter(this.candidateFilter);this.senderChannel=this.call.pc1.createDataChannel({ordered:!1,maxRetransmits:0});
this.senderChannel.addEventListener("open",this.send.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();c.setTimeoutWithProgressBar(this.finishTest.bind(this),this.testDurationMs)},filterConfig:function(a){var c=[],b=a.iceServers[0],f=[],e=b.urls.startsWith("turns")?b.urls+"?transport=tcp":b.urls;f.push(e);b.urls=f;c.push(b);a.iceServers=c},onReceiverChannel:function(a){this.receiveChannel=a.channel;this.receiveChannel.addEventListener("message",
this.receive.bind(this))},send:function(){this.running&&(this.senderChannel.send(""+Date.now()),setTimeout(this.send.bind(this),this.sendIntervalMs))},receive:function(a){if(this.running){a=parseInt(a.data);var c=Date.now()-a;this.recvTimeStamps.push(a);this.delays.push(c);this.test.fillData(a+c,c)}},finishTest:function(){this.running=!1;this.call.close();this.call=null;var a=c.arrayMax(this.delays),f=c.arrayMin(this.delays);this.delays.length<.8*this.testDurationMs/this.sendIntervalMs?this.test.reportError("Not enough samples gathered. Keep the page on  the foreground while the test is running."):
this.test.reportSuccess("Collected "+this.delays.length+" delay samples.");a>2*(f+100)&&this.test.reportError("There is a big difference between the min and max delay of packets. Your network appears unstable.min="+f+"max="+a);this.test.done()}};e.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region,!this.restrictedNetwork):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region)},start:function(f){this.call=new a.a(f,this.test);this.call.setIceCandidateFilter(a.a.isRelay);c.appendSourceId(this.deviceId,"audio",this.constraints);c.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();this.startTime=new Date;this.localStream=a.getAudioTracks()[0];setTimeout(this.gatherStats.bind(this),
this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,c,b,f){if("chrome"===adapter.browserDetails.browser||"safari"===adapter.browserDetails.browser)for(var e in a)"undefined"!==
typeof a[e].connection&&(this.bweStats.add(a[e].connection.timestamp,parseInt(a[e].connection.availableOutgoingBitrate)),this.rttStats.add(a[e].connection.timestamp,parseInt(1E3*a[e].connection.currentRoundTripTime)),this.packetsLost=b[e].audio.remote.packetsLost,this.packetsSent=a[e].audio.local.packetsSent,this.packetsReceived=b[e].audio.remote.packetsReceived,this.audioBytesSent=a[e].audio.local.bytesSent,this.audioBytesRecieved=b[e].audio.remote.bytesReceived,this.jitter=b[e].audio.remote.jitter);
else if("firefox"===adapter.browserDetails.browser)for(var h in a)(c=1E3*a[h].audio.remote.roundTripTime)&&this.rttStats.add(a[h].audio.remote.timestamp,parseInt(c)),this.bytesSent+=a[h].connection.bytesSent,this.packetsSent=a[h].audio.local.packetsSent,this.packetsLost=b[h].audio.remote.packetsLost,this.packetsReceived=b[h].audio.remote.packetsReceived,this.jitter=b[h].audio.remote.jitter,this.audioBytesSent=a[h].audio.local.bytesSent,this.audioBytesRecieved=b[h].audio.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");
this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser||"safari"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3,c=Math.round(this.bweStats.getAverage()/1E3);this.test.reportByState("Average Audio bandwidth (Send): "+c+" kbps",c<k[0]?"poor":c<k[1]?"moderate":"good");!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());
0==this.test.bitrate_only&&(this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived));if(0<this.packetsSent){var b=(this.packetsSent-this.packetsReceived)/this.packetsSent*100;c=b<f[0]?"good":b<f[1]?"moderate":"poor";this.test.reportByState("Packets lost: "+b.toFixed(2)+
"%",c);!0===this.test.bitrate_only&&this.test.fillPacketsLost(b.toFixed(2))}c=(8*this.audioBytesSent/(1E3*a)).toFixed(2);a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Audio Bitrate (Send) :"+c+" kbps");this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps");this.test.reportInfo(JSON.stringify({audioBwKbps:{recv:a,send:c}}));a=1E3*this.jitter;a>r[1]||a<=r[0]||this.test.reportByState("Jitter: "+a,"good")}else"firefox"===adapter.browserDetails.browser&&(a=(new Date-this.startTime)/
1E3,!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived)),0<this.packetsSent&&(b=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,c=b<f[0]?"good":b<f[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+b.toFixed(2)+"%",c),!0===this.test.bitrate_only&&this.test.fillPacketsLost(b.toFixed(2))),c=1E3*this.jitter,c>r[1]||c<=r[0]||this.test.reportByState("Jitter: "+c,"good"),c=(8*this.audioBytesSent/
(1E3*a)).toFixed(2),a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Audio Bitrate (Send) :"+c+" kbps"),this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps"),this.test.reportInfo("{audioBwKbps :{ recv:"+a+", send:"+c+"}}"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<w[0]?"good":a<w[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}}},function(l,t,n){function h(h,
e,a){this.test=h;this.host=e;this.port=a}t.a=function(l,e,a){(new h(l,e,a)).run()};var u=n(32);h.prototype={run:function(){var h=this;u("https://"+this.host+":"+this.port+"/proxy-token",{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"No"}}).then(function(e){return e.json()}).then(function(e){h.test.reportSuccess("Token created successfully.");if(!1===Object.prototype.hasOwnProperty.call(e,"token"))h.test.reportError("Token creation failed due to error: "+e.error),
h.test.done();else{var a={video:!0,audio:!0,data:!0,videoSize:{LD:[80,45,640,360]}.SD,attributes:{name:"Test connectivity"}},c=EnxRtc.Logger.getLogLevel();EnxRtc.Logger.setLogLevel(EnxRtc.Logger.NONE);EnxRtc.joinRoom(e.token,a,function(a,e){EnxRtc.Logger.setLogLevel(c);e&&null!=e?(h.test.reportError("Room not joined due to error: "+e.type),h.test.done()):a&&null!=a&&(a.room.disconnect(),h.test.reportSuccess("Room joined successfully."),h.test.done())})}}).catch(function(e){h.test.reportError("Token creation failed due to error: "+
e);h.test.done()})}}},function(l,t,n){function h(h,e,a,c){this.test=h;this.host=e;this.port=a;this.mediaConnect=void 0===c?!1:c}t.a=function(l,e,a){(new h(l,e,a,!0)).run()};var u=n(32);h.prototype={run:function(){var h=this,e="https://"+this.host+":"+this.port+"/proxy-token";u(e,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"No"}}).then(function(a){return a.json()}).then(function(a){console.log("Token created");h.test.reportSuccess("Token created successfully.");
if(!1===Object.prototype.hasOwnProperty.call(a,"token"))console.log(" Token creation failed for url : "+e+" token: "+JSON.stringify(a)),h.test.reportError("Token creation failed due to error: "+a.error),h.test.done();else{var c={video:!1,audio:!1,data:!0,videoSize:{LD:[80,45,640,360]}.SD,attributes:{name:"Test connectivity"}},f=EnxRtc.Logger.getLogLevel();EnxRtc.Logger.setLogLevel(EnxRtc.Logger.NONE);EnxRtc.joinRoom(a.token,c,function(a,c){EnxRtc.Logger.setLogLevel(f);if(c&&null!=c)h.test.reportError("Room not joined due to error: "+
c.type),h.test.done();else if(a&&null!=a){var e=null;e=a.room;if(h.mediaConnect)if(e.dataStream){console.log("subcribe streams()");for(c=0;c<a.streams.length;c++)console.log("subcribe stream id: "+a.streams[c].getID()),e.subscribe(a.streams[c]);a=[];a.push(new Promise(function(a,c){e.addEventListener("media-state",function(c){console.log("Promise Test media-state event:  ",JSON.stringify(c));a(!0)})}));a.push(new Promise(function(a,c){e.addEventListener("active-talkers-updated",function(c){console.log("Promise Test active talker updated event");
a(!0)})}));Promise.all(a).then(function(a){e.disconnect();h.test.reportSuccess("Room joined, Data connection active.");h.test.done()})}else console.log("----------- FAILED!!!!! localstream undefined ");else e.disconnect(),h.test.reportSuccess("Room joined successfully."),h.test.done()}})}}).catch(function(a){h.test.reportError("Token creation failed due to error: "+a);h.test.done()})}}},function(l,t,n){function h(h){return void 0==h||"app"==h?!1:!0}n(11);t.a={setCustomData:function(h,l,e){console.log("setCustomData")},
getCustomData:function(l,m){console.log("getCustomData");var e={result:0};0==h(l.scope)&&(e.result=1,e.error="Invalid scope parameter "+l.scope,m(e))},saveCustomData:function(l,m,e){console.log("saveCustomData");var a={result:0};if(0==h(l))a.result=1,a.error="Invalid scope parameter: "+l;else if(void 0==m||"object"!=typeof m)a.result=1,a.error="Invalid  data";e(a)}}},function(l,t){},function(l,t,n){t=n(20);l.exports=t.adapter=n(82)},function(l,t,n){l.exports=function(){return function(){function h(l,
m,e){function a(f,n){if(!m[f]){if(!l[f]){if(c)return c(f,!0);n=Error("Cannot find module '"+f+"'");throw n.code="MODULE_NOT_FOUND",n;}n=m[f]={exports:{}};l[f][0].call(n.exports,function(c){return a(l[f][1][c]||c)},n,n.exports,h,l,m,e)}return m[f].exports}for(var c=!1,f=0;f<e.length;f++)a(e[f]);return a}return h}()({1:[function(h,l,m){h=h("./adapter_factory.js");h=(0,h.adapterFactory)({window:window});l.exports=h},{"./adapter_factory.js":2}],2:[function(h,l,m){function e(a){if(a&&a.__esModule)return a;
var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}Object.defineProperty(m,"__esModule",{value:!0});m.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},l=a.log,m=a.detectBrowser(e),b={browserDetails:m,commonShim:k,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};
switch(m.browser){case "chrome":if(!c||!c.shimPeerConnection||!h.shimChrome){l("Chrome shim is not included in this adapter release.");break}l("adapter.js shimming chrome.");b.browserShim=c;c.shimGetUserMedia(e);c.shimMediaStream(e);c.shimPeerConnection(e);c.shimOnTrack(e);c.shimAddTrackRemoveTrack(e);c.shimGetSendersWithDtmf(e);c.shimGetStats(e);c.shimSenderReceiverGetStats(e);c.fixNegotiationNeeded(e);k.shimRTCIceCandidate(e);k.shimConnectionState(e);k.shimMaxMessageSize(e);k.shimSendThrowTypeError(e);
k.removeAllowExtmapMixed(e);break;case "firefox":if(!n||!n.shimPeerConnection||!h.shimFirefox){l("Firefox shim is not included in this adapter release.");break}l("adapter.js shimming firefox.");b.browserShim=n;n.shimGetUserMedia(e);n.shimPeerConnection(e);n.shimOnTrack(e);n.shimRemoveStream(e);n.shimSenderGetStats(e);n.shimReceiverGetStats(e);n.shimRTCDataChannel(e);k.shimRTCIceCandidate(e);k.shimConnectionState(e);k.shimMaxMessageSize(e);k.shimSendThrowTypeError(e);break;case "edge":if(!f||!f.shimPeerConnection||
!h.shimEdge){l("MS edge shim is not included in this adapter release.");break}l("adapter.js shimming edge.");b.browserShim=f;f.shimGetUserMedia(e);f.shimGetDisplayMedia(e);f.shimPeerConnection(e);f.shimReplaceTrack(e);k.shimMaxMessageSize(e);k.shimSendThrowTypeError(e);break;case "safari":if(!q||!h.shimSafari){l("Safari shim is not included in this adapter release.");break}l("adapter.js shimming safari.");b.browserShim=q;q.shimRTCIceServerUrls(e);q.shimCreateOfferLegacy(e);q.shimCallbacksAPI(e);q.shimLocalStreamsAPI(e);
q.shimRemoteStreamsAPI(e);q.shimTrackEventTransceiver(e);q.shimGetUserMedia(e);k.shimRTCIceCandidate(e);k.shimMaxMessageSize(e);k.shimSendThrowTypeError(e);k.removeAllowExtmapMixed(e);break;default:l("Unsupported browser!")}return b};l=h("./utils");var a=e(l);l=h("./chrome/chrome_shim");var c=e(l);l=h("./edge/edge_shim");var f=e(l);l=h("./firefox/firefox_shim");var n=e(l);l=h("./safari/safari_shim");var q=e(l);h=h("./common_shim");var k=e(h)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,
"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(h,l,m){function e(a,c,f){c in a?Object.defineProperty(a,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):a[c]=f;return a}function a(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(a){return b._shimmedLocalStreams[a][0]})};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=
function(b,a){if(!a)return c.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var f=c.apply(this,arguments);this._shimmedLocalStreams[a.id]?-1===this._shimmedLocalStreams[a.id].indexOf(f)&&this._shimmedLocalStreams[a.id].push(f):this._shimmedLocalStreams[a.id]=[a,f];return f};var f=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(b){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};b.getTracks().forEach(function(b){if(a.getSenders().find(function(a){return a.track===
b}))throw new DOMException("Track already exists.","InvalidAccessError");});var c=this.getSenders();f.apply(this,arguments);var e=this.getSenders().filter(function(b){return-1===c.indexOf(b)});this._shimmedLocalStreams[b.id]=[b].concat(e)};var e=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(b){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[b.id];return e.apply(this,arguments)};var h=a.RTCPeerConnection.prototype.removeTrack;
a.RTCPeerConnection.prototype.removeTrack=function(b){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};b&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var f=a._shimmedLocalStreams[c].indexOf(b);-1!==f&&a._shimmedLocalStreams[c].splice(f,1);1===a._shimmedLocalStreams[c].length&&delete a._shimmedLocalStreams[c]});return h.apply(this,arguments)}}Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=m.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=h("./getusermedia");Object.defineProperty(m,"shimGetUserMedia",{enumerable:!0,get:function(){return f.shimGetUserMedia}});var n=h("./getdisplaymedia");Object.defineProperty(m,"shimGetDisplayMedia",
{enumerable:!0,get:function(){return n.shimGetDisplayMedia}});m.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};m.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":c(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)q.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},
set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var f=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;this._ontrackpoly||(this._ontrackpoly=function(f){f.stream.addEventListener("addtrack",function(e){var b=void 0;b=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(b){return b.track&&b.track.id===
e.track.id}):{track:e.track};var h=new Event("track");h.track=e.track;h.receiver=b;h.transceiver={receiver:b};h.streams=[f.stream];c.dispatchEvent(h)});f.stream.getTracks().forEach(function(e){var b=void 0;b=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(b){return b.track&&b.track.id===e.id}):{track:e};var h=new Event("track");h.track=e;h.receiver=b;h.transceiver={receiver:b};h.streams=[f.stream];c.dispatchEvent(h)})},this.addEventListener("addstream",this._ontrackpoly));
return f.apply(this,arguments)}}};m.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":c(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var f=function(b,a){return{track:a,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===a.kind?b.createDTMFSender(a):null);return this._dtmf},_pc:b}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=
this._senders||[];return this._senders.slice()};var e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(b,a){var c=e.apply(this,arguments);c||(c=f(this,b),this._senders.push(c));return c};var h=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(b){h.apply(this,arguments);var a=this._senders.indexOf(b);-1!==a&&this._senders.splice(a,1)}}var k=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=
function(b){var a=this;this._senders=this._senders||[];k.apply(this,[b]);b.getTracks().forEach(function(b){a._senders.push(f(a,b))})};var b=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var c=this;this._senders=this._senders||[];b.apply(this,[a]);a.getTracks().forEach(function(b){var a=c._senders.find(function(a){return a.track===b});a&&c._senders.splice(c._senders.indexOf(a),1)})}}else if("object"===("undefined"===typeof a?"undefined":c(a))&&a.RTCPeerConnection&&
"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var l=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var b=this,a=l.apply(this,[]);a.forEach(function(a){return a._pc=b});return a};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);
return this._dtmf}})}};m.shimGetStats=function(a){if(a.RTCPeerConnection){var c=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,f=Array.prototype.slice.call(arguments),e=f[0],b=f[1];f=f[2];if(0<arguments.length&&"function"===typeof e)return c.apply(this,arguments);if(0===c.length&&(0===arguments.length||"function"!==typeof e))return c.apply(this,[]);var h=function(b){var a={};b.result().forEach(function(b){var c={id:b.id,timestamp:b.timestamp,type:{localcandidate:"local-candidate",
remotecandidate:"remote-candidate"}[b.type]||b.type};b.names().forEach(function(a){c[a]=b.stat(a)});a[c.id]=c});return a},k=function(b){return new Map(Object.keys(b).map(function(a){return[a,b[a]]}))};return 2<=arguments.length?c.apply(this,[function(a){b(k(h(a)))},e]):(new Promise(function(b,f){c.apply(a,[function(a){b(k(h(a)))},f])})).then(b,f)}}};m.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":c(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in
a.RTCRtpSender.prototype)){var f=a.RTCPeerConnection.prototype.getSenders;f&&(a.RTCPeerConnection.prototype.getSenders=function(){var b=this,a=f.apply(this,[]);a.forEach(function(a){return a._pc=b});return a});var e=a.RTCPeerConnection.prototype.addTrack;e&&(a.RTCPeerConnection.prototype.addTrack=function(){var b=e.apply(this,arguments);b._pc=this;return b});a.RTCRtpSender.prototype.getStats=function(){var b=this;return this._pc.getStats().then(function(a){return q.filterStats(a,b.track,!0)})}}if(!("getStats"in
a.RTCRtpReceiver.prototype)){var h=a.RTCPeerConnection.prototype.getReceivers;h&&(a.RTCPeerConnection.prototype.getReceivers=function(){var b=this,a=h.apply(this,[]);a.forEach(function(a){return a._pc=b});return a});q.wrapPeerConnectionEvent(a,"track",function(b){b.receiver._pc=b.srcElement;return b});a.RTCRtpReceiver.prototype.getStats=function(){var b=this;return this._pc.getStats().then(function(a){return q.filterStats(a,b.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var k=
a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],c=void 0,f=void 0,e=void 0;this.getSenders().forEach(function(a){a.track===b&&(c?e=!0:c=a)});this.getReceivers().forEach(function(a){a.track===b&&(f?e=!0:f=a);return a.track===b});return e||c&&f?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():f?
f.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return k.apply(this,arguments)}}}};m.shimAddTrackRemoveTrackWithNative=a;m.shimAddTrackRemoveTrack=function(c){function f(b,a){var c=a.sdp;Object.keys(b._reverseStreams||[]).forEach(function(a){a=b._reverseStreams[a];c=c.replace(new RegExp(b._streams[a.id].id,"g"),a.id)});return new RTCSessionDescription({type:a.type,sdp:c})}function h(b,a){var c=a.sdp;Object.keys(b._reverseStreams||
[]).forEach(function(a){a=b._reverseStreams[a];c=c.replace(new RegExp(a.id,"g"),b._streams[a.id].id)});return new RTCSessionDescription({type:a.type,sdp:c})}if(c.RTCPeerConnection){var k=q.detectBrowser(c);if(c.RTCPeerConnection.prototype.addTrack&&65<=k.version)return a(c);var l=c.RTCPeerConnection.prototype.getLocalStreams;c.RTCPeerConnection.prototype.getLocalStreams=function(){var b=this,a=l.apply(this);this._reverseStreams=this._reverseStreams||{};return a.map(function(a){return b._reverseStreams[a.id]})};
var b=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(a){var f=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(b){if(f.getSenders().find(function(a){return a.track===b}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var e=new c.MediaStream(a.getTracks());this._streams[a.id]=e;this._reverseStreams[e.id]=a;a=e}b.apply(this,[a])};var m=c.RTCPeerConnection.prototype.removeStream;
c.RTCPeerConnection.prototype.removeStream=function(b){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};m.apply(this,[this._streams[b.id]||b]);delete this._reverseStreams[this._streams[b.id]?this._streams[b.id].id:b.id];delete this._streams[b.id]};c.RTCPeerConnection.prototype.addTrack=function(b,a){var f=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,
1);if(1!==e.length||!e[0].getTracks().find(function(a){return a===b}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(a){return a.track===b}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[a.id])?(e.addTrack(b),Promise.resolve().then(function(){f.dispatchEvent(new Event("negotiationneeded"))})):
(e=new c.MediaStream([b]),this._streams[a.id]=e,this._reverseStreams[e.id]=a,this.addStream(e));return this.getSenders().find(function(a){return a.track===b})};["createOffer","createAnswer"].forEach(function(b){var a=c.RTCPeerConnection.prototype[b],h=e({},b,function(){var b=this,c=arguments;return arguments.length&&"function"===typeof arguments[0]?a.apply(this,[function(a){a=f(b,a);c[0].apply(null,[a])},function(b){c[1]&&c[1].apply(null,b)},arguments[2]]):a.apply(this,arguments).then(function(a){return f(b,
a)})});c.RTCPeerConnection.prototype[b]=h[b]});var n=c.RTCPeerConnection.prototype.setLocalDescription;c.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return n.apply(this,arguments);arguments[0]=h(this,arguments[0]);return n.apply(this,arguments)};var w=Object.getOwnPropertyDescriptor(c.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(c.RTCPeerConnection.prototype,"localDescription",{get:function(){var b=w.get.apply(this);
return""===b.type?b:f(this,b)}});c.RTCPeerConnection.prototype.removeTrack=function(b){var a=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!b._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(b._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};
var c=void 0;Object.keys(this._streams).forEach(function(f){a._streams[f].getTracks().find(function(a){return b.track===a})&&(c=a._streams[f])});c&&(1===c.getTracks().length?this.removeStream(this._reverseStreams[c.id]):c.removeTrack(b.track),this.dispatchEvent(new Event("negotiationneeded")))}}};m.shimPeerConnection=function(a){var c=q.detectBrowser(a);!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection);if(a.RTCPeerConnection){53>c.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(c){var f=a.RTCPeerConnection.prototype[c],b=e({},c,function(){arguments[0]=new ("addIceCandidate"===c?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return f.apply(this,arguments)});a.RTCPeerConnection.prototype[c]=b[c]});var f=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>c.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():f.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};m.fixNegotiationNeeded=function(a){q.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};var q=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}(h("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(h,l,m){Object.defineProperty(m,"__esModule",
{value:!0});m.shimGetDisplayMedia=function(e,a){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||("function"!==typeof a?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):e.navigator.mediaDevices.getDisplayMedia=function(c){return a(c).then(function(a){var f=c.video&&c.video.width,h=c.video&&c.video.height;c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:c.video&&c.video.frameRate||3}};f&&
(c.video.mandatory.maxWidth=f);h&&(c.video.mandatory.maxHeight=h);return e.navigator.mediaDevices.getUserMedia(c)})})}},{}],5:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==
Symbol.prototype?"symbol":typeof a};m.shimGetUserMedia=function(f){var h=f&&f.navigator;if(h.mediaDevices){var l=a.detectBrowser(f),k=function(a){if("object"!==("undefined"===typeof a?"undefined":e(a))||a.mandatory||a.optional)return a;var b={};Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var f="object"===e(a[c])?a[c]:{ideal:a[c]};void 0!==f.exact&&"number"===typeof f.exact&&(f.min=f.max=f.exact);var h=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):
"deviceId"===b?"sourceId":b};if(void 0!==f.ideal){b.optional=b.optional||[];var k={};"number"===typeof f.ideal?(k[h("min",c)]=f.ideal,b.optional.push(k),k={},k[h("max",c)]=f.ideal):k[h("",c)]=f.ideal;b.optional.push(k)}void 0!==f.exact&&"number"!==typeof f.exact?(b.mandatory=b.mandatory||{},b.mandatory[h("",c)]=f.exact):["min","max"].forEach(function(a){void 0!==f[a]&&(b.mandatory=b.mandatory||{},b.mandatory[h(a,c)]=f[a])})}});a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced));return b},
m=function(a,b){if(61<=l.version)return b(a);if((a=JSON.parse(JSON.stringify(a)))&&"object"===e(a.audio)){var f=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};a=JSON.parse(JSON.stringify(a));f(a.audio,"autoGainControl","googAutoGainControl");f(a.audio,"noiseSuppression","googNoiseSuppression");a.audio=k(a.audio)}if(a&&"object"===e(a.video)){var m=a.video.facingMode;m=m&&("object"===("undefined"===typeof m?"undefined":e(m))?m:{ideal:m});f=66>l.version;if(!(!m||"user"!==m.exact&&"environment"!==
m.exact&&"user"!==m.ideal&&"environment"!==m.ideal||h.mediaDevices.getSupportedConstraints&&h.mediaDevices.getSupportedConstraints().facingMode&&!f)){delete a.video.facingMode;var n=void 0;if("environment"===m.exact||"environment"===m.ideal)n=["back","rear"];else if("user"===m.exact||"user"===m.ideal)n=["front"];if(n)return h.mediaDevices.enumerateDevices().then(function(f){f=f.filter(function(a){return"videoinput"===a.kind});var e=f.find(function(a){return n.some(function(b){return a.label.toLowerCase().includes(b)})});
!e&&f.length&&n.includes("back")&&(e=f[f.length-1]);e&&(a.video.deviceId=m.exact?{exact:e.deviceId}:{ideal:e.deviceId});a.video=k(a.video);c("chrome: "+JSON.stringify(a));return b(a)})}a.video=k(a.video)}c("chrome: "+JSON.stringify(a));return b(a)},n=function(a){return 64<=l.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",
MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};h.getUserMedia=function(a,b,c){m(a,function(a){h.webkitGetUserMedia(a,b,function(a){c&&c(n(a))})})}.bind(h);if(h.mediaDevices.getUserMedia){var t=h.mediaDevices.getUserMedia.bind(h.mediaDevices);
h.mediaDevices.getUserMedia=function(a){return m(a,function(a){return t(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(n(a))})})}}}};var a=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}(h("../utils.js")),c=a.log},{"../utils.js":15}],
6:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimRTCIceCandidate=function(f){if(f.RTCIceCandidate&&!(f.RTCIceCandidate&&"foundation"in
f.RTCIceCandidate.prototype)){var h=f.RTCIceCandidate;f.RTCIceCandidate=function(c){"object"===("undefined"===typeof c?"undefined":e(c))&&c.candidate&&0===c.candidate.indexOf("a=")&&(c=JSON.parse(JSON.stringify(c)),c.candidate=c.candidate.substr(2));if(c.candidate&&c.candidate.length){var f=new h(c);c=a.default.parseCandidate(c.candidate);var l=Object.assign(f,c);l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}};return l}return new h(c)};
f.RTCIceCandidate.prototype=h.prototype;c.wrapPeerConnectionEvent(f,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new f.RTCIceCandidate(a.candidate),writable:"false"});return a})}};m.shimMaxMessageSize=function(f){if(f.RTCPeerConnection){var e=c.detectBrowser(f);"sctp"in f.RTCPeerConnection.prototype||Object.defineProperty(f.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var h=function(c){if(!c||!c.sdp)return!1;
c=a.default.splitSections(c.sdp);c.shift();return c.some(function(b){return(b=a.default.parseMLine(b))&&"application"===b.kind&&-1!==b.protocol.indexOf("SCTP")})},k=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},l=function(a){var b=65536;"firefox"===e.browser&&(b=57>e.version?-1===a?16384:2147483637:60>e.version?57===e.version?65535:65536:2147483637);return b},m=function(c,b){var f=65536;"firefox"===e.browser&&57===
e.version&&(f=65535);c=a.default.matchPrefix(c.sdp,"a=max-message-size:");0<c.length?f=parseInt(c[0].substr(19),10):"firefox"===e.browser&&-1!==b&&(f=2147483637);return f},n=f.RTCPeerConnection.prototype.setRemoteDescription;f.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===e.browser&&76<=e.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,
configurable:!0});if(h(arguments[0])){var a=k(arguments[0]),b=l(a);a=m(arguments[0],a);var c=void 0;c=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===a?Math.max(b,a):Math.min(b,a);b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return c}});this._sctp=b}return n.apply(this,arguments)}}};m.shimSendThrowTypeError=function(a){function f(a,c){var f=a.send;a.send=function(){var e=arguments[0];e=e.length||e.size||e.byteLength;if("open"===a.readyState&&c.sctp&&e>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+
c.sctp.maxMessageSize+" bytes)");return f.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var e=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=e.apply(this,arguments);f(a,this);return a};c.wrapPeerConnectionEvent(a,"datachannel",function(a){f(a.channel,a.target);return a})}};m.shimConnectionState=function(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var c=
a.RTCPeerConnection.prototype;Object.defineProperty(c,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(c,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);a&&
this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var f=c[a];c[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var c=a.target;if(c._lastConnectionState!==c.connectionState){c._lastConnectionState=c.connectionState;var f=new Event("connectionstatechange",a);c.dispatchEvent(f)}return a},this.addEventListener("iceconnectionstatechange",
this._connectionstatechangepoly));return f.apply(this,arguments)}})}};m.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var f=c.detectBrowser(a);if(!("chrome"===f.browser&&71<=f.version)){var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na=extmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a=extmap-allow-mixed"!==a.trim()}).join("\n"));return e.apply(this,arguments)}}}};
var a=(l=h("sdp"))&&l.__esModule?l:{default:l},c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}(h("./utils"))},{"./utils":15,sdp:17}],7:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=m.shimGetUserMedia=void 0;var e=h("./getusermedia");Object.defineProperty(m,"shimGetUserMedia",{enumerable:!0,get:function(){return e.shimGetUserMedia}});var a=h("./getdisplaymedia");
Object.defineProperty(m,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});m.shimPeerConnection=function(a){var e=c.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),15025>e.version)){var h=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){h.set.call(this,
a);var c=new Event("enabled");c.enabled=a;this.dispatchEvent(c)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var l=(0,n.default)(a,e.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=
(0,f.filterIceServers)(a.iceServers,e.version),c.log("ICE servers after filtering:",a.iceServers));return new l(a)};a.RTCPeerConnection.prototype=l.prototype};m.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};var c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}(h("../utils")),f=h("./filtericeservers"),
n=(h=h("rtcpeerconnection-shim"))&&h.__esModule?h:{default:h}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.filterIceServers=function(a,c){var f=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var c=a.urls||a.url;a.url&&!a.urls&&e.deprecated("RTCIceServer.url","RTCIceServer.urls");var h="string"===typeof c;h&&(c=[c]);c=c.filter(function(a){return 0===
a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport=udp"))&&!f?f=!0:a&&!f});delete a.url;a.urls=h?c[0]:c;return!!c.length}})};var e=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}(h("../utils"))},{"../utils":15}],9:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&
!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator))}},{}],10:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetUserMedia=function(e){e=e&&e.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},c=e.mediaDevices.getUserMedia.bind(e.mediaDevices);
e.mediaDevices.getUserMedia=function(f){return c(f).catch(function(c){return Promise.reject(a(c))})}}},{}],11:[function(h,l,m){function e(a,c,f){c in a?Object.defineProperty(a,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):a[c]=f;return a}Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=m.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=h("./getusermedia");Object.defineProperty(m,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});var f=h("./getdisplaymedia");Object.defineProperty(m,"shimGetDisplayMedia",{enumerable:!0,get:function(){return f.shimGetDisplayMedia}});m.shimOnTrack=function(c){"object"===("undefined"===typeof c?"undefined":
a(c))&&c.RTCTrackEvent&&"receiver"in c.RTCTrackEvent.prototype&&!("transceiver"in c.RTCTrackEvent.prototype)&&Object.defineProperty(c.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};m.shimPeerConnection=function(c){var f=n.detectBrowser(c);if("object"===("undefined"===typeof c?"undefined":a(c))&&(c.RTCPeerConnection||c.mozRTCPeerConnection)){!c.RTCPeerConnection&&c.mozRTCPeerConnection&&(c.RTCPeerConnection=c.mozRTCPeerConnection);53>f.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(a){var b=c.RTCPeerConnection.prototype[a],f=e({},a,function(){arguments[0]=new ("addIceCandidate"===a?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]);return b.apply(this,arguments)});c.RTCPeerConnection.prototype[a]=f[a]});if(68>f.version){var h=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():h.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var l={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},m=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(){var a=Array.prototype.slice.call(arguments),b=a[1],c=a[2];return m.apply(this,[a[0]||null]).then(function(a){if(53>f.version&&!b)try{a.forEach(function(a){a.type=l[a.type]||a.type})}catch(z){if("TypeError"!==
z.name)throw z;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:l[b.type]||b.type}))})}return a}).then(b,c)}}};m.shimSenderGetStats=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection&&c.RTCRtpSender&&!(c.RTCRtpSender&&"getStats"in c.RTCRtpSender.prototype)){var f=c.RTCPeerConnection.prototype.getSenders;f&&(c.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=f.apply(this,[]);c.forEach(function(c){return c._pc=a});return c});var e=c.RTCPeerConnection.prototype.addTrack;
e&&(c.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});c.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};m.shimReceiverGetStats=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection&&c.RTCRtpSender&&!(c.RTCRtpSender&&"getStats"in c.RTCRtpReceiver.prototype)){var f=c.RTCPeerConnection.prototype.getReceivers;f&&(c.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,c=f.apply(this,[]);c.forEach(function(c){return c._pc=a});return c});n.wrapPeerConnectionEvent(c,"track",function(a){a.receiver._pc=a.srcElement;return a});c.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};m.shimRemoveStream=function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var c=this;n.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(f){f.track&&
a.getTracks().includes(f.track)&&c.removeTrack(f)})})};m.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var n=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f]);c.default=a;return c}(h("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=function(e,a){e.navigator.mediaDevices&&
"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(c){if(!c||!c.video)return c=new DOMException("getDisplayMedia without video constraints is undefined"),c.name="NotFoundError",c.code=8,Promise.reject(c);!0===c.video?c.video={mediaSource:a}:c.video.mediaSource=a;return e.navigator.mediaDevices.getUserMedia(c)})}},{}],13:[function(h,l,m){Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimGetUserMedia=function(c){var f=a.detectBrowser(c),h=c&&c.navigator;c=c&&c.MediaStreamTrack;h.getUserMedia=function(c,f,b){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");
h.mediaDevices.getUserMedia(c).then(f,b)};if(!(55<f.version&&"autoGainControl"in h.mediaDevices.getSupportedConstraints())){var l=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])},k=h.mediaDevices.getUserMedia.bind(h.mediaDevices);h.mediaDevices.getUserMedia=function(a){"object"===("undefined"===typeof a?"undefined":e(a))&&"object"===e(a.audio)&&(a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","mozAutoGainControl"),l(a.audio,"noiseSuppression","mozNoiseSuppression"));return k(a)};
if(c&&c.prototype.getSettings){var m=c.prototype.getSettings;c.prototype.getSettings=function(){var a=m.apply(this,arguments);l(a,"mozAutoGainControl","autoGainControl");l(a,"mozNoiseSuppression","noiseSuppression");return a}}if(c&&c.prototype.applyConstraints){var n=c.prototype.applyConstraints;c.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===("undefined"===typeof a?"undefined":e(a))&&(a=JSON.parse(JSON.stringify(a)),l(a,"autoGainControl","mozAutoGainControl"),l(a,"noiseSuppression",
"mozNoiseSuppression"));return n.apply(this,[a])}}}};var a=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=a[e]);c.default=a;return c}(h("../utils"))},{"../utils":15}],14:[function(h,l,m){function e(a){return a&&void 0!==a.video?Object.assign({},a,{video:c.compactObject(a.video)}):a}Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&
"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimLocalStreamsAPI=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection){"getLocalStreams"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=
[]);return this._localStreams});if(!("addStream"in c.RTCPeerConnection.prototype)){var f=c.RTCPeerConnection.prototype.addTrack;c.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||this._localStreams.push(a);a.getAudioTracks().forEach(function(e){return f.call(c,e,a)});a.getVideoTracks().forEach(function(e){return f.call(c,e,a)})};c.RTCPeerConnection.prototype.addTrack=function(a){var c=arguments[1];c&&(this._localStreams?
this._localStreams.includes(c)||this._localStreams.push(c):this._localStreams=[c]);return f.apply(this,arguments)}}"removeStream"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.removeStream=function(a){var c=this;this._localStreams||(this._localStreams=[]);var f=this._localStreams.indexOf(a);if(-1!==f){this._localStreams.splice(f,1);var e=a.getTracks();this.getSenders().forEach(function(a){e.includes(a.track)&&c.removeTrack(a)})}})}};m.shimRemoteStreamsAPI=function(c){if("object"===
("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection&&("getRemoteStreams"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in c.RTCPeerConnection.prototype))){Object.defineProperty(c.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var c=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",
this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){c._remoteStreams||(c._remoteStreams=[]);if(!c._remoteStreams.includes(a)){c._remoteStreams.push(a);var f=new Event("addstream");f.stream=a;c.dispatchEvent(f)}})})}});var f=c.RTCPeerConnection.prototype.setRemoteDescription;c.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",
this._onaddstreampoly=function(c){c.streams.forEach(function(c){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(c))){a._remoteStreams.push(c);var f=new Event("addstream");f.stream=c;a.dispatchEvent(f)}})});return f.apply(a,arguments)}}};m.shimCallbacksAPI=function(c){if("object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCPeerConnection){c=c.RTCPeerConnection.prototype;var f=c.createOffer,e=c.createAnswer,h=c.setLocalDescription,l=c.setRemoteDescription,m=c.addIceCandidate;
c.createOffer=function(a,b){var c=f.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};c.createAnswer=function(a,b){var c=e.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};var n=function(a,b,c){a=h.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};c.setLocalDescription=n;n=function(a,b,c){a=l.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};
c.setRemoteDescription=n;n=function(a,b,c){a=m.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};c.addIceCandidate=n}};m.shimGetUserMedia=function(a){var c=a&&a.navigator;if(c.mediaDevices&&c.mediaDevices.getUserMedia){a=c.mediaDevices;var f=a.getUserMedia.bind(a);c.mediaDevices.getUserMedia=function(a){return f(e(a))}}!c.getUserMedia&&c.mediaDevices&&c.mediaDevices.getUserMedia&&(c.getUserMedia=function(a,f,e){c.mediaDevices.getUserMedia(a).then(f,e)})};m.shimConstraints=e;m.shimRTCIceServerUrls=
function(a){var f=a.RTCPeerConnection;a.RTCPeerConnection=function(a,e){if(a&&a.iceServers){for(var h=[],k=0;k<a.iceServers.length;k++){var l=a.iceServers[k];!l.hasOwnProperty("urls")&&l.hasOwnProperty("url")?(c.deprecated("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,h.push(l)):h.push(a.iceServers[k])}a.iceServers=h}return new f(a,e)};a.RTCPeerConnection.prototype=f.prototype;"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,
"generateCertificate",{get:function(){return f.generateCertificate}})};m.shimTrackEventTransceiver=function(c){"object"===("undefined"===typeof c?"undefined":a(c))&&c.RTCTrackEvent&&"receiver"in c.RTCTrackEvent.prototype&&!("transceiver"in c.RTCTrackEvent.prototype)&&Object.defineProperty(c.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};m.shimCreateOfferLegacy=function(a){var c=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=
function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var f=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&f?"sendrecv"===f.direction?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":"recvonly"===f.direction&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):!0!==a.offerToReceiveAudio||f||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&
(a.offerToReceiveVideo=!!a.offerToReceiveVideo);f=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&f?"sendrecv"===f.direction?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":"recvonly"===f.direction&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):!0!==a.offerToReceiveVideo||f||this.addTransceiver("video")}return c.apply(this,arguments)}};var c=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.prototype.hasOwnProperty.call(a,
f)&&(c[f]=a[f]);c.default=a;return c}(h("../utils"))},{"../utils":15}],15:[function(h,l,m){function e(a,c,f){c in a?Object.defineProperty(a,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):a[c]=f;return a}function a(a,c,f){return(a=a.match(c))&&a.length>=f&&parseInt(a[f],10)}function c(a){return"[object Object]"!==Object.prototype.toString.call(a)?a:Object.keys(a).reduce(function(f,h){var k="[object Object]"===Object.prototype.toString.call(a[h]),b=k?c(a[h]):a[h];k=k&&!Object.keys(b).length;
return void 0===b||k?f:Object.assign(f,e({},h,b))},{})}function f(a,c,e){c&&!e.has(c.id)&&(e.set(c.id,c),Object.keys(c).forEach(function(h){h.endsWith("Id")?f(a,a.get(c[h]),e):h.endsWith("Ids")&&c[h].forEach(function(b){f(a,a.get(b),e)})}))}Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.extractVersion=a;m.wrapPeerConnectionEvent=function(a,c,f){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var e=a.addEventListener;a.addEventListener=function(a,b){if(a!==c)return e.apply(this,arguments);var h=function(a){(a=f(a))&&b(a)};this._eventMap=this._eventMap||{};this._eventMap[b]=h;return e.apply(this,[a,h])};var b=a.removeEventListener;a.removeEventListener=
function(a,f){if(a!==c||!this._eventMap||!this._eventMap[f])return b.apply(this,arguments);var e=this._eventMap[f];delete this._eventMap[f];return b.apply(this,[a,e])};Object.defineProperty(a,"on"+c,{get:function(){return this["_on"+c]},set:function(a){this["_on"+c]&&(this.removeEventListener(c,this["_on"+c]),delete this["_on"+c]);a&&this.addEventListener(c,this["_on"+c]=a)},enumerable:!0,configurable:!0})}};m.disableLog=function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===
typeof a?"undefined":n(a))+". Please use a boolean."):(q=a)?"adapter.js logging disabled":"adapter.js logging enabled"};m.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean.");k=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};m.log=function(){"object"!==("undefined"===typeof window?"undefined":n(window))||q||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,
arguments)};m.deprecated=function(a,c){k&&console.warn(a+" is deprecated, please use "+c+" instead.")};m.detectBrowser=function(c){var f=c.navigator,e={browser:null,version:null};if("undefined"===typeof c||!c.navigator)return e.browser="Not a browser.",e;f.mozGetUserMedia?(e.browser="firefox",e.version=a(f.userAgent,/Firefox\/(\d+)\./,1)):f.webkitGetUserMedia||!1===c.isSecureContext&&c.webkitRTCPeerConnection&&!c.RTCIceGatherer?(e.browser="chrome",e.version=a(f.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):
f.mediaDevices&&f.userAgent.match(/Edge\/(\d+).(\d+)$/)?(e.browser="edge",e.version=a(f.userAgent,/Edge\/(\d+).(\d+)$/,2)):c.RTCPeerConnection&&f.userAgent.match(/AppleWebKit\/(\d+)\./)?(e.browser="safari",e.version=a(f.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=c.RTCRtpTransceiver&&"currentDirection"in c.RTCRtpTransceiver.prototype):e.browser="Not a supported browser.";return e};m.compactObject=c;m.walkStats=f;m.filterStats=function(a,c,e){var h=e?"outbound-rtp":"inbound-rtp",b=new Map;
if(null===c)return b;var k=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===c.id&&k.push(a)});k.forEach(function(c){a.forEach(function(e){e.type===h&&e.trackId===c.id&&f(a,e,b)})});return b};var q=!0,k=!0},{}],16:[function(h,l,m){function e(a,c,f,e,b){c=k.writeRtpDescription(a.kind,c);c+=k.writeIceParameters(a.iceGatherer.getLocalParameters());c+=k.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===f?"actpass":b||"active");c+="a=mid:"+a.mid+"\r\n";c=a.rtpSender&&a.rtpReceiver?
c+"a=sendrecv\r\n":a.rtpSender?c+"a=sendonly\r\n":a.rtpReceiver?c+"a=recvonly\r\n":c+"a=inactive\r\n";a.rtpSender&&(f=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=f,e="msid:"+(e?e.id:"-")+" "+f+"\r\n",c=c+("a="+e)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+e),a.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,c+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));c+="a=ssrc:"+
a.sendEncodingParameters[0].ssrc+" cname:"+k.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+k.localCName+"\r\n");return c}function a(a,c){var f=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var b=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var e="string"===typeof b;e&&(b=[b]);b=b.filter(function(a){return 0!==a.indexOf("turn:")||
-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||f?0===a.indexOf("stun:")&&14393<=c&&-1===a.indexOf("?transport=udp"):f=!0});delete a.url;a.urls=e?b[0]:b;return!!b.length}})}function c(a,c){var f={codecs:[],headerExtensions:[],fecMechanisms:[]},e=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},b=function(a,b,c,f){a=e(a.parameters.apt,c);b=e(b.parameters.apt,f);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};
a.codecs.forEach(function(e){for(var h=0;h<c.codecs.length;h++){var k=c.codecs[h];if(e.name.toLowerCase()===k.name.toLowerCase()&&e.clockRate===k.clockRate&&("rtx"!==e.name.toLowerCase()||!e.parameters||!k.parameters.apt||b(e,k,a.codecs,c.codecs))){k=JSON.parse(JSON.stringify(k));k.numChannels=Math.min(e.numChannels,k.numChannels);f.codecs.push(k);k.rtcpFeedback=k.rtcpFeedback.filter(function(a){for(var b=0;b<e.rtcpFeedback.length;b++)if(e.rtcpFeedback[b].type===a.type&&e.rtcpFeedback[b].parameter===
a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var b=0;b<c.headerExtensions.length;b++){var e=c.headerExtensions[b];if(a.uri===e.uri){f.headerExtensions.push(e);break}}});return f}function f(a,c,f){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[c][a].indexOf(f)}
function n(a,c){var f=a.getRemoteCandidates().find(function(a){return c.foundation===a.foundation&&c.ip===a.ip&&c.port===a.port&&c.priority===a.priority&&c.protocol===a.protocol&&c.type===a.type});f||a.addRemoteCandidate(c);return!f}function q(a,c){c=Error(c);c.name=a;c.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return c}var k=h("sdp");l.exports=function(h,l){function m(a,b){b.addTrack(a);b.dispatchEvent(new h.MediaStreamTrackEvent("addtrack",
{track:a}))}function p(a,b){b.removeTrack(a);b.dispatchEvent(new h.MediaStreamTrackEvent("removetrack",{track:a}))}function b(a,b,c,f){var e=new Event("track");e.track=b;e.receiver=c;e.transceiver={receiver:c};e.streams=f;h.setTimeout(function(){a._dispatchEvent("track",e)})}var r=function(b){var c=this,f=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){c[a]=f[a].bind(f)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=
[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";b=JSON.parse(JSON.stringify(b||{}));this.usingBundle="max-bundle"===b.bundlePolicy;if("negotiate"===b.rtcpMuxPolicy)throw q("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");b.rtcpMuxPolicy||(b.rtcpMuxPolicy="require");switch(b.iceTransportPolicy){case "all":case "relay":break;default:b.iceTransportPolicy=
"all"}switch(b.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:b.bundlePolicy="balanced"}b.iceServers=a(b.iceServers||[],l);this._iceGatherers=[];if(b.iceCandidatePoolSize)for(var e=b.iceCandidatePoolSize;0<e;e--)this._iceGatherers.push(new h.RTCIceGatherer({iceServers:b.iceServers,gatherPolicy:b.iceTransportPolicy}));else b.iceCandidatePoolSize=0;this._config=b;this.transceivers=[];this._sdpSessionId=k.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;
this._isClosed=!1};Object.defineProperty(r.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(r.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});r.prototype.onicecandidate=null;r.prototype.onaddstream=null;r.prototype.ontrack=null;r.prototype.onremovestream=null;r.prototype.onsignalingstatechange=null;r.prototype.oniceconnectionstatechange=null;r.prototype.onconnectionstatechange=null;r.prototype.onicegatheringstatechange=
null;r.prototype.onnegotiationneeded=null;r.prototype.ondatachannel=null;r.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};r.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)};r.prototype.getConfiguration=function(){return this._config};r.prototype.getLocalStreams=function(){return this.localStreams};r.prototype.getRemoteStreams=
function(){return this.remoteStreams};r.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):
(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};r.prototype.addTrack=function(a,b){if(this._isClosed)throw q("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===a}))throw q("InvalidAccessError","Track already exists.");for(var c,f=0;f<this.transceivers.length;f++)this.transceivers[f].track||this.transceivers[f].kind!==a.kind||
(c=this.transceivers[f]);c||(c=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);c.track=a;c.stream=b;c.rtpSender=new h.RTCRtpSender(a,c.dtlsTransport);return c.rtpSender};r.prototype.addStream=function(a){var b=this;if(15025<=l)a.getTracks().forEach(function(c){b.addTrack(c,a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var f=c.getTracks()[b];a.addEventListener("enabled",function(a){f.enabled=a.enabled})});
c.getTracks().forEach(function(a){b.addTrack(a,c)})}};r.prototype.removeTrack=function(a){if(this._isClosed)throw q("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof h.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===a});if(!b)throw q("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;
b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(c)&&-1<this.localStreams.indexOf(c)&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};r.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&b.removeTrack(c)})};r.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};
r.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};r.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var f=new h.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(f,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=
[];this.transceivers[a].bufferCandidates=function(b){var e=!b.candidate||0===Object.keys(b.candidate).length;f.state=e?"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};f.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return f};r.prototype._gather=function(a,b){var c=this,f=this.transceivers[b].iceGatherer;if(!f.onlocalcandidate){var e=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=
null;f.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);f.onlocalcandidate=function(e){if(!(c.usingBundle&&0<b)){var h=new Event("icecandidate");h.candidate={sdpMid:a,sdpMLineIndex:b};var l=e.candidate;if(e=!l||0===Object.keys(l).length){if("new"===f.state||"gathering"===f.state)f.state="completed"}else"new"===f.state&&(f.state="gathering"),l.component=1,l.ufrag=f.getLocalParameters().usernameFragment,l=k.writeCandidate(l),h.candidate=Object.assign(h.candidate,k.parseCandidate(l)),
h.candidate.candidate=l,h.candidate.toJSON=function(){return{candidate:h.candidate.candidate,sdpMid:h.candidate.sdpMid,sdpMLineIndex:h.candidate.sdpMLineIndex,usernameFragment:h.candidate.usernameFragment}};l=k.getMediaSections(c._localDescription.sdp);l[h.candidate.sdpMLineIndex]=e?l[h.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":l[h.candidate.sdpMLineIndex]+("a="+h.candidate.candidate+"\r\n");c._localDescription.sdp=k.getDescription(c._localDescription.sdp)+l.join("");l=c.transceivers.every(function(a){return a.iceGatherer&&
"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&(c.iceGatheringState="gathering",c._emitGatheringStateChange());e||c._dispatchEvent("icecandidate",h);l&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};h.setTimeout(function(){e.forEach(function(a){f.onlocalcandidate(a)})},0)}};r.prototype._createIceAndDtlsTransports=function(){var a=this,b=new h.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();
a._updateConnectionState()};var c=new h.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};r.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;
if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};r.prototype._transceive=function(a,b,f){var e=c(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(e.encodings=a.sendEncodingParameters,e.rtcp={cname:k.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(e.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(e));f&&a.rtpReceiver&&0<e.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&
15019>l&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),e.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],e.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(e.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(e.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(e))};r.prototype.setLocalDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(q("TypeError",'Unsupported type "'+
a.type+'"'));if(!f("setLocalDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(q("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));if("offer"===a.type){var e=k.splitSections(a.sdp);var h=e.shift();e.forEach(function(a,c){a=k.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});b.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){e=k.splitSections(b._remoteDescription.sdp);h=e.shift();var l=0<k.matchPrefix(h,
"a=ice-lite").length;e.forEach(function(a,f){var e=b.transceivers[f],m=e.iceGatherer,n=e.iceTransport,p=e.dtlsTransport,q=e.localCapabilities,d=e.remoteCapabilities;if(!(k.isRejected(a)&&0===k.matchPrefix(a,"a=bundle-only").length||e.rejected)){var r=k.getIceParameters(a,h);a=k.getDtlsParameters(a,h);l&&(a.role="server");b.usingBundle&&0!==f||(b._gather(e.mid,f),"new"===n.state&&n.start(m,r,l?"controlling":"controlled"),"new"===p.state&&p.start(a));f=c(q,d);b._transceive(e,0<f.codecs.length,!1)}})}b._localDescription=
{type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-local-offer"):b._updateSignalingState("stable");return Promise.resolve()};r.prototype.setRemoteDescription=function(a){var e=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(q("TypeError",'Unsupported type "'+a.type+'"'));if(!f("setRemoteDescription",a.type,e.signalingState)||e._isClosed)return Promise.reject(q("InvalidStateError","Can not set remote "+a.type+" in state "+e.signalingState));var r={};e.remoteStreams.forEach(function(a){r[a.id]=
a});var t=[],u=k.splitSections(a.sdp),w=u.shift(),v=0<k.matchPrefix(w,"a=ice-lite").length,x=0<k.matchPrefix(w,"a=group:BUNDLE ").length;e.usingBundle=x;var z=k.matchPrefix(w,"a=ice-options:")[0];e.canTrickleIceCandidates=z?0<=z.substr(14).split(" ").indexOf("trickle"):!1;u.forEach(function(b,f){var q=k.splitLines(b),d=k.getKind(b),u=k.isRejected(b)&&0===k.matchPrefix(b,"a=bundle-only").length,z=q[0].substr(2).split(" ")[2];q=k.getDirection(b,w);var A=k.parseMsid(b),M=k.getMid(b)||k.generateIdentifier();
if(u||"application"===d&&("DTLS/SCTP"===z||"UDP/DTLS/SCTP"===z))e.transceivers[f]={mid:M,kind:d,protocol:z,rejected:!0};else{!u&&e.transceivers[f]&&e.transceivers[f].rejected&&(e.transceivers[f]=e._createTransceiver(d,!0));var C=k.parseRtpParameters(b);if(!u){var G=k.getIceParameters(b,w);var N=k.getDtlsParameters(b,w);N.role="client"}z=k.parseRtpEncodingParameters(b);var X=k.parseRtcpParameters(b),F=0<k.matchPrefix(b,"a=end-of-candidates",w).length,y=k.matchPrefix(b,"a=candidate:").map(function(a){return k.parseCandidate(a)}).filter(function(a){return 1===
a.component});("offer"===a.type||"answer"===a.type)&&!u&&x&&0<f&&e.transceivers[f]&&(e._disposeIceAndDtlsTransports(f),e.transceivers[f].iceGatherer=e.transceivers[0].iceGatherer,e.transceivers[f].iceTransport=e.transceivers[0].iceTransport,e.transceivers[f].dtlsTransport=e.transceivers[0].dtlsTransport,e.transceivers[f].rtpSender&&e.transceivers[f].rtpSender.setTransport(e.transceivers[0].dtlsTransport),e.transceivers[f].rtpReceiver&&e.transceivers[f].rtpReceiver.setTransport(e.transceivers[0].dtlsTransport));
if("offer"!==a.type||u)"answer"!==a.type||u||(D=e.transceivers[f],Q=D.iceGatherer,d=D.iceTransport,M=D.dtlsTransport,H=D.rtpReceiver,u=D.sendEncodingParameters,b=D.localCapabilities,e.transceivers[f].recvEncodingParameters=z,e.transceivers[f].remoteCapabilities=C,e.transceivers[f].rtcpParameters=X,y.length&&"new"===d.state&&(!v&&!F||x&&0!==f?y.forEach(function(a){n(D.iceTransport,a)}):d.setRemoteCandidates(y)),x&&0!==f||("new"===d.state&&d.start(Q,G,"controlling"),"new"===M.state&&M.start(N)),!c(D.localCapabilities,
D.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&D.sendEncodingParameters[0].rtx&&delete D.sendEncodingParameters[0].rtx,e._transceive(D,"sendrecv"===q||"recvonly"===q,"sendrecv"===q||"sendonly"===q),!H||"sendrecv"!==q&&"sendonly"!==q?delete D.rtpReceiver:(q=H.track,A?(r[A.stream]||(r[A.stream]=new h.MediaStream),m(q,r[A.stream]),t.push([q,H,r[A.stream]])):(r.default||(r.default=new h.MediaStream),m(q,r.default),t.push([q,H,r.default]))));else{var D=e.transceivers[f]||
e._createTransceiver(d);D.mid=M;D.iceGatherer||(D.iceGatherer=e._createIceGatherer(f,x));y.length&&"new"===D.iceTransport.state&&(!F||x&&0!==f?y.forEach(function(a){n(D.iceTransport,a)}):D.iceTransport.setRemoteCandidates(y));b=h.RTCRtpReceiver.getCapabilities(d);15019>l&&(b.codecs=b.codecs.filter(function(a){return"rtx"!==a.name}));u=D.sendEncodingParameters||[{ssrc:1001*(2*f+2)}];G=!1;if("sendrecv"===q||"sendonly"===q){G=!D.rtpReceiver;var H=D.rtpReceiver||new h.RTCRtpReceiver(D.dtlsTransport,d);
if(G){q=H.track;if(!A||"-"!==A.stream)if(A){r[A.stream]||(r[A.stream]=new h.MediaStream,Object.defineProperty(r[A.stream],"id",{get:function(){return A.stream}}));Object.defineProperty(q,"id",{get:function(){return A.track}});var Q=r[A.stream]}else r.default||(r.default=new h.MediaStream),Q=r.default;Q&&(m(q,Q),D.associatedRemoteMediaStreams.push(Q));t.push([q,H,Q])}}else D.rtpReceiver&&D.rtpReceiver.track&&(D.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===
D.rtpReceiver.track.id});b&&p(b,a)}),D.associatedRemoteMediaStreams=[]);D.localCapabilities=b;D.remoteCapabilities=C;D.rtpReceiver=H;D.rtcpParameters=X;D.sendEncodingParameters=u;D.recvEncodingParameters=z;e._transceive(e.transceivers[f],!1,G)}}});void 0===e._dtlsRole&&(e._dtlsRole="offer"===a.type?"active":"passive");e._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?e._updateSignalingState("have-remote-offer"):e._updateSignalingState("stable");Object.keys(r).forEach(function(a){var c=
r[a];if(c.getTracks().length){if(-1===e.remoteStreams.indexOf(c)){e.remoteStreams.push(c);var f=new Event("addstream");f.stream=c;h.setTimeout(function(){e._dispatchEvent("addstream",f)})}t.forEach(function(a){c.id===a[2].id&&b(e,a[0],a[1],[c])})}});t.forEach(function(a){a[2]||b(e,a[0],a[1],[])});h.setTimeout(function(){e&&e.transceivers&&e.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),
a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};r.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};r.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};r.prototype._maybeFireNegotiationNeeded=
function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,h.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};r.prototype._updateIceConnectionState=function(){var a={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?
b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};r.prototype._updateConnectionState=function(){var a={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&
(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};r.prototype.createOffer=function(a){var b=this;if(b._isClosed)return Promise.reject(q("InvalidStateError","Can not call createOffer after close"));
var c=b.transceivers.filter(function(a){return"audio"===a.kind}).length,f=b.transceivers.filter(function(a){return"video"===a.kind}).length;if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(c=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio);void 0!==a.offerToReceiveVideo&&(f=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(b.transceivers.forEach(function(a){"audio"===
a.kind?(c--,0>c&&(a.wantReceive=!1)):"video"===a.kind&&(f--,0>f&&(a.wantReceive=!1))});0<c||0<f;)0<c&&(b._createTransceiver("audio"),c--),0<f&&(b._createTransceiver("video"),f--);var m=k.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.transceivers.forEach(function(a,c){var f=a.track,e=a.kind,m=a.mid||k.generateIdentifier();a.mid=m;a.iceGatherer||(a.iceGatherer=b._createIceGatherer(c,b.usingBundle));m=h.RTCRtpSender.getCapabilities(e);15019>l&&(m.codecs=m.codecs.filter(function(a){return"rtx"!==
a.name}));m.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});m.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&
(b.id=a.id)})});c=a.sendEncodingParameters||[{ssrc:1001*(2*c+1)}];f&&15019<=l&&"video"===e&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new h.RTCRtpReceiver(a.dtlsTransport,e));a.localCapabilities=m;a.sendEncodingParameters=c});"max-compat"!==b._config.bundlePolicy&&(m+="a=group:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");m+="a=ice-options:trickle\r\n";b.transceivers.forEach(function(a,c){m+=e(a,a.localCapabilities,"offer",a.stream,b._dtlsRole);
m+="a=rtcp-rsize\r\n";!a.iceGatherer||"new"===b.iceGatheringState||0!==c&&b.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;m+="a="+k.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(m+="a=end-of-candidates\r\n"))});a=new h.RTCSessionDescription({type:"offer",sdp:m});return Promise.resolve(a)};r.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(q("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==
a.signalingState&&"have-local-pranswer"!==a.signalingState)return Promise.reject(q("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var b=k.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&(b+="a=group:BUNDLE "+a.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");b+="a=ice-options:trickle\r\n";var f=k.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(h,k){if(!(k+1>f))if(h.rejected)"application"===
h.kind?b="DTLS/SCTP"===h.protocol?b+"m=application 0 DTLS/SCTP 5000\r\n":b+("m=application 0 "+h.protocol+" webrtc-datachannel\r\n"):"audio"===h.kind?b+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===h.kind&&(b+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),b+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+h.mid+"\r\n";else{if(h.stream){var m;"audio"===h.kind?m=h.stream.getAudioTracks()[0]:"video"===h.kind&&(m=h.stream.getVideoTracks()[0]);m&&15019<=l&&"video"===
h.kind&&!h.sendEncodingParameters[0].rtx&&(h.sendEncodingParameters[0].rtx={ssrc:h.sendEncodingParameters[0].ssrc+1})}k=c(h.localCapabilities,h.remoteCapabilities);!k.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&h.sendEncodingParameters[0].rtx&&delete h.sendEncodingParameters[0].rtx;b+=e(h,k,"answer",h.stream,a._dtlsRole);h.rtcpParameters&&h.rtcpParameters.reducedSize&&(b+="a=rtcp-rsize\r\n")}});var m=new h.RTCSessionDescription({type:"answer",sdp:b});return Promise.resolve(m)};
r.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(f,e){if(b._remoteDescription)if(a&&""!==a.candidate){var h=a.sdpMLineIndex;if(a.sdpMid)for(var l=0;l<b.transceivers.length;l++)if(b.transceivers[l].mid===a.sdpMid){h=l;break}var m=b.transceivers[h];if(m){if(m.rejected)return f();l=0<Object.keys(a.candidate).length?k.parseCandidate(a.candidate):{};if("tcp"===l.protocol&&
(0===l.port||9===l.port)||l.component&&1!==l.component)return f();if((0===h||0<h&&m.iceTransport!==b.transceivers[0].iceTransport)&&!n(m.iceTransport,l))return e(q("OperationError","Can not add ICE candidate"));e=a.candidate.trim();0===e.indexOf("a=")&&(e=e.substr(2));c=k.getMediaSections(b._remoteDescription.sdp);c[h]+="a="+(l.type?e:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=k.getDescription(b._remoteDescription.sdp)+c.join("")}else return e(q("OperationError","Can not add ICE candidate"))}else for(h=
0;h<b.transceivers.length&&(b.transceivers[h].rejected||(b.transceivers[h].iceTransport.addRemoteCandidate({}),c=k.getMediaSections(b._remoteDescription.sdp),c[h]+="a=end-of-candidates\r\n",b._remoteDescription.sdp=k.getDescription(b._remoteDescription.sdp)+c.join(""),!b.usingBundle));h++);else return e(q("InvalidStateError","Can not add ICE candidate without a remote description"));f()})};r.prototype.getStats=function(a){if(a&&a instanceof h.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&
c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw q("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver",
"RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=h[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;Object.keys(a).forEach(function(c){var e=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type;b.set(c,a[c])});return b})}}});var t=["createOffer",
"createAnswer"];t.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});t=["setLocalDescription","setRemoteDescription","addIceCandidate"];t.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===
typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return r}},{sdp:17}],17:[function(h,l,m){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,
10)}};e.localCName=e.generateIdentifier();e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};e.splitSections=function(a){return a.split("\nm=").map(function(a,e){return(0<e?"m="+a:a).trim()+"\r\n"})};e.getDescription=function(a){return(a=e.splitSections(a))&&a[0]};e.getMediaSections=function(a){a=e.splitSections(a);a.shift();return a};e.matchPrefix=function(a,c){return e.splitLines(a).filter(function(a){return 0===a.indexOf(c)})};e.parseCandidate=function(a){a=
0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var c={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},e=8;e<a.length;e+=2)switch(a[e]){case "raddr":c.relatedAddress=a[e+1];break;case "rport":c.relatedPort=parseInt(a[e+1],10);break;case "tcptype":c.tcpType=a[e+1];break;case "ufrag":c.ufrag=a[e+1];c.usernameFragment=a[e+1];break;default:c[a[e]]=a[e+1]}return c};
e.writeCandidate=function(a){var c=[];c.push(a.foundation);c.push(a.component);c.push(a.protocol.toUpperCase());c.push(a.priority);c.push(a.address||a.ip);c.push(a.port);var e=a.type;c.push("typ");c.push(e);"host"!==e&&a.relatedAddress&&a.relatedPort&&(c.push("raddr"),c.push(a.relatedAddress),c.push("rport"),c.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(c.push("tcptype"),c.push(a.tcpType));if(a.usernameFragment||a.ufrag)c.push("ufrag"),c.push(a.usernameFragment||a.ufrag);return"candidate:"+
c.join(" ")};e.parseIceOptions=function(a){return a.substr(14).split(" ")};e.parseRtpMap=function(a){a=a.substr(9).split(" ");var c={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");c.name=a[0];c.clockRate=parseInt(a[1],10);c.channels=3===a.length?parseInt(a[2],10):1;c.numChannels=c.channels;return c};e.writeRtpMap=function(a){var c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);var e=a.channels||a.numChannels||1;return"a=rtpmap:"+c+" "+a.name+"/"+a.clockRate+(1!==
e?"/"+e:"")+"\r\n"};e.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};e.parseFmtp=function(a){for(var c={},e=a.substr(a.indexOf(" ")+1).split(";"),h=0;h<e.length;h++)a=e[h].trim().split("="),c[a[0].trim()]=a[1];return c};e.writeFmtp=function(a){var c="",e=a.payloadType;
void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var h=[];Object.keys(a.parameters).forEach(function(c){a.parameters[c]?h.push(c+"="+a.parameters[c]):h.push(c)});c+="a=fmtp:"+e+" "+h.join(";")+"\r\n"}return c};e.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};e.writeRtcpFb=function(a){var c="",e=a.payloadType;void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);a.rtcpFeedback&&
a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){c+="a=rtcp-fb:"+e+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return c};e.parseSsrcMedia=function(a){var c=a.indexOf(" "),e={ssrc:parseInt(a.substr(7,c-7),10)},h=a.indexOf(":",c);-1<h?(e.attribute=a.substr(c+1,h-c-1),e.value=a.substr(h+1)):e.attribute=a.substr(c+1);return e};e.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};e.getMid=
function(a){if(a=e.matchPrefix(a,"a=mid:")[0])return a.substr(6)};e.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};e.getDtlsParameters=function(a,c){return{role:"auto",fingerprints:e.matchPrefix(a+c,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(a,c){var e="a=setup:"+c+"\r\n";a.fingerprints.forEach(function(a){e+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return e};e.getIceParameters=function(a,c){a=e.splitLines(a);
a=a.concat(e.splitLines(c));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)}};e.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+(a.password+"\r\n")};e.parseRtpParameters=function(a){for(var c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},f=e.splitLines(a)[0].split(" "),h=3;h<f.length;h++){var l=f[h],k=e.matchPrefix(a,
"a=rtpmap:"+l+" ")[0];if(k){k=e.parseRtpMap(k);var m=e.matchPrefix(a,"a=fmtp:"+l+" ");k.parameters=m.length?e.parseFmtp(m[0]):{};k.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb);c.codecs.push(k);switch(k.name.toUpperCase()){case "RED":case "ULPFEC":c.fecMechanisms.push(k.name.toUpperCase())}}}e.matchPrefix(a,"a=extmap:").forEach(function(a){c.headerExtensions.push(e.parseExtmap(a))});return c};e.writeRtpDescription=function(a,c){var f="";f+="m="+a+" ";f+=0<c.codecs.length?"9":
"0";f+=" UDP/TLS/RTP/SAVPF ";f+=c.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";f+="c=IN IP4 0.0.0.0\r\n";f+="a=rtcp:9 IN IP4 0.0.0.0\r\n";c.codecs.forEach(function(a){f+=e.writeRtpMap(a);f+=e.writeFmtp(a);f+=e.writeRtcpFb(a)});var h=0;c.codecs.forEach(function(a){a.maxptime>h&&(h=a.maxptime)});0<h&&(f+="a=maxptime:"+h+"\r\n");f+="a=rtcp-mux\r\n";c.headerExtensions&&c.headerExtensions.forEach(function(a){f+=e.writeExtmap(a)});
return f};e.parseRtpEncodingParameters=function(a){var c=[],f=e.parseRtpParameters(a),h=-1!==f.fecMechanisms.indexOf("RED"),l=-1!==f.fecMechanisms.indexOf("ULPFEC"),k=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),m=0<k.length&&k[0].ssrc,n;k=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<k.length&&1<k[0].length&&k[0][0]===m&&(n=k[0][1]);f.codecs.forEach(function(a){"RTX"===
a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:m,codecPayloadType:parseInt(a.parameters.apt,10)},m&&n&&(a.rtx={ssrc:n}),c.push(a),h&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:m,mechanism:l?"red+ulpfec":"red"},c.push(a)))});0===c.length&&m&&c.push({ssrc:m});var t=e.matchPrefix(a,"b=");t.length&&(t=0===t[0].indexOf("b=TIAS:")?parseInt(t[0].substr(7),10):0===t[0].indexOf("b=AS:")?950*parseInt(t[0].substr(5),10)-16E3:void 0,c.forEach(function(a){a.maxBitrate=t}));return c};e.parseRtcpParameters=
function(a){var c={},f=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];f&&(c.cname=f.value,c.ssrc=f.ssrc);f=e.matchPrefix(a,"a=rtcp-rsize");c.reducedSize=0<f.length;c.compound=0===f.length;a=e.matchPrefix(a,"a=rtcp-mux");c.mux=0<a.length;return c};e.parseMsid=function(a){var c=e.matchPrefix(a,"a=msid:");if(1===c.length)return a=c[0].substr(7).split(" "),{stream:a[0],track:a[1]};a=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===
a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(a,c,f){c=void 0!==c?c:2;a=a?a:e.generateSessionId();return"v=0\r\no="+(f||"thisisadapterortc")+" "+a+" "+c+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(a,c,f,h){c=e.writeRtpDescription(a.kind,c);c+=e.writeIceParameters(a.iceGatherer.getLocalParameters());c+=e.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),
"offer"===f?"actpass":"active");c+="a=mid:"+a.mid+"\r\n";c=a.direction?c+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?c+"a=sendrecv\r\n":a.rtpSender?c+"a=sendonly\r\n":a.rtpReceiver?c+"a=recvonly\r\n":c+"a=inactive\r\n";a.rtpSender&&(f="msid:"+h.id+" "+a.rtpSender.track.id+"\r\n",c=c+("a="+f)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+f),a.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+f,c+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+
a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));c+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n");return c};e.getDirection=function(a,c){a=e.splitLines(a);for(var f=0;f<a.length;f++)switch(a[f]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[f].substr(2)}return c?e.getDirection(c):"sendrecv"};e.getKind=function(a){return e.splitLines(a)[0].split(" ")[0].substr(2)};
e.isRejected=function(a){return"0"===a.split(" ",2)[1]};e.parseMLine=function(a){a=e.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};e.parseOLine=function(a){a=e.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};e.isValidSDP=function(a){if("string"!==typeof a||0===a.length)return!1;a=e.splitLines(a);for(var c=0;c<a.length;c++)if(2>
a[c].length||"="!==a[c].charAt(1))return!1;return!0};"object"===typeof l&&(l.exports=e)},{}]},{},[1])(1)}()},function(l,t,n){n(84)(n(85))},function(l,t){l.exports=function(l){function h(h){"undefined"!==typeof console&&(console.error||console.log)("[Script Loader]",h)}try{"undefined"!==typeof execScript&&"undefined"!==typeof attachEvent&&"undefined"===typeof addEventListener?execScript(l):"undefined"!==typeof eval?eval.call(null,l):h("EvalError: No eval function available")}catch(u){h(u)}}},function(l,
t){l.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\n* directory of this distribution and at\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n*/\nthis.L = this.L || {};\n\n/**\n * @param {HTMLElement} element\n * @param {String}      prop\n * @returns {String|Number}\n */\nL.GetComputedStyle = (computedElement, prop) => {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n  return computedElement.style[prop];\n};\n\n/**\n *\n * @type {Function}\n * @constructor\n */\nL.ElementQueries = function ElementQueries() {\n  /**\n   *\n   * @param element\n   * @returns {Number}\n   */\n  function getEmSize(element = document.documentElement) {\n    const fontSize = L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n\n  /**\n   *\n   * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\n   *\n   * @param element\n   * @param value\n   * @param units\n   * @returns {*}\n   */\n  function convertToPx(element, originalValue) {\n    let vh;\n    let vw;\n    let chooser;\n    const units = originalValue.replace(/[0-9]*/, '');\n    const value = parseFloat(originalValue);\n    switch (units) {\n      case 'px':\n        return value;\n      case 'em':\n        return value * getEmSize(element);\n      case 'rem':\n        return value * getEmSize();\n      // Viewport units!\n      // According to http://quirksmode.org/mobile/tableViewport.html\n      // documentElement.clientWidth/Height gets us the most reliable info\n      case 'vw':\n        return (value * document.documentElement.clientWidth) / 100;\n      case 'vh':\n        return (value * document.documentElement.clientHeight) / 100;\n      case 'vmin':\n      case 'vmax':\n        vw = document.documentElement.clientWidth / 100;\n        vh = document.documentElement.clientHeight / 100;\n        chooser = Math[units === 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n      default:\n        return value;\n      // for now, not supporting physical units (since they are just a set number of px)\n      // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @constructor\n   */\n  function SetupInformation(element) {\n    this.element = element;\n    this.options = [];\n    let i;\n    let j;\n    let option;\n    let width = 0;\n    let height = 0;\n    let value;\n    let actualValue;\n    let attrValues;\n    let attrValue;\n    let attrName;\n\n    /**\n     * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\n     */\n    this.addOption = (newOption) => {\n      this.options.push(newOption);\n    };\n\n    const attributes = ['min-width', 'min-height', 'max-width', 'max-height'];\n\n    /**\n     * Extracts the computed width/height and sets to min/max- attribute.\n     */\n    this.call = () => {\n      // extract current dimensions\n      width = this.element.offsetWidth;\n      height = this.element.offsetHeight;\n\n      attrValues = {};\n\n      for (i = 0, j = this.options.length; i < j; i += 1) {\n        option = this.options[i];\n        value = convertToPx(this.element, option.value);\n\n        actualValue = option.property === 'width' ? width : height;\n        attrName = `${option.mode}-${option.property}`;\n        attrValue = '';\n\n        if (option.mode === 'min' && actualValue >= value) {\n          attrValue += option.value;\n        }\n\n        if (option.mode === 'max' && actualValue <= value) {\n          attrValue += option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] = '';\n        if (attrValue && (` ${attrValues[attrName]} `)\n          .indexOf(` ${attrValue} `) === -1) {\n          attrValues[attrName] += ` ${attrValue}`;\n        }\n      }\n\n      for (let k = 0; k < attributes.length; k += 1) {\n        if (attrValues[attributes[k]]) {\n          this.element.setAttribute(\n            attributes[k],\n            attrValues[attributes[k]].substr(1),\n          );\n        } else {\n          this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object}      options\n   */\n  function setupElement(originalElement, options) {\n    const element = originalElement;\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation = new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor = new L.ResizeSensor(element, () => {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n\n  /**\n   * @param {String} selector\n   * @param {String} mode min|max\n   * @param {String} property width|height\n   * @param {String} value\n   */\n  function queueQuery(selector, mode, property, value) {\n    let query;\n    if (document.querySelectorAll) query = document.querySelectorAll.bind(document);\n    if (!query && typeof $$ !== 'undefined') query = $$;\n    if (!query && typeof jQuery !== 'undefined') query = jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    const elements = query(selector) || [];\n    for (let i = 0, j = elements.length; i < j; i += 1) {\n      elements[i] = setupElement(elements[i], {\n        mode,\n        property,\n        value,\n      });\n    }\n  }\n\n  const regex = /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?=[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi; // jshint ignore:line\n\n  /**\n   * @param {String} css\n   */\n  function extractQuery(originalCss) {\n    let match;\n    const css = originalCss.replace(/'/g, '\"');\n    while ((match = regex.exec(css)) !== null) {\n      if (match.length > 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n\n  /**\n   * @param {CssRule[]|String} rules\n   */\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n    let selector = '';\n    let rules = originalRules;\n    if (typeof originalRules === 'string') {\n      rules = originalRules.toLowerCase();\n      if (rules.indexOf('min-width') !== -1 || rules.indexOf('max-width') !== -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (let i = 0, j = rules.length; i < j; i += 1) {\n        if (rules[i].type === 1) {\n          selector = rules[i].selectorText || rules[i].cssText;\n          if (selector.indexOf('min-height') !== -1 ||\n            selector.indexOf('max-height') !== -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !== -1 ||\n            selector.indexOf('max-width') !== -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type === 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n\n  /**\n   * Searches all css rules and setups the event listener\n   * to all elements with element query rules..\n   */\n  this.init = () => {\n  try {\n    const styleSheets = document.styleSheets || [];\n    for (let i = 0, j = styleSheets.length; i < j; i += 1) {\n      readRules(styleSheets[i].cssText ||\n        styleSheets[i].cssRules ||\n        styleSheets[i].rules);\n    }\n  }catch(error){\n    console.warn (\"init() readRules failed : \" + error);\n  }\n  };\n};\n\nfunction init() {\n  (new L.ElementQueries()).init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n\n/**\n * Iterate over each of the provided element(s).\n *\n * @param {HTMLElement|HTMLElement[]} elements\n * @param {Function}                  callback\n */\nfunction forEachElement(elements, callback = () => { }) {\n  const elementsType = Object.prototype.toString.call(elements);\n  const isCollectionTyped = (elementsType === '[object Array]' ||\n    (elementsType === '[object NodeList]') ||\n    (elementsType === '[object HTMLCollection]') ||\n    (typeof jQuery !== 'undefined' && elements instanceof jQuery) || // jquery\n    (typeof Elements !== 'undefined' && elements instanceof Elements) // mootools\n  );\n  let i = 0;\n  const j = elements.length;\n  if (isCollectionTyped) {\n    for (; i < j; i += 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n/**\n * Class for dimension change detection.\n *\n * @param {Element|Element[]|Elements|jQuery} element\n * @param {Function} callback\n *\n * @constructor\n */\nL.ResizeSensor = function ResizeSensor(element, callback = () => { }) {\n  /**\n   *\n   * @constructor\n   */\n  function EventQueue() {\n    let q = [];\n    this.add = (ev) => {\n      q.push(ev);\n    };\n\n    let i;\n    let j;\n    this.call = () => {\n      for (i = 0, j = q.length; i < j; i += 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove = (ev) => {\n      const newQueue = [];\n      for (i = 0, j = q.length; i < j; i += 1) {\n        if (q[i] !== ev) newQueue.push(q[i]);\n      }\n      q = newQueue;\n    };\n\n    this.length = () => q.length;\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @param {Function}    resized\n   */\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    const customRequestAnimationFrame = window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame ||\n      function delay(fn) {\n        return window.setTimeout(fn, 20);\n      };\n\n    const newElement = htmlElement;\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached = new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor = document.createElement('div');\n    newElement.resizeSensor.className = 'resize-sensor';\n    const style = 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\n      'overflow: hidden; z-index: -1; visibility: hidden;';\n    const styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\n\n    newElement.resizeSensor.style.cssText = style;\n    newElement.resizeSensor.innerHTML =\n      `<div class=\"resize-sensor-expand\" style=\"${style}\">` +\n      `<div style=\"${styleChild}\"></div>` +\n      '</div>' +\n      `<div class=\"resize-sensor-shrink\" style=\"${style}\">` +\n      `<div style=\"${styleChild} width: 200%; height: 200%\"></div>` +\n      '</div>';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') === 'static') {\n      newElement.style.position = 'relative';\n    }\n\n    const expand = newElement.resizeSensor.childNodes[0];\n    const expandChild = expand.childNodes[0];\n    const shrink = newElement.resizeSensor.childNodes[1];\n\n    const reset = () => {\n      expandChild.style.width = `${100000}px`;\n      expandChild.style.height = `${100000}px`;\n\n      expand.scrollLeft = 100000;\n      expand.scrollTop = 100000;\n\n      shrink.scrollLeft = 100000;\n      shrink.scrollTop = 100000;\n    };\n\n    reset();\n    let dirty = false;\n\n    const dirtyChecking = () => {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty = false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    let lastWidth;\n    let lastHeight;\n    let cachedWidth;\n    let cachedHeight; // useful to not query offsetWidth twice\n\n    const onScroll = () => {\n      if ((cachedWidth = newElement.offsetWidth) !== lastWidth ||\n        (cachedHeight = newElement.offsetHeight) !== lastHeight) {\n        dirty = true;\n\n        lastWidth = cachedWidth;\n        lastHeight = cachedHeight;\n      }\n      reset();\n    };\n\n    const addEvent = (el, name, cb) => {\n      if (el.attachEvent) {\n        el.attachEvent(`on${name}`, cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, (elem) => {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach = (ev) => {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach = (element, ev) => {\n  forEachElement(element, (elem) => {\n    const elementItem = elem;\n    if (elementItem.resizedAttached && typeof ev === 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};\n"}])["default"];

//# sourceMappingURL=EnxRtc.js.map
